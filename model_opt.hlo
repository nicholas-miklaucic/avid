HloModule jit_loss, is_scheduled=true, entry_computation_layout={(f32[256]{0}, f32[256]{0}, f32[256]{0}, f32[256]{0}, f32[256]{0}, /*index=5*/f32[256]{0}, f32[256]{0}, f32[256,256]{1,0}, f32[8,32]{1,0}, f32[256,8,32]{2,1,0}, /*index=10*/f32[256]{0}, f32[8,32,256]{2,1,0}, f32[8,32]{1,0}, f32[256,8,32]{2,1,0}, f32[8,32]{1,0}, /*index=15*/f32[256,8,32]{2,1,0}, f32[256]{0}, f32[256]{0}, f32[256]{0}, f32[256]{0}, /*index=20*/f32[256]{0}, f32[256,256]{1,0}, f32[8,32]{1,0}, f32[256,8,32]{2,1,0}, f32[256]{0}, /*index=25*/f32[8,32,256]{2,1,0}, f32[8,32]{1,0}, f32[256,8,32]{2,1,0}, f32[8,32]{1,0}, f32[256,8,32]{2,1,0}, /*index=30*/f32[1]{0}, f32[256,1]{1,0}, f32[256]{0}, f32[1728,256]{1,0}, bf16[512,256]{1,0}, /*index=35*/f32[56,64]{1,0})->(bf16[], f32[256]{0}, f32[256]{0}, f32[256]{0}, f32[256]{0}, /*index=5*/f32[256]{0}, f32[256]{0}, f32[256]{0}, f32[256,256]{1,0}, f32[8,32]{1,0}, /*index=10*/f32[256,8,32]{2,1,0}, f32[256]{0}, f32[8,32,256]{2,1,0}, f32[8,32]{1,0}, f32[256,8,32]{2,1,0}, /*index=15*/f32[8,32]{1,0}, f32[256,8,32]{2,1,0}, f32[256]{0}, f32[256]{0}, f32[256]{0}, /*index=20*/f32[256]{0}, f32[256]{0}, f32[256,256]{1,0}, f32[8,32]{1,0}, f32[256,8,32]{2,1,0}, /*index=25*/f32[256]{0}, f32[8,32,256]{2,1,0}, f32[8,32]{1,0}, f32[256,8,32]{2,1,0}, f32[8,32]{1,0}, /*index=30*/f32[256,8,32]{2,1,0}, f32[1]{0}, f32[256,1]{1,0}, f32[256]{0}, f32[1728,256]{1,0}, /*index=35*/bf16[512,256]{1,0}, f32[56,64]{1,0})}, allow_spmd_sharding_propagation_to_output={true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true}, frontend_attributes={fingerprint_before_lhs="969cd50f026cde036289fbde43843964"}

%fused_convert (param_0.2: bf16[], param_1.2: bf16[]) -> bf16[] {
  %param_1.2 = bf16[] parameter(1)
  %convert.1320.1 = f32[] convert(bf16[] %param_1.2)
  %param_0.2 = bf16[] parameter(0)
  %convert.1321.1 = f32[] convert(bf16[] %param_0.2)
  %add.169.1 = f32[] add(f32[] %convert.1320.1, f32[] %convert.1321.1), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/vmap(vmap(LazyInMLP_0))/Dense_0/reduce_sum[axes=(0, 1)]" source_file="/home/nicholas/programs/avid/avid/layers.py" source_line=49}
  ROOT %convert.1322.1 = bf16[] convert(f32[] %add.169.1)
}

%region_26.806 (Arg_0.807.0: bf16[], Arg_1.808.0: bf16[]) -> bf16[] {
  %Arg_1.808.0 = bf16[] parameter(1)
  %Arg_0.807.0 = bf16[] parameter(0)
  ROOT %loop_convert_fusion = bf16[] fusion(bf16[] %Arg_1.808.0, bf16[] %Arg_0.807.0), kind=kLoop, calls=%fused_convert
}

%region_26.806.clone.27 (Arg_0.30.0: f32[], Arg_1.30.0: f32[]) -> f32[] {
  %Arg_1.30.0 = f32[] parameter(1)
  %Arg_0.30.0 = f32[] parameter(0)
  ROOT %add.197.0 = f32[] add(f32[] %Arg_0.30.0, f32[] %Arg_1.30.0), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/vmap(vmap(LazyInMLP_0))/Dense_0/reduce_sum[axes=(0, 1)]" source_file="/home/nicholas/programs/avid/avid/layers.py" source_line=49}
}

%fused_scatter (param_0.3: bf16[56,64], param_1.3: s32[260,1], param_2.651: f32[216,5,52,64]) -> bf16[56,64] {
  %param_0.3 = bf16[56,64]{1,0} parameter(0)
  %param_1.3 = s32[260,1]{1,0} parameter(1)
  %param_2.651 = f32[216,5,52,64]{3,2,1,0} parameter(2)
  %constant_60_2 = bf16[] constant(0)
  %convert.1433.31 = f32[] convert(bf16[] %constant_60_2)
  %reduce.1316.5 = f32[5,52,64]{2,1,0} reduce(f32[216,5,52,64]{3,2,1,0} %param_2.651, f32[] %convert.1433.31), dimensions={0}, to_apply=%region_26.806.clone.27, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/spec_embed/vmap(vmap(vmap(species_embed)))/reduce_sum[axes=(0,)]" source_file="/home/nicholas/programs/avid/avid/encoder.py" source_line=38}
  %convert.1518.3 = bf16[5,52,64]{2,1,0} convert(f32[5,52,64]{2,1,0} %reduce.1316.5)
  %bitcast.6432.1 = bf16[260,1,64]{2,0,1} bitcast(bf16[5,52,64]{2,1,0} %convert.1518.3)
  ROOT %scatter.0.1 = bf16[56,64]{1,0} scatter(bf16[56,64]{1,0} %param_0.3, s32[260,1]{1,0} %param_1.3, bf16[260,1,64]{2,0,1} %bitcast.6432.1), update_window_dims={1,2}, inserted_window_dims={}, scatter_dims_to_operand_dims={0}, index_vector_dim=1, to_apply=%region_26.806, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/spec_embed/vmap(vmap(vmap(species_embed)))/species_embed/jit(_take)/scatter-add[update_consts=() dimension_numbers=ScatterDimensionNumbers(update_window_dims=(2,), inserted_window_dims=(0,), scatter_dims_to_operand_dims=(0,)) indices_are_sorted=False unique_indices=False mode=GatherScatterMode.FILL_OR_DROP]" source_file="/home/nicholas/programs/avid/avid/encoder.py" source_line=38}
}

%region_2.176 (Arg_0.177.0: f32[], Arg_1.178.0: f32[]) -> f32[] {
  %Arg_1.178.0 = f32[] parameter(1)
  %Arg_0.177.0 = f32[] parameter(0)
  ROOT %add.166.0 = f32[] add(f32[] %Arg_0.177.0, f32[] %Arg_1.178.0), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/LayerNorm_0/reduce_sum[axes=(2,)]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
}

%fused_multiply_reduce (param_0.1200: f32[256,52], param_1.1332: f32[], param_2.799: bf16[52], param_3.508: f32[52], param_4.315: f32[1], param_5.294: f32[256,1]) -> (f32[256,1], f32[256,52]) {
  %param_0.1200 = f32[256,52]{1,0} parameter(0)
  %param_3.508 = f32[52]{0} parameter(3)
  %param_4.315 = f32[1]{0} parameter(4)
  %convert.1413.11 = bf16[1]{0} convert(f32[1]{0} %param_4.315), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/vmap(head)/Dense_0/convert_element_type[new_dtype=bfloat16 weak_type=False]" source_file="/home/nicholas/programs/avid/avid/layers.py" source_line=49}
  %bitcast.5084.18 = bf16[] bitcast(bf16[1]{0} %convert.1413.11), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/vmap(head)/Dense_0/add" source_file="/home/nicholas/programs/avid/avid/layers.py" source_line=49}
  %convert.1540.15 = f32[] convert(bf16[] %bitcast.5084.18)
  %broadcast.631.15 = f32[52]{0} broadcast(f32[] %convert.1540.15), dimensions={}, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/vmap(head)/Dense_0/add" source_file="/home/nicholas/programs/avid/avid/layers.py" source_line=49}
  %add.226.15 = f32[52]{0} add(f32[52]{0} %param_3.508, f32[52]{0} %broadcast.631.15), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/vmap(head)/Dense_0/add" source_file="/home/nicholas/programs/avid/avid/layers.py" source_line=49}
  %param_2.799 = bf16[52]{0} parameter(2)
  %convert.1415.13 = f32[52]{0} convert(bf16[52]{0} %param_2.799)
  %add.227.13 = f32[52]{0} add(f32[52]{0} %add.226.15, f32[52]{0} %convert.1415.13), metadata={op_name="jit(loss)/jit(main)/jvp(cond)/branch_1_fun/sub" source_file="/home/nicholas/programs/avid/avid/config.py" source_line=380}
  %constant_59_1 = bf16[] constant(0.5)
  %convert.1417.13 = f32[] convert(bf16[] %constant_59_1)
  %param_1.1332 = f32[] parameter(1)
  %constant_67_1 = f32[] constant(0.0192307699)
  %multiply.354.15 = f32[] multiply(f32[] %param_1.1332, f32[] %constant_67_1), metadata={op_name="jit(loss)/jit(main)/jvp(cond)/branch_1_fun/div" source_file="/home/nicholas/programs/avid/avid/config.py" source_line=380}
  %sqrt.2.15 = f32[] sqrt(f32[] %multiply.354.15), metadata={op_name="jit(loss)/jit(main)/jvp(cond)/branch_1_fun/sqrt" source_file="/home/nicholas/programs/avid/avid/config.py" source_line=380}
  %divide.40.13 = f32[] divide(f32[] %convert.1417.13, f32[] %sqrt.2.15), metadata={op_name="jit(loss)/jit(main)/jvp(cond)/branch_1_fun/div" source_file="/home/nicholas/programs/avid/avid/config.py" source_line=380}
  %multiply.355.13 = f32[] multiply(f32[] %divide.40.13, f32[] %constant_67_1), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(cond))/branch_1_fun/div" source_file="/home/nicholas/programs/avid/avid/config.py" source_line=380}
  %constant_37_1 = bf16[] constant(2)
  %convert.1418.13 = f32[] convert(bf16[] %constant_37_1)
  %multiply.358.13 = f32[] multiply(f32[] %multiply.355.13, f32[] %convert.1418.13), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(cond))/branch_1_fun/mul" source_file="/home/nicholas/programs/avid/avid/config.py" source_line=380}
  %broadcast.633.9 = f32[52]{0} broadcast(f32[] %multiply.358.13), dimensions={}, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(cond))/branch_1_fun/mul" source_file="/home/nicholas/programs/avid/avid/config.py" source_line=380}
  %multiply.359.9 = f32[52]{0} multiply(f32[52]{0} %add.227.13, f32[52]{0} %broadcast.633.9), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(cond))/branch_1_fun/mul" source_file="/home/nicholas/programs/avid/avid/config.py" source_line=380}
  %constant_66_3 = f32[] constant(0.001953125)
  %broadcast.655.3 = f32[52]{0} broadcast(f32[] %constant_66_3), dimensions={}
  %multiply.442.3 = f32[52]{0} multiply(f32[52]{0} %multiply.359.9, f32[52]{0} %broadcast.655.3)
  %broadcast.656.7 = f32[256,52]{1,0} broadcast(f32[52]{0} %multiply.442.3), dimensions={1}
  %multiply.426.7 = f32[256,52]{1,0} multiply(f32[256,52]{1,0} %param_0.1200, f32[256,52]{1,0} %broadcast.656.7)
  %constant_50_7 = f32[] constant(0)
  %reduce.10.5 = f32[256]{0} reduce(f32[256,52]{1,0} %multiply.426.7, f32[] %constant_50_7), dimensions={1}, to_apply=%region_2.176
  %convert.1502.3 = bf16[256]{0} convert(f32[256]{0} %reduce.10.5), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/vmap(head)/Dense_0/dot_general[dimension_numbers=(((0,), (0,)), ((), ())) precision=None preferred_element_type=None]" source_file="/home/nicholas/programs/avid/avid/layers.py" source_line=49}
  %bitcast.6251.1 = bf16[256,1]{1,0} bitcast(bf16[256]{0} %convert.1502.3)
  %convert.1503.1 = f32[256,1]{1,0} convert(bf16[256,1]{1,0} %bitcast.6251.1), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/vmap(head)/Dense_0/convert_element_type[new_dtype=float32 weak_type=False]" source_file="/home/nicholas/programs/avid/avid/layers.py" source_line=49}
  %broadcast.634.3.clone.1 = f32[256,52]{1,0} broadcast(f32[52]{0} %multiply.359.9), dimensions={1}, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/vmap(head)/Dense_0/dot_general[dimension_numbers=(((1,), (1,)), ((), ())) precision=None preferred_element_type=None]" source_file="/home/nicholas/programs/avid/avid/layers.py" source_line=49}
  %param_5.294 = f32[256,1]{1,0} parameter(5)
  %convert.1411.1.clone.1 = bf16[256,1]{1,0} convert(f32[256,1]{1,0} %param_5.294), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/vmap(head)/Dense_0/convert_element_type[new_dtype=bfloat16 weak_type=False]" source_file="/home/nicholas/programs/avid/avid/layers.py" source_line=49}
  %bitcast.5070.8.clone.1 = bf16[256]{0} bitcast(bf16[256,1]{1,0} %convert.1411.1.clone.1)
  %convert.1539.5.clone.1 = f32[256]{0} convert(bf16[256]{0} %bitcast.5070.8.clone.1)
  %broadcast.651.3.clone.1 = f32[256,52]{1,0} broadcast(f32[256]{0} %convert.1539.5.clone.1), dimensions={0}, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/vmap(head)/Dense_0/dot_general[dimension_numbers=(((1,), (0,)), ((), ())) precision=None preferred_element_type=None]" source_file="/home/nicholas/programs/avid/avid/layers.py" source_line=49}
  %multiply.360.3.clone.1 = f32[256,52]{1,0} multiply(f32[256,52]{1,0} %broadcast.634.3.clone.1, f32[256,52]{1,0} %broadcast.651.3.clone.1), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/vmap(head)/Dense_0/dot_general[dimension_numbers=(((1,), (1,)), ((), ())) precision=None preferred_element_type=None]" source_file="/home/nicholas/programs/avid/avid/layers.py" source_line=49}
  %broadcast.564.1.clone.1 = f32[256,52]{1,0} broadcast(f32[] %constant_66_3), dimensions={}
  %multiply.361.1.clone.1 = f32[256,52]{1,0} multiply(f32[256,52]{1,0} %multiply.360.3.clone.1, f32[256,52]{1,0} %broadcast.564.1.clone.1), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/div" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=250}
  ROOT %tuple.50 = (f32[256,1]{1,0}, f32[256,52]{1,0}) tuple(f32[256,1]{1,0} %convert.1503.1, f32[256,52]{1,0} %multiply.361.1.clone.1)
}

%region_26.806.clone.22 (Arg_0.25.0: f32[], Arg_1.25.0: f32[]) -> f32[] {
  %Arg_1.25.0 = f32[] parameter(1)
  %Arg_0.25.0 = f32[] parameter(0)
  ROOT %add.170.0 = f32[] add(f32[] %Arg_0.25.0, f32[] %Arg_1.25.0), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/vmap(vmap(LazyInMLP_0))/Dense_0/reduce_sum[axes=(0, 1)]" source_file="/home/nicholas/programs/avid/avid/layers.py" source_line=49}
}

%fused_reduce (param_0.1256: f32[], param_1.1333: bf16[52], param_2.800: f32[52], param_3.509: f32[1]) -> f32[1] {
  %param_2.800 = f32[52]{0} parameter(2)
  %param_3.509 = f32[1]{0} parameter(3)
  %convert.1413.5 = bf16[1]{0} convert(f32[1]{0} %param_3.509), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/vmap(head)/Dense_0/convert_element_type[new_dtype=bfloat16 weak_type=False]" source_file="/home/nicholas/programs/avid/avid/layers.py" source_line=49}
  %bitcast.5084.12 = bf16[] bitcast(bf16[1]{0} %convert.1413.5), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/vmap(head)/Dense_0/add" source_file="/home/nicholas/programs/avid/avid/layers.py" source_line=49}
  %convert.1540.9 = f32[] convert(bf16[] %bitcast.5084.12)
  %broadcast.631.9 = f32[52]{0} broadcast(f32[] %convert.1540.9), dimensions={}, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/vmap(head)/Dense_0/add" source_file="/home/nicholas/programs/avid/avid/layers.py" source_line=49}
  %add.226.9 = f32[52]{0} add(f32[52]{0} %param_2.800, f32[52]{0} %broadcast.631.9), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/vmap(head)/Dense_0/add" source_file="/home/nicholas/programs/avid/avid/layers.py" source_line=49}
  %param_1.1333 = bf16[52]{0} parameter(1)
  %convert.1415.7 = f32[52]{0} convert(bf16[52]{0} %param_1.1333)
  %add.227.7 = f32[52]{0} add(f32[52]{0} %add.226.9, f32[52]{0} %convert.1415.7), metadata={op_name="jit(loss)/jit(main)/jvp(cond)/branch_1_fun/sub" source_file="/home/nicholas/programs/avid/avid/config.py" source_line=380}
  %constant_59_3 = bf16[] constant(0.5)
  %convert.1417.7 = f32[] convert(bf16[] %constant_59_3)
  %param_0.1256 = f32[] parameter(0)
  %constant_67_4 = f32[] constant(0.0192307699)
  %multiply.354.9 = f32[] multiply(f32[] %param_0.1256, f32[] %constant_67_4), metadata={op_name="jit(loss)/jit(main)/jvp(cond)/branch_1_fun/div" source_file="/home/nicholas/programs/avid/avid/config.py" source_line=380}
  %sqrt.2.9 = f32[] sqrt(f32[] %multiply.354.9), metadata={op_name="jit(loss)/jit(main)/jvp(cond)/branch_1_fun/sqrt" source_file="/home/nicholas/programs/avid/avid/config.py" source_line=380}
  %divide.40.7 = f32[] divide(f32[] %convert.1417.7, f32[] %sqrt.2.9), metadata={op_name="jit(loss)/jit(main)/jvp(cond)/branch_1_fun/div" source_file="/home/nicholas/programs/avid/avid/config.py" source_line=380}
  %multiply.355.7 = f32[] multiply(f32[] %divide.40.7, f32[] %constant_67_4), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(cond))/branch_1_fun/div" source_file="/home/nicholas/programs/avid/avid/config.py" source_line=380}
  %constant_37_3 = bf16[] constant(2)
  %convert.1418.7 = f32[] convert(bf16[] %constant_37_3)
  %multiply.358.7 = f32[] multiply(f32[] %multiply.355.7, f32[] %convert.1418.7), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(cond))/branch_1_fun/mul" source_file="/home/nicholas/programs/avid/avid/config.py" source_line=380}
  %broadcast.633.3 = f32[52]{0} broadcast(f32[] %multiply.358.7), dimensions={}, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(cond))/branch_1_fun/mul" source_file="/home/nicholas/programs/avid/avid/config.py" source_line=380}
  %multiply.359.3 = f32[52]{0} multiply(f32[52]{0} %add.227.7, f32[52]{0} %broadcast.633.3), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(cond))/branch_1_fun/mul" source_file="/home/nicholas/programs/avid/avid/config.py" source_line=380}
  %constant_60_25 = bf16[] constant(0)
  %convert.1433.35 = f32[] convert(bf16[] %constant_60_25)
  %reduce.15.5 = f32[] reduce(f32[52]{0} %multiply.359.3, f32[] %convert.1433.35), dimensions={0}, to_apply=%region_26.806.clone.22, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/vmap(head)/Dense_0/reduce_sum[axes=(0,)]" source_file="/home/nicholas/programs/avid/avid/layers.py" source_line=49}
  %convert.1499.3 = bf16[] convert(f32[] %reduce.15.5)
  %bitcast.6233.1 = bf16[1]{0} bitcast(bf16[] %convert.1499.3)
  ROOT %convert.1500.1 = f32[1]{0} convert(bf16[1]{0} %bitcast.6233.1), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/vmap(head)/Dense_0/convert_element_type[new_dtype=float32 weak_type=False]" source_file="/home/nicholas/programs/avid/avid/layers.py" source_line=49}
}

%fused_convert.1 (param_0.21: bf16[256,256]) -> f32[256,8,32] {
  %param_0.21 = bf16[256,256]{0,1} parameter(0)
  %bitcast.6222.1 = bf16[256,8,32]{2,1,0} bitcast(bf16[256,256]{0,1} %param_0.21)
  ROOT %convert.1497.1 = f32[256,8,32]{2,1,0} convert(bf16[256,8,32]{2,1,0} %bitcast.6222.1), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/MultiHeadDotProductAttention_0/value/convert_element_type[new_dtype=float32 weak_type=False]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
}

%fused_convert.2 (param_0.23: bf16[256,256]) -> f32[256,8,32] {
  %param_0.23 = bf16[256,256]{0,1} parameter(0)
  %bitcast.6193.1 = bf16[256,8,32]{2,1,0} bitcast(bf16[256,256]{0,1} %param_0.23)
  ROOT %convert.1493.1 = f32[256,8,32]{2,1,0} convert(bf16[256,8,32]{2,1,0} %bitcast.6193.1), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/MultiHeadDotProductAttention_0/query/convert_element_type[new_dtype=float32 weak_type=False]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
}

%fused_convert.3 (param_0.25: bf16[256,256]) -> f32[8,32,256] {
  %param_0.25 = bf16[256,256]{0,1} parameter(0)
  %bitcast.6169.1 = bf16[8,32,256]{2,1,0} bitcast(bf16[256,256]{0,1} %param_0.25)
  ROOT %convert.1490.1 = f32[8,32,256]{2,1,0} convert(bf16[8,32,256]{2,1,0} %bitcast.6169.1), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/MultiHeadDotProductAttention_0/out/convert_element_type[new_dtype=float32 weak_type=False]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
}

%fused_convert.4 (param_0.27: bf16[256,256]) -> f32[256,8,32] {
  %param_0.27 = bf16[256,256]{0,1} parameter(0)
  %bitcast.6140.1 = bf16[256,8,32]{2,1,0} bitcast(bf16[256,256]{0,1} %param_0.27)
  ROOT %convert.1486.1 = f32[256,8,32]{2,1,0} convert(bf16[256,8,32]{2,1,0} %bitcast.6140.1), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/MultiHeadDotProductAttention_0/key/convert_element_type[new_dtype=float32 weak_type=False]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
}

%fused_reduce.1 (param_0.1195: bf16[26624,256]) -> f32[208,256] {
  %param_0.1195 = bf16[26624,256]{1,0} parameter(0)
  %convert.1425.1 = f32[26624,256]{1,0} convert(bf16[26624,256]{1,0} %param_0.1195), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/LayerNorm_1/convert_element_type[new_dtype=float32 weak_type=False]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
  %bitcast.6065.1 = f32[208,128,256]{2,1,0} bitcast(f32[26624,256]{1,0} %convert.1425.1)
  %constant_50_2 = f32[] constant(0)
  ROOT %reduce.83.1 = f32[208,256]{1,0} reduce(f32[208,128,256]{2,1,0} %bitcast.6065.1, f32[] %constant_50_2), dimensions={1}, to_apply=%region_2.176, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/LayerNorm_1/reduce_sum[axes=(0, 1)]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
}

%fused_reduce.2 (param_0.1240: bf16[26624,256], param_1.1310: bf16[26624,256]) -> f32[208,256] {
  %param_1.1310 = bf16[26624,256]{1,0} parameter(1)
  %convert.1437.5 = f32[26624,256]{1,0} convert(bf16[26624,256]{1,0} %param_1.1310)
  %param_0.1240 = bf16[26624,256]{1,0} parameter(0)
  %convert.1441.5 = f32[26624,256]{1,0} convert(bf16[26624,256]{1,0} %param_0.1240)
  %add.237.5 = f32[26624,256]{1,0} add(f32[26624,256]{1,0} %convert.1437.5, f32[26624,256]{1,0} %convert.1441.5), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/MultiHeadDotProductAttention_0/query/add_any" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %bitcast.6040.1 = f32[208,128,256]{2,1,0} bitcast(f32[26624,256]{1,0} %add.237.5)
  %constant_50_47 = f32[] constant(0)
  ROOT %reduce.79.1 = f32[208,256]{1,0} reduce(f32[208,128,256]{2,1,0} %bitcast.6040.1, f32[] %constant_50_47), dimensions={1}, to_apply=%region_2.176, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/LayerNorm_0/reduce_sum[axes=(0, 1)]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
}

%fused_convert.5 (param_0.33: bf16[256,256]) -> f32[256,8,32] {
  %param_0.33 = bf16[256,256]{0,1} parameter(0)
  %bitcast.6034.1 = bf16[256,8,32]{2,1,0} bitcast(bf16[256,256]{0,1} %param_0.33)
  ROOT %convert.1478.1 = f32[256,8,32]{2,1,0} convert(bf16[256,8,32]{2,1,0} %bitcast.6034.1), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/MultiHeadDotProductAttention_0/value/convert_element_type[new_dtype=float32 weak_type=False]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
}

%fused_convert.6 (param_0.35: bf16[256,256]) -> f32[256,8,32] {
  %param_0.35 = bf16[256,256]{0,1} parameter(0)
  %bitcast.6005.1 = bf16[256,8,32]{2,1,0} bitcast(bf16[256,256]{0,1} %param_0.35)
  ROOT %convert.1474.1 = f32[256,8,32]{2,1,0} convert(bf16[256,8,32]{2,1,0} %bitcast.6005.1), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/MultiHeadDotProductAttention_0/query/convert_element_type[new_dtype=float32 weak_type=False]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
}

%fused_convert.7 (param_0.37: bf16[256,256]) -> f32[8,32,256] {
  %param_0.37 = bf16[256,256]{0,1} parameter(0)
  %bitcast.5981.1 = bf16[8,32,256]{2,1,0} bitcast(bf16[256,256]{0,1} %param_0.37)
  ROOT %convert.1471.1 = f32[8,32,256]{2,1,0} convert(bf16[8,32,256]{2,1,0} %bitcast.5981.1), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/MultiHeadDotProductAttention_0/out/convert_element_type[new_dtype=float32 weak_type=False]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
}

%fused_convert.8 (param_0.39: bf16[256,256]) -> f32[256,8,32] {
  %param_0.39 = bf16[256,256]{0,1} parameter(0)
  %bitcast.5952.1 = bf16[256,8,32]{2,1,0} bitcast(bf16[256,256]{0,1} %param_0.39)
  ROOT %convert.1467.1 = f32[256,8,32]{2,1,0} convert(bf16[256,8,32]{2,1,0} %bitcast.5952.1), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/MultiHeadDotProductAttention_0/key/convert_element_type[new_dtype=float32 weak_type=False]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
}

%fused_reduce.3 (param_0.1238: bf16[26624,256]) -> f32[208,256] {
  %param_0.1238 = bf16[26624,256]{1,0} parameter(0)
  %convert.1443.1 = f32[26624,256]{1,0} convert(bf16[26624,256]{1,0} %param_0.1238), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/LayerNorm_1/convert_element_type[new_dtype=float32 weak_type=False]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
  %bitcast.5877.1 = f32[208,128,256]{2,1,0} bitcast(f32[26624,256]{1,0} %convert.1443.1)
  %constant_50_45 = f32[] constant(0)
  ROOT %reduce.69.1 = f32[208,256]{1,0} reduce(f32[208,128,256]{2,1,0} %bitcast.5877.1, f32[] %constant_50_45), dimensions={1}, to_apply=%region_2.176, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/LayerNorm_1/reduce_sum[axes=(0, 1)]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
}

%fused_transpose (param_0.600: bf16[26624,256], param_1.547: bf16[26624,256]) -> f32[512,256,52] {
  %param_1.547 = bf16[26624,256]{1,0} parameter(1)
  %convert.1455.3 = f32[26624,256]{1,0} convert(bf16[26624,256]{1,0} %param_1.547)
  %param_0.600 = bf16[26624,256]{1,0} parameter(0)
  %convert.1459.3 = f32[26624,256]{1,0} convert(bf16[26624,256]{1,0} %param_0.600)
  %add.248.3 = f32[26624,256]{1,0} add(f32[26624,256]{1,0} %convert.1455.3, f32[26624,256]{1,0} %convert.1459.3), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/MultiHeadDotProductAttention_0/query/add_any" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %bitcast.5859.1 = f32[52,512,256]{2,1,0} bitcast(f32[26624,256]{1,0} %add.248.3)
  ROOT %transpose.1218.1 = f32[512,256,52]{2,1,0} transpose(f32[52,512,256]{2,1,0} %bitcast.5859.1), dimensions={1,2,0}, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/LayerNorm_0/convert_element_type[new_dtype=float32 weak_type=False]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
}

%fused_reduce.4 (param_0.1236: bf16[26624,256], param_1.1307: bf16[26624,256]) -> f32[208,256] {
  %param_1.1307 = bf16[26624,256]{1,0} parameter(1)
  %convert.1455.5 = f32[26624,256]{1,0} convert(bf16[26624,256]{1,0} %param_1.1307)
  %param_0.1236 = bf16[26624,256]{1,0} parameter(0)
  %convert.1459.5 = f32[26624,256]{1,0} convert(bf16[26624,256]{1,0} %param_0.1236)
  %add.248.5 = f32[26624,256]{1,0} add(f32[26624,256]{1,0} %convert.1455.5, f32[26624,256]{1,0} %convert.1459.5), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/MultiHeadDotProductAttention_0/query/add_any" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %bitcast.5848.1 = f32[208,128,256]{2,1,0} bitcast(f32[26624,256]{1,0} %add.248.5)
  %constant_50_43 = f32[] constant(0)
  ROOT %reduce.65.1 = f32[208,256]{1,0} reduce(f32[208,128,256]{2,1,0} %bitcast.5848.1, f32[] %constant_50_43), dimensions={1}, to_apply=%region_2.176, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/LayerNorm_0/reduce_sum[axes=(0, 1)]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
}

%region_26.806.clone.4 (Arg_0.7.0: f32[], Arg_1.7.0: f32[]) -> f32[] {
  %Arg_1.7.0 = f32[] parameter(1)
  %Arg_0.7.0 = f32[] parameter(0)
  ROOT %add.172.0 = f32[] add(f32[] %Arg_0.7.0, f32[] %Arg_1.7.0), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/vmap(vmap(LazyInMLP_0))/Dense_0/reduce_sum[axes=(0, 1)]" source_file="/home/nicholas/programs/avid/avid/layers.py" source_line=49}
}

%fused_reduce_transpose (param_0.53: bf16[416,512,32]) -> (bf16[8,32,52,512], bf16[52,512,8,32], f32[52,8,32]) {
  %param_0.53 = bf16[416,512,32]{2,1,0} parameter(0)
  %bitcast.5803.3 = bf16[52,8,512,32]{3,2,1,0} bitcast(bf16[416,512,32]{2,1,0} %param_0.53)
  %transpose.1220.1 = bf16[8,32,52,512]{3,2,1,0} transpose(bf16[52,8,512,32]{3,2,1,0} %bitcast.5803.3), dimensions={1,3,0,2}, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/MultiHeadDotProductAttention_0/...qhd,...khd->...hqk/transpose[permutation=(0, 2, 1, 3)]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %transpose.1215.1.clone.1 = bf16[52,512,8,32]{3,2,1,0} transpose(bf16[52,8,512,32]{3,2,1,0} %bitcast.5803.3), dimensions={0,2,1,3}, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/MultiHeadDotProductAttention_0/...qhd,...khd->...hqk/transpose[permutation=(0, 2, 1, 3)]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %convert.1464.3.clone.1 = f32[52,8,512,32]{3,2,1,0} convert(bf16[52,8,512,32]{3,2,1,0} %bitcast.5803.3)
  %constant_60_7_clone_1 = bf16[] constant(0)
  %convert.1433.5.clone.1 = f32[] convert(bf16[] %constant_60_7_clone_1)
  %reduce.53.1.clone.1 = f32[52,8,32]{2,1,0} reduce(f32[52,8,512,32]{3,2,1,0} %convert.1464.3.clone.1, f32[] %convert.1433.5.clone.1), dimensions={2}, to_apply=%region_26.806.clone.4, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/MultiHeadDotProductAttention_0/key/reduce_sum[axes=(0, 1)]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  ROOT %tuple.24 = (bf16[8,32,52,512]{3,2,1,0}, bf16[52,512,8,32]{3,2,1,0}, f32[52,8,32]{2,1,0}) tuple(bf16[8,32,52,512]{3,2,1,0} %transpose.1220.1, bf16[52,512,8,32]{3,2,1,0} %transpose.1215.1.clone.1, f32[52,8,32]{2,1,0} %reduce.53.1.clone.1)
}

%fused_transpose.1 (param_0.61: bf16[416,32,512]) -> (bf16[8,32,52,512], bf16[52,512,8,32]) {
  %param_0.61 = bf16[416,32,512]{2,1,0} parameter(0)
  %bitcast.5735.3 = bf16[52,8,32,512]{3,2,1,0} bitcast(bf16[416,32,512]{2,1,0} %param_0.61)
  %transpose.1223.1 = bf16[8,32,52,512]{3,2,1,0} transpose(bf16[52,8,32,512]{3,2,1,0} %bitcast.5735.3), dimensions={1,2,0,3}, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/MultiHeadDotProductAttention_0/...hqk,...khd->...qhd/transpose[permutation=(0, 3, 1, 2)]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %transpose.1213.1.clone.1 = bf16[52,512,8,32]{3,2,1,0} transpose(bf16[52,8,32,512]{3,2,1,0} %bitcast.5735.3), dimensions={0,3,1,2}, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/MultiHeadDotProductAttention_0/...hqk,...khd->...qhd/transpose[permutation=(0, 3, 1, 2)]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  ROOT %tuple.25 = (bf16[8,32,52,512]{3,2,1,0}, bf16[52,512,8,32]{3,2,1,0}) tuple(bf16[8,32,52,512]{3,2,1,0} %transpose.1223.1, bf16[52,512,8,32]{3,2,1,0} %transpose.1213.1.clone.1)
}

%fused_transpose.2 (param_0.65: bf16[26624,256]) -> (bf16[52,8,512,32], bf16[52,8,32,512]) {
  %param_0.65 = bf16[26624,256]{1,0} parameter(0)
  %bitcast.5724.2 = bf16[52,512,8,32]{3,2,1,0} bitcast(bf16[26624,256]{1,0} %param_0.65)
  %transpose.1214.1 = bf16[52,8,512,32]{3,2,1,0} transpose(bf16[52,512,8,32]{3,2,1,0} %bitcast.5724.2), dimensions={0,2,1,3}, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/MultiHeadDotProductAttention_0/...hqk,...khd->...qhd/transpose[permutation=(0, 2, 3, 1)]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %transpose.1212.1.clone.1 = bf16[52,8,32,512]{3,2,1,0} transpose(bf16[52,512,8,32]{3,2,1,0} %bitcast.5724.2), dimensions={0,2,3,1}, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/MultiHeadDotProductAttention_0/out/dot_general[dimension_numbers=(((2,), (2,)), ((), ())) precision=None preferred_element_type=None]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  ROOT %tuple.28 = (bf16[52,8,512,32]{3,2,1,0}, bf16[52,8,32,512]{3,2,1,0}) tuple(bf16[52,8,512,32]{3,2,1,0} %transpose.1214.1, bf16[52,8,32,512]{3,2,1,0} %transpose.1212.1.clone.1)
}

%fused_transpose.3 (param_0.396: bf16[26624,256]) -> f32[512,256,52] {
  %param_0.396 = bf16[26624,256]{1,0} parameter(0)
  %convert.1443.2 = f32[26624,256]{1,0} convert(bf16[26624,256]{1,0} %param_0.396), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/LayerNorm_1/convert_element_type[new_dtype=float32 weak_type=False]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
  %bitcast.5612.1 = f32[52,512,256]{2,1,0} bitcast(f32[26624,256]{1,0} %convert.1443.2)
  ROOT %transpose.1210.1 = f32[512,256,52]{2,1,0} transpose(f32[52,512,256]{2,1,0} %bitcast.5612.1), dimensions={1,2,0}, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/LayerNorm_1/convert_element_type[new_dtype=float32 weak_type=False]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
}

%fused_transpose.4 (param_0.596: bf16[26624,256], param_1.540: bf16[26624,256]) -> f32[512,256,52] {
  %param_1.540 = bf16[26624,256]{1,0} parameter(1)
  %convert.1437.3 = f32[26624,256]{1,0} convert(bf16[26624,256]{1,0} %param_1.540)
  %param_0.596 = bf16[26624,256]{1,0} parameter(0)
  %convert.1441.3 = f32[26624,256]{1,0} convert(bf16[26624,256]{1,0} %param_0.596)
  %add.237.3 = f32[26624,256]{1,0} add(f32[26624,256]{1,0} %convert.1437.3, f32[26624,256]{1,0} %convert.1441.3), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/MultiHeadDotProductAttention_0/query/add_any" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %bitcast.5499.1 = f32[52,512,256]{2,1,0} bitcast(f32[26624,256]{1,0} %add.237.3)
  ROOT %transpose.1208.1 = f32[512,256,52]{2,1,0} transpose(f32[52,512,256]{2,1,0} %bitcast.5499.1), dimensions={1,2,0}, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/LayerNorm_0/convert_element_type[new_dtype=float32 weak_type=False]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
}

%region_26.806.clone.14 (Arg_0.17.0: f32[], Arg_1.17.0: f32[]) -> f32[] {
  %Arg_1.17.0 = f32[] parameter(1)
  %Arg_0.17.0 = f32[] parameter(0)
  ROOT %add.176.0 = f32[] add(f32[] %Arg_0.17.0, f32[] %Arg_1.17.0), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/vmap(vmap(LazyInMLP_0))/Dense_0/reduce_sum[axes=(0, 1)]" source_file="/home/nicholas/programs/avid/avid/layers.py" source_line=49}
}

%fused_reduce_transpose.1 (param_0.85: bf16[416,512,32]) -> (bf16[8,32,52,512], bf16[52,512,8,32], f32[52,8,32]) {
  %param_0.85 = bf16[416,512,32]{2,1,0} parameter(0)
  %bitcast.5455.3 = bf16[52,8,512,32]{3,2,1,0} bitcast(bf16[416,512,32]{2,1,0} %param_0.85)
  %transpose.1225.1 = bf16[8,32,52,512]{3,2,1,0} transpose(bf16[52,8,512,32]{3,2,1,0} %bitcast.5455.3), dimensions={1,3,0,2}, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/MultiHeadDotProductAttention_0/...qhd,...khd->...hqk/transpose[permutation=(0, 2, 1, 3)]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %transpose.1205.1.clone.1 = bf16[52,512,8,32]{3,2,1,0} transpose(bf16[52,8,512,32]{3,2,1,0} %bitcast.5455.3), dimensions={0,2,1,3}, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/MultiHeadDotProductAttention_0/...qhd,...khd->...hqk/transpose[permutation=(0, 2, 1, 3)]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %convert.1483.3.clone.1 = f32[52,8,512,32]{3,2,1,0} convert(bf16[52,8,512,32]{3,2,1,0} %bitcast.5455.3)
  %constant_60_17_clone_1 = bf16[] constant(0)
  %convert.1433.15.clone.1 = f32[] convert(bf16[] %constant_60_17_clone_1)
  %reduce.57.1.clone.1 = f32[52,8,32]{2,1,0} reduce(f32[52,8,512,32]{3,2,1,0} %convert.1483.3.clone.1, f32[] %convert.1433.15.clone.1), dimensions={2}, to_apply=%region_26.806.clone.14, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/MultiHeadDotProductAttention_0/key/reduce_sum[axes=(0, 1)]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  ROOT %tuple.36 = (bf16[8,32,52,512]{3,2,1,0}, bf16[52,512,8,32]{3,2,1,0}, f32[52,8,32]{2,1,0}) tuple(bf16[8,32,52,512]{3,2,1,0} %transpose.1225.1, bf16[52,512,8,32]{3,2,1,0} %transpose.1205.1.clone.1, f32[52,8,32]{2,1,0} %reduce.57.1.clone.1)
}

%fused_transpose.5 (param_0.93: bf16[416,32,512]) -> (bf16[8,32,52,512], bf16[52,512,8,32]) {
  %param_0.93 = bf16[416,32,512]{2,1,0} parameter(0)
  %bitcast.5388.3 = bf16[52,8,32,512]{3,2,1,0} bitcast(bf16[416,32,512]{2,1,0} %param_0.93)
  %transpose.1228.1 = bf16[8,32,52,512]{3,2,1,0} transpose(bf16[52,8,32,512]{3,2,1,0} %bitcast.5388.3), dimensions={1,2,0,3}, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/MultiHeadDotProductAttention_0/...hqk,...khd->...qhd/transpose[permutation=(0, 3, 1, 2)]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %transpose.1203.1.clone.1 = bf16[52,512,8,32]{3,2,1,0} transpose(bf16[52,8,32,512]{3,2,1,0} %bitcast.5388.3), dimensions={0,3,1,2}, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/MultiHeadDotProductAttention_0/...hqk,...khd->...qhd/transpose[permutation=(0, 3, 1, 2)]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  ROOT %tuple.37 = (bf16[8,32,52,512]{3,2,1,0}, bf16[52,512,8,32]{3,2,1,0}) tuple(bf16[8,32,52,512]{3,2,1,0} %transpose.1228.1, bf16[52,512,8,32]{3,2,1,0} %transpose.1203.1.clone.1)
}

%fused_transpose.6 (param_0.97: bf16[26624,256]) -> (bf16[52,8,512,32], bf16[52,8,32,512]) {
  %param_0.97 = bf16[26624,256]{1,0} parameter(0)
  %bitcast.5377.2 = bf16[52,512,8,32]{3,2,1,0} bitcast(bf16[26624,256]{1,0} %param_0.97)
  %transpose.1204.1 = bf16[52,8,512,32]{3,2,1,0} transpose(bf16[52,512,8,32]{3,2,1,0} %bitcast.5377.2), dimensions={0,2,1,3}, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/MultiHeadDotProductAttention_0/...hqk,...khd->...qhd/transpose[permutation=(0, 2, 3, 1)]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %transpose.1202.1.clone.1 = bf16[52,8,32,512]{3,2,1,0} transpose(bf16[52,512,8,32]{3,2,1,0} %bitcast.5377.2), dimensions={0,2,3,1}, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/MultiHeadDotProductAttention_0/out/dot_general[dimension_numbers=(((2,), (2,)), ((), ())) precision=None preferred_element_type=None]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  ROOT %tuple.40 = (bf16[52,8,512,32]{3,2,1,0}, bf16[52,8,32,512]{3,2,1,0}) tuple(bf16[52,8,512,32]{3,2,1,0} %transpose.1204.1, bf16[52,8,32,512]{3,2,1,0} %transpose.1202.1.clone.1)
}

%fused_transpose.7 (param_0.397: bf16[26624,256]) -> f32[512,256,52] {
  %param_0.397 = bf16[26624,256]{1,0} parameter(0)
  %convert.1425.2 = f32[26624,256]{1,0} convert(bf16[26624,256]{1,0} %param_0.397), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/LayerNorm_1/convert_element_type[new_dtype=float32 weak_type=False]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
  %bitcast.5263.1 = f32[52,512,256]{2,1,0} bitcast(f32[26624,256]{1,0} %convert.1425.2)
  ROOT %transpose.1199.1 = f32[512,256,52]{2,1,0} transpose(f32[52,512,256]{2,1,0} %bitcast.5263.1), dimensions={1,2,0}, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/LayerNorm_1/convert_element_type[new_dtype=float32 weak_type=False]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
}

%fused_multiply_rsqrt (param_0.1279: f32[512,52], param_1.1396: f32[512,52]) -> (f32[1,512,52], f32[512,52]) {
  %param_0.1279 = f32[512,52]{1,0} parameter(0)
  %constant_35_20 = f32[] constant(0.00390625)
  %broadcast.519.43 = f32[512,52]{1,0} broadcast(f32[] %constant_35_20), dimensions={}
  %multiply.346.5 = f32[512,52]{1,0} multiply(f32[512,52]{1,0} %param_0.1279, f32[512,52]{1,0} %broadcast.519.43), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoder_norm/div" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=228}
  %param_1.1396 = f32[512,52]{1,0} parameter(1)
  %multiply.344.1.clone.1 = f32[512,52]{1,0} multiply(f32[512,52]{1,0} %param_1.1396, f32[512,52]{1,0} %broadcast.519.43), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoder_norm/div" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=228}
  %multiply.347.3 = f32[512,52]{1,0} multiply(f32[512,52]{1,0} %multiply.344.1.clone.1, f32[512,52]{1,0} %multiply.344.1.clone.1), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoder_norm/integer_pow[y=2]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=228}
  %subtract.37.3 = f32[512,52]{1,0} subtract(f32[512,52]{1,0} %multiply.346.5, f32[512,52]{1,0} %multiply.347.3), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoder_norm/sub" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=228}
  %constant_50_53 = f32[] constant(0)
  %broadcast.522.49 = f32[512,52]{1,0} broadcast(f32[] %constant_50_53), dimensions={}
  %maximum.20.11 = f32[512,52]{1,0} maximum(f32[512,52]{1,0} %subtract.37.3, f32[512,52]{1,0} %broadcast.522.49), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoder_norm/max" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=228}
  %constant_46_1 = f32[] constant(1e-06)
  %broadcast.524.9 = f32[512,52]{1,0} broadcast(f32[] %constant_46_1), dimensions={}
  %add.223.5 = f32[512,52]{1,0} add(f32[512,52]{1,0} %maximum.20.11, f32[512,52]{1,0} %broadcast.524.9), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoder_norm/add" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=228}
  %bitcast.5039.1 = f32[1,512,52]{2,1,0} bitcast(f32[512,52]{1,0} %add.223.5)
  %rsqrt.14.1 = f32[1,512,52]{2,1,0} rsqrt(f32[1,512,52]{2,1,0} %bitcast.5039.1), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoder_norm/rsqrt" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=228}
  ROOT %tuple.51 = (f32[1,512,52]{2,1,0}, f32[512,52]{1,0}) tuple(f32[1,512,52]{2,1,0} %rsqrt.14.1, f32[512,52]{1,0} %multiply.344.1.clone.1)
}

%fused_multiply_rsqrt.1 (param_0.1280: f32[512,52], param_1.1398: f32[512,52]) -> (f32[1,512,52], f32[512,52]) {
  %param_0.1280 = f32[512,52]{1,0} parameter(0)
  %constant_35_19 = f32[] constant(0.00390625)
  %broadcast.519.39 = f32[512,52]{1,0} broadcast(f32[] %constant_35_19), dimensions={}
  %multiply.340.5 = f32[512,52]{1,0} multiply(f32[512,52]{1,0} %param_0.1280, f32[512,52]{1,0} %broadcast.519.39), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/LayerNorm_1/div" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
  %param_1.1398 = f32[512,52]{1,0} parameter(1)
  %multiply.338.1.clone.1 = f32[512,52]{1,0} multiply(f32[512,52]{1,0} %param_1.1398, f32[512,52]{1,0} %broadcast.519.39), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/LayerNorm_1/div" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
  %multiply.341.3 = f32[512,52]{1,0} multiply(f32[512,52]{1,0} %multiply.338.1.clone.1, f32[512,52]{1,0} %multiply.338.1.clone.1), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/LayerNorm_1/integer_pow[y=2]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
  %subtract.35.3 = f32[512,52]{1,0} subtract(f32[512,52]{1,0} %multiply.340.5, f32[512,52]{1,0} %multiply.341.3), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/LayerNorm_1/sub" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
  %constant_50_52 = f32[] constant(0)
  %broadcast.522.53 = f32[512,52]{1,0} broadcast(f32[] %constant_50_52), dimensions={}
  %maximum.19.11 = f32[512,52]{1,0} maximum(f32[512,52]{1,0} %subtract.35.3, f32[512,52]{1,0} %broadcast.522.53), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/LayerNorm_1/max" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
  %constant_46_5 = f32[] constant(1e-06)
  %broadcast.524.13 = f32[512,52]{1,0} broadcast(f32[] %constant_46_5), dimensions={}
  %add.219.5 = f32[512,52]{1,0} add(f32[512,52]{1,0} %maximum.19.11, f32[512,52]{1,0} %broadcast.524.13), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/LayerNorm_1/add" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
  %bitcast.4955.1 = f32[1,512,52]{2,1,0} bitcast(f32[512,52]{1,0} %add.219.5)
  %rsqrt.13.1 = f32[1,512,52]{2,1,0} rsqrt(f32[1,512,52]{2,1,0} %bitcast.4955.1), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/LayerNorm_1/rsqrt" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
  ROOT %tuple.53 = (f32[1,512,52]{2,1,0}, f32[512,52]{1,0}) tuple(f32[1,512,52]{2,1,0} %rsqrt.13.1, f32[512,52]{1,0} %multiply.338.1.clone.1)
}

%fused_transpose.8 (param_0.131: bf16[416,32,512]) -> bf16[52,512,8,32] {
  %param_0.131 = bf16[416,32,512]{2,1,0} parameter(0)
  %bitcast.4881.1 = bf16[52,8,32,512]{3,2,1,0} bitcast(bf16[416,32,512]{2,1,0} %param_0.131)
  ROOT %transpose.1194.1 = bf16[52,512,8,32]{3,2,1,0} transpose(bf16[52,8,32,512]{3,2,1,0} %bitcast.4881.1), dimensions={0,3,1,2}, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/MultiHeadDotProductAttention_0/...hqk,...khd->...qhd/transpose[permutation=(0, 3, 1, 2)]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
}

%fused_multiply_rsqrt.2 (param_0.1281: f32[512,52], param_1.1400: f32[512,52]) -> (f32[1,512,52], f32[512,52]) {
  %param_0.1281 = f32[512,52]{1,0} parameter(0)
  %constant_35_18 = f32[] constant(0.00390625)
  %broadcast.519.35 = f32[512,52]{1,0} broadcast(f32[] %constant_35_18), dimensions={}
  %multiply.333.5 = f32[512,52]{1,0} multiply(f32[512,52]{1,0} %param_0.1281, f32[512,52]{1,0} %broadcast.519.35), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/LayerNorm_0/div" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
  %param_1.1400 = f32[512,52]{1,0} parameter(1)
  %multiply.331.1.clone.1 = f32[512,52]{1,0} multiply(f32[512,52]{1,0} %param_1.1400, f32[512,52]{1,0} %broadcast.519.35), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/LayerNorm_0/div" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
  %multiply.334.3 = f32[512,52]{1,0} multiply(f32[512,52]{1,0} %multiply.331.1.clone.1, f32[512,52]{1,0} %multiply.331.1.clone.1), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/LayerNorm_0/integer_pow[y=2]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
  %subtract.32.3 = f32[512,52]{1,0} subtract(f32[512,52]{1,0} %multiply.333.5, f32[512,52]{1,0} %multiply.334.3), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/LayerNorm_0/sub" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
  %constant_50_51 = f32[] constant(0)
  %broadcast.522.57 = f32[512,52]{1,0} broadcast(f32[] %constant_50_51), dimensions={}
  %maximum.18.11 = f32[512,52]{1,0} maximum(f32[512,52]{1,0} %subtract.32.3, f32[512,52]{1,0} %broadcast.522.57), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/LayerNorm_0/max" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
  %constant_46_4 = f32[] constant(1e-06)
  %broadcast.524.17 = f32[512,52]{1,0} broadcast(f32[] %constant_46_4), dimensions={}
  %add.212.5 = f32[512,52]{1,0} add(f32[512,52]{1,0} %maximum.18.11, f32[512,52]{1,0} %broadcast.524.17), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/LayerNorm_0/add" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
  %bitcast.4759.1 = f32[1,512,52]{2,1,0} bitcast(f32[512,52]{1,0} %add.212.5)
  %rsqrt.12.1 = f32[1,512,52]{2,1,0} rsqrt(f32[1,512,52]{2,1,0} %bitcast.4759.1), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/LayerNorm_0/rsqrt" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
  ROOT %tuple.56 = (f32[1,512,52]{2,1,0}, f32[512,52]{1,0}) tuple(f32[1,512,52]{2,1,0} %rsqrt.12.1, f32[512,52]{1,0} %multiply.331.1.clone.1)
}

%fused_multiply_rsqrt.3 (param_0.1282: f32[512,52], param_1.1402: f32[512,52]) -> (f32[1,512,52], f32[512,52]) {
  %param_0.1282 = f32[512,52]{1,0} parameter(0)
  %constant_35_17 = f32[] constant(0.00390625)
  %broadcast.519.31 = f32[512,52]{1,0} broadcast(f32[] %constant_35_17), dimensions={}
  %multiply.325.5 = f32[512,52]{1,0} multiply(f32[512,52]{1,0} %param_0.1282, f32[512,52]{1,0} %broadcast.519.31), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/LayerNorm_1/div" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
  %param_1.1402 = f32[512,52]{1,0} parameter(1)
  %multiply.323.1.clone.1 = f32[512,52]{1,0} multiply(f32[512,52]{1,0} %param_1.1402, f32[512,52]{1,0} %broadcast.519.31), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/LayerNorm_1/div" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
  %multiply.327.3 = f32[512,52]{1,0} multiply(f32[512,52]{1,0} %multiply.323.1.clone.1, f32[512,52]{1,0} %multiply.323.1.clone.1), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/LayerNorm_1/integer_pow[y=2]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
  %subtract.30.3 = f32[512,52]{1,0} subtract(f32[512,52]{1,0} %multiply.325.5, f32[512,52]{1,0} %multiply.327.3), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/LayerNorm_1/sub" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
  %constant_50_49 = f32[] constant(0)
  %broadcast.522.65 = f32[512,52]{1,0} broadcast(f32[] %constant_50_49), dimensions={}
  %maximum.17.11 = f32[512,52]{1,0} maximum(f32[512,52]{1,0} %subtract.30.3, f32[512,52]{1,0} %broadcast.522.65), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/LayerNorm_1/max" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
  %constant_46_2 = f32[] constant(1e-06)
  %broadcast.524.25 = f32[512,52]{1,0} broadcast(f32[] %constant_46_2), dimensions={}
  %add.208.5 = f32[512,52]{1,0} add(f32[512,52]{1,0} %maximum.17.11, f32[512,52]{1,0} %broadcast.524.25), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/LayerNorm_1/add" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
  %bitcast.4675.1 = f32[1,512,52]{2,1,0} bitcast(f32[512,52]{1,0} %add.208.5)
  %rsqrt.11.1 = f32[1,512,52]{2,1,0} rsqrt(f32[1,512,52]{2,1,0} %bitcast.4675.1), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/LayerNorm_1/rsqrt" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
  ROOT %tuple.58 = (f32[1,512,52]{2,1,0}, f32[512,52]{1,0}) tuple(f32[1,512,52]{2,1,0} %rsqrt.11.1, f32[512,52]{1,0} %multiply.323.1.clone.1)
}

%fused_transpose.9 (param_0.155: bf16[416,32,512]) -> bf16[52,512,8,32] {
  %param_0.155 = bf16[416,32,512]{2,1,0} parameter(0)
  %bitcast.4601.1 = bf16[52,8,32,512]{3,2,1,0} bitcast(bf16[416,32,512]{2,1,0} %param_0.155)
  ROOT %transpose.1185.1 = bf16[52,512,8,32]{3,2,1,0} transpose(bf16[52,8,32,512]{3,2,1,0} %bitcast.4601.1), dimensions={0,3,1,2}, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/MultiHeadDotProductAttention_0/...hqk,...khd->...qhd/transpose[permutation=(0, 3, 1, 2)]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
}

%fused_multiply_rsqrt.4 (param_0.1283: f32[512,52], param_1.1404: f32[512,52]) -> (f32[1,512,52], f32[512,52]) {
  %param_0.1283 = f32[512,52]{1,0} parameter(0)
  %constant_35_16 = f32[] constant(0.00390625)
  %broadcast.519.27 = f32[512,52]{1,0} broadcast(f32[] %constant_35_16), dimensions={}
  %multiply.318.5 = f32[512,52]{1,0} multiply(f32[512,52]{1,0} %param_0.1283, f32[512,52]{1,0} %broadcast.519.27), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/LayerNorm_0/div" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
  %param_1.1404 = f32[512,52]{1,0} parameter(1)
  %multiply.316.1.clone.1 = f32[512,52]{1,0} multiply(f32[512,52]{1,0} %param_1.1404, f32[512,52]{1,0} %broadcast.519.27), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/LayerNorm_0/div" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
  %multiply.319.3 = f32[512,52]{1,0} multiply(f32[512,52]{1,0} %multiply.316.1.clone.1, f32[512,52]{1,0} %multiply.316.1.clone.1), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/LayerNorm_0/integer_pow[y=2]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
  %subtract.27.3 = f32[512,52]{1,0} subtract(f32[512,52]{1,0} %multiply.318.5, f32[512,52]{1,0} %multiply.319.3), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/LayerNorm_0/sub" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
  %constant_50_50 = f32[] constant(0)
  %broadcast.522.61 = f32[512,52]{1,0} broadcast(f32[] %constant_50_50), dimensions={}
  %maximum.16.11 = f32[512,52]{1,0} maximum(f32[512,52]{1,0} %subtract.27.3, f32[512,52]{1,0} %broadcast.522.61), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/LayerNorm_0/max" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
  %constant_46_3 = f32[] constant(1e-06)
  %broadcast.524.21 = f32[512,52]{1,0} broadcast(f32[] %constant_46_3), dimensions={}
  %add.200.5 = f32[512,52]{1,0} add(f32[512,52]{1,0} %maximum.16.11, f32[512,52]{1,0} %broadcast.524.21), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/LayerNorm_0/add" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
  %bitcast.4480.1 = f32[1,512,52]{2,1,0} bitcast(f32[512,52]{1,0} %add.200.5)
  %rsqrt.10.1 = f32[1,512,52]{2,1,0} rsqrt(f32[1,512,52]{2,1,0} %bitcast.4480.1), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/LayerNorm_0/rsqrt" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
  ROOT %tuple.61 = (f32[1,512,52]{2,1,0}, f32[512,52]{1,0}) tuple(f32[1,512,52]{2,1,0} %rsqrt.10.1, f32[512,52]{1,0} %multiply.316.1.clone.1)
}

%fused_transpose.10 (param_0.646: f32[256], param_1.602: bf16[26624,256]) -> bf16[512,256,52] {
  %param_1.602 = bf16[26624,256]{1,0} parameter(1)
  %convert.1328.3 = f32[26624,256]{1,0} convert(bf16[26624,256]{1,0} %param_1.602)
  %param_0.646 = f32[256]{0} parameter(0)
  %broadcast.600.5 = f32[26624,256]{1,0} broadcast(f32[256]{0} %param_0.646), dimensions={1}, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/im_embed/vmap(inner)/vmap(Patchify_0)/patch_proj/add" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=40}
  %add.198.5 = f32[26624,256]{1,0} add(f32[26624,256]{1,0} %convert.1328.3, f32[26624,256]{1,0} %broadcast.600.5), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/im_embed/vmap(inner)/vmap(Patchify_0)/patch_proj/add" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=40}
  %convert.1331.3 = bf16[26624,256]{1,0} convert(f32[26624,256]{1,0} %add.198.5)
  %bitcast.4423.1 = bf16[52,512,256]{2,1,0} bitcast(bf16[26624,256]{1,0} %convert.1331.3)
  ROOT %transpose.1178.1 = bf16[512,256,52]{2,1,0} transpose(bf16[52,512,256]{2,1,0} %bitcast.4423.1), dimensions={1,2,0}, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/im_embed/vmap(inner)/vmap(Patchify_0)/patch_proj/add" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=40}
}

%fused_transpose.11 (param_0.1201: bf16[13824,5,52], param_1.1277: bf16[260,1,64]) -> bf16[52,8,8,8,3,3,3,64] {
  %param_1.1277 = bf16[260,1,64]{2,1,0} parameter(1)
  %bitcast.4393.8 = bf16[5,52,64]{2,1,0} bitcast(bf16[260,1,64]{2,1,0} %param_1.1277)
  %convert.1520.5 = f32[5,52,64]{2,1,0} convert(bf16[5,52,64]{2,1,0} %bitcast.4393.8)
  %broadcast.597.5 = f32[13824,5,52,64]{3,2,1,0} broadcast(f32[5,52,64]{2,1,0} %convert.1520.5), dimensions={1,2,3}, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/spec_embed/vmap(vmap(vmap(species_embed)))/mul" source_file="/home/nicholas/programs/avid/avid/encoder.py" source_line=38}
  %param_0.1201 = bf16[13824,5,52]{2,1,0} parameter(0)
  %convert.1521.8 = f32[13824,5,52]{2,1,0} convert(bf16[13824,5,52]{2,1,0} %param_0.1201)
  %broadcast.598.10 = f32[13824,5,52,64]{3,2,1,0} broadcast(f32[13824,5,52]{2,1,0} %convert.1521.8), dimensions={0,1,2}, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/spec_embed/vmap(vmap(vmap(species_embed)))/mul" source_file="/home/nicholas/programs/avid/avid/encoder.py" source_line=38}
  %multiply.315.7 = f32[13824,5,52,64]{3,2,1,0} multiply(f32[13824,5,52,64]{3,2,1,0} %broadcast.597.5, f32[13824,5,52,64]{3,2,1,0} %broadcast.598.10), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/spec_embed/vmap(vmap(vmap(species_embed)))/mul" source_file="/home/nicholas/programs/avid/avid/encoder.py" source_line=38}
  %constant_50_8 = f32[] constant(0)
  %reduce.5.5 = f32[13824,52,64]{2,1,0} reduce(f32[13824,5,52,64]{3,2,1,0} %multiply.315.7, f32[] %constant_50_8), dimensions={1}, to_apply=%region_2.176, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/spec_embed/reduce_sum[axes=(3,)]" source_file="/home/nicholas/programs/avid/avid/encoder.py" source_line=60}
  %convert.1326.3 = bf16[13824,52,64]{2,1,0} convert(f32[13824,52,64]{2,1,0} %reduce.5.5), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/spec_embed/convert_element_type[new_dtype=bfloat16 weak_type=False]" source_file="/home/nicholas/programs/avid/avid/encoder.py" source_line=60}
  %bitcast.4405.1 = bf16[8,3,8,3,8,3,52,64]{7,6,5,4,3,2,1,0} bitcast(bf16[13824,52,64]{2,1,0} %convert.1326.3)
  ROOT %transpose.1177.1 = bf16[52,8,8,8,3,3,3,64]{7,6,5,4,3,2,1,0} transpose(bf16[8,3,8,3,8,3,52,64]{7,6,5,4,3,2,1,0} %bitcast.4405.1), dimensions={6,0,2,4,1,3,5,7}, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/im_embed/vmap(inner)/transpose[permutation=(0, 1, 3, 5, 2, 4, 6, 7)]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=103}
}

%region_26.806.clone.26 (Arg_0.29.0: f32[], Arg_1.29.0: f32[]) -> f32[] {
  %Arg_1.29.0 = f32[] parameter(1)
  %Arg_0.29.0 = f32[] parameter(0)
  ROOT %add.196.0 = f32[] add(f32[] %Arg_0.29.0, f32[] %Arg_1.29.0), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/vmap(vmap(LazyInMLP_0))/Dense_0/reduce_sum[axes=(0, 1)]" source_file="/home/nicholas/programs/avid/avid/layers.py" source_line=49}
}

%fused_reduce.5 (param_0.883: bf16[13824,5,52], param_1.889: bf16[26624,1728]) -> f32[216,5,52,64] {
  %param_1.889 = bf16[26624,1728]{1,0} parameter(1)
  %bitcast.6405.3 = bf16[52,8,8,8,3,3,3,64]{7,6,5,4,3,2,1,0} bitcast(bf16[26624,1728]{1,0} %param_1.889)
  %transpose.1231.3 = bf16[8,3,8,3,8,3,52,64]{7,6,5,4,3,2,1,0} transpose(bf16[52,8,8,8,3,3,3,64]{7,6,5,4,3,2,1,0} %bitcast.6405.3), dimensions={1,4,2,5,3,6,0,7}, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/im_embed/vmap(inner)/vmap(Patchify_0)/patch_proj/dot_general[dimension_numbers=(((2,), (1,)), ((), ())) precision=None preferred_element_type=None]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=40}
  %bitcast.6408.6 = bf16[13824,52,64]{2,1,0} bitcast(bf16[8,3,8,3,8,3,52,64]{7,6,5,4,3,2,1,0} %transpose.1231.3)
  %convert.1548.3 = f32[13824,52,64]{2,1,0} convert(bf16[13824,52,64]{2,1,0} %bitcast.6408.6)
  %broadcast.641.5 = f32[13824,5,52,64]{3,2,1,0} broadcast(f32[13824,52,64]{2,1,0} %convert.1548.3), dimensions={0,2,3}, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/spec_embed/broadcast_in_dim[shape=(52, 13824, 64, 5) broadcast_dimensions=(0, 1, 2)]" source_file="/home/nicholas/programs/avid/avid/encoder.py" source_line=60}
  %param_0.883 = bf16[13824,5,52]{2,1,0} parameter(0)
  %convert.1521.4 = f32[13824,5,52]{2,1,0} convert(bf16[13824,5,52]{2,1,0} %param_0.883)
  %broadcast.598.6 = f32[13824,5,52,64]{3,2,1,0} broadcast(f32[13824,5,52]{2,1,0} %convert.1521.4), dimensions={0,1,2}, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/spec_embed/vmap(vmap(vmap(species_embed)))/mul" source_file="/home/nicholas/programs/avid/avid/encoder.py" source_line=38}
  %multiply.439.5 = f32[13824,5,52,64]{3,2,1,0} multiply(f32[13824,5,52,64]{3,2,1,0} %broadcast.641.5, f32[13824,5,52,64]{3,2,1,0} %broadcast.598.6), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/spec_embed/vmap(vmap(vmap(species_embed)))/mul" source_file="/home/nicholas/programs/avid/avid/encoder.py" source_line=38}
  %convert.1514.3 = bf16[13824,5,52,64]{3,2,1,0} convert(f32[13824,5,52,64]{3,2,1,0} %multiply.439.5)
  %bitcast.6417.3 = bf16[216,64,5,52,64]{4,3,2,1,0} bitcast(bf16[13824,5,52,64]{3,2,1,0} %convert.1514.3)
  %convert.1515.3 = f32[216,64,5,52,64]{4,3,2,1,0} convert(bf16[216,64,5,52,64]{4,3,2,1,0} %bitcast.6417.3)
  %constant_60_28 = bf16[] constant(0)
  %convert.1433.26 = f32[] convert(bf16[] %constant_60_28)
  ROOT %reduce.95.1 = f32[216,5,52,64]{3,2,1,0} reduce(f32[216,64,5,52,64]{4,3,2,1,0} %convert.1515.3, f32[] %convert.1433.26), dimensions={1}, to_apply=%region_26.806.clone.26, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/spec_embed/vmap(vmap(vmap(species_embed)))/reduce_sum[axes=(0,)]" source_file="/home/nicholas/programs/avid/avid/encoder.py" source_line=38}
}

%region_4.262.clone (Arg_0.0.0: f32[], Arg_1.0.0: f32[]) -> f32[] {
  %Arg_1.0.0 = f32[] parameter(1)
  %Arg_0.0.0 = f32[] parameter(0)
  ROOT %maximum.14.0 = f32[] maximum(f32[] %Arg_0.0.0, f32[] %Arg_1.0.0), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/MultiHeadDotProductAttention_0/reduce_max[axes=(3,)]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
}

%fused_reduce.6 (param_0.1100: bf16[416,512,512]) -> f32[52,8,512] {
  %param_0.1100 = bf16[416,512,512]{2,1,0} parameter(0)
  %bitcast.4569.5 = bf16[52,8,512,512]{3,2,1,0} bitcast(bf16[416,512,512]{2,1,0} %param_0.1100)
  %convert.1352.5 = f32[52,8,512,512]{3,2,1,0} convert(bf16[52,8,512,512]{3,2,1,0} %bitcast.4569.5)
  %constant_61_2 = bf16[] constant(-inf)
  %convert.1354.1 = f32[] convert(bf16[] %constant_61_2)
  ROOT %reduce.266.1 = f32[52,8,512]{2,1,0} reduce(f32[52,8,512,512]{3,2,1,0} %convert.1352.5, f32[] %convert.1354.1), dimensions={3}, to_apply=%region_4.262.clone, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/MultiHeadDotProductAttention_0/reduce_max[axes=(3,)]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
}

%region_4.262.clone.1 (Arg_0.2.0: f32[], Arg_1.1.0: f32[]) -> f32[] {
  %Arg_1.1.0 = f32[] parameter(1)
  %Arg_0.2.0 = f32[] parameter(0)
  ROOT %maximum.15.0 = f32[] maximum(f32[] %Arg_0.2.0, f32[] %Arg_1.1.0), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/MultiHeadDotProductAttention_0/reduce_max[axes=(3,)]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
}

%fused_reduce.7 (param_0.1101: bf16[416,512,512]) -> f32[52,8,512] {
  %param_0.1101 = bf16[416,512,512]{2,1,0} parameter(0)
  %bitcast.4848.5 = bf16[52,8,512,512]{3,2,1,0} bitcast(bf16[416,512,512]{2,1,0} %param_0.1101)
  %convert.1390.5 = f32[52,8,512,512]{3,2,1,0} convert(bf16[52,8,512,512]{3,2,1,0} %bitcast.4848.5)
  %constant_61_1 = bf16[] constant(-inf)
  %convert.1354.2 = f32[] convert(bf16[] %constant_61_1)
  ROOT %reduce.506.1 = f32[52,8,512]{2,1,0} reduce(f32[52,8,512,512]{3,2,1,0} %convert.1390.5, f32[] %convert.1354.2), dimensions={3}, to_apply=%region_4.262.clone.1, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/MultiHeadDotProductAttention_0/reduce_max[axes=(3,)]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
}

%fused_convert.9 (param_0.277: f32[52,8,512], param_1.154: f32[52,8,512], param_2.57: bf16[416,512,512]) -> bf16[52,8,512,512] {
  %param_2.57 = bf16[416,512,512]{2,1,0} parameter(2)
  %bitcast.4569.9 = bf16[52,8,512,512]{3,2,1,0} bitcast(bf16[416,512,512]{2,1,0} %param_2.57)
  %convert.1352.9 = f32[52,8,512,512]{3,2,1,0} convert(bf16[52,8,512,512]{3,2,1,0} %bitcast.4569.9)
  %param_1.154 = f32[52,8,512]{2,1,0} parameter(1)
  %broadcast.611.3 = f32[52,8,512,512]{3,2,1,0} broadcast(f32[52,8,512]{2,1,0} %param_1.154), dimensions={0,1,2}, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/MultiHeadDotProductAttention_0/sub" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %subtract.28.5 = f32[52,8,512,512]{3,2,1,0} subtract(f32[52,8,512,512]{3,2,1,0} %convert.1352.9, f32[52,8,512,512]{3,2,1,0} %broadcast.611.3), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/MultiHeadDotProductAttention_0/sub" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %exponential.4.3 = f32[52,8,512,512]{3,2,1,0} exponential(f32[52,8,512,512]{3,2,1,0} %subtract.28.5), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/MultiHeadDotProductAttention_0/exp" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %param_0.277 = f32[52,8,512]{2,1,0} parameter(0)
  %broadcast.613.8 = f32[52,8,512,512]{3,2,1,0} broadcast(f32[52,8,512]{2,1,0} %param_0.277), dimensions={0,1,2}, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/MultiHeadDotProductAttention_0/div" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %divide.38.3 = f32[52,8,512,512]{3,2,1,0} divide(f32[52,8,512,512]{3,2,1,0} %exponential.4.3, f32[52,8,512,512]{3,2,1,0} %broadcast.613.8), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/MultiHeadDotProductAttention_0/div" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  ROOT %convert.1359.1 = bf16[52,8,512,512]{3,2,1,0} convert(f32[52,8,512,512]{3,2,1,0} %divide.38.3)
}

%fused_convert.10 (param_0.285: f32[52,8,512], param_1.167: f32[52,8,512], param_2.67: bf16[416,512,512]) -> bf16[52,8,512,512] {
  %param_2.67 = bf16[416,512,512]{2,1,0} parameter(2)
  %bitcast.4848.9 = bf16[52,8,512,512]{3,2,1,0} bitcast(bf16[416,512,512]{2,1,0} %param_2.67)
  %convert.1390.9 = f32[52,8,512,512]{3,2,1,0} convert(bf16[52,8,512,512]{3,2,1,0} %bitcast.4848.9)
  %param_1.167 = f32[52,8,512]{2,1,0} parameter(1)
  %broadcast.621.3 = f32[52,8,512,512]{3,2,1,0} broadcast(f32[52,8,512]{2,1,0} %param_1.167), dimensions={0,1,2}, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/MultiHeadDotProductAttention_0/sub" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %subtract.33.5 = f32[52,8,512,512]{3,2,1,0} subtract(f32[52,8,512,512]{3,2,1,0} %convert.1390.9, f32[52,8,512,512]{3,2,1,0} %broadcast.621.3), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/MultiHeadDotProductAttention_0/sub" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %exponential.5.3 = f32[52,8,512,512]{3,2,1,0} exponential(f32[52,8,512,512]{3,2,1,0} %subtract.33.5), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/MultiHeadDotProductAttention_0/exp" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %param_0.285 = f32[52,8,512]{2,1,0} parameter(0)
  %broadcast.622.8 = f32[52,8,512,512]{3,2,1,0} broadcast(f32[52,8,512]{2,1,0} %param_0.285), dimensions={0,1,2}, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/MultiHeadDotProductAttention_0/div" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %divide.39.3 = f32[52,8,512,512]{3,2,1,0} divide(f32[52,8,512,512]{3,2,1,0} %exponential.5.3, f32[52,8,512,512]{3,2,1,0} %broadcast.622.8), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/MultiHeadDotProductAttention_0/div" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  ROOT %convert.1397.1 = bf16[52,8,512,512]{3,2,1,0} convert(f32[52,8,512,512]{3,2,1,0} %divide.39.3)
}

%fused_convert.11 (param_0.287: f32[52,8,512], param_1.169: f32[52,8,512], param_2.68: bf16[416,512,512], param_3.36: f32[52,8,512], param_4.11: bf16[416,512,512]) -> bf16[52,8,512,512] {
  %param_2.68 = bf16[416,512,512]{2,1,0} parameter(2)
  %bitcast.5410.15 = bf16[52,8,512,512]{3,2,1,0} bitcast(bf16[416,512,512]{2,1,0} %param_2.68)
  %convert.1427.15 = f32[52,8,512,512]{3,2,1,0} convert(bf16[52,8,512,512]{3,2,1,0} %bitcast.5410.15)
  %param_1.169 = f32[52,8,512]{2,1,0} parameter(1)
  %broadcast.622.10 = f32[52,8,512,512]{3,2,1,0} broadcast(f32[52,8,512]{2,1,0} %param_1.169), dimensions={0,1,2}, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/MultiHeadDotProductAttention_0/div" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %divide.45.7 = f32[52,8,512,512]{3,2,1,0} divide(f32[52,8,512,512]{3,2,1,0} %convert.1427.15, f32[52,8,512,512]{3,2,1,0} %broadcast.622.10), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/MultiHeadDotProductAttention_0/div" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %param_0.287 = f32[52,8,512]{2,1,0} parameter(0)
  %broadcast.638.3 = f32[52,8,512,512]{3,2,1,0} broadcast(f32[52,8,512]{2,1,0} %param_0.287), dimensions={0,1,2}, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/MultiHeadDotProductAttention_0/broadcast_in_dim[shape=(52, 8, 512, 512) broadcast_dimensions=(0, 1, 2)]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %add.236.5 = f32[52,8,512,512]{3,2,1,0} add(f32[52,8,512,512]{3,2,1,0} %divide.45.7, f32[52,8,512,512]{3,2,1,0} %broadcast.638.3), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/MultiHeadDotProductAttention_0/add_any" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %param_4.11 = bf16[416,512,512]{2,1,0} parameter(4)
  %bitcast.4848.11 = bf16[52,8,512,512]{3,2,1,0} bitcast(bf16[416,512,512]{2,1,0} %param_4.11)
  %convert.1390.11 = f32[52,8,512,512]{3,2,1,0} convert(bf16[52,8,512,512]{3,2,1,0} %bitcast.4848.11)
  %param_3.36 = f32[52,8,512]{2,1,0} parameter(3)
  %broadcast.621.5 = f32[52,8,512,512]{3,2,1,0} broadcast(f32[52,8,512]{2,1,0} %param_3.36), dimensions={0,1,2}, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/MultiHeadDotProductAttention_0/sub" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %subtract.33.7 = f32[52,8,512,512]{3,2,1,0} subtract(f32[52,8,512,512]{3,2,1,0} %convert.1390.11, f32[52,8,512,512]{3,2,1,0} %broadcast.621.5), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/MultiHeadDotProductAttention_0/sub" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %exponential.5.5 = f32[52,8,512,512]{3,2,1,0} exponential(f32[52,8,512,512]{3,2,1,0} %subtract.33.7), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/MultiHeadDotProductAttention_0/exp" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %multiply.390.3 = f32[52,8,512,512]{3,2,1,0} multiply(f32[52,8,512,512]{3,2,1,0} %add.236.5, f32[52,8,512,512]{3,2,1,0} %exponential.5.5), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/MultiHeadDotProductAttention_0/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  ROOT %convert.1436.1 = bf16[52,8,512,512]{3,2,1,0} convert(f32[52,8,512,512]{3,2,1,0} %multiply.390.3)
}

%fused_convert.12 (param_0.279: f32[52,8,512], param_1.156: f32[52,8,512], param_2.58: bf16[416,512,512], param_3.30: f32[52,8,512], param_4.3: bf16[416,512,512]) -> bf16[52,8,512,512] {
  %param_2.58 = bf16[416,512,512]{2,1,0} parameter(2)
  %bitcast.5757.15 = bf16[52,8,512,512]{3,2,1,0} bitcast(bf16[416,512,512]{2,1,0} %param_2.58)
  %convert.1445.15 = f32[52,8,512,512]{3,2,1,0} convert(bf16[52,8,512,512]{3,2,1,0} %bitcast.5757.15)
  %param_1.156 = f32[52,8,512]{2,1,0} parameter(1)
  %broadcast.613.10 = f32[52,8,512,512]{3,2,1,0} broadcast(f32[52,8,512]{2,1,0} %param_1.156), dimensions={0,1,2}, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/MultiHeadDotProductAttention_0/div" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %divide.51.7 = f32[52,8,512,512]{3,2,1,0} divide(f32[52,8,512,512]{3,2,1,0} %convert.1445.15, f32[52,8,512,512]{3,2,1,0} %broadcast.613.10), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/MultiHeadDotProductAttention_0/div" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %param_0.279 = f32[52,8,512]{2,1,0} parameter(0)
  %broadcast.640.3 = f32[52,8,512,512]{3,2,1,0} broadcast(f32[52,8,512]{2,1,0} %param_0.279), dimensions={0,1,2}, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/MultiHeadDotProductAttention_0/broadcast_in_dim[shape=(52, 8, 512, 512) broadcast_dimensions=(0, 1, 2)]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %add.247.5 = f32[52,8,512,512]{3,2,1,0} add(f32[52,8,512,512]{3,2,1,0} %divide.51.7, f32[52,8,512,512]{3,2,1,0} %broadcast.640.3), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/MultiHeadDotProductAttention_0/add_any" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %param_4.3 = bf16[416,512,512]{2,1,0} parameter(4)
  %bitcast.4569.11 = bf16[52,8,512,512]{3,2,1,0} bitcast(bf16[416,512,512]{2,1,0} %param_4.3)
  %convert.1352.11 = f32[52,8,512,512]{3,2,1,0} convert(bf16[52,8,512,512]{3,2,1,0} %bitcast.4569.11)
  %param_3.30 = f32[52,8,512]{2,1,0} parameter(3)
  %broadcast.611.5 = f32[52,8,512,512]{3,2,1,0} broadcast(f32[52,8,512]{2,1,0} %param_3.30), dimensions={0,1,2}, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/MultiHeadDotProductAttention_0/sub" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %subtract.28.7 = f32[52,8,512,512]{3,2,1,0} subtract(f32[52,8,512,512]{3,2,1,0} %convert.1352.11, f32[52,8,512,512]{3,2,1,0} %broadcast.611.5), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/MultiHeadDotProductAttention_0/sub" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %exponential.4.5 = f32[52,8,512,512]{3,2,1,0} exponential(f32[52,8,512,512]{3,2,1,0} %subtract.28.7), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/MultiHeadDotProductAttention_0/exp" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %multiply.419.3 = f32[52,8,512,512]{3,2,1,0} multiply(f32[52,8,512,512]{3,2,1,0} %add.247.5, f32[52,8,512,512]{3,2,1,0} %exponential.4.5), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/MultiHeadDotProductAttention_0/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  ROOT %convert.1454.1 = bf16[52,8,512,512]{3,2,1,0} convert(f32[52,8,512,512]{3,2,1,0} %multiply.419.3)
}

%fused_reduce.8 (param_0.1204: f32[52,8,512], param_1.1280: bf16[416,512,512]) -> f32[52,8,512] {
  %param_1.1280 = bf16[416,512,512]{2,1,0} parameter(1)
  %bitcast.4569.13 = bf16[52,8,512,512]{3,2,1,0} bitcast(bf16[416,512,512]{2,1,0} %param_1.1280)
  %convert.1352.13 = f32[52,8,512,512]{3,2,1,0} convert(bf16[52,8,512,512]{3,2,1,0} %bitcast.4569.13)
  %param_0.1204 = f32[52,8,512]{2,1,0} parameter(0)
  %broadcast.611.7 = f32[52,8,512,512]{3,2,1,0} broadcast(f32[52,8,512]{2,1,0} %param_0.1204), dimensions={0,1,2}, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/MultiHeadDotProductAttention_0/sub" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %subtract.28.9 = f32[52,8,512,512]{3,2,1,0} subtract(f32[52,8,512,512]{3,2,1,0} %convert.1352.13, f32[52,8,512,512]{3,2,1,0} %broadcast.611.7), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/MultiHeadDotProductAttention_0/sub" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %exponential.4.7 = f32[52,8,512,512]{3,2,1,0} exponential(f32[52,8,512,512]{3,2,1,0} %subtract.28.9), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/MultiHeadDotProductAttention_0/exp" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %constant_50_11 = f32[] constant(0)
  ROOT %reduce.278.1 = f32[52,8,512]{2,1,0} reduce(f32[52,8,512,512]{3,2,1,0} %exponential.4.7, f32[] %constant_50_11), dimensions={3}, to_apply=%region_2.176, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/MultiHeadDotProductAttention_0/reduce_sum[axes=(3,)]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
}

%fused_reduce.9 (param_0.1209: f32[52,8,512], param_1.1283: bf16[416,512,512]) -> f32[52,8,512] {
  %param_1.1283 = bf16[416,512,512]{2,1,0} parameter(1)
  %bitcast.4848.13 = bf16[52,8,512,512]{3,2,1,0} bitcast(bf16[416,512,512]{2,1,0} %param_1.1283)
  %convert.1390.13 = f32[52,8,512,512]{3,2,1,0} convert(bf16[52,8,512,512]{3,2,1,0} %bitcast.4848.13)
  %param_0.1209 = f32[52,8,512]{2,1,0} parameter(0)
  %broadcast.621.7 = f32[52,8,512,512]{3,2,1,0} broadcast(f32[52,8,512]{2,1,0} %param_0.1209), dimensions={0,1,2}, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/MultiHeadDotProductAttention_0/sub" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %subtract.33.9 = f32[52,8,512,512]{3,2,1,0} subtract(f32[52,8,512,512]{3,2,1,0} %convert.1390.13, f32[52,8,512,512]{3,2,1,0} %broadcast.621.7), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/MultiHeadDotProductAttention_0/sub" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %exponential.5.7 = f32[52,8,512,512]{3,2,1,0} exponential(f32[52,8,512,512]{3,2,1,0} %subtract.33.9), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/MultiHeadDotProductAttention_0/exp" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %constant_50_16 = f32[] constant(0)
  ROOT %reduce.518.1 = f32[52,8,512]{2,1,0} reduce(f32[52,8,512,512]{3,2,1,0} %exponential.5.7, f32[] %constant_50_16), dimensions={3}, to_apply=%region_2.176, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/MultiHeadDotProductAttention_0/reduce_sum[axes=(3,)]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
}

%fused_reduce.10 (param_0.1234: f32[256,52], param_1.1395: f32[512,256,52], param_2.858: f32[512,52], param_3.549: f32[1,512,52]) -> (f32[512,256], f32[512,256]) {
  %param_0.1234 = f32[256,52]{1,0} parameter(0)
  %broadcast.569.3 = f32[512,256,52]{2,1,0} broadcast(f32[256,52]{1,0} %param_0.1234), dimensions={1,2}, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/transpose[permutation=(0, 2, 1)]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=250}
  %constant_50_41 = f32[] constant(0)
  %reduce.61.1 = f32[512,256]{1,0} reduce(f32[512,256,52]{2,1,0} %broadcast.569.3, f32[] %constant_50_41), dimensions={2}, to_apply=%region_2.176
  %param_3.549 = f32[1,512,52]{2,1,0} parameter(3)
  %bitcast.5042.19.clone.1 = f32[512,52]{1,0} bitcast(f32[1,512,52]{2,1,0} %param_3.549)
  %broadcast.561.19.clone.1 = f32[512,256,52]{2,1,0} broadcast(f32[512,52]{1,0} %bitcast.5042.19.clone.1), dimensions={0,2}, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoder_norm/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=228}
  %param_1.1395 = f32[512,256,52]{2,1,0} parameter(1)
  %param_2.858 = f32[512,52]{1,0} parameter(2)
  %broadcast.560.3.clone.1 = f32[512,256,52]{2,1,0} broadcast(f32[512,52]{1,0} %param_2.858), dimensions={0,2}, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoder_norm/sub" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=228}
  %subtract.36.3.clone.1 = f32[512,256,52]{2,1,0} subtract(f32[512,256,52]{2,1,0} %param_1.1395, f32[512,256,52]{2,1,0} %broadcast.560.3.clone.1), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoder_norm/sub" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=228}
  %multiply.362.5.clone.1 = f32[512,256,52]{2,1,0} multiply(f32[512,256,52]{2,1,0} %subtract.36.3.clone.1, f32[512,256,52]{2,1,0} %broadcast.569.3), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoder_norm/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=228}
  %multiply.363.3.clone.1 = f32[512,256,52]{2,1,0} multiply(f32[512,256,52]{2,1,0} %broadcast.561.19.clone.1, f32[512,256,52]{2,1,0} %multiply.362.5.clone.1), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoder_norm/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=228}
  %reduce.63.1.clone.1 = f32[512,256]{1,0} reduce(f32[512,256,52]{2,1,0} %multiply.363.3.clone.1, f32[] %constant_50_41), dimensions={2}, to_apply=%region_2.176
  ROOT %tuple.48 = (f32[512,256]{1,0}, f32[512,256]{1,0}) tuple(f32[512,256]{1,0} %reduce.61.1, f32[512,256]{1,0} %reduce.63.1.clone.1)
}

%fused_reduce.11 (param_0.1213: f32[512,256,52]) -> (f32[512,52], f32[512,52]) {
  %param_0.1213 = f32[512,256,52]{2,1,0} parameter(0)
  %multiply.345.1 = f32[512,256,52]{2,1,0} multiply(f32[512,256,52]{2,1,0} %param_0.1213, f32[512,256,52]{2,1,0} %param_0.1213), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoder_norm/integer_pow[y=2]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=228}
  %constant_50_20 = f32[] constant(0)
  %reduce.27.1 = f32[512,52]{1,0} reduce(f32[512,256,52]{2,1,0} %multiply.345.1, f32[] %constant_50_20), dimensions={1}, to_apply=%region_2.176
  %reduce.26.1.clone.1 = f32[512,52]{1,0} reduce(f32[512,256,52]{2,1,0} %param_0.1213, f32[] %constant_50_20), dimensions={1}, to_apply=%region_2.176
  ROOT %tuple.52 = (f32[512,52]{1,0}, f32[512,52]{1,0}) tuple(f32[512,52]{1,0} %reduce.27.1, f32[512,52]{1,0} %reduce.26.1.clone.1)
}

%fused_reduce.12 (param_0.1211: f32[512,256,52]) -> (f32[512,52], f32[512,52]) {
  %param_0.1211 = f32[512,256,52]{2,1,0} parameter(0)
  %multiply.339.1 = f32[512,256,52]{2,1,0} multiply(f32[512,256,52]{2,1,0} %param_0.1211, f32[512,256,52]{2,1,0} %param_0.1211), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/LayerNorm_1/integer_pow[y=2]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
  %constant_50_18 = f32[] constant(0)
  %reduce.25.1 = f32[512,52]{1,0} reduce(f32[512,256,52]{2,1,0} %multiply.339.1, f32[] %constant_50_18), dimensions={1}, to_apply=%region_2.176
  %reduce.24.1.clone.1 = f32[512,52]{1,0} reduce(f32[512,256,52]{2,1,0} %param_0.1211, f32[] %constant_50_18), dimensions={1}, to_apply=%region_2.176
  ROOT %tuple.54 = (f32[512,52]{1,0}, f32[512,52]{1,0}) tuple(f32[512,52]{1,0} %reduce.25.1, f32[512,52]{1,0} %reduce.24.1.clone.1)
}

%fused_reduce.13 (param_0.1208: f32[512,256,52]) -> (f32[512,52], f32[512,52]) {
  %param_0.1208 = f32[512,256,52]{2,1,0} parameter(0)
  %multiply.332.1 = f32[512,256,52]{2,1,0} multiply(f32[512,256,52]{2,1,0} %param_0.1208, f32[512,256,52]{2,1,0} %param_0.1208), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/LayerNorm_0/integer_pow[y=2]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
  %constant_50_15 = f32[] constant(0)
  %reduce.23.1 = f32[512,52]{1,0} reduce(f32[512,256,52]{2,1,0} %multiply.332.1, f32[] %constant_50_15), dimensions={1}, to_apply=%region_2.176
  %reduce.22.1.clone.1 = f32[512,52]{1,0} reduce(f32[512,256,52]{2,1,0} %param_0.1208, f32[] %constant_50_15), dimensions={1}, to_apply=%region_2.176
  ROOT %tuple.57 = (f32[512,52]{1,0}, f32[512,52]{1,0}) tuple(f32[512,52]{1,0} %reduce.23.1, f32[512,52]{1,0} %reduce.22.1.clone.1)
}

%fused_reduce.14 (param_0.1206: f32[512,256,52]) -> (f32[512,52], f32[512,52]) {
  %param_0.1206 = f32[512,256,52]{2,1,0} parameter(0)
  %multiply.324.1 = f32[512,256,52]{2,1,0} multiply(f32[512,256,52]{2,1,0} %param_0.1206, f32[512,256,52]{2,1,0} %param_0.1206), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/LayerNorm_1/integer_pow[y=2]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
  %constant_50_13 = f32[] constant(0)
  %reduce.21.1 = f32[512,52]{1,0} reduce(f32[512,256,52]{2,1,0} %multiply.324.1, f32[] %constant_50_13), dimensions={1}, to_apply=%region_2.176
  %reduce.20.1.clone.1 = f32[512,52]{1,0} reduce(f32[512,256,52]{2,1,0} %param_0.1206, f32[] %constant_50_13), dimensions={1}, to_apply=%region_2.176
  ROOT %tuple.59 = (f32[512,52]{1,0}, f32[512,52]{1,0}) tuple(f32[512,52]{1,0} %reduce.21.1, f32[512,52]{1,0} %reduce.20.1.clone.1)
}

%fused_reduce.15 (param_0.1214: f32[256], param_1.1286: f32[1,512,52], param_2.761: f32[256], param_3.479: f32[512,256,52], param_4.281: f32[512,52]) -> f32[256,52] {
  %param_3.479 = f32[512,256,52]{2,1,0} parameter(3)
  %param_4.281 = f32[512,52]{1,0} parameter(4)
  %broadcast.560.5 = f32[512,256,52]{2,1,0} broadcast(f32[512,52]{1,0} %param_4.281), dimensions={0,2}, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoder_norm/sub" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=228}
  %subtract.36.5 = f32[512,256,52]{2,1,0} subtract(f32[512,256,52]{2,1,0} %param_3.479, f32[512,256,52]{2,1,0} %broadcast.560.5), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoder_norm/sub" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=228}
  %param_1.1286 = f32[1,512,52]{2,1,0} parameter(1)
  %bitcast.5042.17 = f32[512,52]{1,0} bitcast(f32[1,512,52]{2,1,0} %param_1.1286)
  %broadcast.561.17 = f32[512,256,52]{2,1,0} broadcast(f32[512,52]{1,0} %bitcast.5042.17), dimensions={0,2}, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoder_norm/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=228}
  %param_0.1214 = f32[256]{0} parameter(0)
  %broadcast.562.14 = f32[512,256,52]{2,1,0} broadcast(f32[256]{0} %param_0.1214), dimensions={1}, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoder_norm/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=228}
  %multiply.349.13 = f32[512,256,52]{2,1,0} multiply(f32[512,256,52]{2,1,0} %broadcast.561.17, f32[512,256,52]{2,1,0} %broadcast.562.14), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoder_norm/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=228}
  %multiply.350.5 = f32[512,256,52]{2,1,0} multiply(f32[512,256,52]{2,1,0} %subtract.36.5, f32[512,256,52]{2,1,0} %multiply.349.13), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoder_norm/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=228}
  %param_2.761 = f32[256]{0} parameter(2)
  %broadcast.563.1 = f32[512,256,52]{2,1,0} broadcast(f32[256]{0} %param_2.761), dimensions={1}, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoder_norm/add" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=228}
  %add.225.3 = f32[512,256,52]{2,1,0} add(f32[512,256,52]{2,1,0} %multiply.350.5, f32[512,256,52]{2,1,0} %broadcast.563.1), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoder_norm/add" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=228}
  %constant_50_21 = f32[] constant(0)
  ROOT %reduce.28.1 = f32[256,52]{1,0} reduce(f32[512,256,52]{2,1,0} %add.225.3, f32[] %constant_50_21), dimensions={0}, to_apply=%region_2.176
}

%fused_reduce.16 (param_0.1196: f32[1,512,52], param_1.1272: f32[512,256,52], param_2.757: f32[512,256,52], param_3.477: f32[512,52]) -> f32[512,256] {
  %param_0.1196 = f32[1,512,52]{2,1,0} parameter(0)
  %bitcast.4958.15 = f32[512,52]{1,0} bitcast(f32[1,512,52]{2,1,0} %param_0.1196)
  %broadcast.556.15 = f32[512,256,52]{2,1,0} broadcast(f32[512,52]{1,0} %bitcast.4958.15), dimensions={0,2}, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/LayerNorm_1/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
  %param_2.757 = f32[512,256,52]{2,1,0} parameter(2)
  %param_3.477 = f32[512,52]{1,0} parameter(3)
  %broadcast.555.9 = f32[512,256,52]{2,1,0} broadcast(f32[512,52]{1,0} %param_3.477), dimensions={0,2}, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/LayerNorm_1/sub" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
  %subtract.34.9 = f32[512,256,52]{2,1,0} subtract(f32[512,256,52]{2,1,0} %param_2.757, f32[512,256,52]{2,1,0} %broadcast.555.9), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/LayerNorm_1/sub" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
  %param_1.1272 = f32[512,256,52]{2,1,0} parameter(1)
  %multiply.376.3 = f32[512,256,52]{2,1,0} multiply(f32[512,256,52]{2,1,0} %subtract.34.9, f32[512,256,52]{2,1,0} %param_1.1272), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/LayerNorm_1/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
  %multiply.425.3 = f32[512,256,52]{2,1,0} multiply(f32[512,256,52]{2,1,0} %broadcast.556.15, f32[512,256,52]{2,1,0} %multiply.376.3), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/LayerNorm_1/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
  %constant_50_3 = f32[] constant(0)
  ROOT %reduce.85.1 = f32[512,256]{1,0} reduce(f32[512,256,52]{2,1,0} %multiply.425.3, f32[] %constant_50_3), dimensions={2}, to_apply=%region_2.176
}

%fused_reduce.17 (param_0.1241: f32[1,512,52], param_1.1311: f32[512,256,52], param_2.775: f32[512,256,52], param_3.488: f32[512,52]) -> f32[512,256] {
  %param_0.1241 = f32[1,512,52]{2,1,0} parameter(0)
  %bitcast.4762.15 = f32[512,52]{1,0} bitcast(f32[1,512,52]{2,1,0} %param_0.1241)
  %broadcast.546.15 = f32[512,256,52]{2,1,0} broadcast(f32[512,52]{1,0} %bitcast.4762.15), dimensions={0,2}, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/LayerNorm_0/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
  %param_2.775 = f32[512,256,52]{2,1,0} parameter(2)
  %param_3.488 = f32[512,52]{1,0} parameter(3)
  %broadcast.544.9 = f32[512,256,52]{2,1,0} broadcast(f32[512,52]{1,0} %param_3.488), dimensions={0,2}, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/LayerNorm_0/sub" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
  %subtract.31.9 = f32[512,256,52]{2,1,0} subtract(f32[512,256,52]{2,1,0} %param_2.775, f32[512,256,52]{2,1,0} %broadcast.544.9), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/LayerNorm_0/sub" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
  %param_1.1311 = f32[512,256,52]{2,1,0} parameter(1)
  %multiply.393.3 = f32[512,256,52]{2,1,0} multiply(f32[512,256,52]{2,1,0} %subtract.31.9, f32[512,256,52]{2,1,0} %param_1.1311), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/LayerNorm_0/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
  %multiply.424.3 = f32[512,256,52]{2,1,0} multiply(f32[512,256,52]{2,1,0} %broadcast.546.15, f32[512,256,52]{2,1,0} %multiply.393.3), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/LayerNorm_0/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
  %constant_50_48 = f32[] constant(0)
  ROOT %reduce.81.1 = f32[512,256]{1,0} reduce(f32[512,256,52]{2,1,0} %multiply.424.3, f32[] %constant_50_48), dimensions={2}, to_apply=%region_2.176
}

%fused_reduce.18 (param_0.1239: f32[1,512,52], param_1.1309: f32[512,256,52], param_2.774: f32[512,256,52], param_3.487: f32[512,52]) -> f32[512,256] {
  %param_0.1239 = f32[1,512,52]{2,1,0} parameter(0)
  %bitcast.4678.15 = f32[512,52]{1,0} bitcast(f32[1,512,52]{2,1,0} %param_0.1239)
  %broadcast.537.15 = f32[512,256,52]{2,1,0} broadcast(f32[512,52]{1,0} %bitcast.4678.15), dimensions={0,2}, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/LayerNorm_1/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
  %param_2.774 = f32[512,256,52]{2,1,0} parameter(2)
  %param_3.487 = f32[512,52]{1,0} parameter(3)
  %broadcast.536.9 = f32[512,256,52]{2,1,0} broadcast(f32[512,52]{1,0} %param_3.487), dimensions={0,2}, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/LayerNorm_1/sub" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
  %subtract.29.9 = f32[512,256,52]{2,1,0} subtract(f32[512,256,52]{2,1,0} %param_2.774, f32[512,256,52]{2,1,0} %broadcast.536.9), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/LayerNorm_1/sub" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
  %param_1.1309 = f32[512,256,52]{2,1,0} parameter(1)
  %multiply.404.3 = f32[512,256,52]{2,1,0} multiply(f32[512,256,52]{2,1,0} %subtract.29.9, f32[512,256,52]{2,1,0} %param_1.1309), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/LayerNorm_1/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
  %multiply.423.3 = f32[512,256,52]{2,1,0} multiply(f32[512,256,52]{2,1,0} %broadcast.537.15, f32[512,256,52]{2,1,0} %multiply.404.3), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/LayerNorm_1/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
  %constant_50_46 = f32[] constant(0)
  ROOT %reduce.71.1 = f32[512,256]{1,0} reduce(f32[512,256,52]{2,1,0} %multiply.423.3, f32[] %constant_50_46), dimensions={2}, to_apply=%region_2.176
}

%fused_reduce.19 (param_0.1237: f32[1,512,52], param_1.1308: f32[512,256,52], param_2.773: f32[512,52], param_3.486: bf16[512,256], param_4.283: bf16[512,256,52]) -> f32[512,256] {
  %param_0.1237 = f32[1,512,52]{2,1,0} parameter(0)
  %bitcast.4483.15 = f32[512,52]{1,0} bitcast(f32[1,512,52]{2,1,0} %param_0.1237)
  %broadcast.525.15 = f32[512,256,52]{2,1,0} broadcast(f32[512,52]{1,0} %bitcast.4483.15), dimensions={0,2}, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/LayerNorm_0/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
  %param_4.283 = bf16[512,256,52]{2,1,0} parameter(4)
  %convert.1332.21 = f32[512,256,52]{2,1,0} convert(bf16[512,256,52]{2,1,0} %param_4.283)
  %param_3.486 = bf16[512,256]{1,0} parameter(3)
  %convert.1523.12 = f32[512,256]{1,0} convert(bf16[512,256]{1,0} %param_3.486)
  %broadcast.602.21 = f32[512,256,52]{2,1,0} broadcast(f32[512,256]{1,0} %convert.1523.12), dimensions={0,1}, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/im_embed/vmap(inner)/pos_embed/add" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=64}
  %add.199.21 = f32[512,256,52]{2,1,0} add(f32[512,256,52]{2,1,0} %convert.1332.21, f32[512,256,52]{2,1,0} %broadcast.602.21), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/im_embed/vmap(inner)/pos_embed/add" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=64}
  %param_2.773 = f32[512,52]{1,0} parameter(2)
  %broadcast.520.11 = f32[512,256,52]{2,1,0} broadcast(f32[512,52]{1,0} %param_2.773), dimensions={0,2}, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/LayerNorm_0/sub" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
  %subtract.26.11 = f32[512,256,52]{2,1,0} subtract(f32[512,256,52]{2,1,0} %add.199.21, f32[512,256,52]{2,1,0} %broadcast.520.11), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/LayerNorm_0/sub" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
  %param_1.1308 = f32[512,256,52]{2,1,0} parameter(1)
  %multiply.421.5 = f32[512,256,52]{2,1,0} multiply(f32[512,256,52]{2,1,0} %subtract.26.11, f32[512,256,52]{2,1,0} %param_1.1308), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/LayerNorm_0/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
  %multiply.422.3 = f32[512,256,52]{2,1,0} multiply(f32[512,256,52]{2,1,0} %broadcast.525.15, f32[512,256,52]{2,1,0} %multiply.421.5), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/LayerNorm_0/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
  %constant_50_44 = f32[] constant(0)
  ROOT %reduce.67.1 = f32[512,256]{1,0} reduce(f32[512,256,52]{2,1,0} %multiply.422.3, f32[] %constant_50_44), dimensions={2}, to_apply=%region_2.176
}

%fused_reduce.20 (param_0.1225: f32[256], param_1.1297: f32[512,256,52], param_2.767: f32[512,256,52], param_3.482: f32[512,52], param_4.346: f32[1,512,52]) -> (f32[512,52], f32[512,52]) {
  %param_2.767 = f32[512,256,52]{2,1,0} parameter(2)
  %param_3.482 = f32[512,52]{1,0} parameter(3)
  %broadcast.536.11 = f32[512,256,52]{2,1,0} broadcast(f32[512,52]{1,0} %param_3.482), dimensions={0,2}, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/LayerNorm_1/sub" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
  %subtract.29.11 = f32[512,256,52]{2,1,0} subtract(f32[512,256,52]{2,1,0} %param_2.767, f32[512,256,52]{2,1,0} %broadcast.536.11), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/LayerNorm_1/sub" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
  %param_1.1297 = f32[512,256,52]{2,1,0} parameter(1)
  %multiply.404.5 = f32[512,256,52]{2,1,0} multiply(f32[512,256,52]{2,1,0} %subtract.29.11, f32[512,256,52]{2,1,0} %param_1.1297), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/LayerNorm_1/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
  %param_0.1225 = f32[256]{0} parameter(0)
  %broadcast.539.12 = f32[512,256,52]{2,1,0} broadcast(f32[256]{0} %param_0.1225), dimensions={1}, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/LayerNorm_1/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
  %multiply.405.3 = f32[512,256,52]{2,1,0} multiply(f32[512,256,52]{2,1,0} %multiply.404.5, f32[512,256,52]{2,1,0} %broadcast.539.12), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/LayerNorm_1/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
  %constant_50_32 = f32[] constant(0)
  %reduce.38.1 = f32[512,52]{1,0} reduce(f32[512,256,52]{2,1,0} %multiply.405.3, f32[] %constant_50_32), dimensions={1}, to_apply=%region_2.176
  %param_4.346 = f32[1,512,52]{2,1,0} parameter(4)
  %bitcast.4678.23.clone.1 = f32[512,52]{1,0} bitcast(f32[1,512,52]{2,1,0} %param_4.346)
  %broadcast.537.23.clone.1 = f32[512,256,52]{2,1,0} broadcast(f32[512,52]{1,0} %bitcast.4678.23.clone.1), dimensions={0,2}, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/LayerNorm_1/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
  %multiply.328.17.clone.1 = f32[512,256,52]{2,1,0} multiply(f32[512,256,52]{2,1,0} %broadcast.537.23.clone.1, f32[512,256,52]{2,1,0} %broadcast.539.12), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/LayerNorm_1/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
  %multiply.403.7.clone.1 = f32[512,256,52]{2,1,0} multiply(f32[512,256,52]{2,1,0} %param_1.1297, f32[512,256,52]{2,1,0} %multiply.328.17.clone.1), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/LayerNorm_1/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
  %reduce.39.3.clone.1 = f32[512,52]{1,0} reduce(f32[512,256,52]{2,1,0} %multiply.403.7.clone.1, f32[] %constant_50_32), dimensions={1}, to_apply=%region_2.176
  %negate.40.1.clone.1 = f32[512,52]{1,0} negate(f32[512,52]{1,0} %reduce.39.3.clone.1), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/LayerNorm_1/neg" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
  ROOT %tuple.31 = (f32[512,52]{1,0}, f32[512,52]{1,0}) tuple(f32[512,52]{1,0} %reduce.38.1, f32[512,52]{1,0} %negate.40.1.clone.1)
}

%fused_reduce.21 (param_0.1231: f32[256], param_1.1303: f32[512,256,52], param_2.770: f32[512,256,52], param_3.484: f32[512,52], param_4.357: f32[1,512,52]) -> (f32[512,52], f32[512,52]) {
  %param_2.770 = f32[512,256,52]{2,1,0} parameter(2)
  %param_3.484 = f32[512,52]{1,0} parameter(3)
  %broadcast.544.11 = f32[512,256,52]{2,1,0} broadcast(f32[512,52]{1,0} %param_3.484), dimensions={0,2}, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/LayerNorm_0/sub" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
  %subtract.31.11 = f32[512,256,52]{2,1,0} subtract(f32[512,256,52]{2,1,0} %param_2.770, f32[512,256,52]{2,1,0} %broadcast.544.11), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/LayerNorm_0/sub" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
  %param_1.1303 = f32[512,256,52]{2,1,0} parameter(1)
  %multiply.393.5 = f32[512,256,52]{2,1,0} multiply(f32[512,256,52]{2,1,0} %subtract.31.11, f32[512,256,52]{2,1,0} %param_1.1303), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/LayerNorm_0/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
  %param_0.1231 = f32[256]{0} parameter(0)
  %broadcast.547.12 = f32[512,256,52]{2,1,0} broadcast(f32[256]{0} %param_0.1231), dimensions={1}, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/LayerNorm_0/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
  %multiply.394.3 = f32[512,256,52]{2,1,0} multiply(f32[512,256,52]{2,1,0} %multiply.393.5, f32[512,256,52]{2,1,0} %broadcast.547.12), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/LayerNorm_0/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
  %constant_50_38 = f32[] constant(0)
  %reduce.36.1 = f32[512,52]{1,0} reduce(f32[512,256,52]{2,1,0} %multiply.394.3, f32[] %constant_50_38), dimensions={1}, to_apply=%region_2.176
  %param_4.357 = f32[1,512,52]{2,1,0} parameter(4)
  %bitcast.4762.23.clone.1 = f32[512,52]{1,0} bitcast(f32[1,512,52]{2,1,0} %param_4.357)
  %broadcast.546.23.clone.1 = f32[512,256,52]{2,1,0} broadcast(f32[512,52]{1,0} %bitcast.4762.23.clone.1), dimensions={0,2}, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/LayerNorm_0/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
  %multiply.335.17.clone.1 = f32[512,256,52]{2,1,0} multiply(f32[512,256,52]{2,1,0} %broadcast.546.23.clone.1, f32[512,256,52]{2,1,0} %broadcast.547.12), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/LayerNorm_0/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
  %multiply.392.7.clone.1 = f32[512,256,52]{2,1,0} multiply(f32[512,256,52]{2,1,0} %param_1.1303, f32[512,256,52]{2,1,0} %multiply.335.17.clone.1), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/LayerNorm_0/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
  %reduce.37.3.clone.1 = f32[512,52]{1,0} reduce(f32[512,256,52]{2,1,0} %multiply.392.7.clone.1, f32[] %constant_50_38), dimensions={1}, to_apply=%region_2.176
  %negate.38.1.clone.1 = f32[512,52]{1,0} negate(f32[512,52]{1,0} %reduce.37.3.clone.1), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/LayerNorm_0/neg" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
  ROOT %tuple.34 = (f32[512,52]{1,0}, f32[512,52]{1,0}) tuple(f32[512,52]{1,0} %reduce.36.1, f32[512,52]{1,0} %negate.38.1.clone.1)
}

%fused_reduce.22 (param_0.1224: f32[256], param_1.1296: f32[512,256,52], param_2.766: f32[512,256,52], param_3.481: f32[512,52], param_4.368: f32[1,512,52]) -> (f32[512,52], f32[512,52]) {
  %param_2.766 = f32[512,256,52]{2,1,0} parameter(2)
  %param_3.481 = f32[512,52]{1,0} parameter(3)
  %broadcast.555.11 = f32[512,256,52]{2,1,0} broadcast(f32[512,52]{1,0} %param_3.481), dimensions={0,2}, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/LayerNorm_1/sub" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
  %subtract.34.11 = f32[512,256,52]{2,1,0} subtract(f32[512,256,52]{2,1,0} %param_2.766, f32[512,256,52]{2,1,0} %broadcast.555.11), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/LayerNorm_1/sub" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
  %param_1.1296 = f32[512,256,52]{2,1,0} parameter(1)
  %multiply.376.5 = f32[512,256,52]{2,1,0} multiply(f32[512,256,52]{2,1,0} %subtract.34.11, f32[512,256,52]{2,1,0} %param_1.1296), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/LayerNorm_1/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
  %param_0.1224 = f32[256]{0} parameter(0)
  %broadcast.557.12 = f32[512,256,52]{2,1,0} broadcast(f32[256]{0} %param_0.1224), dimensions={1}, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/LayerNorm_1/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
  %multiply.377.3 = f32[512,256,52]{2,1,0} multiply(f32[512,256,52]{2,1,0} %multiply.376.5, f32[512,256,52]{2,1,0} %broadcast.557.12), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/LayerNorm_1/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
  %constant_50_31 = f32[] constant(0)
  %reduce.34.1 = f32[512,52]{1,0} reduce(f32[512,256,52]{2,1,0} %multiply.377.3, f32[] %constant_50_31), dimensions={1}, to_apply=%region_2.176
  %param_4.368 = f32[1,512,52]{2,1,0} parameter(4)
  %bitcast.4958.23.clone.1 = f32[512,52]{1,0} bitcast(f32[1,512,52]{2,1,0} %param_4.368)
  %broadcast.556.23.clone.1 = f32[512,256,52]{2,1,0} broadcast(f32[512,52]{1,0} %bitcast.4958.23.clone.1), dimensions={0,2}, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/LayerNorm_1/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
  %multiply.342.17.clone.1 = f32[512,256,52]{2,1,0} multiply(f32[512,256,52]{2,1,0} %broadcast.556.23.clone.1, f32[512,256,52]{2,1,0} %broadcast.557.12), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/LayerNorm_1/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
  %multiply.375.7.clone.1 = f32[512,256,52]{2,1,0} multiply(f32[512,256,52]{2,1,0} %param_1.1296, f32[512,256,52]{2,1,0} %multiply.342.17.clone.1), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/LayerNorm_1/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
  %reduce.35.3.clone.1 = f32[512,52]{1,0} reduce(f32[512,256,52]{2,1,0} %multiply.375.7.clone.1, f32[] %constant_50_31), dimensions={1}, to_apply=%region_2.176
  %negate.35.1.clone.1 = f32[512,52]{1,0} negate(f32[512,52]{1,0} %reduce.35.3.clone.1), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/LayerNorm_1/neg" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
  ROOT %tuple.43 = (f32[512,52]{1,0}, f32[512,52]{1,0}) tuple(f32[512,52]{1,0} %reduce.34.1, f32[512,52]{1,0} %negate.35.1.clone.1)
}

%fused_convert.13 (param_0.780: f32[8,32], param_1.717: bf16[26624,256]) -> bf16[52,8,512,32] {
  %param_1.717 = bf16[26624,256]{1,0} parameter(1)
  %bitcast.4807.3 = bf16[52,512,8,32]{3,2,1,0} bitcast(bf16[26624,256]{1,0} %param_1.717)
  %transpose.1192.3 = bf16[52,8,512,32]{3,2,1,0} transpose(bf16[52,512,8,32]{3,2,1,0} %bitcast.4807.3), dimensions={0,2,1,3}, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/MultiHeadDotProductAttention_0/query/dot_general[dimension_numbers=(((2,), (0,)), ((), ())) precision=None preferred_element_type=None]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %convert.1380.1 = f32[52,8,512,32]{3,2,1,0} convert(bf16[52,8,512,32]{3,2,1,0} %transpose.1192.3)
  %param_0.780 = f32[8,32]{1,0} parameter(0)
  %broadcast.617.3 = f32[52,8,512,32]{3,2,1,0} broadcast(f32[8,32]{1,0} %param_0.780), dimensions={1,3}, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/MultiHeadDotProductAttention_0/query/add" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %add.215.3 = f32[52,8,512,32]{3,2,1,0} add(f32[52,8,512,32]{3,2,1,0} %convert.1380.1, f32[52,8,512,32]{3,2,1,0} %broadcast.617.3), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/MultiHeadDotProductAttention_0/query/add" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %constant_38_5 = bf16[] constant(0.1768)
  %convert.1526.3 = f32[] convert(bf16[] %constant_38_5)
  %broadcast.608.6 = f32[52,8,512,32]{3,2,1,0} broadcast(f32[] %convert.1526.3), dimensions={}
  %multiply.337.3 = f32[52,8,512,32]{3,2,1,0} multiply(f32[52,8,512,32]{3,2,1,0} %add.215.3, f32[52,8,512,32]{3,2,1,0} %broadcast.608.6), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/MultiHeadDotProductAttention_0/div" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  ROOT %convert.1384.1 = bf16[52,8,512,32]{3,2,1,0} convert(f32[52,8,512,32]{3,2,1,0} %multiply.337.3)
}

%fused_convert.14 (param_0.779: f32[8,32], param_1.716: bf16[26624,256]) -> bf16[52,8,512,32] {
  %param_1.716 = bf16[26624,256]{1,0} parameter(1)
  %bitcast.4528.3 = bf16[52,512,8,32]{3,2,1,0} bitcast(bf16[26624,256]{1,0} %param_1.716)
  %transpose.1183.3 = bf16[52,8,512,32]{3,2,1,0} transpose(bf16[52,512,8,32]{3,2,1,0} %bitcast.4528.3), dimensions={0,2,1,3}, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/MultiHeadDotProductAttention_0/query/dot_general[dimension_numbers=(((2,), (0,)), ((), ())) precision=None preferred_element_type=None]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %convert.1342.1 = f32[52,8,512,32]{3,2,1,0} convert(bf16[52,8,512,32]{3,2,1,0} %transpose.1183.3)
  %param_0.779 = f32[8,32]{1,0} parameter(0)
  %broadcast.604.3 = f32[52,8,512,32]{3,2,1,0} broadcast(f32[8,32]{1,0} %param_0.779), dimensions={1,3}, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/MultiHeadDotProductAttention_0/query/add" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %add.203.3 = f32[52,8,512,32]{3,2,1,0} add(f32[52,8,512,32]{3,2,1,0} %convert.1342.1, f32[52,8,512,32]{3,2,1,0} %broadcast.604.3), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/MultiHeadDotProductAttention_0/query/add" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %constant_38_4 = bf16[] constant(0.1768)
  %convert.1526.2 = f32[] convert(bf16[] %constant_38_4)
  %broadcast.608.8 = f32[52,8,512,32]{3,2,1,0} broadcast(f32[] %convert.1526.2), dimensions={}
  %multiply.322.3 = f32[52,8,512,32]{3,2,1,0} multiply(f32[52,8,512,32]{3,2,1,0} %add.203.3, f32[52,8,512,32]{3,2,1,0} %broadcast.608.8), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/MultiHeadDotProductAttention_0/div" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  ROOT %convert.1346.1 = bf16[52,8,512,32]{3,2,1,0} convert(f32[52,8,512,32]{3,2,1,0} %multiply.322.3)
}

%region_26.806.clone.20 (Arg_0.23.0: f32[], Arg_1.23.0: f32[]) -> f32[] {
  %Arg_1.23.0 = f32[] parameter(1)
  %Arg_0.23.0 = f32[] parameter(0)
  ROOT %add.192.0 = f32[] add(f32[] %Arg_0.23.0, f32[] %Arg_1.23.0), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/vmap(vmap(LazyInMLP_0))/Dense_0/reduce_sum[axes=(0, 1)]" source_file="/home/nicholas/programs/avid/avid/layers.py" source_line=49}
}

%fused_reduce.23 (param_0.878: bf16[416,32,512]) -> f32[52,8,32] {
  %param_0.878 = bf16[416,32,512]{2,1,0} parameter(0)
  %bitcast.5388.5 = bf16[52,8,32,512]{3,2,1,0} bitcast(bf16[416,32,512]{2,1,0} %param_0.878)
  %convert.1494.3 = f32[52,8,32,512]{3,2,1,0} convert(bf16[52,8,32,512]{3,2,1,0} %bitcast.5388.5)
  %constant_60_23 = bf16[] constant(0)
  %convert.1433.21 = f32[] convert(bf16[] %constant_60_23)
  ROOT %reduce.91.1 = f32[52,8,32]{2,1,0} reduce(f32[52,8,32,512]{3,2,1,0} %convert.1494.3, f32[] %convert.1433.21), dimensions={3}, to_apply=%region_26.806.clone.20
}

%region_26.806.clone.10 (Arg_0.13.0: f32[], Arg_1.13.0: f32[]) -> f32[] {
  %Arg_1.13.0 = f32[] parameter(1)
  %Arg_0.13.0 = f32[] parameter(0)
  ROOT %add.186.0 = f32[] add(f32[] %Arg_0.13.0, f32[] %Arg_1.13.0), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/vmap(vmap(LazyInMLP_0))/Dense_0/reduce_sum[axes=(0, 1)]" source_file="/home/nicholas/programs/avid/avid/layers.py" source_line=49}
}

%fused_reduce.24 (param_0.868: bf16[416,32,512]) -> f32[52,8,32] {
  %param_0.868 = bf16[416,32,512]{2,1,0} parameter(0)
  %bitcast.5735.5 = bf16[52,8,32,512]{3,2,1,0} bitcast(bf16[416,32,512]{2,1,0} %param_0.868)
  %convert.1475.3 = f32[52,8,32,512]{3,2,1,0} convert(bf16[52,8,32,512]{3,2,1,0} %bitcast.5735.5)
  %constant_60_13 = bf16[] constant(0)
  %convert.1433.11 = f32[] convert(bf16[] %constant_60_13)
  ROOT %reduce.77.1 = f32[52,8,32]{2,1,0} reduce(f32[52,8,32,512]{3,2,1,0} %convert.1475.3, f32[] %convert.1433.11), dimensions={3}, to_apply=%region_26.806.clone.10
}

%fused_transpose.12 (param_0.568: f32[8,32], param_1.654: bf16[26624,256]) -> bf16[52,8,32,512] {
  %param_1.654 = bf16[26624,256]{1,0} parameter(1)
  %bitcast.4833.3 = bf16[52,512,8,32]{3,2,1,0} bitcast(bf16[26624,256]{1,0} %param_1.654)
  %transpose.1193.3 = bf16[52,8,32,512]{3,2,1,0} transpose(bf16[52,512,8,32]{3,2,1,0} %bitcast.4833.3), dimensions={0,2,3,1}, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/MultiHeadDotProductAttention_0/key/dot_general[dimension_numbers=(((2,), (0,)), ((), ())) precision=None preferred_element_type=None]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %convert.1386.1 = f32[52,8,32,512]{3,2,1,0} convert(bf16[52,8,32,512]{3,2,1,0} %transpose.1193.3)
  %param_0.568 = f32[8,32]{1,0} parameter(0)
  %broadcast.619.3 = f32[52,8,32,512]{3,2,1,0} broadcast(f32[8,32]{1,0} %param_0.568), dimensions={1,2}, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/MultiHeadDotProductAttention_0/key/add" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %add.216.3 = f32[52,8,32,512]{3,2,1,0} add(f32[52,8,32,512]{3,2,1,0} %convert.1386.1, f32[52,8,32,512]{3,2,1,0} %broadcast.619.3), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/MultiHeadDotProductAttention_0/key/add" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  ROOT %convert.1389.1 = bf16[52,8,32,512]{3,2,1,0} convert(f32[52,8,32,512]{3,2,1,0} %add.216.3)
}

%fused_transpose.13 (param_0.569: f32[8,32], param_1.652: bf16[26624,256]) -> bf16[52,8,32,512] {
  %param_1.652 = bf16[26624,256]{1,0} parameter(1)
  %bitcast.4785.3 = bf16[52,512,8,32]{3,2,1,0} bitcast(bf16[26624,256]{1,0} %param_1.652)
  %transpose.1191.3 = bf16[52,8,32,512]{3,2,1,0} transpose(bf16[52,512,8,32]{3,2,1,0} %bitcast.4785.3), dimensions={0,2,3,1}, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/MultiHeadDotProductAttention_0/value/dot_general[dimension_numbers=(((2,), (0,)), ((), ())) precision=None preferred_element_type=None]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %convert.1375.1 = f32[52,8,32,512]{3,2,1,0} convert(bf16[52,8,32,512]{3,2,1,0} %transpose.1191.3)
  %param_0.569 = f32[8,32]{1,0} parameter(0)
  %broadcast.616.3 = f32[52,8,32,512]{3,2,1,0} broadcast(f32[8,32]{1,0} %param_0.569), dimensions={1,2}, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/MultiHeadDotProductAttention_0/value/add" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %add.214.3 = f32[52,8,32,512]{3,2,1,0} add(f32[52,8,32,512]{3,2,1,0} %convert.1375.1, f32[52,8,32,512]{3,2,1,0} %broadcast.616.3), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/MultiHeadDotProductAttention_0/value/add" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  ROOT %convert.1378.1 = bf16[52,8,32,512]{3,2,1,0} convert(f32[52,8,32,512]{3,2,1,0} %add.214.3)
}

%fused_transpose.14 (param_0.579: f32[8,32], param_1.642: bf16[26624,256]) -> bf16[52,8,32,512] {
  %param_1.642 = bf16[26624,256]{1,0} parameter(1)
  %bitcast.4554.3 = bf16[52,512,8,32]{3,2,1,0} bitcast(bf16[26624,256]{1,0} %param_1.642)
  %transpose.1184.3 = bf16[52,8,32,512]{3,2,1,0} transpose(bf16[52,512,8,32]{3,2,1,0} %bitcast.4554.3), dimensions={0,2,3,1}, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/MultiHeadDotProductAttention_0/key/dot_general[dimension_numbers=(((2,), (0,)), ((), ())) precision=None preferred_element_type=None]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %convert.1348.1 = f32[52,8,32,512]{3,2,1,0} convert(bf16[52,8,32,512]{3,2,1,0} %transpose.1184.3)
  %param_0.579 = f32[8,32]{1,0} parameter(0)
  %broadcast.609.3 = f32[52,8,32,512]{3,2,1,0} broadcast(f32[8,32]{1,0} %param_0.579), dimensions={1,2}, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/MultiHeadDotProductAttention_0/key/add" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %add.204.3 = f32[52,8,32,512]{3,2,1,0} add(f32[52,8,32,512]{3,2,1,0} %convert.1348.1, f32[52,8,32,512]{3,2,1,0} %broadcast.609.3), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/MultiHeadDotProductAttention_0/key/add" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  ROOT %convert.1351.1 = bf16[52,8,32,512]{3,2,1,0} convert(f32[52,8,32,512]{3,2,1,0} %add.204.3)
}

%fused_transpose.15 (param_0.580: f32[8,32], param_1.640: bf16[26624,256]) -> bf16[52,8,32,512] {
  %param_1.640 = bf16[26624,256]{1,0} parameter(1)
  %bitcast.4506.3 = bf16[52,512,8,32]{3,2,1,0} bitcast(bf16[26624,256]{1,0} %param_1.640)
  %transpose.1182.3 = bf16[52,8,32,512]{3,2,1,0} transpose(bf16[52,512,8,32]{3,2,1,0} %bitcast.4506.3), dimensions={0,2,3,1}, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/MultiHeadDotProductAttention_0/value/dot_general[dimension_numbers=(((2,), (0,)), ((), ())) precision=None preferred_element_type=None]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %convert.1337.1 = f32[52,8,32,512]{3,2,1,0} convert(bf16[52,8,32,512]{3,2,1,0} %transpose.1182.3)
  %param_0.580 = f32[8,32]{1,0} parameter(0)
  %broadcast.603.3 = f32[52,8,32,512]{3,2,1,0} broadcast(f32[8,32]{1,0} %param_0.580), dimensions={1,2}, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/MultiHeadDotProductAttention_0/value/add" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %add.202.3 = f32[52,8,32,512]{3,2,1,0} add(f32[52,8,32,512]{3,2,1,0} %convert.1337.1, f32[52,8,32,512]{3,2,1,0} %broadcast.603.3), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/MultiHeadDotProductAttention_0/value/add" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  ROOT %convert.1340.1 = bf16[52,8,32,512]{3,2,1,0} convert(f32[52,8,32,512]{3,2,1,0} %add.202.3)
}

%fused_transpose.16 (param_0.561: f32[512,256,52], param_1.666: f32[256], param_2.343: bf16[26624,256]) -> f32[512,256,52] {
  %param_0.561 = f32[512,256,52]{2,1,0} parameter(0)
  %param_2.343 = bf16[26624,256]{1,0} parameter(2)
  %convert.1406.5 = f32[26624,256]{1,0} convert(bf16[26624,256]{1,0} %param_2.343)
  %param_1.666 = f32[256]{0} parameter(1)
  %broadcast.626.7 = f32[26624,256]{1,0} broadcast(f32[256]{0} %param_1.666), dimensions={1}, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/vmap(vmap(LazyInMLP_0))/Dense_0/add" source_file="/home/nicholas/programs/avid/avid/layers.py" source_line=49}
  %add.221.7 = f32[26624,256]{1,0} add(f32[26624,256]{1,0} %convert.1406.5, f32[26624,256]{1,0} %broadcast.626.7), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/vmap(vmap(LazyInMLP_0))/Dense_0/add" source_file="/home/nicholas/programs/avid/avid/layers.py" source_line=49}
  %convert.1409.5 = bf16[26624,256]{1,0} convert(f32[26624,256]{1,0} %add.221.7)
  %bitcast.4987.3 = bf16[52,512,256]{2,1,0} bitcast(bf16[26624,256]{1,0} %convert.1409.5)
  %transpose.1197.3 = bf16[512,256,52]{2,1,0} transpose(bf16[52,512,256]{2,1,0} %bitcast.4987.3), dimensions={1,2,0}, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/vmap(vmap(LazyInMLP_0))/Dense_0/add" source_file="/home/nicholas/programs/avid/avid/layers.py" source_line=49}
  %convert.1410.1 = f32[512,256,52]{2,1,0} convert(bf16[512,256,52]{2,1,0} %transpose.1197.3)
  ROOT %add.222.1 = f32[512,256,52]{2,1,0} add(f32[512,256,52]{2,1,0} %param_0.561, f32[512,256,52]{2,1,0} %convert.1410.1), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/add" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=185}
}

%fused_transpose.17 (param_0.566: f32[512,256,52], param_1.660: f32[256], param_2.340: bf16[26624,256]) -> f32[512,256,52] {
  %param_2.340 = bf16[26624,256]{1,0} parameter(2)
  %convert.1399.5 = f32[26624,256]{1,0} convert(bf16[26624,256]{1,0} %param_2.340)
  %param_1.660 = f32[256]{0} parameter(1)
  %broadcast.624.7 = f32[26624,256]{1,0} broadcast(f32[256]{0} %param_1.660), dimensions={1}, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/MultiHeadDotProductAttention_0/out/add" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %add.217.7 = f32[26624,256]{1,0} add(f32[26624,256]{1,0} %convert.1399.5, f32[26624,256]{1,0} %broadcast.624.7), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/MultiHeadDotProductAttention_0/out/add" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %convert.1402.5 = bf16[26624,256]{1,0} convert(f32[26624,256]{1,0} %add.217.7)
  %bitcast.4901.3 = bf16[52,512,256]{2,1,0} bitcast(bf16[26624,256]{1,0} %convert.1402.5)
  %transpose.1195.3 = bf16[512,256,52]{2,1,0} transpose(bf16[52,512,256]{2,1,0} %bitcast.4901.3), dimensions={1,2,0}, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/MultiHeadDotProductAttention_0/out/add" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %convert.1403.1 = f32[512,256,52]{2,1,0} convert(bf16[512,256,52]{2,1,0} %transpose.1195.3)
  %param_0.566 = f32[512,256,52]{2,1,0} parameter(0)
  ROOT %add.218.1 = f32[512,256,52]{2,1,0} add(f32[512,256,52]{2,1,0} %convert.1403.1, f32[512,256,52]{2,1,0} %param_0.566), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/add" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=168}
}

%fused_transpose.18 (param_0.572: f32[512,256,52], param_1.650: f32[256], param_2.335: bf16[26624,256]) -> f32[512,256,52] {
  %param_0.572 = f32[512,256,52]{2,1,0} parameter(0)
  %param_2.335 = bf16[26624,256]{1,0} parameter(2)
  %convert.1368.5 = f32[26624,256]{1,0} convert(bf16[26624,256]{1,0} %param_2.335)
  %param_1.650 = f32[256]{0} parameter(1)
  %broadcast.615.7 = f32[26624,256]{1,0} broadcast(f32[256]{0} %param_1.650), dimensions={1}, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/vmap(vmap(LazyInMLP_0))/Dense_0/add" source_file="/home/nicholas/programs/avid/avid/layers.py" source_line=49}
  %add.210.7 = f32[26624,256]{1,0} add(f32[26624,256]{1,0} %convert.1368.5, f32[26624,256]{1,0} %broadcast.615.7), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/vmap(vmap(LazyInMLP_0))/Dense_0/add" source_file="/home/nicholas/programs/avid/avid/layers.py" source_line=49}
  %convert.1371.5 = bf16[26624,256]{1,0} convert(f32[26624,256]{1,0} %add.210.7)
  %bitcast.4707.3 = bf16[52,512,256]{2,1,0} bitcast(bf16[26624,256]{1,0} %convert.1371.5)
  %transpose.1188.3 = bf16[512,256,52]{2,1,0} transpose(bf16[52,512,256]{2,1,0} %bitcast.4707.3), dimensions={1,2,0}, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/vmap(vmap(LazyInMLP_0))/Dense_0/add" source_file="/home/nicholas/programs/avid/avid/layers.py" source_line=49}
  %convert.1372.1 = f32[512,256,52]{2,1,0} convert(bf16[512,256,52]{2,1,0} %transpose.1188.3)
  ROOT %add.211.1 = f32[512,256,52]{2,1,0} add(f32[512,256,52]{2,1,0} %param_0.572, f32[512,256,52]{2,1,0} %convert.1372.1), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/add" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=185}
}

%fused_transpose.19 (param_0.687: bf16[512,256,52], param_1.644: bf16[512,256], param_2.332: f32[256], param_3.175: bf16[26624,256]) -> f32[512,256,52] {
  %param_3.175 = bf16[26624,256]{1,0} parameter(3)
  %convert.1361.5 = f32[26624,256]{1,0} convert(bf16[26624,256]{1,0} %param_3.175)
  %param_2.332 = f32[256]{0} parameter(2)
  %broadcast.614.7 = f32[26624,256]{1,0} broadcast(f32[256]{0} %param_2.332), dimensions={1}, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/MultiHeadDotProductAttention_0/out/add" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %add.205.7 = f32[26624,256]{1,0} add(f32[26624,256]{1,0} %convert.1361.5, f32[26624,256]{1,0} %broadcast.614.7), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/MultiHeadDotProductAttention_0/out/add" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %convert.1364.5 = bf16[26624,256]{1,0} convert(f32[26624,256]{1,0} %add.205.7)
  %bitcast.4621.3 = bf16[52,512,256]{2,1,0} bitcast(bf16[26624,256]{1,0} %convert.1364.5)
  %transpose.1186.3 = bf16[512,256,52]{2,1,0} transpose(bf16[52,512,256]{2,1,0} %bitcast.4621.3), dimensions={1,2,0}, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/MultiHeadDotProductAttention_0/out/add" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %convert.1365.1 = f32[512,256,52]{2,1,0} convert(bf16[512,256,52]{2,1,0} %transpose.1186.3)
  %param_0.687 = bf16[512,256,52]{2,1,0} parameter(0)
  %convert.1332.5 = f32[512,256,52]{2,1,0} convert(bf16[512,256,52]{2,1,0} %param_0.687)
  %param_1.644 = bf16[512,256]{1,0} parameter(1)
  %convert.1523.3 = f32[512,256]{1,0} convert(bf16[512,256]{1,0} %param_1.644)
  %broadcast.602.5 = f32[512,256,52]{2,1,0} broadcast(f32[512,256]{1,0} %convert.1523.3), dimensions={0,1}, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/im_embed/vmap(inner)/pos_embed/add" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=64}
  %add.199.5 = f32[512,256,52]{2,1,0} add(f32[512,256,52]{2,1,0} %convert.1332.5, f32[512,256,52]{2,1,0} %broadcast.602.5), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/im_embed/vmap(inner)/pos_embed/add" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=64}
  ROOT %add.206.1 = f32[512,256,52]{2,1,0} add(f32[512,256,52]{2,1,0} %convert.1365.1, f32[512,256,52]{2,1,0} %add.199.5), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/add" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=168}
}

%fused_reduce.25 (param_0.1202: bf16[512,256,52], param_1.1278: bf16[512,256]) -> (f32[512,52], f32[512,52]) {
  %param_0.1202 = bf16[512,256,52]{2,1,0} parameter(0)
  %convert.1332.11 = f32[512,256,52]{2,1,0} convert(bf16[512,256,52]{2,1,0} %param_0.1202)
  %param_1.1278 = bf16[512,256]{1,0} parameter(1)
  %convert.1523.1 = f32[512,256]{1,0} convert(bf16[512,256]{1,0} %param_1.1278)
  %broadcast.602.11 = f32[512,256,52]{2,1,0} broadcast(f32[512,256]{1,0} %convert.1523.1), dimensions={0,1}, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/im_embed/vmap(inner)/pos_embed/add" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=64}
  %add.199.11 = f32[512,256,52]{2,1,0} add(f32[512,256,52]{2,1,0} %convert.1332.11, f32[512,256,52]{2,1,0} %broadcast.602.11), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/im_embed/vmap(inner)/pos_embed/add" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=64}
  %constant_50_9 = f32[] constant(0)
  %reduce.18.1 = f32[512,52]{1,0} reduce(f32[512,256,52]{2,1,0} %add.199.11, f32[] %constant_50_9), dimensions={1}, to_apply=%region_2.176
  %multiply.317.1.clone.1 = f32[512,256,52]{2,1,0} multiply(f32[512,256,52]{2,1,0} %add.199.11, f32[512,256,52]{2,1,0} %add.199.11), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/LayerNorm_0/integer_pow[y=2]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
  %reduce.19.1.clone.1 = f32[512,52]{1,0} reduce(f32[512,256,52]{2,1,0} %multiply.317.1.clone.1, f32[] %constant_50_9), dimensions={1}, to_apply=%region_2.176
  ROOT %tuple.62 = (f32[512,52]{1,0}, f32[512,52]{1,0}) tuple(f32[512,52]{1,0} %reduce.18.1, f32[512,52]{1,0} %reduce.19.1.clone.1)
}

%fused_transpose.20 (param_0.667: f32[256], param_1.623: f32[256], param_2.310: f32[1,512,52], param_3.154: f32[512,52], param_4.55: bf16[512,256], param_5.26: bf16[512,256,52]) -> bf16[52,512,256] {
  %param_5.26 = bf16[512,256,52]{2,1,0} parameter(5)
  %convert.1332.17 = f32[512,256,52]{2,1,0} convert(bf16[512,256,52]{2,1,0} %param_5.26)
  %param_4.55 = bf16[512,256]{1,0} parameter(4)
  %convert.1523.8 = f32[512,256]{1,0} convert(bf16[512,256]{1,0} %param_4.55)
  %broadcast.602.17 = f32[512,256,52]{2,1,0} broadcast(f32[512,256]{1,0} %convert.1523.8), dimensions={0,1}, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/im_embed/vmap(inner)/pos_embed/add" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=64}
  %add.199.17 = f32[512,256,52]{2,1,0} add(f32[512,256,52]{2,1,0} %convert.1332.17, f32[512,256,52]{2,1,0} %broadcast.602.17), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/im_embed/vmap(inner)/pos_embed/add" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=64}
  %param_3.154 = f32[512,52]{1,0} parameter(3)
  %broadcast.520.7 = f32[512,256,52]{2,1,0} broadcast(f32[512,52]{1,0} %param_3.154), dimensions={0,2}, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/LayerNorm_0/sub" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
  %subtract.26.7 = f32[512,256,52]{2,1,0} subtract(f32[512,256,52]{2,1,0} %add.199.17, f32[512,256,52]{2,1,0} %broadcast.520.7), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/LayerNorm_0/sub" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
  %param_2.310 = f32[1,512,52]{2,1,0} parameter(2)
  %bitcast.4483.21 = f32[512,52]{1,0} bitcast(f32[1,512,52]{2,1,0} %param_2.310)
  %broadcast.525.21 = f32[512,256,52]{2,1,0} broadcast(f32[512,52]{1,0} %bitcast.4483.21), dimensions={0,2}, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/LayerNorm_0/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
  %param_1.623 = f32[256]{0} parameter(1)
  %broadcast.526.18 = f32[512,256,52]{2,1,0} broadcast(f32[256]{0} %param_1.623), dimensions={1}, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/LayerNorm_0/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
  %multiply.320.15 = f32[512,256,52]{2,1,0} multiply(f32[512,256,52]{2,1,0} %broadcast.525.21, f32[512,256,52]{2,1,0} %broadcast.526.18), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/LayerNorm_0/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
  %multiply.321.7 = f32[512,256,52]{2,1,0} multiply(f32[512,256,52]{2,1,0} %subtract.26.7, f32[512,256,52]{2,1,0} %multiply.320.15), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/LayerNorm_0/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
  %param_0.667 = f32[256]{0} parameter(0)
  %broadcast.527.3 = f32[512,256,52]{2,1,0} broadcast(f32[256]{0} %param_0.667), dimensions={1}, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/LayerNorm_0/add" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
  %add.201.5 = f32[512,256,52]{2,1,0} add(f32[512,256,52]{2,1,0} %multiply.321.7, f32[512,256,52]{2,1,0} %broadcast.527.3), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/LayerNorm_0/add" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
  %convert.1335.3 = bf16[512,256,52]{2,1,0} convert(f32[512,256,52]{2,1,0} %add.201.5), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/LayerNorm_0/convert_element_type[new_dtype=bfloat16 weak_type=False]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
  ROOT %transpose.1180.1 = bf16[52,512,256]{2,1,0} transpose(bf16[512,256,52]{2,1,0} %convert.1335.3), dimensions={2,0,1}, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/LayerNorm_0/convert_element_type[new_dtype=bfloat16 weak_type=False]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
}

%fused_transpose.21 (param_0.672: f32[256], param_1.628: f32[256], param_2.315: f32[1,512,52], param_3.160: f32[512,256,52], param_4.58: f32[512,52]) -> bf16[52,512,256] {
  %param_3.160 = f32[512,256,52]{2,1,0} parameter(3)
  %param_4.58 = f32[512,52]{1,0} parameter(4)
  %broadcast.536.7 = f32[512,256,52]{2,1,0} broadcast(f32[512,52]{1,0} %param_4.58), dimensions={0,2}, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/LayerNorm_1/sub" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
  %subtract.29.7 = f32[512,256,52]{2,1,0} subtract(f32[512,256,52]{2,1,0} %param_3.160, f32[512,256,52]{2,1,0} %broadcast.536.7), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/LayerNorm_1/sub" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
  %param_2.315 = f32[1,512,52]{2,1,0} parameter(2)
  %bitcast.4678.21 = f32[512,52]{1,0} bitcast(f32[1,512,52]{2,1,0} %param_2.315)
  %broadcast.537.21 = f32[512,256,52]{2,1,0} broadcast(f32[512,52]{1,0} %bitcast.4678.21), dimensions={0,2}, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/LayerNorm_1/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
  %param_1.628 = f32[256]{0} parameter(1)
  %broadcast.539.18 = f32[512,256,52]{2,1,0} broadcast(f32[256]{0} %param_1.628), dimensions={1}, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/LayerNorm_1/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
  %multiply.328.15 = f32[512,256,52]{2,1,0} multiply(f32[512,256,52]{2,1,0} %broadcast.537.21, f32[512,256,52]{2,1,0} %broadcast.539.18), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/LayerNorm_1/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
  %multiply.329.7 = f32[512,256,52]{2,1,0} multiply(f32[512,256,52]{2,1,0} %subtract.29.7, f32[512,256,52]{2,1,0} %multiply.328.15), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/LayerNorm_1/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
  %param_0.672 = f32[256]{0} parameter(0)
  %broadcast.541.3 = f32[512,256,52]{2,1,0} broadcast(f32[256]{0} %param_0.672), dimensions={1}, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/LayerNorm_1/add" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
  %add.209.5 = f32[512,256,52]{2,1,0} add(f32[512,256,52]{2,1,0} %multiply.329.7, f32[512,256,52]{2,1,0} %broadcast.541.3), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/LayerNorm_1/add" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
  %convert.1366.3 = bf16[512,256,52]{2,1,0} convert(f32[512,256,52]{2,1,0} %add.209.5), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/LayerNorm_1/convert_element_type[new_dtype=bfloat16 weak_type=False]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
  ROOT %transpose.1187.1 = bf16[52,512,256]{2,1,0} transpose(bf16[512,256,52]{2,1,0} %convert.1366.3), dimensions={2,0,1}, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/LayerNorm_1/convert_element_type[new_dtype=bfloat16 weak_type=False]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
}

%fused_transpose.22 (param_0.677: f32[256], param_1.633: f32[256], param_2.320: f32[1,512,52], param_3.166: f32[512,256,52], param_4.61: f32[512,52]) -> bf16[52,512,256] {
  %param_3.166 = f32[512,256,52]{2,1,0} parameter(3)
  %param_4.61 = f32[512,52]{1,0} parameter(4)
  %broadcast.544.7 = f32[512,256,52]{2,1,0} broadcast(f32[512,52]{1,0} %param_4.61), dimensions={0,2}, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/LayerNorm_0/sub" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
  %subtract.31.7 = f32[512,256,52]{2,1,0} subtract(f32[512,256,52]{2,1,0} %param_3.166, f32[512,256,52]{2,1,0} %broadcast.544.7), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/LayerNorm_0/sub" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
  %param_2.320 = f32[1,512,52]{2,1,0} parameter(2)
  %bitcast.4762.21 = f32[512,52]{1,0} bitcast(f32[1,512,52]{2,1,0} %param_2.320)
  %broadcast.546.21 = f32[512,256,52]{2,1,0} broadcast(f32[512,52]{1,0} %bitcast.4762.21), dimensions={0,2}, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/LayerNorm_0/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
  %param_1.633 = f32[256]{0} parameter(1)
  %broadcast.547.18 = f32[512,256,52]{2,1,0} broadcast(f32[256]{0} %param_1.633), dimensions={1}, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/LayerNorm_0/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
  %multiply.335.15 = f32[512,256,52]{2,1,0} multiply(f32[512,256,52]{2,1,0} %broadcast.546.21, f32[512,256,52]{2,1,0} %broadcast.547.18), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/LayerNorm_0/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
  %multiply.336.7 = f32[512,256,52]{2,1,0} multiply(f32[512,256,52]{2,1,0} %subtract.31.7, f32[512,256,52]{2,1,0} %multiply.335.15), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/LayerNorm_0/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
  %param_0.677 = f32[256]{0} parameter(0)
  %broadcast.548.3 = f32[512,256,52]{2,1,0} broadcast(f32[256]{0} %param_0.677), dimensions={1}, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/LayerNorm_0/add" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
  %add.213.5 = f32[512,256,52]{2,1,0} add(f32[512,256,52]{2,1,0} %multiply.336.7, f32[512,256,52]{2,1,0} %broadcast.548.3), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/LayerNorm_0/add" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
  %convert.1373.3 = bf16[512,256,52]{2,1,0} convert(f32[512,256,52]{2,1,0} %add.213.5), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/LayerNorm_0/convert_element_type[new_dtype=bfloat16 weak_type=False]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
  ROOT %transpose.1190.1 = bf16[52,512,256]{2,1,0} transpose(bf16[512,256,52]{2,1,0} %convert.1373.3), dimensions={2,0,1}, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/LayerNorm_0/convert_element_type[new_dtype=bfloat16 weak_type=False]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
}

%fused_transpose.23 (param_0.682: f32[256], param_1.638: f32[256], param_2.325: f32[1,512,52], param_3.172: f32[512,256,52], param_4.64: f32[512,52]) -> bf16[52,512,256] {
  %param_3.172 = f32[512,256,52]{2,1,0} parameter(3)
  %param_4.64 = f32[512,52]{1,0} parameter(4)
  %broadcast.555.7 = f32[512,256,52]{2,1,0} broadcast(f32[512,52]{1,0} %param_4.64), dimensions={0,2}, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/LayerNorm_1/sub" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
  %subtract.34.7 = f32[512,256,52]{2,1,0} subtract(f32[512,256,52]{2,1,0} %param_3.172, f32[512,256,52]{2,1,0} %broadcast.555.7), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/LayerNorm_1/sub" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
  %param_2.325 = f32[1,512,52]{2,1,0} parameter(2)
  %bitcast.4958.21 = f32[512,52]{1,0} bitcast(f32[1,512,52]{2,1,0} %param_2.325)
  %broadcast.556.21 = f32[512,256,52]{2,1,0} broadcast(f32[512,52]{1,0} %bitcast.4958.21), dimensions={0,2}, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/LayerNorm_1/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
  %param_1.638 = f32[256]{0} parameter(1)
  %broadcast.557.18 = f32[512,256,52]{2,1,0} broadcast(f32[256]{0} %param_1.638), dimensions={1}, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/LayerNorm_1/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
  %multiply.342.15 = f32[512,256,52]{2,1,0} multiply(f32[512,256,52]{2,1,0} %broadcast.556.21, f32[512,256,52]{2,1,0} %broadcast.557.18), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/LayerNorm_1/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
  %multiply.343.7 = f32[512,256,52]{2,1,0} multiply(f32[512,256,52]{2,1,0} %subtract.34.7, f32[512,256,52]{2,1,0} %multiply.342.15), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/LayerNorm_1/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
  %param_0.682 = f32[256]{0} parameter(0)
  %broadcast.558.3 = f32[512,256,52]{2,1,0} broadcast(f32[256]{0} %param_0.682), dimensions={1}, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/LayerNorm_1/add" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
  %add.220.5 = f32[512,256,52]{2,1,0} add(f32[512,256,52]{2,1,0} %multiply.343.7, f32[512,256,52]{2,1,0} %broadcast.558.3), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/LayerNorm_1/add" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
  %convert.1404.3 = bf16[512,256,52]{2,1,0} convert(f32[512,256,52]{2,1,0} %add.220.5), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/LayerNorm_1/convert_element_type[new_dtype=bfloat16 weak_type=False]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
  ROOT %transpose.1196.1 = bf16[52,512,256]{2,1,0} transpose(bf16[512,256,52]{2,1,0} %convert.1404.3), dimensions={2,0,1}, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/LayerNorm_1/convert_element_type[new_dtype=bfloat16 weak_type=False]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
}

%region_26.806.clone.8 (Arg_0.11.0: f32[], Arg_1.11.0: f32[]) -> f32[] {
  %Arg_1.11.0 = f32[] parameter(1)
  %Arg_0.11.0 = f32[] parameter(0)
  ROOT %add.174.0 = f32[] add(f32[] %Arg_0.11.0, f32[] %Arg_1.11.0), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/vmap(vmap(LazyInMLP_0))/Dense_0/reduce_sum[axes=(0, 1)]" source_file="/home/nicholas/programs/avid/avid/layers.py" source_line=49}
}

%fused_reduce_transpose.2 (param_0.778: bf16[416,512,32]) -> (bf16[52,512,8,32], f32[52,8,32], bf16[8,32,52,512]) {
  %param_0.778 = bf16[416,512,32]{2,1,0} parameter(0)
  %bitcast.5828.11 = bf16[52,8,512,32]{3,2,1,0} bitcast(bf16[416,512,32]{2,1,0} %param_0.778)
  %convert.1456.11 = f32[52,8,512,32]{3,2,1,0} convert(bf16[52,8,512,32]{3,2,1,0} %bitcast.5828.11)
  %constant_38_3 = bf16[] constant(0.1768)
  %convert.1526.1 = f32[] convert(bf16[] %constant_38_3)
  %broadcast.608.20 = f32[52,8,512,32]{3,2,1,0} broadcast(f32[] %convert.1526.1), dimensions={}
  %multiply.420.9 = f32[52,8,512,32]{3,2,1,0} multiply(f32[52,8,512,32]{3,2,1,0} %convert.1456.11, f32[52,8,512,32]{3,2,1,0} %broadcast.608.20), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/MultiHeadDotProductAttention_0/div" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %convert.1458.5 = bf16[52,8,512,32]{3,2,1,0} convert(f32[52,8,512,32]{3,2,1,0} %multiply.420.9)
  %transpose.1217.1 = bf16[52,512,8,32]{3,2,1,0} transpose(bf16[52,8,512,32]{3,2,1,0} %convert.1458.5), dimensions={0,2,1,3}, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/MultiHeadDotProductAttention_0/div" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %constant_60_11_clone_1 = bf16[] constant(0)
  %convert.1433.9.clone.1 = f32[] convert(bf16[] %constant_60_11_clone_1)
  %reduce.55.1.clone.1 = f32[52,8,32]{2,1,0} reduce(f32[52,8,512,32]{3,2,1,0} %multiply.420.9, f32[] %convert.1433.9.clone.1), dimensions={2}, to_apply=%region_26.806.clone.8, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/MultiHeadDotProductAttention_0/query/reduce_sum[axes=(0, 1)]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %transpose.1222.1.clone.1 = bf16[8,32,52,512]{3,2,1,0} transpose(bf16[52,8,512,32]{3,2,1,0} %convert.1458.5), dimensions={1,3,0,2}, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/MultiHeadDotProductAttention_0/div" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  ROOT %tuple.27 = (bf16[52,512,8,32]{3,2,1,0}, f32[52,8,32]{2,1,0}, bf16[8,32,52,512]{3,2,1,0}) tuple(bf16[52,512,8,32]{3,2,1,0} %transpose.1217.1, f32[52,8,32]{2,1,0} %reduce.55.1.clone.1, bf16[8,32,52,512]{3,2,1,0} %transpose.1222.1.clone.1)
}

%region_26.806.clone.18 (Arg_0.21.0: f32[], Arg_1.21.0: f32[]) -> f32[] {
  %Arg_1.21.0 = f32[] parameter(1)
  %Arg_0.21.0 = f32[] parameter(0)
  ROOT %add.178.0 = f32[] add(f32[] %Arg_0.21.0, f32[] %Arg_1.21.0), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/vmap(vmap(LazyInMLP_0))/Dense_0/reduce_sum[axes=(0, 1)]" source_file="/home/nicholas/programs/avid/avid/layers.py" source_line=49}
}

%fused_reduce_transpose.3 (param_0.781: bf16[416,512,32]) -> (bf16[52,512,8,32], f32[52,8,32], bf16[8,32,52,512]) {
  %param_0.781 = bf16[416,512,32]{2,1,0} parameter(0)
  %bitcast.5480.11 = bf16[52,8,512,32]{3,2,1,0} bitcast(bf16[416,512,32]{2,1,0} %param_0.781)
  %convert.1438.11 = f32[52,8,512,32]{3,2,1,0} convert(bf16[52,8,512,32]{3,2,1,0} %bitcast.5480.11)
  %constant_38_6 = bf16[] constant(0.1768)
  %convert.1526.4 = f32[] convert(bf16[] %constant_38_6)
  %broadcast.608.24 = f32[52,8,512,32]{3,2,1,0} broadcast(f32[] %convert.1526.4), dimensions={}
  %multiply.391.9 = f32[52,8,512,32]{3,2,1,0} multiply(f32[52,8,512,32]{3,2,1,0} %convert.1438.11, f32[52,8,512,32]{3,2,1,0} %broadcast.608.24), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/MultiHeadDotProductAttention_0/div" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %convert.1440.5 = bf16[52,8,512,32]{3,2,1,0} convert(f32[52,8,512,32]{3,2,1,0} %multiply.391.9)
  %transpose.1207.1 = bf16[52,512,8,32]{3,2,1,0} transpose(bf16[52,8,512,32]{3,2,1,0} %convert.1440.5), dimensions={0,2,1,3}, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/MultiHeadDotProductAttention_0/div" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %constant_60_21_clone_1 = bf16[] constant(0)
  %convert.1433.19.clone.1 = f32[] convert(bf16[] %constant_60_21_clone_1)
  %reduce.59.1.clone.1 = f32[52,8,32]{2,1,0} reduce(f32[52,8,512,32]{3,2,1,0} %multiply.391.9, f32[] %convert.1433.19.clone.1), dimensions={2}, to_apply=%region_26.806.clone.18, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/MultiHeadDotProductAttention_0/query/reduce_sum[axes=(0, 1)]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %transpose.1227.1.clone.1 = bf16[8,32,52,512]{3,2,1,0} transpose(bf16[52,8,512,32]{3,2,1,0} %convert.1440.5), dimensions={1,3,0,2}, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/MultiHeadDotProductAttention_0/div" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  ROOT %tuple.39 = (bf16[52,512,8,32]{3,2,1,0}, f32[52,8,32]{2,1,0}, bf16[8,32,52,512]{3,2,1,0}) tuple(bf16[52,512,8,32]{3,2,1,0} %transpose.1207.1, f32[52,8,32]{2,1,0} %reduce.59.1.clone.1, bf16[8,32,52,512]{3,2,1,0} %transpose.1227.1.clone.1)
}

%fused_transpose.24 (param_0.749: f32[512,256,52]) -> bf16[256,52,512] {
  %param_0.749 = f32[512,256,52]{2,1,0} parameter(0)
  %convert.1504.1 = bf16[512,256,52]{2,1,0} convert(f32[512,256,52]{2,1,0} %param_0.749)
  ROOT %transpose.1229.1 = bf16[256,52,512]{2,1,0} transpose(bf16[512,256,52]{2,1,0} %convert.1504.1), dimensions={1,2,0}, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/LayerNorm_0/add_any" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
}

%fused_add_transpose (param_0.1264: f32[512,52], param_1.1344: f32[512,52], param_2.817: bf16[512,256], param_3.526: bf16[512,256,52], param_4.326: f32[512,256,52], param_5.247: f32[512,256,52], param_6.230: f32[256], param_7.185: f32[1,512,52]) -> (bf16[52,512,256], f32[512,256,52]) {
  %param_4.326 = f32[512,256,52]{2,1,0} parameter(4)
  %param_5.247 = f32[512,256,52]{2,1,0} parameter(5)
  %param_7.185 = f32[1,512,52]{2,1,0} parameter(7)
  %bitcast.4483.19.clone.1 = f32[512,52]{1,0} bitcast(f32[1,512,52]{2,1,0} %param_7.185)
  %broadcast.525.19.clone.1 = f32[512,256,52]{2,1,0} broadcast(f32[512,52]{1,0} %bitcast.4483.19.clone.1), dimensions={0,2}, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/LayerNorm_0/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
  %param_6.230 = f32[256]{0} parameter(6)
  %broadcast.526.16.clone.1 = f32[512,256,52]{2,1,0} broadcast(f32[256]{0} %param_6.230), dimensions={1}, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/LayerNorm_0/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
  %multiply.320.13.clone.1 = f32[512,256,52]{2,1,0} multiply(f32[512,256,52]{2,1,0} %broadcast.525.19.clone.1, f32[512,256,52]{2,1,0} %broadcast.526.16.clone.1), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/LayerNorm_0/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
  %multiply.427.5.clone.1 = f32[512,256,52]{2,1,0} multiply(f32[512,256,52]{2,1,0} %param_5.247, f32[512,256,52]{2,1,0} %multiply.320.13.clone.1), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/LayerNorm_0/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
  %add.249.1.clone.1 = f32[512,256,52]{2,1,0} add(f32[512,256,52]{2,1,0} %param_4.326, f32[512,256,52]{2,1,0} %multiply.427.5.clone.1), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/LayerNorm_0/add_any" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
  %param_3.526 = bf16[512,256,52]{2,1,0} parameter(3)
  %convert.1332.7.clone.1 = f32[512,256,52]{2,1,0} convert(bf16[512,256,52]{2,1,0} %param_3.526)
  %param_2.817 = bf16[512,256]{1,0} parameter(2)
  %convert.1523.4.clone.1 = f32[512,256]{1,0} convert(bf16[512,256]{1,0} %param_2.817)
  %broadcast.602.7.clone.1 = f32[512,256,52]{2,1,0} broadcast(f32[512,256]{1,0} %convert.1523.4.clone.1), dimensions={0,1}, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/im_embed/vmap(inner)/pos_embed/add" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=64}
  %add.199.7.clone.1 = f32[512,256,52]{2,1,0} add(f32[512,256,52]{2,1,0} %convert.1332.7.clone.1, f32[512,256,52]{2,1,0} %broadcast.602.7.clone.1), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/im_embed/vmap(inner)/pos_embed/add" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=64}
  %param_1.1344 = f32[512,52]{1,0} parameter(1)
  %broadcast.589.1.clone.1 = f32[512,256,52]{2,1,0} broadcast(f32[512,52]{1,0} %param_1.1344), dimensions={0,2}, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/LayerNorm_0/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
  %multiply.435.1.clone.1 = f32[512,256,52]{2,1,0} multiply(f32[512,256,52]{2,1,0} %add.199.7.clone.1, f32[512,256,52]{2,1,0} %broadcast.589.1.clone.1), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/LayerNorm_0/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
  %param_0.1264 = f32[512,52]{1,0} parameter(0)
  %broadcast.591.1.clone.1 = f32[512,256,52]{2,1,0} broadcast(f32[512,52]{1,0} %param_0.1264), dimensions={0,2}, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/LayerNorm_0/broadcast_in_dim[shape=(52, 512, 256) broadcast_dimensions=(0, 1)]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
  %add.252.1.clone.1 = f32[512,256,52]{2,1,0} add(f32[512,256,52]{2,1,0} %multiply.435.1.clone.1, f32[512,256,52]{2,1,0} %broadcast.591.1.clone.1), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/LayerNorm_0/add_any" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
  %add.253.1.clone.1 = f32[512,256,52]{2,1,0} add(f32[512,256,52]{2,1,0} %add.249.1.clone.1, f32[512,256,52]{2,1,0} %add.252.1.clone.1), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/LayerNorm_0/add_any" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
  %convert.1504.2 = bf16[512,256,52]{2,1,0} convert(f32[512,256,52]{2,1,0} %add.253.1.clone.1)
  %transpose.1230.1 = bf16[52,512,256]{2,1,0} transpose(bf16[512,256,52]{2,1,0} %convert.1504.2), dimensions={2,0,1}, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/LayerNorm_0/add_any" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
  ROOT %tuple.20 = (bf16[52,512,256]{2,1,0}, f32[512,256,52]{2,1,0}) tuple(bf16[52,512,256]{2,1,0} %transpose.1230.1, f32[512,256,52]{2,1,0} %add.253.1.clone.1)
}

%fused_transpose.25 (param_0.753: f32[512,256,52]) -> bf16[256,52,512] {
  %param_0.753 = f32[512,256,52]{2,1,0} parameter(0)
  %convert.1444.1 = bf16[512,256,52]{2,1,0} convert(f32[512,256,52]{2,1,0} %param_0.753)
  ROOT %transpose.1221.1 = bf16[256,52,512]{2,1,0} transpose(bf16[512,256,52]{2,1,0} %convert.1444.1), dimensions={1,2,0}, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=167}
}

%fused_add_transpose.1 (param_0.1266: f32[512,52], param_1.1360: f32[512,256,52], param_2.831: f32[512,52], param_3.534: f32[512,256,52], param_4.337: f32[512,256,52], param_5.258: f32[256], param_6.238: f32[1,512,52]) -> (bf16[52,512,256], f32[512,256,52]) {
  %param_3.534 = f32[512,256,52]{2,1,0} parameter(3)
  %param_4.337 = f32[512,256,52]{2,1,0} parameter(4)
  %param_6.238 = f32[1,512,52]{2,1,0} parameter(6)
  %bitcast.4678.19.clone.1 = f32[512,52]{1,0} bitcast(f32[1,512,52]{2,1,0} %param_6.238)
  %broadcast.537.19.clone.1 = f32[512,256,52]{2,1,0} broadcast(f32[512,52]{1,0} %bitcast.4678.19.clone.1), dimensions={0,2}, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/LayerNorm_1/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
  %param_5.258 = f32[256]{0} parameter(5)
  %broadcast.539.16.clone.1 = f32[512,256,52]{2,1,0} broadcast(f32[256]{0} %param_5.258), dimensions={1}, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/LayerNorm_1/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
  %multiply.328.13.clone.1 = f32[512,256,52]{2,1,0} multiply(f32[512,256,52]{2,1,0} %broadcast.537.19.clone.1, f32[512,256,52]{2,1,0} %broadcast.539.16.clone.1), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/LayerNorm_1/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
  %multiply.403.5.clone.1 = f32[512,256,52]{2,1,0} multiply(f32[512,256,52]{2,1,0} %param_4.337, f32[512,256,52]{2,1,0} %multiply.328.13.clone.1), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/LayerNorm_1/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
  %add.242.1.clone.1 = f32[512,256,52]{2,1,0} add(f32[512,256,52]{2,1,0} %param_3.534, f32[512,256,52]{2,1,0} %multiply.403.5.clone.1), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/LayerNorm_1/add_any" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
  %param_1.1360 = f32[512,256,52]{2,1,0} parameter(1)
  %param_2.831 = f32[512,52]{1,0} parameter(2)
  %broadcast.585.1.clone.1 = f32[512,256,52]{2,1,0} broadcast(f32[512,52]{1,0} %param_2.831), dimensions={0,2}, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/LayerNorm_1/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
  %multiply.410.1.clone.1 = f32[512,256,52]{2,1,0} multiply(f32[512,256,52]{2,1,0} %param_1.1360, f32[512,256,52]{2,1,0} %broadcast.585.1.clone.1), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/LayerNorm_1/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
  %param_0.1266 = f32[512,52]{1,0} parameter(0)
  %broadcast.586.1.clone.1 = f32[512,256,52]{2,1,0} broadcast(f32[512,52]{1,0} %param_0.1266), dimensions={0,2}, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/LayerNorm_1/broadcast_in_dim[shape=(52, 512, 256) broadcast_dimensions=(0, 1)]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
  %add.245.1.clone.1 = f32[512,256,52]{2,1,0} add(f32[512,256,52]{2,1,0} %multiply.410.1.clone.1, f32[512,256,52]{2,1,0} %broadcast.586.1.clone.1), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/LayerNorm_1/add_any" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
  %add.246.1.clone.1 = f32[512,256,52]{2,1,0} add(f32[512,256,52]{2,1,0} %add.242.1.clone.1, f32[512,256,52]{2,1,0} %add.245.1.clone.1), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/LayerNorm_1/add_any" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
  %convert.1444.2 = bf16[512,256,52]{2,1,0} convert(f32[512,256,52]{2,1,0} %add.246.1.clone.1)
  %transpose.1211.1 = bf16[52,512,256]{2,1,0} transpose(bf16[512,256,52]{2,1,0} %convert.1444.2), dimensions={2,0,1}, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/LayerNorm_1/add_any" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
  ROOT %tuple.29 = (bf16[52,512,256]{2,1,0}, f32[512,256,52]{2,1,0}) tuple(bf16[52,512,256]{2,1,0} %transpose.1211.1, f32[512,256,52]{2,1,0} %add.246.1.clone.1)
}

%fused_transpose.26 (param_0.757: f32[512,256,52]) -> bf16[256,52,512] {
  %param_0.757 = f32[512,256,52]{2,1,0} parameter(0)
  %convert.1442.1 = bf16[512,256,52]{2,1,0} convert(f32[512,256,52]{2,1,0} %param_0.757)
  ROOT %transpose.1219.1 = bf16[256,52,512]{2,1,0} transpose(bf16[512,256,52]{2,1,0} %convert.1442.1), dimensions={1,2,0}, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=183}
}

%fused_add_transpose.2 (param_0.1268: f32[512,52], param_1.1364: f32[512,256,52], param_2.835: f32[512,52], param_3.537: f32[512,256,52], param_4.348: f32[512,256,52], param_5.267: f32[256], param_6.246: f32[1,512,52]) -> (bf16[52,512,256], f32[512,256,52]) {
  %param_3.537 = f32[512,256,52]{2,1,0} parameter(3)
  %param_4.348 = f32[512,256,52]{2,1,0} parameter(4)
  %param_6.246 = f32[1,512,52]{2,1,0} parameter(6)
  %bitcast.4762.19.clone.1 = f32[512,52]{1,0} bitcast(f32[1,512,52]{2,1,0} %param_6.246)
  %broadcast.546.19.clone.1 = f32[512,256,52]{2,1,0} broadcast(f32[512,52]{1,0} %bitcast.4762.19.clone.1), dimensions={0,2}, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/LayerNorm_0/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
  %param_5.267 = f32[256]{0} parameter(5)
  %broadcast.547.16.clone.1 = f32[512,256,52]{2,1,0} broadcast(f32[256]{0} %param_5.267), dimensions={1}, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/LayerNorm_0/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
  %multiply.335.13.clone.1 = f32[512,256,52]{2,1,0} multiply(f32[512,256,52]{2,1,0} %broadcast.546.19.clone.1, f32[512,256,52]{2,1,0} %broadcast.547.16.clone.1), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/LayerNorm_0/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
  %multiply.392.5.clone.1 = f32[512,256,52]{2,1,0} multiply(f32[512,256,52]{2,1,0} %param_4.348, f32[512,256,52]{2,1,0} %multiply.335.13.clone.1), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/LayerNorm_0/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
  %add.238.1.clone.1 = f32[512,256,52]{2,1,0} add(f32[512,256,52]{2,1,0} %param_3.537, f32[512,256,52]{2,1,0} %multiply.392.5.clone.1), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/LayerNorm_0/add_any" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
  %param_1.1364 = f32[512,256,52]{2,1,0} parameter(1)
  %param_2.835 = f32[512,52]{1,0} parameter(2)
  %broadcast.582.1.clone.1 = f32[512,256,52]{2,1,0} broadcast(f32[512,52]{1,0} %param_2.835), dimensions={0,2}, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/LayerNorm_0/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
  %multiply.399.1.clone.1 = f32[512,256,52]{2,1,0} multiply(f32[512,256,52]{2,1,0} %param_1.1364, f32[512,256,52]{2,1,0} %broadcast.582.1.clone.1), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/LayerNorm_0/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
  %param_0.1268 = f32[512,52]{1,0} parameter(0)
  %broadcast.584.1.clone.1 = f32[512,256,52]{2,1,0} broadcast(f32[512,52]{1,0} %param_0.1268), dimensions={0,2}, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/LayerNorm_0/broadcast_in_dim[shape=(52, 512, 256) broadcast_dimensions=(0, 1)]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
  %add.240.1.clone.1 = f32[512,256,52]{2,1,0} add(f32[512,256,52]{2,1,0} %multiply.399.1.clone.1, f32[512,256,52]{2,1,0} %broadcast.584.1.clone.1), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/LayerNorm_0/add_any" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
  %add.241.1.clone.1 = f32[512,256,52]{2,1,0} add(f32[512,256,52]{2,1,0} %add.238.1.clone.1, f32[512,256,52]{2,1,0} %add.240.1.clone.1), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/LayerNorm_0/add_any" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
  %convert.1442.2 = bf16[512,256,52]{2,1,0} convert(f32[512,256,52]{2,1,0} %add.241.1.clone.1)
  %transpose.1209.1 = bf16[52,512,256]{2,1,0} transpose(bf16[512,256,52]{2,1,0} %convert.1442.2), dimensions={2,0,1}, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/LayerNorm_0/add_any" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
  ROOT %tuple.32 = (bf16[52,512,256]{2,1,0}, f32[512,256,52]{2,1,0}) tuple(bf16[52,512,256]{2,1,0} %transpose.1209.1, f32[512,256,52]{2,1,0} %add.241.1.clone.1)
}

%fused_transpose.27 (param_0.761: f32[512,256,52]) -> bf16[256,52,512] {
  %param_0.761 = f32[512,256,52]{2,1,0} parameter(0)
  %convert.1426.1 = bf16[512,256,52]{2,1,0} convert(f32[512,256,52]{2,1,0} %param_0.761)
  ROOT %transpose.1226.1 = bf16[256,52,512]{2,1,0} transpose(bf16[512,256,52]{2,1,0} %convert.1426.1), dimensions={1,2,0}, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=167}
}

%fused_add_transpose.3 (param_0.1270: f32[512,52], param_1.1380: f32[512,256,52], param_2.849: f32[512,52], param_3.540: f32[512,256,52], param_4.359: f32[512,256,52], param_5.276: f32[256], param_6.254: f32[1,512,52]) -> (bf16[52,512,256], f32[512,256,52]) {
  %param_3.540 = f32[512,256,52]{2,1,0} parameter(3)
  %param_4.359 = f32[512,256,52]{2,1,0} parameter(4)
  %param_6.254 = f32[1,512,52]{2,1,0} parameter(6)
  %bitcast.4958.19.clone.1 = f32[512,52]{1,0} bitcast(f32[1,512,52]{2,1,0} %param_6.254)
  %broadcast.556.19.clone.1 = f32[512,256,52]{2,1,0} broadcast(f32[512,52]{1,0} %bitcast.4958.19.clone.1), dimensions={0,2}, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/LayerNorm_1/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
  %param_5.276 = f32[256]{0} parameter(5)
  %broadcast.557.16.clone.1 = f32[512,256,52]{2,1,0} broadcast(f32[256]{0} %param_5.276), dimensions={1}, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/LayerNorm_1/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
  %multiply.342.13.clone.1 = f32[512,256,52]{2,1,0} multiply(f32[512,256,52]{2,1,0} %broadcast.556.19.clone.1, f32[512,256,52]{2,1,0} %broadcast.557.16.clone.1), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/LayerNorm_1/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
  %multiply.375.5.clone.1 = f32[512,256,52]{2,1,0} multiply(f32[512,256,52]{2,1,0} %param_4.359, f32[512,256,52]{2,1,0} %multiply.342.13.clone.1), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/LayerNorm_1/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
  %add.231.1.clone.1 = f32[512,256,52]{2,1,0} add(f32[512,256,52]{2,1,0} %param_3.540, f32[512,256,52]{2,1,0} %multiply.375.5.clone.1), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/LayerNorm_1/add_any" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
  %param_1.1380 = f32[512,256,52]{2,1,0} parameter(1)
  %param_2.849 = f32[512,52]{1,0} parameter(2)
  %broadcast.576.1.clone.1 = f32[512,256,52]{2,1,0} broadcast(f32[512,52]{1,0} %param_2.849), dimensions={0,2}, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/LayerNorm_1/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
  %multiply.382.1.clone.1 = f32[512,256,52]{2,1,0} multiply(f32[512,256,52]{2,1,0} %param_1.1380, f32[512,256,52]{2,1,0} %broadcast.576.1.clone.1), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/LayerNorm_1/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
  %param_0.1270 = f32[512,52]{1,0} parameter(0)
  %broadcast.577.1.clone.1 = f32[512,256,52]{2,1,0} broadcast(f32[512,52]{1,0} %param_0.1270), dimensions={0,2}, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/LayerNorm_1/broadcast_in_dim[shape=(52, 512, 256) broadcast_dimensions=(0, 1)]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
  %add.233.1.clone.1 = f32[512,256,52]{2,1,0} add(f32[512,256,52]{2,1,0} %multiply.382.1.clone.1, f32[512,256,52]{2,1,0} %broadcast.577.1.clone.1), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/LayerNorm_1/add_any" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
  %add.234.1.clone.1 = f32[512,256,52]{2,1,0} add(f32[512,256,52]{2,1,0} %add.231.1.clone.1, f32[512,256,52]{2,1,0} %add.233.1.clone.1), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/LayerNorm_1/add_any" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
  %convert.1426.2 = bf16[512,256,52]{2,1,0} convert(f32[512,256,52]{2,1,0} %add.234.1.clone.1)
  %transpose.1200.1 = bf16[52,512,256]{2,1,0} transpose(bf16[512,256,52]{2,1,0} %convert.1426.2), dimensions={2,0,1}, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/LayerNorm_1/add_any" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
  ROOT %tuple.41 = (bf16[52,512,256]{2,1,0}, f32[512,256,52]{2,1,0}) tuple(bf16[52,512,256]{2,1,0} %transpose.1200.1, f32[512,256,52]{2,1,0} %add.234.1.clone.1)
}

%fused_transpose.28 (param_0.765: f32[512,256,52]) -> bf16[256,52,512] {
  %param_0.765 = f32[512,256,52]{2,1,0} parameter(0)
  %convert.1424.1 = bf16[512,256,52]{2,1,0} convert(f32[512,256,52]{2,1,0} %param_0.765)
  ROOT %transpose.1224.1 = bf16[256,52,512]{2,1,0} transpose(bf16[512,256,52]{2,1,0} %convert.1424.1), dimensions={1,2,0}, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=183}
}

%fused_add_transpose.4 (param_0.1272: f32[512,52], param_1.1384: f32[512,256,52], param_2.853: f32[512,52], param_3.544: f32[256], param_4.372: f32[1,512,52], param_5.287: f32[256,52]) -> (bf16[52,512,256], f32[512,256,52]) {
  %param_5.287 = f32[256,52]{1,0} parameter(5)
  %broadcast.569.5.clone.1 = f32[512,256,52]{2,1,0} broadcast(f32[256,52]{1,0} %param_5.287), dimensions={1,2}, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/transpose[permutation=(0, 2, 1)]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=250}
  %param_4.372 = f32[1,512,52]{2,1,0} parameter(4)
  %bitcast.5042.11.clone.1 = f32[512,52]{1,0} bitcast(f32[1,512,52]{2,1,0} %param_4.372)
  %broadcast.561.11.clone.1 = f32[512,256,52]{2,1,0} broadcast(f32[512,52]{1,0} %bitcast.5042.11.clone.1), dimensions={0,2}, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoder_norm/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=228}
  %param_3.544 = f32[256]{0} parameter(3)
  %broadcast.562.8.clone.1 = f32[512,256,52]{2,1,0} broadcast(f32[256]{0} %param_3.544), dimensions={1}, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoder_norm/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=228}
  %multiply.349.7.clone.1 = f32[512,256,52]{2,1,0} multiply(f32[512,256,52]{2,1,0} %broadcast.561.11.clone.1, f32[512,256,52]{2,1,0} %broadcast.562.8.clone.1), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoder_norm/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=228}
  %multiply.364.3.clone.1 = f32[512,256,52]{2,1,0} multiply(f32[512,256,52]{2,1,0} %broadcast.569.5.clone.1, f32[512,256,52]{2,1,0} %multiply.349.7.clone.1), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoder_norm/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=228}
  %param_1.1384 = f32[512,256,52]{2,1,0} parameter(1)
  %param_2.853 = f32[512,52]{1,0} parameter(2)
  %broadcast.574.1.clone.1 = f32[512,256,52]{2,1,0} broadcast(f32[512,52]{1,0} %param_2.853), dimensions={0,2}, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoder_norm/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=228}
  %multiply.371.1.clone.1 = f32[512,256,52]{2,1,0} multiply(f32[512,256,52]{2,1,0} %param_1.1384, f32[512,256,52]{2,1,0} %broadcast.574.1.clone.1), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoder_norm/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=228}
  %param_0.1272 = f32[512,52]{1,0} parameter(0)
  %broadcast.575.1.clone.1 = f32[512,256,52]{2,1,0} broadcast(f32[512,52]{1,0} %param_0.1272), dimensions={0,2}, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoder_norm/broadcast_in_dim[shape=(52, 512, 256) broadcast_dimensions=(0, 1)]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=228}
  %add.229.1.clone.1 = f32[512,256,52]{2,1,0} add(f32[512,256,52]{2,1,0} %multiply.371.1.clone.1, f32[512,256,52]{2,1,0} %broadcast.575.1.clone.1), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoder_norm/add_any" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=228}
  %add.230.1.clone.1 = f32[512,256,52]{2,1,0} add(f32[512,256,52]{2,1,0} %multiply.364.3.clone.1, f32[512,256,52]{2,1,0} %add.229.1.clone.1), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoder_norm/add_any" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=228}
  %convert.1424.2 = bf16[512,256,52]{2,1,0} convert(f32[512,256,52]{2,1,0} %add.230.1.clone.1)
  %transpose.1198.1 = bf16[52,512,256]{2,1,0} transpose(bf16[512,256,52]{2,1,0} %convert.1424.2), dimensions={2,0,1}, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoder_norm/add_any" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=228}
  ROOT %tuple.44 = (bf16[52,512,256]{2,1,0}, f32[512,256,52]{2,1,0}) tuple(bf16[52,512,256]{2,1,0} %transpose.1198.1, f32[512,256,52]{2,1,0} %add.230.1.clone.1)
}

%fused_transpose.29 (param_0.772: f32[8,32], param_1.708: bf16[26624,256]) -> bf16[52,8,512,32] {
  %param_1.708 = bf16[26624,256]{1,0} parameter(1)
  %bitcast.4554.5 = bf16[52,512,8,32]{3,2,1,0} bitcast(bf16[26624,256]{1,0} %param_1.708)
  %transpose.1184.5 = bf16[52,8,32,512]{3,2,1,0} transpose(bf16[52,512,8,32]{3,2,1,0} %bitcast.4554.5), dimensions={0,2,3,1}, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/MultiHeadDotProductAttention_0/key/dot_general[dimension_numbers=(((2,), (0,)), ((), ())) precision=None preferred_element_type=None]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %convert.1348.3 = f32[52,8,32,512]{3,2,1,0} convert(bf16[52,8,32,512]{3,2,1,0} %transpose.1184.5)
  %param_0.772 = f32[8,32]{1,0} parameter(0)
  %broadcast.609.5 = f32[52,8,32,512]{3,2,1,0} broadcast(f32[8,32]{1,0} %param_0.772), dimensions={1,2}, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/MultiHeadDotProductAttention_0/key/add" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %add.204.5 = f32[52,8,32,512]{3,2,1,0} add(f32[52,8,32,512]{3,2,1,0} %convert.1348.3, f32[52,8,32,512]{3,2,1,0} %broadcast.609.5), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/MultiHeadDotProductAttention_0/key/add" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %convert.1351.3 = bf16[52,8,32,512]{3,2,1,0} convert(f32[52,8,32,512]{3,2,1,0} %add.204.5)
  ROOT %transpose.1216.1 = bf16[52,8,512,32]{3,2,1,0} transpose(bf16[52,8,32,512]{3,2,1,0} %convert.1351.3), dimensions={0,1,3,2}, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/MultiHeadDotProductAttention_0/key/add" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
}

%fused_transpose.30 (param_0.777: f32[8,32], param_1.714: bf16[26624,256]) -> bf16[52,8,512,32] {
  %param_1.714 = bf16[26624,256]{1,0} parameter(1)
  %bitcast.4833.5 = bf16[52,512,8,32]{3,2,1,0} bitcast(bf16[26624,256]{1,0} %param_1.714)
  %transpose.1193.5 = bf16[52,8,32,512]{3,2,1,0} transpose(bf16[52,512,8,32]{3,2,1,0} %bitcast.4833.5), dimensions={0,2,3,1}, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/MultiHeadDotProductAttention_0/key/dot_general[dimension_numbers=(((2,), (0,)), ((), ())) precision=None preferred_element_type=None]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %convert.1386.3 = f32[52,8,32,512]{3,2,1,0} convert(bf16[52,8,32,512]{3,2,1,0} %transpose.1193.5)
  %param_0.777 = f32[8,32]{1,0} parameter(0)
  %broadcast.619.5 = f32[52,8,32,512]{3,2,1,0} broadcast(f32[8,32]{1,0} %param_0.777), dimensions={1,2}, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/MultiHeadDotProductAttention_0/key/add" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %add.216.5 = f32[52,8,32,512]{3,2,1,0} add(f32[52,8,32,512]{3,2,1,0} %convert.1386.3, f32[52,8,32,512]{3,2,1,0} %broadcast.619.5), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/MultiHeadDotProductAttention_0/key/add" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %convert.1389.3 = bf16[52,8,32,512]{3,2,1,0} convert(f32[52,8,32,512]{3,2,1,0} %add.216.5)
  ROOT %transpose.1206.1 = bf16[52,8,512,32]{3,2,1,0} transpose(bf16[52,8,32,512]{3,2,1,0} %convert.1389.3), dimensions={0,1,3,2}, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/MultiHeadDotProductAttention_0/key/add" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
}

%region_26.806.clone (Arg_0.3.0: f32[], Arg_1.3.0: f32[]) -> f32[] {
  %Arg_1.3.0 = f32[] parameter(1)
  %Arg_0.3.0 = f32[] parameter(0)
  ROOT %add.167.0 = f32[] add(f32[] %Arg_0.3.0, f32[] %Arg_1.3.0), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/vmap(vmap(LazyInMLP_0))/Dense_0/reduce_sum[axes=(0, 1)]" source_file="/home/nicholas/programs/avid/avid/layers.py" source_line=49}
}

%fused_reduce.26 (param_0.858: f32[52,8,512], param_1.847: bf16[416,512,512], param_2.414: f32[52,8,512], param_3.210: bf16[416,512,512]) -> f32[52,8,512] {
  %param_3.210 = bf16[416,512,512]{2,1,0} parameter(3)
  %bitcast.5410.17 = bf16[52,8,512,512]{3,2,1,0} bitcast(bf16[416,512,512]{2,1,0} %param_3.210)
  %convert.1427.17 = f32[52,8,512,512]{3,2,1,0} convert(bf16[52,8,512,512]{3,2,1,0} %bitcast.5410.17)
  %param_2.414 = f32[52,8,512]{2,1,0} parameter(2)
  %broadcast.637.3 = f32[52,8,512,512]{3,2,1,0} broadcast(f32[52,8,512]{2,1,0} %param_2.414), dimensions={0,1,2}, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/MultiHeadDotProductAttention_0/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %multiply.388.7 = f32[52,8,512,512]{3,2,1,0} multiply(f32[52,8,512,512]{3,2,1,0} %convert.1427.17, f32[52,8,512,512]{3,2,1,0} %broadcast.637.3), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/MultiHeadDotProductAttention_0/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %param_1.847 = bf16[416,512,512]{2,1,0} parameter(1)
  %bitcast.4848.17 = bf16[52,8,512,512]{3,2,1,0} bitcast(bf16[416,512,512]{2,1,0} %param_1.847)
  %convert.1390.17 = f32[52,8,512,512]{3,2,1,0} convert(bf16[52,8,512,512]{3,2,1,0} %bitcast.4848.17)
  %param_0.858 = f32[52,8,512]{2,1,0} parameter(0)
  %broadcast.621.11 = f32[52,8,512,512]{3,2,1,0} broadcast(f32[52,8,512]{2,1,0} %param_0.858), dimensions={0,1,2}, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/MultiHeadDotProductAttention_0/sub" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %subtract.33.13 = f32[52,8,512,512]{3,2,1,0} subtract(f32[52,8,512,512]{3,2,1,0} %convert.1390.17, f32[52,8,512,512]{3,2,1,0} %broadcast.621.11), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/MultiHeadDotProductAttention_0/sub" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %exponential.5.11 = f32[52,8,512,512]{3,2,1,0} exponential(f32[52,8,512,512]{3,2,1,0} %subtract.33.13), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/MultiHeadDotProductAttention_0/exp" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %multiply.389.5 = f32[52,8,512,512]{3,2,1,0} multiply(f32[52,8,512,512]{3,2,1,0} %multiply.388.7, f32[52,8,512,512]{3,2,1,0} %exponential.5.11), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/MultiHeadDotProductAttention_0/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %constant_60_3 = bf16[] constant(0)
  %convert.1433.1 = f32[] convert(bf16[] %constant_60_3)
  %reduce.928.3 = f32[52,8,512]{2,1,0} reduce(f32[52,8,512,512]{3,2,1,0} %multiply.389.5, f32[] %convert.1433.1), dimensions={3}, to_apply=%region_26.806.clone, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/MultiHeadDotProductAttention_0/reduce_sum[axes=(3,)]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  ROOT %negate.36.1 = f32[52,8,512]{2,1,0} negate(f32[52,8,512]{2,1,0} %reduce.928.3), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/MultiHeadDotProductAttention_0/neg" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
}

%region_26.806.clone.1 (Arg_0.4.0: f32[], Arg_1.4.0: f32[]) -> f32[] {
  %Arg_1.4.0 = f32[] parameter(1)
  %Arg_0.4.0 = f32[] parameter(0)
  ROOT %add.168.0 = f32[] add(f32[] %Arg_0.4.0, f32[] %Arg_1.4.0), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/vmap(vmap(LazyInMLP_0))/Dense_0/reduce_sum[axes=(0, 1)]" source_file="/home/nicholas/programs/avid/avid/layers.py" source_line=49}
}

%fused_reduce.27 (param_0.859: f32[52,8,512], param_1.848: bf16[416,512,512], param_2.415: f32[52,8,512], param_3.211: bf16[416,512,512]) -> f32[52,8,512] {
  %param_3.211 = bf16[416,512,512]{2,1,0} parameter(3)
  %bitcast.5757.17 = bf16[52,8,512,512]{3,2,1,0} bitcast(bf16[416,512,512]{2,1,0} %param_3.211)
  %convert.1445.17 = f32[52,8,512,512]{3,2,1,0} convert(bf16[52,8,512,512]{3,2,1,0} %bitcast.5757.17)
  %param_2.415 = f32[52,8,512]{2,1,0} parameter(2)
  %broadcast.639.3 = f32[52,8,512,512]{3,2,1,0} broadcast(f32[52,8,512]{2,1,0} %param_2.415), dimensions={0,1,2}, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/MultiHeadDotProductAttention_0/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %multiply.417.7 = f32[52,8,512,512]{3,2,1,0} multiply(f32[52,8,512,512]{3,2,1,0} %convert.1445.17, f32[52,8,512,512]{3,2,1,0} %broadcast.639.3), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/MultiHeadDotProductAttention_0/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %param_1.848 = bf16[416,512,512]{2,1,0} parameter(1)
  %bitcast.4569.17 = bf16[52,8,512,512]{3,2,1,0} bitcast(bf16[416,512,512]{2,1,0} %param_1.848)
  %convert.1352.17 = f32[52,8,512,512]{3,2,1,0} convert(bf16[52,8,512,512]{3,2,1,0} %bitcast.4569.17)
  %param_0.859 = f32[52,8,512]{2,1,0} parameter(0)
  %broadcast.611.11 = f32[52,8,512,512]{3,2,1,0} broadcast(f32[52,8,512]{2,1,0} %param_0.859), dimensions={0,1,2}, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/MultiHeadDotProductAttention_0/sub" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %subtract.28.13 = f32[52,8,512,512]{3,2,1,0} subtract(f32[52,8,512,512]{3,2,1,0} %convert.1352.17, f32[52,8,512,512]{3,2,1,0} %broadcast.611.11), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/MultiHeadDotProductAttention_0/sub" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %exponential.4.11 = f32[52,8,512,512]{3,2,1,0} exponential(f32[52,8,512,512]{3,2,1,0} %subtract.28.13), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/MultiHeadDotProductAttention_0/exp" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %multiply.418.5 = f32[52,8,512,512]{3,2,1,0} multiply(f32[52,8,512,512]{3,2,1,0} %multiply.417.7, f32[52,8,512,512]{3,2,1,0} %exponential.4.11), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/MultiHeadDotProductAttention_0/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %constant_60_4 = bf16[] constant(0)
  %convert.1433.2 = f32[] convert(bf16[] %constant_60_4)
  %reduce.1161.3 = f32[52,8,512]{2,1,0} reduce(f32[52,8,512,512]{3,2,1,0} %multiply.418.5, f32[] %convert.1433.2), dimensions={3}, to_apply=%region_26.806.clone.1, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/MultiHeadDotProductAttention_0/reduce_sum[axes=(3,)]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  ROOT %negate.41.1 = f32[52,8,512]{2,1,0} negate(f32[52,8,512]{2,1,0} %reduce.1161.3), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/MultiHeadDotProductAttention_0/neg" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
}

%fused_multiply (param_0.1258: f32[1,512,52], param_1.1336: f32[512,52], param_2.805: f32[512,52], param_3.514: f32[512,52], param_4.375: f32[512,52], param_5.291: f32[512,52]) -> (f32[512,52], f32[512,52]) {
  %param_3.514 = f32[512,52]{1,0} parameter(3)
  %bitcast.5177.7 = f32[1,512,52]{2,1,0} bitcast(f32[512,52]{1,0} %param_3.514)
  %param_0.1258 = f32[1,512,52]{2,1,0} parameter(0)
  %param_2.805 = f32[512,52]{1,0} parameter(2)
  %constant_35_11 = f32[] constant(0.00390625)
  %broadcast.519.49 = f32[512,52]{1,0} broadcast(f32[] %constant_35_11), dimensions={}
  %multiply.346.11 = f32[512,52]{1,0} multiply(f32[512,52]{1,0} %param_2.805, f32[512,52]{1,0} %broadcast.519.49), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoder_norm/div" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=228}
  %param_1.1336 = f32[512,52]{1,0} parameter(1)
  %multiply.347.9 = f32[512,52]{1,0} multiply(f32[512,52]{1,0} %param_1.1336, f32[512,52]{1,0} %param_1.1336), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoder_norm/integer_pow[y=2]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=228}
  %subtract.37.9 = f32[512,52]{1,0} subtract(f32[512,52]{1,0} %multiply.346.11, f32[512,52]{1,0} %multiply.347.9), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoder_norm/sub" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=228}
  %constant_50_54 = f32[] constant(0)
  %broadcast.522.145 = f32[512,52]{1,0} broadcast(f32[] %constant_50_54), dimensions={}
  %maximum.20.31 = f32[512,52]{1,0} maximum(f32[512,52]{1,0} %subtract.37.9, f32[512,52]{1,0} %broadcast.522.145), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoder_norm/max" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=228}
  %constant_46_6 = f32[] constant(1e-06)
  %broadcast.524.49 = f32[512,52]{1,0} broadcast(f32[] %constant_46_6), dimensions={}
  %add.223.13 = f32[512,52]{1,0} add(f32[512,52]{1,0} %maximum.20.31, f32[512,52]{1,0} %broadcast.524.49), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoder_norm/add" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=228}
  %bitcast.5039.10 = f32[1,512,52]{2,1,0} bitcast(f32[512,52]{1,0} %add.223.13)
  %divide.41.9 = f32[1,512,52]{2,1,0} divide(f32[1,512,52]{2,1,0} %param_0.1258, f32[1,512,52]{2,1,0} %bitcast.5039.10), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoder_norm/div" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=228}
  %constant_44_3 = f32[] constant(-0.5)
  %broadcast.570.29 = f32[1,512,52]{2,1,0} broadcast(f32[] %constant_44_3), dimensions={}
  %multiply.366.9 = f32[1,512,52]{2,1,0} multiply(f32[1,512,52]{2,1,0} %divide.41.9, f32[1,512,52]{2,1,0} %broadcast.570.29), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoder_norm/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=228}
  %multiply.367.7 = f32[1,512,52]{2,1,0} multiply(f32[1,512,52]{2,1,0} %bitcast.5177.7, f32[1,512,52]{2,1,0} %multiply.366.9), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoder_norm/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=228}
  %bitcast.5190.5 = f32[512,52]{1,0} bitcast(f32[1,512,52]{2,1,0} %multiply.367.7)
  %compare.29.7 = pred[512,52]{1,0} compare(f32[512,52]{1,0} %subtract.37.9, f32[512,52]{1,0} %maximum.20.31), direction=EQ, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoder_norm/eq" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=228}
  %constant_48_2 = f32[] constant(1)
  %broadcast.571.48 = f32[512,52]{1,0} broadcast(f32[] %constant_48_2), dimensions={}
  %select.23.7 = f32[512,52]{1,0} select(pred[512,52]{1,0} %compare.29.7, f32[512,52]{1,0} %broadcast.571.48, f32[512,52]{1,0} %broadcast.522.145), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoder_norm/select_n" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=228}
  %compare.30.7 = pred[512,52]{1,0} compare(f32[512,52]{1,0} %broadcast.522.145, f32[512,52]{1,0} %maximum.20.31), direction=EQ, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoder_norm/eq" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=228}
  %constant_52_3 = f32[] constant(2)
  %broadcast.572.29 = f32[512,52]{1,0} broadcast(f32[] %constant_52_3), dimensions={}
  %select.24.9 = f32[512,52]{1,0} select(pred[512,52]{1,0} %compare.30.7, f32[512,52]{1,0} %broadcast.572.29, f32[512,52]{1,0} %broadcast.571.48), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoder_norm/select_n" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=228}
  %divide.42.7 = f32[512,52]{1,0} divide(f32[512,52]{1,0} %select.23.7, f32[512,52]{1,0} %select.24.9), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoder_norm/div" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=228}
  %multiply.369.5 = f32[512,52]{1,0} multiply(f32[512,52]{1,0} %bitcast.5190.5, f32[512,52]{1,0} %divide.42.7), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoder_norm/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=228}
  %constant_198_3 = f32[] constant(0.0078125)
  %broadcast.573.2 = f32[512,52]{1,0} broadcast(f32[] %constant_198_3), dimensions={}, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoder_norm/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=228}
  %multiply.370.1 = f32[512,52]{1,0} multiply(f32[512,52]{1,0} %multiply.369.5, f32[512,52]{1,0} %broadcast.573.2), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoder_norm/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=228}
  %negate.32.1.clone.1 = f32[512,52]{1,0} negate(f32[512,52]{1,0} %multiply.369.5), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoder_norm/neg" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=228}
  %param_5.291 = f32[512,52]{1,0} parameter(5)
  %multiply.372.7.clone.1 = f32[512,52]{1,0} multiply(f32[512,52]{1,0} %param_5.291, f32[512,52]{1,0} %broadcast.573.2), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoder_norm/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=228}
  %multiply.373.5.clone.1 = f32[512,52]{1,0} multiply(f32[512,52]{1,0} %negate.32.1.clone.1, f32[512,52]{1,0} %multiply.372.7.clone.1), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoder_norm/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=228}
  %param_4.375 = f32[512,52]{1,0} parameter(4)
  %add.228.3.clone.1 = f32[512,52]{1,0} add(f32[512,52]{1,0} %multiply.373.5.clone.1, f32[512,52]{1,0} %param_4.375), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoder_norm/add_any" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=228}
  %multiply.374.1.clone.1 = f32[512,52]{1,0} multiply(f32[512,52]{1,0} %add.228.3.clone.1, f32[512,52]{1,0} %broadcast.519.49), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoder_norm/div" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=228}
  ROOT %tuple.45 = (f32[512,52]{1,0}, f32[512,52]{1,0}) tuple(f32[512,52]{1,0} %multiply.370.1, f32[512,52]{1,0} %multiply.374.1.clone.1)
}

%fused_multiply.1 (param_0.1259: f32[1,512,52], param_1.1337: f32[512,52], param_2.806: f32[512,52], param_3.515: f32[512,52], param_4.362: f32[512,52], param_5.280: f32[512,52]) -> (f32[512,52], f32[512,52]) {
  %param_3.515 = f32[512,52]{1,0} parameter(3)
  %bitcast.5290.7 = f32[1,512,52]{2,1,0} bitcast(f32[512,52]{1,0} %param_3.515)
  %param_0.1259 = f32[1,512,52]{2,1,0} parameter(0)
  %param_2.806 = f32[512,52]{1,0} parameter(2)
  %constant_35_9 = f32[] constant(0.00390625)
  %broadcast.519.53 = f32[512,52]{1,0} broadcast(f32[] %constant_35_9), dimensions={}
  %multiply.340.11 = f32[512,52]{1,0} multiply(f32[512,52]{1,0} %param_2.806, f32[512,52]{1,0} %broadcast.519.53), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/LayerNorm_1/div" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
  %param_1.1337 = f32[512,52]{1,0} parameter(1)
  %multiply.341.9 = f32[512,52]{1,0} multiply(f32[512,52]{1,0} %param_1.1337, f32[512,52]{1,0} %param_1.1337), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/LayerNorm_1/integer_pow[y=2]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
  %subtract.35.9 = f32[512,52]{1,0} subtract(f32[512,52]{1,0} %multiply.340.11, f32[512,52]{1,0} %multiply.341.9), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/LayerNorm_1/sub" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
  %constant_50_56 = f32[] constant(0)
  %broadcast.522.165 = f32[512,52]{1,0} broadcast(f32[] %constant_50_56), dimensions={}
  %maximum.19.31 = f32[512,52]{1,0} maximum(f32[512,52]{1,0} %subtract.35.9, f32[512,52]{1,0} %broadcast.522.165), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/LayerNorm_1/max" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
  %constant_46_7 = f32[] constant(1e-06)
  %broadcast.524.53 = f32[512,52]{1,0} broadcast(f32[] %constant_46_7), dimensions={}
  %add.219.13 = f32[512,52]{1,0} add(f32[512,52]{1,0} %maximum.19.31, f32[512,52]{1,0} %broadcast.524.53), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/LayerNorm_1/add" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
  %bitcast.4955.10 = f32[1,512,52]{2,1,0} bitcast(f32[512,52]{1,0} %add.219.13)
  %divide.43.9 = f32[1,512,52]{2,1,0} divide(f32[1,512,52]{2,1,0} %param_0.1259, f32[1,512,52]{2,1,0} %bitcast.4955.10), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/LayerNorm_1/div" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
  %constant_44_2 = f32[] constant(-0.5)
  %broadcast.570.33 = f32[1,512,52]{2,1,0} broadcast(f32[] %constant_44_2), dimensions={}
  %multiply.378.9 = f32[1,512,52]{2,1,0} multiply(f32[1,512,52]{2,1,0} %divide.43.9, f32[1,512,52]{2,1,0} %broadcast.570.33), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/LayerNorm_1/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
  %multiply.379.7 = f32[1,512,52]{2,1,0} multiply(f32[1,512,52]{2,1,0} %bitcast.5290.7, f32[1,512,52]{2,1,0} %multiply.378.9), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/LayerNorm_1/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
  %bitcast.5303.5 = f32[512,52]{1,0} bitcast(f32[1,512,52]{2,1,0} %multiply.379.7)
  %compare.31.7 = pred[512,52]{1,0} compare(f32[512,52]{1,0} %subtract.35.9, f32[512,52]{1,0} %maximum.19.31), direction=EQ, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/LayerNorm_1/eq" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
  %constant_48_5 = f32[] constant(1)
  %broadcast.571.56 = f32[512,52]{1,0} broadcast(f32[] %constant_48_5), dimensions={}
  %select.25.7 = f32[512,52]{1,0} select(pred[512,52]{1,0} %compare.31.7, f32[512,52]{1,0} %broadcast.571.56, f32[512,52]{1,0} %broadcast.522.165), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/LayerNorm_1/select_n" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
  %compare.32.7 = pred[512,52]{1,0} compare(f32[512,52]{1,0} %broadcast.522.165, f32[512,52]{1,0} %maximum.19.31), direction=EQ, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/LayerNorm_1/eq" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
  %constant_52_2 = f32[] constant(2)
  %broadcast.572.33 = f32[512,52]{1,0} broadcast(f32[] %constant_52_2), dimensions={}
  %select.26.9 = f32[512,52]{1,0} select(pred[512,52]{1,0} %compare.32.7, f32[512,52]{1,0} %broadcast.572.33, f32[512,52]{1,0} %broadcast.571.56), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/LayerNorm_1/select_n" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
  %divide.44.7 = f32[512,52]{1,0} divide(f32[512,52]{1,0} %select.25.7, f32[512,52]{1,0} %select.26.9), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/LayerNorm_1/div" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
  %multiply.380.5 = f32[512,52]{1,0} multiply(f32[512,52]{1,0} %bitcast.5303.5, f32[512,52]{1,0} %divide.44.7), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/LayerNorm_1/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
  %constant_198_4 = f32[] constant(0.0078125)
  %broadcast.573.3 = f32[512,52]{1,0} broadcast(f32[] %constant_198_4), dimensions={}, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoder_norm/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=228}
  %multiply.381.1 = f32[512,52]{1,0} multiply(f32[512,52]{1,0} %multiply.380.5, f32[512,52]{1,0} %broadcast.573.3), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/LayerNorm_1/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
  %negate.34.1.clone.1 = f32[512,52]{1,0} negate(f32[512,52]{1,0} %multiply.380.5), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/LayerNorm_1/neg" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
  %param_5.280 = f32[512,52]{1,0} parameter(5)
  %multiply.383.7.clone.1 = f32[512,52]{1,0} multiply(f32[512,52]{1,0} %param_5.280, f32[512,52]{1,0} %broadcast.573.3), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/LayerNorm_1/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
  %multiply.384.5.clone.1 = f32[512,52]{1,0} multiply(f32[512,52]{1,0} %negate.34.1.clone.1, f32[512,52]{1,0} %multiply.383.7.clone.1), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/LayerNorm_1/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
  %param_4.362 = f32[512,52]{1,0} parameter(4)
  %add.232.3.clone.1 = f32[512,52]{1,0} add(f32[512,52]{1,0} %multiply.384.5.clone.1, f32[512,52]{1,0} %param_4.362), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/LayerNorm_1/add_any" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
  %multiply.385.1.clone.1 = f32[512,52]{1,0} multiply(f32[512,52]{1,0} %add.232.3.clone.1, f32[512,52]{1,0} %broadcast.519.53), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/LayerNorm_1/div" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
  ROOT %tuple.42 = (f32[512,52]{1,0}, f32[512,52]{1,0}) tuple(f32[512,52]{1,0} %multiply.381.1, f32[512,52]{1,0} %multiply.385.1.clone.1)
}

%fused_multiply.2 (param_0.1260: f32[1,512,52], param_1.1338: f32[512,52], param_2.808: f32[512,52], param_3.517: f32[512,52], param_4.351: f32[512,52], param_5.271: f32[512,52]) -> (f32[512,52], f32[512,52]) {
  %param_3.517 = f32[512,52]{1,0} parameter(3)
  %bitcast.5526.7 = f32[1,512,52]{2,1,0} bitcast(f32[512,52]{1,0} %param_3.517)
  %param_0.1260 = f32[1,512,52]{2,1,0} parameter(0)
  %param_2.808 = f32[512,52]{1,0} parameter(2)
  %constant_35_7 = f32[] constant(0.00390625)
  %broadcast.519.57 = f32[512,52]{1,0} broadcast(f32[] %constant_35_7), dimensions={}
  %multiply.333.11 = f32[512,52]{1,0} multiply(f32[512,52]{1,0} %param_2.808, f32[512,52]{1,0} %broadcast.519.57), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/LayerNorm_0/div" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
  %param_1.1338 = f32[512,52]{1,0} parameter(1)
  %multiply.334.9 = f32[512,52]{1,0} multiply(f32[512,52]{1,0} %param_1.1338, f32[512,52]{1,0} %param_1.1338), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/LayerNorm_0/integer_pow[y=2]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
  %subtract.32.9 = f32[512,52]{1,0} subtract(f32[512,52]{1,0} %multiply.333.11, f32[512,52]{1,0} %multiply.334.9), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/LayerNorm_0/sub" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
  %constant_50_55 = f32[] constant(0)
  %broadcast.522.185 = f32[512,52]{1,0} broadcast(f32[] %constant_50_55), dimensions={}
  %maximum.18.31 = f32[512,52]{1,0} maximum(f32[512,52]{1,0} %subtract.32.9, f32[512,52]{1,0} %broadcast.522.185), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/LayerNorm_0/max" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
  %constant_46_8 = f32[] constant(1e-06)
  %broadcast.524.57 = f32[512,52]{1,0} broadcast(f32[] %constant_46_8), dimensions={}
  %add.212.13 = f32[512,52]{1,0} add(f32[512,52]{1,0} %maximum.18.31, f32[512,52]{1,0} %broadcast.524.57), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/LayerNorm_0/add" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
  %bitcast.4759.10 = f32[1,512,52]{2,1,0} bitcast(f32[512,52]{1,0} %add.212.13)
  %divide.47.9 = f32[1,512,52]{2,1,0} divide(f32[1,512,52]{2,1,0} %param_0.1260, f32[1,512,52]{2,1,0} %bitcast.4759.10), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/LayerNorm_0/div" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
  %constant_44_4 = f32[] constant(-0.5)
  %broadcast.570.37 = f32[1,512,52]{2,1,0} broadcast(f32[] %constant_44_4), dimensions={}
  %multiply.395.9 = f32[1,512,52]{2,1,0} multiply(f32[1,512,52]{2,1,0} %divide.47.9, f32[1,512,52]{2,1,0} %broadcast.570.37), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/LayerNorm_0/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
  %multiply.396.7 = f32[1,512,52]{2,1,0} multiply(f32[1,512,52]{2,1,0} %bitcast.5526.7, f32[1,512,52]{2,1,0} %multiply.395.9), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/LayerNorm_0/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
  %bitcast.5539.5 = f32[512,52]{1,0} bitcast(f32[1,512,52]{2,1,0} %multiply.396.7)
  %compare.33.7 = pred[512,52]{1,0} compare(f32[512,52]{1,0} %subtract.32.9, f32[512,52]{1,0} %maximum.18.31), direction=EQ, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/LayerNorm_0/eq" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
  %constant_48_4 = f32[] constant(1)
  %broadcast.571.64 = f32[512,52]{1,0} broadcast(f32[] %constant_48_4), dimensions={}
  %select.27.7 = f32[512,52]{1,0} select(pred[512,52]{1,0} %compare.33.7, f32[512,52]{1,0} %broadcast.571.64, f32[512,52]{1,0} %broadcast.522.185), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/LayerNorm_0/select_n" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
  %compare.34.7 = pred[512,52]{1,0} compare(f32[512,52]{1,0} %broadcast.522.185, f32[512,52]{1,0} %maximum.18.31), direction=EQ, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/LayerNorm_0/eq" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
  %constant_52_4 = f32[] constant(2)
  %broadcast.572.37 = f32[512,52]{1,0} broadcast(f32[] %constant_52_4), dimensions={}
  %select.28.9 = f32[512,52]{1,0} select(pred[512,52]{1,0} %compare.34.7, f32[512,52]{1,0} %broadcast.572.37, f32[512,52]{1,0} %broadcast.571.64), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/LayerNorm_0/select_n" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
  %divide.48.7 = f32[512,52]{1,0} divide(f32[512,52]{1,0} %select.27.7, f32[512,52]{1,0} %select.28.9), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/LayerNorm_0/div" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
  %multiply.397.5 = f32[512,52]{1,0} multiply(f32[512,52]{1,0} %bitcast.5539.5, f32[512,52]{1,0} %divide.48.7), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/LayerNorm_0/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
  %constant_198_6 = f32[] constant(0.0078125)
  %broadcast.573.5 = f32[512,52]{1,0} broadcast(f32[] %constant_198_6), dimensions={}, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoder_norm/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=228}
  %multiply.398.1 = f32[512,52]{1,0} multiply(f32[512,52]{1,0} %multiply.397.5, f32[512,52]{1,0} %broadcast.573.5), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/LayerNorm_0/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
  %negate.37.1.clone.1 = f32[512,52]{1,0} negate(f32[512,52]{1,0} %multiply.397.5), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/LayerNorm_0/neg" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
  %param_5.271 = f32[512,52]{1,0} parameter(5)
  %multiply.400.7.clone.1 = f32[512,52]{1,0} multiply(f32[512,52]{1,0} %param_5.271, f32[512,52]{1,0} %broadcast.573.5), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/LayerNorm_0/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
  %multiply.401.5.clone.1 = f32[512,52]{1,0} multiply(f32[512,52]{1,0} %negate.37.1.clone.1, f32[512,52]{1,0} %multiply.400.7.clone.1), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/LayerNorm_0/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
  %param_4.351 = f32[512,52]{1,0} parameter(4)
  %add.239.3.clone.1 = f32[512,52]{1,0} add(f32[512,52]{1,0} %multiply.401.5.clone.1, f32[512,52]{1,0} %param_4.351), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/LayerNorm_0/add_any" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
  %multiply.402.1.clone.1 = f32[512,52]{1,0} multiply(f32[512,52]{1,0} %add.239.3.clone.1, f32[512,52]{1,0} %broadcast.519.57), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/LayerNorm_0/div" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
  ROOT %tuple.33 = (f32[512,52]{1,0}, f32[512,52]{1,0}) tuple(f32[512,52]{1,0} %multiply.398.1, f32[512,52]{1,0} %multiply.402.1.clone.1)
}

%fused_multiply.3 (param_0.1261: f32[1,512,52], param_1.1339: f32[512,52], param_2.810: f32[512,52], param_3.519: f32[512,52], param_4.340: f32[512,52], param_5.262: f32[512,52]) -> (f32[512,52], f32[512,52]) {
  %param_3.519 = f32[512,52]{1,0} parameter(3)
  %bitcast.5639.7 = f32[1,512,52]{2,1,0} bitcast(f32[512,52]{1,0} %param_3.519)
  %param_0.1261 = f32[1,512,52]{2,1,0} parameter(0)
  %param_2.810 = f32[512,52]{1,0} parameter(2)
  %constant_35_5 = f32[] constant(0.00390625)
  %broadcast.519.61 = f32[512,52]{1,0} broadcast(f32[] %constant_35_5), dimensions={}
  %multiply.325.11 = f32[512,52]{1,0} multiply(f32[512,52]{1,0} %param_2.810, f32[512,52]{1,0} %broadcast.519.61), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/LayerNorm_1/div" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
  %param_1.1339 = f32[512,52]{1,0} parameter(1)
  %multiply.327.9 = f32[512,52]{1,0} multiply(f32[512,52]{1,0} %param_1.1339, f32[512,52]{1,0} %param_1.1339), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/LayerNorm_1/integer_pow[y=2]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
  %subtract.30.9 = f32[512,52]{1,0} subtract(f32[512,52]{1,0} %multiply.325.11, f32[512,52]{1,0} %multiply.327.9), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/LayerNorm_1/sub" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
  %constant_50_1 = f32[] constant(0)
  %broadcast.522.205 = f32[512,52]{1,0} broadcast(f32[] %constant_50_1), dimensions={}
  %maximum.17.31 = f32[512,52]{1,0} maximum(f32[512,52]{1,0} %subtract.30.9, f32[512,52]{1,0} %broadcast.522.205), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/LayerNorm_1/max" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
  %constant_46_10 = f32[] constant(1e-06)
  %broadcast.524.61 = f32[512,52]{1,0} broadcast(f32[] %constant_46_10), dimensions={}
  %add.208.13 = f32[512,52]{1,0} add(f32[512,52]{1,0} %maximum.17.31, f32[512,52]{1,0} %broadcast.524.61), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/LayerNorm_1/add" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
  %bitcast.4675.10 = f32[1,512,52]{2,1,0} bitcast(f32[512,52]{1,0} %add.208.13)
  %divide.49.9 = f32[1,512,52]{2,1,0} divide(f32[1,512,52]{2,1,0} %param_0.1261, f32[1,512,52]{2,1,0} %bitcast.4675.10), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/LayerNorm_1/div" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
  %constant_44_5 = f32[] constant(-0.5)
  %broadcast.570.41 = f32[1,512,52]{2,1,0} broadcast(f32[] %constant_44_5), dimensions={}
  %multiply.406.9 = f32[1,512,52]{2,1,0} multiply(f32[1,512,52]{2,1,0} %divide.49.9, f32[1,512,52]{2,1,0} %broadcast.570.41), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/LayerNorm_1/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
  %multiply.407.7 = f32[1,512,52]{2,1,0} multiply(f32[1,512,52]{2,1,0} %bitcast.5639.7, f32[1,512,52]{2,1,0} %multiply.406.9), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/LayerNorm_1/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
  %bitcast.5652.5 = f32[512,52]{1,0} bitcast(f32[1,512,52]{2,1,0} %multiply.407.7)
  %compare.35.7 = pred[512,52]{1,0} compare(f32[512,52]{1,0} %subtract.30.9, f32[512,52]{1,0} %maximum.17.31), direction=EQ, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/LayerNorm_1/eq" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
  %constant_48_3 = f32[] constant(1)
  %broadcast.571.72 = f32[512,52]{1,0} broadcast(f32[] %constant_48_3), dimensions={}
  %select.29.7 = f32[512,52]{1,0} select(pred[512,52]{1,0} %compare.35.7, f32[512,52]{1,0} %broadcast.571.72, f32[512,52]{1,0} %broadcast.522.205), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/LayerNorm_1/select_n" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
  %compare.36.7 = pred[512,52]{1,0} compare(f32[512,52]{1,0} %broadcast.522.205, f32[512,52]{1,0} %maximum.17.31), direction=EQ, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/LayerNorm_1/eq" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
  %constant_52_5 = f32[] constant(2)
  %broadcast.572.41 = f32[512,52]{1,0} broadcast(f32[] %constant_52_5), dimensions={}
  %select.30.9 = f32[512,52]{1,0} select(pred[512,52]{1,0} %compare.36.7, f32[512,52]{1,0} %broadcast.572.41, f32[512,52]{1,0} %broadcast.571.72), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/LayerNorm_1/select_n" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
  %divide.50.7 = f32[512,52]{1,0} divide(f32[512,52]{1,0} %select.29.7, f32[512,52]{1,0} %select.30.9), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/LayerNorm_1/div" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
  %multiply.408.5 = f32[512,52]{1,0} multiply(f32[512,52]{1,0} %bitcast.5652.5, f32[512,52]{1,0} %divide.50.7), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/LayerNorm_1/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
  %constant_198_8 = f32[] constant(0.0078125)
  %broadcast.573.7 = f32[512,52]{1,0} broadcast(f32[] %constant_198_8), dimensions={}, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoder_norm/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=228}
  %multiply.409.1 = f32[512,52]{1,0} multiply(f32[512,52]{1,0} %multiply.408.5, f32[512,52]{1,0} %broadcast.573.7), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/LayerNorm_1/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
  %negate.39.1.clone.1 = f32[512,52]{1,0} negate(f32[512,52]{1,0} %multiply.408.5), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/LayerNorm_1/neg" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
  %param_5.262 = f32[512,52]{1,0} parameter(5)
  %multiply.412.7.clone.1 = f32[512,52]{1,0} multiply(f32[512,52]{1,0} %param_5.262, f32[512,52]{1,0} %broadcast.573.7), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/LayerNorm_1/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
  %multiply.413.5.clone.1 = f32[512,52]{1,0} multiply(f32[512,52]{1,0} %negate.39.1.clone.1, f32[512,52]{1,0} %multiply.412.7.clone.1), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/LayerNorm_1/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
  %param_4.340 = f32[512,52]{1,0} parameter(4)
  %add.244.3.clone.1 = f32[512,52]{1,0} add(f32[512,52]{1,0} %multiply.413.5.clone.1, f32[512,52]{1,0} %param_4.340), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/LayerNorm_1/add_any" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
  %multiply.414.1.clone.1 = f32[512,52]{1,0} multiply(f32[512,52]{1,0} %add.244.3.clone.1, f32[512,52]{1,0} %broadcast.519.61), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/LayerNorm_1/div" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
  ROOT %tuple.30 = (f32[512,52]{1,0}, f32[512,52]{1,0}) tuple(f32[512,52]{1,0} %multiply.409.1, f32[512,52]{1,0} %multiply.414.1.clone.1)
}

%fused_multiply.4 (param_0.1262: f32[1,512,52], param_1.1340: f32[512,52], param_2.812: f32[512,52], param_3.521: f32[512,52], param_4.329: f32[512,52], param_5.251: f32[512,52]) -> (f32[512,52], f32[512,52]) {
  %param_3.521 = f32[512,52]{1,0} parameter(3)
  %bitcast.6279.7 = f32[1,512,52]{2,1,0} bitcast(f32[512,52]{1,0} %param_3.521)
  %param_0.1262 = f32[1,512,52]{2,1,0} parameter(0)
  %param_2.812 = f32[512,52]{1,0} parameter(2)
  %constant_35_2 = f32[] constant(0.00390625)
  %broadcast.519.65 = f32[512,52]{1,0} broadcast(f32[] %constant_35_2), dimensions={}
  %multiply.318.11 = f32[512,52]{1,0} multiply(f32[512,52]{1,0} %param_2.812, f32[512,52]{1,0} %broadcast.519.65), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/LayerNorm_0/div" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
  %param_1.1340 = f32[512,52]{1,0} parameter(1)
  %multiply.319.9 = f32[512,52]{1,0} multiply(f32[512,52]{1,0} %param_1.1340, f32[512,52]{1,0} %param_1.1340), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/LayerNorm_0/integer_pow[y=2]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
  %subtract.27.9 = f32[512,52]{1,0} subtract(f32[512,52]{1,0} %multiply.318.11, f32[512,52]{1,0} %multiply.319.9), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/LayerNorm_0/sub" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
  %constant_50_57 = f32[] constant(0)
  %broadcast.522.225 = f32[512,52]{1,0} broadcast(f32[] %constant_50_57), dimensions={}
  %maximum.16.31 = f32[512,52]{1,0} maximum(f32[512,52]{1,0} %subtract.27.9, f32[512,52]{1,0} %broadcast.522.225), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/LayerNorm_0/max" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
  %constant_46_9 = f32[] constant(1e-06)
  %broadcast.524.65 = f32[512,52]{1,0} broadcast(f32[] %constant_46_9), dimensions={}
  %add.200.13 = f32[512,52]{1,0} add(f32[512,52]{1,0} %maximum.16.31, f32[512,52]{1,0} %broadcast.524.65), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/LayerNorm_0/add" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
  %bitcast.4480.10 = f32[1,512,52]{2,1,0} bitcast(f32[512,52]{1,0} %add.200.13)
  %divide.53.9 = f32[1,512,52]{2,1,0} divide(f32[1,512,52]{2,1,0} %param_0.1262, f32[1,512,52]{2,1,0} %bitcast.4480.10), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/LayerNorm_0/div" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
  %constant_44_1 = f32[] constant(-0.5)
  %broadcast.570.45 = f32[1,512,52]{2,1,0} broadcast(f32[] %constant_44_1), dimensions={}
  %multiply.430.9 = f32[1,512,52]{2,1,0} multiply(f32[1,512,52]{2,1,0} %divide.53.9, f32[1,512,52]{2,1,0} %broadcast.570.45), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/LayerNorm_0/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
  %multiply.431.7 = f32[1,512,52]{2,1,0} multiply(f32[1,512,52]{2,1,0} %bitcast.6279.7, f32[1,512,52]{2,1,0} %multiply.430.9), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/LayerNorm_0/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
  %bitcast.6292.5 = f32[512,52]{1,0} bitcast(f32[1,512,52]{2,1,0} %multiply.431.7)
  %compare.37.7 = pred[512,52]{1,0} compare(f32[512,52]{1,0} %subtract.27.9, f32[512,52]{1,0} %maximum.16.31), direction=EQ, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/LayerNorm_0/eq" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
  %constant_48_1 = f32[] constant(1)
  %broadcast.571.80 = f32[512,52]{1,0} broadcast(f32[] %constant_48_1), dimensions={}
  %select.31.7 = f32[512,52]{1,0} select(pred[512,52]{1,0} %compare.37.7, f32[512,52]{1,0} %broadcast.571.80, f32[512,52]{1,0} %broadcast.522.225), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/LayerNorm_0/select_n" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
  %compare.38.7 = pred[512,52]{1,0} compare(f32[512,52]{1,0} %broadcast.522.225, f32[512,52]{1,0} %maximum.16.31), direction=EQ, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/LayerNorm_0/eq" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
  %constant_52_1 = f32[] constant(2)
  %broadcast.572.45 = f32[512,52]{1,0} broadcast(f32[] %constant_52_1), dimensions={}
  %select.32.9 = f32[512,52]{1,0} select(pred[512,52]{1,0} %compare.38.7, f32[512,52]{1,0} %broadcast.572.45, f32[512,52]{1,0} %broadcast.571.80), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/LayerNorm_0/select_n" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
  %divide.54.7 = f32[512,52]{1,0} divide(f32[512,52]{1,0} %select.31.7, f32[512,52]{1,0} %select.32.9), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/LayerNorm_0/div" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
  %multiply.433.5 = f32[512,52]{1,0} multiply(f32[512,52]{1,0} %bitcast.6292.5, f32[512,52]{1,0} %divide.54.7), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/LayerNorm_0/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
  %constant_198_10 = f32[] constant(0.0078125)
  %broadcast.573.9 = f32[512,52]{1,0} broadcast(f32[] %constant_198_10), dimensions={}, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoder_norm/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=228}
  %multiply.434.1 = f32[512,52]{1,0} multiply(f32[512,52]{1,0} %multiply.433.5, f32[512,52]{1,0} %broadcast.573.9), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/LayerNorm_0/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
  %negate.42.1.clone.1 = f32[512,52]{1,0} negate(f32[512,52]{1,0} %multiply.433.5), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/LayerNorm_0/neg" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
  %param_5.251 = f32[512,52]{1,0} parameter(5)
  %multiply.436.7.clone.1 = f32[512,52]{1,0} multiply(f32[512,52]{1,0} %param_5.251, f32[512,52]{1,0} %broadcast.573.9), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/LayerNorm_0/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
  %multiply.437.5.clone.1 = f32[512,52]{1,0} multiply(f32[512,52]{1,0} %negate.42.1.clone.1, f32[512,52]{1,0} %multiply.436.7.clone.1), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/LayerNorm_0/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
  %param_4.329 = f32[512,52]{1,0} parameter(4)
  %add.250.3.clone.1 = f32[512,52]{1,0} add(f32[512,52]{1,0} %multiply.437.5.clone.1, f32[512,52]{1,0} %param_4.329), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/LayerNorm_0/add_any" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
  %multiply.438.1.clone.1 = f32[512,52]{1,0} multiply(f32[512,52]{1,0} %add.250.3.clone.1, f32[512,52]{1,0} %broadcast.519.65), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/LayerNorm_0/div" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
  ROOT %tuple.21 = (f32[512,52]{1,0}, f32[512,52]{1,0}) tuple(f32[512,52]{1,0} %multiply.434.1, f32[512,52]{1,0} %multiply.438.1.clone.1)
}

%region_26.806.clone.2 (Arg_0.5.0: f32[], Arg_1.5.0: f32[]) -> f32[] {
  %Arg_1.5.0 = f32[] parameter(1)
  %Arg_0.5.0 = f32[] parameter(0)
  ROOT %add.181.0 = f32[] add(f32[] %Arg_0.5.0, f32[] %Arg_1.5.0), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/vmap(vmap(LazyInMLP_0))/Dense_0/reduce_sum[axes=(0, 1)]" source_file="/home/nicholas/programs/avid/avid/layers.py" source_line=49}
}

%fused_reduce.28 (param_0.860: f32[512,256,52]) -> f32[512,256] {
  %param_0.860 = f32[512,256,52]{2,1,0} parameter(0)
  %constant_60_5 = bf16[] constant(0)
  %convert.1433.3 = f32[] convert(bf16[] %constant_60_5)
  ROOT %reduce.73.1 = f32[512,256]{1,0} reduce(f32[512,256,52]{2,1,0} %param_0.860, f32[] %convert.1433.3), dimensions={2}, to_apply=%region_26.806.clone.2
}

%region_26.806.clone.6 (Arg_0.9.0: f32[], Arg_1.9.0: f32[]) -> f32[] {
  %Arg_1.9.0 = f32[] parameter(1)
  %Arg_0.9.0 = f32[] parameter(0)
  ROOT %add.183.0 = f32[] add(f32[] %Arg_0.9.0, f32[] %Arg_1.9.0), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/vmap(vmap(LazyInMLP_0))/Dense_0/reduce_sum[axes=(0, 1)]" source_file="/home/nicholas/programs/avid/avid/layers.py" source_line=49}
}

%fused_reduce.29 (param_0.864: f32[512,256,52]) -> f32[512,256] {
  %param_0.864 = f32[512,256,52]{2,1,0} parameter(0)
  %constant_60_9 = bf16[] constant(0)
  %convert.1433.7 = f32[] convert(bf16[] %constant_60_9)
  ROOT %reduce.75.1 = f32[512,256]{1,0} reduce(f32[512,256,52]{2,1,0} %param_0.864, f32[] %convert.1433.7), dimensions={2}, to_apply=%region_26.806.clone.6
}

%region_26.806.clone.9 (Arg_0.12.0: f32[], Arg_1.12.0: f32[]) -> f32[] {
  %Arg_1.12.0 = f32[] parameter(1)
  %Arg_0.12.0 = f32[] parameter(0)
  ROOT %add.175.0 = f32[] add(f32[] %Arg_0.12.0, f32[] %Arg_1.12.0), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/vmap(vmap(LazyInMLP_0))/Dense_0/reduce_sum[axes=(0, 1)]" source_file="/home/nicholas/programs/avid/avid/layers.py" source_line=49}
}

%region_26.806.clone.11 (Arg_0.14.0: f32[], Arg_1.14.0: f32[]) -> f32[] {
  %Arg_1.14.0 = f32[] parameter(1)
  %Arg_0.14.0 = f32[] parameter(0)
  ROOT %add.187.0 = f32[] add(f32[] %Arg_0.14.0, f32[] %Arg_1.14.0), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/vmap(vmap(LazyInMLP_0))/Dense_0/reduce_sum[axes=(0, 1)]" source_file="/home/nicholas/programs/avid/avid/layers.py" source_line=49}
}

%region_26.806.clone.5 (Arg_0.8.0: f32[], Arg_1.8.0: f32[]) -> f32[] {
  %Arg_1.8.0 = f32[] parameter(1)
  %Arg_0.8.0 = f32[] parameter(0)
  ROOT %add.173.0 = f32[] add(f32[] %Arg_0.8.0, f32[] %Arg_1.8.0), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/vmap(vmap(LazyInMLP_0))/Dense_0/reduce_sum[axes=(0, 1)]" source_file="/home/nicholas/programs/avid/avid/layers.py" source_line=49}
}

%region_26.806.clone.15 (Arg_0.18.0: f32[], Arg_1.18.0: f32[]) -> f32[] {
  %Arg_1.18.0 = f32[] parameter(1)
  %Arg_0.18.0 = f32[] parameter(0)
  ROOT %add.177.0 = f32[] add(f32[] %Arg_0.18.0, f32[] %Arg_1.18.0), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/vmap(vmap(LazyInMLP_0))/Dense_0/reduce_sum[axes=(0, 1)]" source_file="/home/nicholas/programs/avid/avid/layers.py" source_line=49}
}

%region_26.806.clone.19 (Arg_0.22.0: f32[], Arg_1.22.0: f32[]) -> f32[] {
  %Arg_1.22.0 = f32[] parameter(1)
  %Arg_0.22.0 = f32[] parameter(0)
  ROOT %add.180.0 = f32[] add(f32[] %Arg_0.22.0, f32[] %Arg_1.22.0), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/vmap(vmap(LazyInMLP_0))/Dense_0/reduce_sum[axes=(0, 1)]" source_file="/home/nicholas/programs/avid/avid/layers.py" source_line=49}
}

%fused_reduce.30 (param_0.867: f32[52,8,32], param_1.1408: f32[52,8,32], param_2.881: f32[52,8,32], param_3.566: f32[52,8,32], param_4.389: f32[52,8,32]) -> (f32[8,32], f32[8,32], f32[8,32], f32[8,32], f32[8,32]) {
  %param_0.867 = f32[52,8,32]{2,1,0} parameter(0)
  %constant_60_12 = bf16[] constant(0)
  %convert.1433.10 = f32[] convert(bf16[] %constant_60_12)
  %reduce.1198.1 = f32[8,32]{1,0} reduce(f32[52,8,32]{2,1,0} %param_0.867, f32[] %convert.1433.10), dimensions={0}, to_apply=%region_26.806.clone.9, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/MultiHeadDotProductAttention_0/query/reduce_sum[axes=(0, 1)]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %param_1.1408 = f32[52,8,32]{2,1,0} parameter(1)
  %reduce.1146.1.clone.1 = f32[8,32]{1,0} reduce(f32[52,8,32]{2,1,0} %param_1.1408, f32[] %convert.1433.10), dimensions={0}, to_apply=%region_26.806.clone.11, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/MultiHeadDotProductAttention_0/value/reduce_sum[axes=(0, 1)]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %param_2.881 = f32[52,8,32]{2,1,0} parameter(2)
  %reduce.1186.1.clone.1 = f32[8,32]{1,0} reduce(f32[52,8,32]{2,1,0} %param_2.881, f32[] %convert.1433.10), dimensions={0}, to_apply=%region_26.806.clone.5, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/MultiHeadDotProductAttention_0/key/reduce_sum[axes=(0, 1)]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %param_3.566 = f32[52,8,32]{2,1,0} parameter(3)
  %reduce.953.1.clone.1 = f32[8,32]{1,0} reduce(f32[52,8,32]{2,1,0} %param_3.566, f32[] %convert.1433.10), dimensions={0}, to_apply=%region_26.806.clone.15, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/MultiHeadDotProductAttention_0/key/reduce_sum[axes=(0, 1)]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %param_4.389 = f32[52,8,32]{2,1,0} parameter(4)
  %reduce.965.1.clone.1 = f32[8,32]{1,0} reduce(f32[52,8,32]{2,1,0} %param_4.389, f32[] %convert.1433.10), dimensions={0}, to_apply=%region_26.806.clone.19, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/MultiHeadDotProductAttention_0/query/reduce_sum[axes=(0, 1)]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  ROOT %tuple.78 = (f32[8,32]{1,0}, f32[8,32]{1,0}, f32[8,32]{1,0}, f32[8,32]{1,0}, f32[8,32]{1,0}) tuple(f32[8,32]{1,0} %reduce.1198.1, f32[8,32]{1,0} %reduce.1146.1.clone.1, f32[8,32]{1,0} %reduce.1186.1.clone.1, f32[8,32]{1,0} %reduce.953.1.clone.1, f32[8,32]{1,0} %reduce.965.1.clone.1)
}

%region_26.806.clone.12 (Arg_0.15.0: f32[], Arg_1.15.0: f32[]) -> f32[] {
  %Arg_1.15.0 = f32[] parameter(1)
  %Arg_0.15.0 = f32[] parameter(0)
  ROOT %add.188.0 = f32[] add(f32[] %Arg_0.15.0, f32[] %Arg_1.15.0), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/vmap(vmap(LazyInMLP_0))/Dense_0/reduce_sum[axes=(0, 1)]" source_file="/home/nicholas/programs/avid/avid/layers.py" source_line=49}
}

%fused_reduce.31 (param_0.870: f32[512,256,52]) -> f32[512,256] {
  %param_0.870 = f32[512,256,52]{2,1,0} parameter(0)
  %constant_60_15 = bf16[] constant(0)
  %convert.1433.13 = f32[] convert(bf16[] %constant_60_15)
  ROOT %reduce.87.1 = f32[512,256]{1,0} reduce(f32[512,256,52]{2,1,0} %param_0.870, f32[] %convert.1433.13), dimensions={2}, to_apply=%region_26.806.clone.12
}

%region_26.806.clone.16 (Arg_0.19.0: f32[], Arg_1.19.0: f32[]) -> f32[] {
  %Arg_1.19.0 = f32[] parameter(1)
  %Arg_0.19.0 = f32[] parameter(0)
  ROOT %add.190.0 = f32[] add(f32[] %Arg_0.19.0, f32[] %Arg_1.19.0), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/vmap(vmap(LazyInMLP_0))/Dense_0/reduce_sum[axes=(0, 1)]" source_file="/home/nicholas/programs/avid/avid/layers.py" source_line=49}
}

%fused_reduce.32 (param_0.874: f32[512,256,52]) -> f32[512,256] {
  %param_0.874 = f32[512,256,52]{2,1,0} parameter(0)
  %constant_60_19 = bf16[] constant(0)
  %convert.1433.17 = f32[] convert(bf16[] %constant_60_19)
  ROOT %reduce.89.1 = f32[512,256]{1,0} reduce(f32[512,256,52]{2,1,0} %param_0.874, f32[] %convert.1433.17), dimensions={2}, to_apply=%region_26.806.clone.16
}

%region_26.806.clone.21 (Arg_0.24.0: f32[], Arg_1.24.0: f32[]) -> f32[] {
  %Arg_1.24.0 = f32[] parameter(1)
  %Arg_0.24.0 = f32[] parameter(0)
  ROOT %add.193.0 = f32[] add(f32[] %Arg_0.24.0, f32[] %Arg_1.24.0), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/vmap(vmap(LazyInMLP_0))/Dense_0/reduce_sum[axes=(0, 1)]" source_file="/home/nicholas/programs/avid/avid/layers.py" source_line=49}
}

%fused_reduce.33 (param_0.879: f32[52,8,32]) -> f32[8,32] {
  %param_0.879 = f32[52,8,32]{2,1,0} parameter(0)
  %constant_60_24 = bf16[] constant(0)
  %convert.1433.22 = f32[] convert(bf16[] %constant_60_24)
  ROOT %reduce.913.1 = f32[8,32]{1,0} reduce(f32[52,8,32]{2,1,0} %param_0.879, f32[] %convert.1433.22), dimensions={0}, to_apply=%region_26.806.clone.21, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/MultiHeadDotProductAttention_0/value/reduce_sum[axes=(0, 1)]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
}

%region_26.806.clone.23 (Arg_0.26.0: f32[], Arg_1.26.0: f32[]) -> f32[] {
  %Arg_1.26.0 = f32[] parameter(1)
  %Arg_0.26.0 = f32[] parameter(0)
  ROOT %add.194.0 = f32[] add(f32[] %Arg_0.26.0, f32[] %Arg_1.26.0), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/vmap(vmap(LazyInMLP_0))/Dense_0/reduce_sum[axes=(0, 1)]" source_file="/home/nicholas/programs/avid/avid/layers.py" source_line=49}
}

%fused_reduce.34 (param_0.881: f32[512,256,52]) -> f32[512,256] {
  %param_0.881 = f32[512,256,52]{2,1,0} parameter(0)
  %constant_60_26 = bf16[] constant(0)
  %convert.1433.24 = f32[] convert(bf16[] %constant_60_26)
  ROOT %reduce.93.1 = f32[512,256]{1,0} reduce(f32[512,256,52]{2,1,0} %param_0.881, f32[] %convert.1433.24), dimensions={2}, to_apply=%region_26.806.clone.23
}

%region_26.806.clone.24 (Arg_0.27.0: f32[], Arg_1.27.0: f32[]) -> f32[] {
  %Arg_1.27.0 = f32[] parameter(1)
  %Arg_0.27.0 = f32[] parameter(0)
  ROOT %add.195.0 = f32[] add(f32[] %Arg_0.27.0, f32[] %Arg_1.27.0), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/vmap(vmap(LazyInMLP_0))/Dense_0/reduce_sum[axes=(0, 1)]" source_file="/home/nicholas/programs/avid/avid/layers.py" source_line=49}
}

%fused_convert_reduce (param_0.882: f32[512,256]) -> (f32[256], bf16[512,256]) {
  %param_0.882 = f32[512,256]{1,0} parameter(0)
  %constant_60_27 = bf16[] constant(0)
  %convert.1433.25 = f32[] convert(bf16[] %constant_60_27)
  %reduce.1283.1 = f32[256]{0} reduce(f32[512,256]{1,0} %param_0.882, f32[] %convert.1433.25), dimensions={0}, to_apply=%region_26.806.clone.24, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/im_embed/vmap(inner)/vmap(Patchify_0)/patch_proj/reduce_sum[axes=(0, 1)]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=40}
  %convert.1511.1 = bf16[512,256]{1,0} convert(f32[512,256]{1,0} %param_0.882)
  ROOT %tuple.19 = (f32[256]{0}, bf16[512,256]{1,0}) tuple(f32[256]{0} %reduce.1283.1, bf16[512,256]{1,0} %convert.1511.1)
}

%fused_reduce.35 (param_0.1221: f32[512,256,52], param_1.1293: f32[256], param_2.765: f32[1,512,52], param_3.531: f32[512,52], param_4.335: bf16[512,256], param_5.255: bf16[512,256,52]) -> (f32[512,52], f32[512,52]) {
  %param_0.1221 = f32[512,256,52]{2,1,0} parameter(0)
  %param_2.765 = f32[1,512,52]{2,1,0} parameter(2)
  %bitcast.4483.23 = f32[512,52]{1,0} bitcast(f32[1,512,52]{2,1,0} %param_2.765)
  %broadcast.525.23 = f32[512,256,52]{2,1,0} broadcast(f32[512,52]{1,0} %bitcast.4483.23), dimensions={0,2}, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/LayerNorm_0/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
  %param_1.1293 = f32[256]{0} parameter(1)
  %broadcast.526.20 = f32[512,256,52]{2,1,0} broadcast(f32[256]{0} %param_1.1293), dimensions={1}, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/LayerNorm_0/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
  %multiply.320.17 = f32[512,256,52]{2,1,0} multiply(f32[512,256,52]{2,1,0} %broadcast.525.23, f32[512,256,52]{2,1,0} %broadcast.526.20), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/LayerNorm_0/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
  %multiply.427.7 = f32[512,256,52]{2,1,0} multiply(f32[512,256,52]{2,1,0} %param_0.1221, f32[512,256,52]{2,1,0} %multiply.320.17), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/LayerNorm_0/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
  %constant_50_28 = f32[] constant(0)
  %reduce.50.3 = f32[512,52]{1,0} reduce(f32[512,256,52]{2,1,0} %multiply.427.7, f32[] %constant_50_28), dimensions={1}, to_apply=%region_2.176
  %negate.43.1 = f32[512,52]{1,0} negate(f32[512,52]{1,0} %reduce.50.3), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/LayerNorm_0/neg" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
  %param_5.255 = bf16[512,256,52]{2,1,0} parameter(5)
  %convert.1332.19.clone.1 = f32[512,256,52]{2,1,0} convert(bf16[512,256,52]{2,1,0} %param_5.255)
  %param_4.335 = bf16[512,256]{1,0} parameter(4)
  %convert.1523.10.clone.1 = f32[512,256]{1,0} convert(bf16[512,256]{1,0} %param_4.335)
  %broadcast.602.19.clone.1 = f32[512,256,52]{2,1,0} broadcast(f32[512,256]{1,0} %convert.1523.10.clone.1), dimensions={0,1}, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/im_embed/vmap(inner)/pos_embed/add" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=64}
  %add.199.19.clone.1 = f32[512,256,52]{2,1,0} add(f32[512,256,52]{2,1,0} %convert.1332.19.clone.1, f32[512,256,52]{2,1,0} %broadcast.602.19.clone.1), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/im_embed/vmap(inner)/pos_embed/add" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=64}
  %param_3.531 = f32[512,52]{1,0} parameter(3)
  %broadcast.520.9.clone.1 = f32[512,256,52]{2,1,0} broadcast(f32[512,52]{1,0} %param_3.531), dimensions={0,2}, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/LayerNorm_0/sub" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
  %subtract.26.9.clone.1 = f32[512,256,52]{2,1,0} subtract(f32[512,256,52]{2,1,0} %add.199.19.clone.1, f32[512,256,52]{2,1,0} %broadcast.520.9.clone.1), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/LayerNorm_0/sub" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
  %multiply.421.3.clone.1 = f32[512,256,52]{2,1,0} multiply(f32[512,256,52]{2,1,0} %subtract.26.9.clone.1, f32[512,256,52]{2,1,0} %param_0.1221), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/LayerNorm_0/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
  %multiply.429.3.clone.1 = f32[512,256,52]{2,1,0} multiply(f32[512,256,52]{2,1,0} %multiply.421.3.clone.1, f32[512,256,52]{2,1,0} %broadcast.526.20), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/LayerNorm_0/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
  %reduce.49.1.clone.1 = f32[512,52]{1,0} reduce(f32[512,256,52]{2,1,0} %multiply.429.3.clone.1, f32[] %constant_50_28), dimensions={1}, to_apply=%region_2.176
  ROOT %tuple.22 = (f32[512,52]{1,0}, f32[512,52]{1,0}) tuple(f32[512,52]{1,0} %negate.43.1, f32[512,52]{1,0} %reduce.49.1.clone.1)
}

%fused_reduce.36 (param_0.1220: f32[256], param_1.1292: f32[1,512,52], param_2.764: f32[256,52], param_3.553: f32[512,256,52], param_4.380: f32[512,52]) -> (f32[512,52], f32[512,52]) {
  %param_2.764 = f32[256,52]{1,0} parameter(2)
  %broadcast.569.13 = f32[512,256,52]{2,1,0} broadcast(f32[256,52]{1,0} %param_2.764), dimensions={1,2}, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/transpose[permutation=(0, 2, 1)]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=250}
  %param_1.1292 = f32[1,512,52]{2,1,0} parameter(1)
  %bitcast.5042.21 = f32[512,52]{1,0} bitcast(f32[1,512,52]{2,1,0} %param_1.1292)
  %broadcast.561.21 = f32[512,256,52]{2,1,0} broadcast(f32[512,52]{1,0} %bitcast.5042.21), dimensions={0,2}, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoder_norm/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=228}
  %param_0.1220 = f32[256]{0} parameter(0)
  %broadcast.562.18 = f32[512,256,52]{2,1,0} broadcast(f32[256]{0} %param_0.1220), dimensions={1}, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoder_norm/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=228}
  %multiply.349.15 = f32[512,256,52]{2,1,0} multiply(f32[512,256,52]{2,1,0} %broadcast.561.21, f32[512,256,52]{2,1,0} %broadcast.562.18), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoder_norm/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=228}
  %multiply.364.7 = f32[512,256,52]{2,1,0} multiply(f32[512,256,52]{2,1,0} %broadcast.569.13, f32[512,256,52]{2,1,0} %multiply.349.15), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoder_norm/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=228}
  %constant_50_27 = f32[] constant(0)
  %reduce.33.3 = f32[512,52]{1,0} reduce(f32[512,256,52]{2,1,0} %multiply.364.7, f32[] %constant_50_27), dimensions={1}, to_apply=%region_2.176
  %negate.33.1 = f32[512,52]{1,0} negate(f32[512,52]{1,0} %reduce.33.3), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoder_norm/neg" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=228}
  %param_3.553 = f32[512,256,52]{2,1,0} parameter(3)
  %param_4.380 = f32[512,52]{1,0} parameter(4)
  %broadcast.560.7.clone.1 = f32[512,256,52]{2,1,0} broadcast(f32[512,52]{1,0} %param_4.380), dimensions={0,2}, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoder_norm/sub" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=228}
  %subtract.36.7.clone.1 = f32[512,256,52]{2,1,0} subtract(f32[512,256,52]{2,1,0} %param_3.553, f32[512,256,52]{2,1,0} %broadcast.560.7.clone.1), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoder_norm/sub" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=228}
  %multiply.362.3.clone.1 = f32[512,256,52]{2,1,0} multiply(f32[512,256,52]{2,1,0} %subtract.36.7.clone.1, f32[512,256,52]{2,1,0} %broadcast.569.13), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoder_norm/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=228}
  %multiply.365.3.clone.1 = f32[512,256,52]{2,1,0} multiply(f32[512,256,52]{2,1,0} %multiply.362.3.clone.1, f32[512,256,52]{2,1,0} %broadcast.562.18), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoder_norm/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=228}
  %reduce.32.1.clone.1 = f32[512,52]{1,0} reduce(f32[512,256,52]{2,1,0} %multiply.365.3.clone.1, f32[] %constant_50_27), dimensions={1}, to_apply=%region_2.176
  ROOT %tuple.49 = (f32[512,52]{1,0}, f32[512,52]{1,0}) tuple(f32[512,52]{1,0} %negate.33.1, f32[512,52]{1,0} %reduce.32.1.clone.1)
}

%fused_gather (param_0.1103: s32[260,1], param_1.1167: f32[56,64]) -> bf16[260,1,64] {
  %param_1.1167 = f32[56,64]{1,0} parameter(1)
  %convert.1323.1 = bf16[56,64]{1,0} convert(f32[56,64]{1,0} %param_1.1167), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/spec_embed/vmap(vmap(vmap(species_embed)))/species_embed/convert_element_type[new_dtype=bfloat16 weak_type=False]" source_file="/home/nicholas/programs/avid/avid/encoder.py" source_line=38}
  %param_0.1103 = s32[260,1]{1,0} parameter(0)
  ROOT %gather.5.1 = bf16[260,1,64]{2,1,0} gather(bf16[56,64]{1,0} %convert.1323.1, s32[260,1]{1,0} %param_0.1103), offset_dims={1,2}, collapsed_slice_dims={}, start_index_map={0}, index_vector_dim=1, slice_sizes={1,64}, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/spec_embed/vmap(vmap(vmap(species_embed)))/species_embed/jit(_take)/gather[dimension_numbers=GatherDimensionNumbers(offset_dims=(2,), collapsed_slice_dims=(0,), start_index_map=(0,)) slice_sizes=(1, 64) unique_indices=False indices_are_sorted=False mode=GatherScatterMode.PROMISE_IN_BOUNDS fill_value=None]" source_file="/home/nicholas/programs/avid/avid/encoder.py" source_line=38}
}

%fused_reduce.37 (param_0.1215: bf16[52], param_1.1287: f32[52], param_2.762: f32[1]) -> f32[] {
  %param_1.1287 = f32[52]{0} parameter(1)
  %param_2.762 = f32[1]{0} parameter(2)
  %convert.1413.1 = bf16[1]{0} convert(f32[1]{0} %param_2.762), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/vmap(head)/Dense_0/convert_element_type[new_dtype=bfloat16 weak_type=False]" source_file="/home/nicholas/programs/avid/avid/layers.py" source_line=49}
  %bitcast.5084.10 = bf16[] bitcast(bf16[1]{0} %convert.1413.1), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/vmap(head)/Dense_0/add" source_file="/home/nicholas/programs/avid/avid/layers.py" source_line=49}
  %convert.1540.7 = f32[] convert(bf16[] %bitcast.5084.10)
  %broadcast.631.7 = f32[52]{0} broadcast(f32[] %convert.1540.7), dimensions={}, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/vmap(head)/Dense_0/add" source_file="/home/nicholas/programs/avid/avid/layers.py" source_line=49}
  %add.226.7 = f32[52]{0} add(f32[52]{0} %param_1.1287, f32[52]{0} %broadcast.631.7), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/vmap(head)/Dense_0/add" source_file="/home/nicholas/programs/avid/avid/layers.py" source_line=49}
  %param_0.1215 = bf16[52]{0} parameter(0)
  %convert.1415.5 = f32[52]{0} convert(bf16[52]{0} %param_0.1215)
  %add.227.5 = f32[52]{0} add(f32[52]{0} %add.226.7, f32[52]{0} %convert.1415.5), metadata={op_name="jit(loss)/jit(main)/jvp(cond)/branch_1_fun/sub" source_file="/home/nicholas/programs/avid/avid/config.py" source_line=380}
  %multiply.353.1 = f32[52]{0} multiply(f32[52]{0} %add.227.5, f32[52]{0} %add.227.5), metadata={op_name="jit(loss)/jit(main)/jvp(cond)/branch_1_fun/integer_pow[y=2]" source_file="/home/nicholas/programs/avid/avid/config.py" source_line=380}
  %constant_50_22 = f32[] constant(0)
  ROOT %reduce.712.1 = f32[] reduce(f32[52]{0} %multiply.353.1, f32[] %constant_50_22), dimensions={0}, to_apply=%region_2.176, metadata={op_name="jit(loss)/jit(main)/jvp(cond)/branch_1_fun/reduce_sum[axes=(0, 1)]" source_file="/home/nicholas/programs/avid/avid/config.py" source_line=380}
}

%fused_convert.15 (param_0.1161: f32[]) -> bf16[] {
  %param_0.1161 = f32[] parameter(0)
  %constant_67_2 = f32[] constant(0.0192307699)
  %multiply.354.5 = f32[] multiply(f32[] %param_0.1161, f32[] %constant_67_2), metadata={op_name="jit(loss)/jit(main)/jvp(cond)/branch_1_fun/div" source_file="/home/nicholas/programs/avid/avid/config.py" source_line=380}
  %sqrt.2.5 = f32[] sqrt(f32[] %multiply.354.5), metadata={op_name="jit(loss)/jit(main)/jvp(cond)/branch_1_fun/sqrt" source_file="/home/nicholas/programs/avid/avid/config.py" source_line=380}
  ROOT %convert.1416.1 = bf16[] convert(f32[] %sqrt.2.5)
}

%fused_reduce.38 (param_0.1199: f32[256,52], param_1.1330: f32[256,1]) -> f32[52] {
  %param_0.1199 = f32[256,52]{1,0} parameter(0)
  %param_1.1330 = f32[256,1]{1,0} parameter(1)
  %convert.1411.5 = bf16[256,1]{1,0} convert(f32[256,1]{1,0} %param_1.1330), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/vmap(head)/Dense_0/convert_element_type[new_dtype=bfloat16 weak_type=False]" source_file="/home/nicholas/programs/avid/avid/layers.py" source_line=49}
  %bitcast.5070.12 = bf16[256]{0} bitcast(bf16[256,1]{1,0} %convert.1411.5)
  %convert.1539.9 = f32[256]{0} convert(bf16[256]{0} %bitcast.5070.12)
  %constant_66_2 = f32[] constant(0.001953125)
  %broadcast.628.5 = f32[256]{0} broadcast(f32[] %constant_66_2), dimensions={}
  %multiply.440.5 = f32[256]{0} multiply(f32[256]{0} %convert.1539.9, f32[256]{0} %broadcast.628.5)
  %broadcast.629.3 = f32[256,52]{1,0} broadcast(f32[256]{0} %multiply.440.5), dimensions={0}
  %multiply.352.3 = f32[256,52]{1,0} multiply(f32[256,52]{1,0} %param_0.1199, f32[256,52]{1,0} %broadcast.629.3)
  %constant_50_6 = f32[] constant(0)
  ROOT %reduce.7.1 = f32[52]{0} reduce(f32[256,52]{1,0} %multiply.352.3, f32[] %constant_50_6), dimensions={0}, to_apply=%region_2.176
}

%region_26.806.clone.7 (Arg_0.10.0: f32[], Arg_1.10.0: f32[]) -> f32[] {
  %Arg_1.10.0 = f32[] parameter(1)
  %Arg_0.10.0 = f32[] parameter(0)
  ROOT %add.184.0 = f32[] add(f32[] %Arg_0.10.0, f32[] %Arg_1.10.0), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/vmap(vmap(LazyInMLP_0))/Dense_0/reduce_sum[axes=(0, 1)]" source_file="/home/nicholas/programs/avid/avid/layers.py" source_line=49}
}

%region_26.806.clone.3 (Arg_0.6.0: f32[], Arg_1.6.0: f32[]) -> f32[] {
  %Arg_1.6.0 = f32[] parameter(1)
  %Arg_0.6.0 = f32[] parameter(0)
  ROOT %add.182.0 = f32[] add(f32[] %Arg_0.6.0, f32[] %Arg_1.6.0), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/vmap(vmap(LazyInMLP_0))/Dense_0/reduce_sum[axes=(0, 1)]" source_file="/home/nicholas/programs/avid/avid/layers.py" source_line=49}
}

%region_26.806.clone.13 (Arg_0.16.0: f32[], Arg_1.16.0: f32[]) -> f32[] {
  %Arg_1.16.0 = f32[] parameter(1)
  %Arg_0.16.0 = f32[] parameter(0)
  ROOT %add.189.0 = f32[] add(f32[] %Arg_0.16.0, f32[] %Arg_1.16.0), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/vmap(vmap(LazyInMLP_0))/Dense_0/reduce_sum[axes=(0, 1)]" source_file="/home/nicholas/programs/avid/avid/layers.py" source_line=49}
}

%region_26.806.clone.17 (Arg_0.20.0: f32[], Arg_1.20.0: f32[]) -> f32[] {
  %Arg_1.20.0 = f32[] parameter(1)
  %Arg_0.20.0 = f32[] parameter(0)
  ROOT %add.191.0 = f32[] add(f32[] %Arg_0.20.0, f32[] %Arg_1.20.0), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/vmap(vmap(LazyInMLP_0))/Dense_0/reduce_sum[axes=(0, 1)]" source_file="/home/nicholas/programs/avid/avid/layers.py" source_line=49}
}

%fused_reduce.39 (param_0.1216: f32[512,256], param_1.1407: f32[512,256], param_2.878: f32[512,256], param_3.563: f32[512,256], param_4.386: f32[512,256]) -> (f32[256], f32[256], f32[256], f32[256], f32[256]) {
  %param_0.1216 = f32[512,256]{1,0} parameter(0)
  %constant_50_23 = f32[] constant(0)
  %reduce.749.1 = f32[256]{0} reduce(f32[512,256]{1,0} %param_0.1216, f32[] %constant_50_23), dimensions={0}, to_apply=%region_2.176, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoder_norm/reduce_sum[axes=(0, 1)]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=228}
  %param_1.1407 = f32[512,256]{1,0} parameter(1)
  %constant_60_10_clone_1 = bf16[] constant(0)
  %convert.1433.8.clone.1 = f32[] convert(bf16[] %constant_60_10_clone_1)
  %reduce.1132.1.clone.1 = f32[256]{0} reduce(f32[512,256]{1,0} %param_1.1407, f32[] %convert.1433.8.clone.1), dimensions={0}, to_apply=%region_26.806.clone.7, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/MultiHeadDotProductAttention_0/out/reduce_sum[axes=(0, 1)]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %param_2.878 = f32[512,256]{1,0} parameter(2)
  %reduce.1043.1.clone.1 = f32[256]{0} reduce(f32[512,256]{1,0} %param_2.878, f32[] %convert.1433.8.clone.1), dimensions={0}, to_apply=%region_26.806.clone.3, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/vmap(vmap(LazyInMLP_0))/Dense_0/reduce_sum[axes=(0, 1)]" source_file="/home/nicholas/programs/avid/avid/layers.py" source_line=49}
  %param_3.563 = f32[512,256]{1,0} parameter(3)
  %reduce.810.1.clone.1 = f32[256]{0} reduce(f32[512,256]{1,0} %param_3.563, f32[] %convert.1433.8.clone.1), dimensions={0}, to_apply=%region_26.806.clone.13, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/vmap(vmap(LazyInMLP_0))/Dense_0/reduce_sum[axes=(0, 1)]" source_file="/home/nicholas/programs/avid/avid/layers.py" source_line=49}
  %param_4.386 = f32[512,256]{1,0} parameter(4)
  %reduce.899.1.clone.1 = f32[256]{0} reduce(f32[512,256]{1,0} %param_4.386, f32[] %convert.1433.8.clone.1), dimensions={0}, to_apply=%region_26.806.clone.17, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/MultiHeadDotProductAttention_0/out/reduce_sum[axes=(0, 1)]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  ROOT %tuple.74 = (f32[256]{0}, f32[256]{0}, f32[256]{0}, f32[256]{0}, f32[256]{0}) tuple(f32[256]{0} %reduce.749.1, f32[256]{0} %reduce.1132.1.clone.1, f32[256]{0} %reduce.1043.1.clone.1, f32[256]{0} %reduce.810.1.clone.1, f32[256]{0} %reduce.899.1.clone.1)
}

%fused_reduce.40 (param_0.1217: f32[512,256], param_1.1406: f32[512,256], param_2.875: f32[512,256], param_3.560: f32[512,256], param_4.383: f32[512,256]) -> (f32[256], f32[256], f32[256], f32[256], f32[256]) {
  %param_0.1217 = f32[512,256]{1,0} parameter(0)
  %constant_50_24 = f32[] constant(0)
  %reduce.760.1 = f32[256]{0} reduce(f32[512,256]{1,0} %param_0.1217, f32[] %constant_50_24), dimensions={0}, to_apply=%region_2.176, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoder_norm/reduce_sum[axes=(0, 1)]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=228}
  %param_1.1406 = f32[512,256]{1,0} parameter(1)
  %reduce.848.1.clone.1 = f32[256]{0} reduce(f32[512,256]{1,0} %param_1.1406, f32[] %constant_50_24), dimensions={0}, to_apply=%region_2.176, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/LayerNorm_1/reduce_sum[axes=(0, 1)]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
  %param_2.875 = f32[512,256]{1,0} parameter(2)
  %reduce.992.1.clone.1 = f32[256]{0} reduce(f32[512,256]{1,0} %param_2.875, f32[] %constant_50_24), dimensions={0}, to_apply=%region_2.176, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/LayerNorm_0/reduce_sum[axes=(0, 1)]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
  %param_3.560 = f32[512,256]{1,0} parameter(3)
  %reduce.1081.1.clone.1 = f32[256]{0} reduce(f32[512,256]{1,0} %param_3.560, f32[] %constant_50_24), dimensions={0}, to_apply=%region_2.176, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/LayerNorm_1/reduce_sum[axes=(0, 1)]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
  %param_4.383 = f32[512,256]{1,0} parameter(4)
  %reduce.1225.1.clone.1 = f32[256]{0} reduce(f32[512,256]{1,0} %param_4.383, f32[] %constant_50_24), dimensions={0}, to_apply=%region_2.176, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/LayerNorm_0/reduce_sum[axes=(0, 1)]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
  ROOT %tuple.70 = (f32[256]{0}, f32[256]{0}, f32[256]{0}, f32[256]{0}, f32[256]{0}) tuple(f32[256]{0} %reduce.760.1, f32[256]{0} %reduce.848.1.clone.1, f32[256]{0} %reduce.992.1.clone.1, f32[256]{0} %reduce.1081.1.clone.1, f32[256]{0} %reduce.1225.1.clone.1)
}

%fused_reduce.41 (param_0.1232: f32[208,256], param_1.1405: f32[208,256], param_2.873: f32[208,256], param_3.558: f32[208,256]) -> (f32[256], f32[256], f32[256], f32[256]) {
  %param_0.1232 = f32[208,256]{1,0} parameter(0)
  %constant_50_39 = f32[] constant(0)
  %reduce.1214.1 = f32[256]{0} reduce(f32[208,256]{1,0} %param_0.1232, f32[] %constant_50_39), dimensions={0}, to_apply=%region_2.176, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/LayerNorm_0/reduce_sum[axes=(0, 1)]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
  %param_1.1405 = f32[208,256]{1,0} parameter(1)
  %reduce.1070.1.clone.1 = f32[256]{0} reduce(f32[208,256]{1,0} %param_1.1405, f32[] %constant_50_39), dimensions={0}, to_apply=%region_2.176, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/LayerNorm_1/reduce_sum[axes=(0, 1)]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
  %param_2.873 = f32[208,256]{1,0} parameter(2)
  %reduce.837.1.clone.1 = f32[256]{0} reduce(f32[208,256]{1,0} %param_2.873, f32[] %constant_50_39), dimensions={0}, to_apply=%region_2.176, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/LayerNorm_1/reduce_sum[axes=(0, 1)]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
  %param_3.558 = f32[208,256]{1,0} parameter(3)
  %reduce.981.1.clone.1 = f32[256]{0} reduce(f32[208,256]{1,0} %param_3.558, f32[] %constant_50_39), dimensions={0}, to_apply=%region_2.176, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/LayerNorm_0/reduce_sum[axes=(0, 1)]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
  ROOT %tuple.66 = (f32[256]{0}, f32[256]{0}, f32[256]{0}, f32[256]{0}) tuple(f32[256]{0} %reduce.1214.1, f32[256]{0} %reduce.1070.1.clone.1, f32[256]{0} %reduce.837.1.clone.1, f32[256]{0} %reduce.981.1.clone.1)
}

%fused_broadcast () -> bf16[56,64] {
  %constant_60_1 = bf16[] constant(0)
  ROOT %broadcast.594.1 = bf16[56,64]{1,0} broadcast(bf16[] %constant_60_1), dimensions={}, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/spec_embed/vmap(vmap(vmap(species_embed)))/species_embed/jit(_take)/broadcast_in_dim[shape=(56, 64) broadcast_dimensions=()]" source_file="/home/nicholas/programs/avid/avid/encoder.py" source_line=38}
}

%fused_convert_divide (param_0.1275: f32[52,8,512]) -> (bf16[52,8,512], f32[52,8,512], bf16[52,8,512]) {
  %constant_8_2_clone_1 = bf16[] constant(1)
  %convert.1543.2.clone.1 = f32[] convert(bf16[] %constant_8_2_clone_1)
  %broadcast.636.1.clone.1 = f32[52,8,512]{2,1,0} broadcast(f32[] %convert.1543.2.clone.1), dimensions={}
  %param_0.1275 = f32[52,8,512]{2,1,0} parameter(0)
  %multiply.387.1.clone.1 = f32[52,8,512]{2,1,0} multiply(f32[52,8,512]{2,1,0} %param_0.1275, f32[52,8,512]{2,1,0} %param_0.1275), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/MultiHeadDotProductAttention_0/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %divide.46.1.clone.1 = f32[52,8,512]{2,1,0} divide(f32[52,8,512]{2,1,0} %broadcast.636.1.clone.1, f32[52,8,512]{2,1,0} %multiply.387.1.clone.1), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/MultiHeadDotProductAttention_0/div" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %convert.1431.1 = bf16[52,8,512]{2,1,0} convert(f32[52,8,512]{2,1,0} %divide.46.1.clone.1)
  %convert.1395.1 = bf16[52,8,512]{2,1,0} convert(f32[52,8,512]{2,1,0} %param_0.1275), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/MultiHeadDotProductAttention_0/convert_element_type[new_dtype=bfloat16 weak_type=False]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  ROOT %tuple.55 = (bf16[52,8,512]{2,1,0}, f32[52,8,512]{2,1,0}, bf16[52,8,512]{2,1,0}) tuple(bf16[52,8,512]{2,1,0} %convert.1431.1, f32[52,8,512]{2,1,0} %divide.46.1.clone.1, bf16[52,8,512]{2,1,0} %convert.1395.1)
}

%fused_convert_divide.1 (param_0.1278: f32[52,8,512]) -> (bf16[52,8,512], f32[52,8,512], bf16[52,8,512]) {
  %constant_8_3_clone_1 = bf16[] constant(1)
  %convert.1543.1.clone.1 = f32[] convert(bf16[] %constant_8_3_clone_1)
  %broadcast.636.2.clone.1 = f32[52,8,512]{2,1,0} broadcast(f32[] %convert.1543.1.clone.1), dimensions={}
  %param_0.1278 = f32[52,8,512]{2,1,0} parameter(0)
  %multiply.416.1.clone.1 = f32[52,8,512]{2,1,0} multiply(f32[52,8,512]{2,1,0} %param_0.1278, f32[52,8,512]{2,1,0} %param_0.1278), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/MultiHeadDotProductAttention_0/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %divide.52.1.clone.1 = f32[52,8,512]{2,1,0} divide(f32[52,8,512]{2,1,0} %broadcast.636.2.clone.1, f32[52,8,512]{2,1,0} %multiply.416.1.clone.1), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/MultiHeadDotProductAttention_0/div" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %convert.1449.1 = bf16[52,8,512]{2,1,0} convert(f32[52,8,512]{2,1,0} %divide.52.1.clone.1)
  %convert.1357.1 = bf16[52,8,512]{2,1,0} convert(f32[52,8,512]{2,1,0} %param_0.1278), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/MultiHeadDotProductAttention_0/convert_element_type[new_dtype=bfloat16 weak_type=False]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  ROOT %tuple.60 = (bf16[52,8,512]{2,1,0}, f32[52,8,512]{2,1,0}, bf16[52,8,512]{2,1,0}) tuple(bf16[52,8,512]{2,1,0} %convert.1449.1, f32[52,8,512]{2,1,0} %divide.52.1.clone.1, bf16[52,8,512]{2,1,0} %convert.1357.1)
}

%fused_convert.16 (param_0_0: bf16[256,256], param_1_0: bf16[256,256]) -> (f32[256,256], f32[256,256]) {
  %param_0_0 = bf16[256,256]{1,0} parameter(0)
  %convert.1463.2 = f32[256,256]{1,0} convert(bf16[256,256]{1,0} %param_0_0), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/vmap(vmap(LazyInMLP_0))/Dense_0/convert_element_type[new_dtype=float32 weak_type=False]" source_file="/home/nicholas/programs/avid/avid/layers.py" source_line=49}
  %param_1_0 = bf16[256,256]{1,0} parameter(1)
  %convert.1482.2 = f32[256,256]{1,0} convert(bf16[256,256]{1,0} %param_1_0), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/vmap(vmap(LazyInMLP_0))/Dense_0/convert_element_type[new_dtype=float32 weak_type=False]" source_file="/home/nicholas/programs/avid/avid/layers.py" source_line=49}
  ROOT %tuple.63 = (f32[256,256]{1,0}, f32[256,256]{1,0}) tuple(f32[256,256]{1,0} %convert.1463.2, f32[256,256]{1,0} %convert.1482.2)
}

%wrapped_convert_computation (param_0.1286: f32[1728,256]) -> bf16[1728,256] {
  %param_0.1286 = f32[1728,256]{1,0} parameter(0)
  ROOT %convert.1327.1 = bf16[1728,256]{1,0} convert(f32[1728,256]{1,0} %param_0.1286), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/im_embed/vmap(inner)/vmap(Patchify_0)/patch_proj/convert_element_type[new_dtype=bfloat16 weak_type=False]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=40}
}

%wrapped_convert_computation.1 (param_0.1287: f32[256,8,32]) -> bf16[256,8,32] {
  %param_0.1287 = f32[256,8,32]{2,1,0} parameter(0)
  ROOT %convert.1336.1 = bf16[256,8,32]{2,1,0} convert(f32[256,8,32]{2,1,0} %param_0.1287), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/MultiHeadDotProductAttention_0/value/convert_element_type[new_dtype=bfloat16 weak_type=False]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
}

%wrapped_convert_computation.2 (param_0.1288: f32[256,8,32]) -> bf16[256,8,32] {
  %param_0.1288 = f32[256,8,32]{2,1,0} parameter(0)
  ROOT %convert.1341.1 = bf16[256,8,32]{2,1,0} convert(f32[256,8,32]{2,1,0} %param_0.1288), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/MultiHeadDotProductAttention_0/query/convert_element_type[new_dtype=bfloat16 weak_type=False]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
}

%wrapped_convert_computation.3 (param_0.1289: f32[256,8,32]) -> bf16[256,8,32] {
  %param_0.1289 = f32[256,8,32]{2,1,0} parameter(0)
  ROOT %convert.1347.1 = bf16[256,8,32]{2,1,0} convert(f32[256,8,32]{2,1,0} %param_0.1289), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/MultiHeadDotProductAttention_0/key/convert_element_type[new_dtype=bfloat16 weak_type=False]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
}

%wrapped_convert_computation.4 (param_0.1290: f32[8,32,256]) -> bf16[8,32,256] {
  %param_0.1290 = f32[8,32,256]{2,1,0} parameter(0)
  ROOT %convert.1360.1 = bf16[8,32,256]{2,1,0} convert(f32[8,32,256]{2,1,0} %param_0.1290), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/MultiHeadDotProductAttention_0/out/convert_element_type[new_dtype=bfloat16 weak_type=False]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
}

%wrapped_convert_computation.5 (param_0.1291: f32[256,256]) -> bf16[256,256] {
  %param_0.1291 = f32[256,256]{1,0} parameter(0)
  ROOT %convert.1367.1 = bf16[256,256]{1,0} convert(f32[256,256]{1,0} %param_0.1291), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/vmap(vmap(LazyInMLP_0))/Dense_0/convert_element_type[new_dtype=bfloat16 weak_type=False]" source_file="/home/nicholas/programs/avid/avid/layers.py" source_line=49}
}

%wrapped_convert_computation.6 (param_0.1292: f32[256,8,32]) -> bf16[256,8,32] {
  %param_0.1292 = f32[256,8,32]{2,1,0} parameter(0)
  ROOT %convert.1374.1 = bf16[256,8,32]{2,1,0} convert(f32[256,8,32]{2,1,0} %param_0.1292), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/MultiHeadDotProductAttention_0/value/convert_element_type[new_dtype=bfloat16 weak_type=False]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
}

%wrapped_convert_computation.7 (param_0.1293: f32[256,8,32]) -> bf16[256,8,32] {
  %param_0.1293 = f32[256,8,32]{2,1,0} parameter(0)
  ROOT %convert.1379.1 = bf16[256,8,32]{2,1,0} convert(f32[256,8,32]{2,1,0} %param_0.1293), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/MultiHeadDotProductAttention_0/query/convert_element_type[new_dtype=bfloat16 weak_type=False]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
}

%wrapped_convert_computation.8 (param_0.1294: f32[256,8,32]) -> bf16[256,8,32] {
  %param_0.1294 = f32[256,8,32]{2,1,0} parameter(0)
  ROOT %convert.1385.1 = bf16[256,8,32]{2,1,0} convert(f32[256,8,32]{2,1,0} %param_0.1294), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/MultiHeadDotProductAttention_0/key/convert_element_type[new_dtype=bfloat16 weak_type=False]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
}

%wrapped_convert_computation.9 (param_0.1295: f32[8,32,256]) -> bf16[8,32,256] {
  %param_0.1295 = f32[8,32,256]{2,1,0} parameter(0)
  ROOT %convert.1398.1 = bf16[8,32,256]{2,1,0} convert(f32[8,32,256]{2,1,0} %param_0.1295), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/MultiHeadDotProductAttention_0/out/convert_element_type[new_dtype=bfloat16 weak_type=False]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
}

%wrapped_convert_computation.10 (param_0.1296: f32[256,256]) -> bf16[256,256] {
  %param_0.1296 = f32[256,256]{1,0} parameter(0)
  ROOT %convert.1405.1 = bf16[256,256]{1,0} convert(f32[256,256]{1,0} %param_0.1296), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/vmap(vmap(LazyInMLP_0))/Dense_0/convert_element_type[new_dtype=bfloat16 weak_type=False]" source_file="/home/nicholas/programs/avid/avid/layers.py" source_line=49}
}

%wrapped_convert_computation.11 (param_0.1297: bf16[1728,256]) -> f32[1728,256] {
  %param_0.1297 = bf16[1728,256]{1,0} parameter(0)
  ROOT %convert.1508.1 = f32[1728,256]{1,0} convert(bf16[1728,256]{1,0} %param_0.1297), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/im_embed/vmap(inner)/vmap(Patchify_0)/patch_proj/convert_element_type[new_dtype=float32 weak_type=False]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=40}
}

%wrapped_convert_computation.12 (param_0.1298: bf16[56,64]) -> f32[56,64] {
  %param_0.1298 = bf16[56,64]{1,0} parameter(0)
  ROOT %convert.1519.1 = f32[56,64]{1,0} convert(bf16[56,64]{1,0} %param_0.1298), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/spec_embed/vmap(vmap(vmap(species_embed)))/species_embed/convert_element_type[new_dtype=float32 weak_type=False]" source_file="/home/nicholas/programs/avid/avid/encoder.py" source_line=38}
}

ENTRY %main.1336 (Arg_0.1.0: f32[256], Arg_1.2.0: f32[256], Arg_2.3.0: f32[256], Arg_3.4.0: f32[256], Arg_4.5.0: f32[256], Arg_5.6.0: f32[256], Arg_6.7.0: f32[256], Arg_7.8.0: f32[256,256], Arg_8.9.0: f32[8,32], Arg_9.10.0: f32[256,8,32], Arg_10.11.0: f32[256], Arg_11.12.0: f32[8,32,256], Arg_12.13.0: f32[8,32], Arg_13.14.0: f32[256,8,32], Arg_14.15.0: f32[8,32], Arg_15.16.0: f32[256,8,32], Arg_16.17.0: f32[256], Arg_17.18.0: f32[256], Arg_18.19.0: f32[256], Arg_19.20.0: f32[256], Arg_20.21.0: f32[256], Arg_21.22.0: f32[256,256], Arg_22.23.0: f32[8,32], Arg_23.24.0: f32[256,8,32], Arg_24.25.0: f32[256], Arg_25.26.0: f32[8,32,256], Arg_26.27.0: f32[8,32], Arg_27.28.0: f32[256,8,32], Arg_28.29.0: f32[8,32], Arg_29.30.0: f32[256,8,32], Arg_30.31.0: f32[1], Arg_31.32.0: f32[256,1], Arg_32.33.0: f32[256], Arg_33.34.0: f32[1728,256], Arg_34.35.0: bf16[512,256], Arg_35.36.0: f32[56,64]) -> (bf16[], f32[256], f32[256], f32[256], f32[256], /*index=5*/f32[256], f32[256], f32[256], f32[256,256], f32[8,32], /*index=10*/f32[256,8,32], f32[256], f32[8,32,256], f32[8,32], f32[256,8,32], /*index=15*/f32[8,32], f32[256,8,32], f32[256], f32[256], f32[256], /*index=20*/f32[256], f32[256], f32[256,256], f32[8,32], f32[256,8,32], /*index=25*/f32[256], f32[8,32,256], f32[8,32], f32[256,8,32], f32[8,32], /*index=30*/f32[256,8,32], f32[1], f32[256,1], f32[256], f32[1728,256], /*index=35*/bf16[512,256], f32[56,64]) {
  %Arg_30.31.0 = f32[1]{0} parameter(30), sharding={replicated}
  %Arg_34.35.0 = bf16[512,256]{1,0} parameter(34), sharding={replicated}
  %constant_222_0 = bf16[52]{0} constant({...})
  %Arg_19.20.0 = f32[256]{0} parameter(19), sharding={replicated}
  %Arg_17.18.0 = f32[256]{0} parameter(17), sharding={replicated}
  %Arg_5.6.0 = f32[256]{0} parameter(5), sharding={replicated}
  %Arg_3.4.0 = f32[256]{0} parameter(3), sharding={replicated}
  %Arg_1.2.0 = f32[256]{0} parameter(1), sharding={replicated}
  %constant_124_0 = bf16[13824,5,52]{2,1,0} constant({...})
  %constant_121_0 = s32[260,1]{1,0} constant({...})
  %Arg_31.32.0 = f32[256,1]{1,0} parameter(31), sharding={replicated}
  %Arg_22.23.0 = f32[8,32]{1,0} parameter(22), sharding={replicated}
  %Arg_8.9.0 = f32[8,32]{1,0} parameter(8), sharding={replicated}
  %Arg_35.36.0 = f32[56,64]{1,0} parameter(35), sharding={replicated}
  %Arg_33.34.0 = f32[1728,256]{1,0} parameter(33), sharding={replicated}
  %Arg_32.33.0 = f32[256]{0} parameter(32), sharding={replicated}
  %Arg_29.30.0 = f32[256,8,32]{2,1,0} parameter(29), sharding={replicated}
  %Arg_28.29.0 = f32[8,32]{1,0} parameter(28), sharding={replicated}
  %Arg_27.28.0 = f32[256,8,32]{2,1,0} parameter(27), sharding={replicated}
  %Arg_26.27.0 = f32[8,32]{1,0} parameter(26), sharding={replicated}
  %Arg_25.26.0 = f32[8,32,256]{2,1,0} parameter(25), sharding={replicated}
  %Arg_24.25.0 = f32[256]{0} parameter(24), sharding={replicated}
  %Arg_23.24.0 = f32[256,8,32]{2,1,0} parameter(23), sharding={replicated}
  %Arg_21.22.0 = f32[256,256]{1,0} parameter(21), sharding={replicated}
  %Arg_20.21.0 = f32[256]{0} parameter(20), sharding={replicated}
  %Arg_18.19.0 = f32[256]{0} parameter(18), sharding={replicated}
  %Arg_16.17.0 = f32[256]{0} parameter(16), sharding={replicated}
  %Arg_15.16.0 = f32[256,8,32]{2,1,0} parameter(15), sharding={replicated}
  %Arg_14.15.0 = f32[8,32]{1,0} parameter(14), sharding={replicated}
  %Arg_13.14.0 = f32[256,8,32]{2,1,0} parameter(13), sharding={replicated}
  %Arg_12.13.0 = f32[8,32]{1,0} parameter(12), sharding={replicated}
  %Arg_11.12.0 = f32[8,32,256]{2,1,0} parameter(11), sharding={replicated}
  %Arg_10.11.0 = f32[256]{0} parameter(10), sharding={replicated}
  %Arg_9.10.0 = f32[256,8,32]{2,1,0} parameter(9), sharding={replicated}
  %Arg_7.8.0 = f32[256,256]{1,0} parameter(7), sharding={replicated}
  %Arg_6.7.0 = f32[256]{0} parameter(6), sharding={replicated}
  %Arg_4.5.0 = f32[256]{0} parameter(4), sharding={replicated}
  %Arg_2.3.0 = f32[256]{0} parameter(2), sharding={replicated}
  %Arg_0.1.0 = f32[256]{0} parameter(0), sharding={replicated}
  %loop_broadcast_fusion = bf16[56,64]{1,0} fusion(), kind=kLoop, calls=%fused_broadcast, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/spec_embed/vmap(vmap(vmap(species_embed)))/species_embed/jit(_take)/broadcast_in_dim[shape=(56, 64) broadcast_dimensions=()]" source_file="/home/nicholas/programs/avid/avid/encoder.py" source_line=38}
  %loop_gather_fusion = bf16[260,1,64]{2,1,0} fusion(s32[260,1]{1,0} %constant_121_0, f32[56,64]{1,0} %Arg_35.36.0), kind=kLoop, calls=%fused_gather, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/spec_embed/vmap(vmap(vmap(species_embed)))/species_embed/jit(_take)/gather[dimension_numbers=GatherDimensionNumbers(offset_dims=(2,), collapsed_slice_dims=(0,), start_index_map=(0,)) slice_sizes=(1, 64) unique_indices=False indices_are_sorted=False mode=GatherScatterMode.PROMISE_IN_BOUNDS fill_value=None]" source_file="/home/nicholas/programs/avid/avid/encoder.py" source_line=38}
  %wrapped_convert.5 = bf16[256,256]{1,0} fusion(f32[256,256]{1,0} %Arg_7.8.0), kind=kLoop, calls=%wrapped_convert_computation.5, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/vmap(vmap(LazyInMLP_0))/Dense_0/convert_element_type[new_dtype=bfloat16 weak_type=False]" source_file="/home/nicholas/programs/avid/avid/layers.py" source_line=49}
  %wrapped_convert.3 = bf16[256,8,32]{2,1,0} fusion(f32[256,8,32]{2,1,0} %Arg_9.10.0), kind=kLoop, calls=%wrapped_convert_computation.3, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/MultiHeadDotProductAttention_0/key/convert_element_type[new_dtype=bfloat16 weak_type=False]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %bitcast.4551.0 = bf16[256,256]{1,0} bitcast(bf16[256,8,32]{2,1,0} %wrapped_convert.3)
  %bitcast.5811.0 = bf16[256,256]{0,1} bitcast(bf16[256,8,32]{2,1,0} %wrapped_convert.3)
  %wrapped_convert.4 = bf16[8,32,256]{2,1,0} fusion(f32[8,32,256]{2,1,0} %Arg_11.12.0), kind=kLoop, calls=%wrapped_convert_computation.4, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/MultiHeadDotProductAttention_0/out/convert_element_type[new_dtype=bfloat16 weak_type=False]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %bitcast.4610.0 = bf16[256,256]{1,0} bitcast(bf16[8,32,256]{2,1,0} %wrapped_convert.4)
  %bitcast.5721.0 = bf16[256,256]{0,1} bitcast(bf16[8,32,256]{2,1,0} %wrapped_convert.4)
  %wrapped_convert.2 = bf16[256,8,32]{2,1,0} fusion(f32[256,8,32]{2,1,0} %Arg_13.14.0), kind=kLoop, calls=%wrapped_convert_computation.2, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/MultiHeadDotProductAttention_0/query/convert_element_type[new_dtype=bfloat16 weak_type=False]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %bitcast.4525.0 = bf16[256,256]{1,0} bitcast(bf16[256,8,32]{2,1,0} %wrapped_convert.2)
  %bitcast.5842.0 = bf16[256,256]{0,1} bitcast(bf16[256,8,32]{2,1,0} %wrapped_convert.2)
  %wrapped_convert.1 = bf16[256,8,32]{2,1,0} fusion(f32[256,8,32]{2,1,0} %Arg_15.16.0), kind=kLoop, calls=%wrapped_convert_computation.1, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/MultiHeadDotProductAttention_0/value/convert_element_type[new_dtype=bfloat16 weak_type=False]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %bitcast.4503.0 = bf16[256,256]{1,0} bitcast(bf16[256,8,32]{2,1,0} %wrapped_convert.1)
  %bitcast.5743.0 = bf16[256,256]{0,1} bitcast(bf16[256,8,32]{2,1,0} %wrapped_convert.1)
  %wrapped_convert.10 = bf16[256,256]{1,0} fusion(f32[256,256]{1,0} %Arg_21.22.0), kind=kLoop, calls=%wrapped_convert_computation.10, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/vmap(vmap(LazyInMLP_0))/Dense_0/convert_element_type[new_dtype=bfloat16 weak_type=False]" source_file="/home/nicholas/programs/avid/avid/layers.py" source_line=49}
  %wrapped_convert.8 = bf16[256,8,32]{2,1,0} fusion(f32[256,8,32]{2,1,0} %Arg_23.24.0), kind=kLoop, calls=%wrapped_convert_computation.8, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/MultiHeadDotProductAttention_0/key/convert_element_type[new_dtype=bfloat16 weak_type=False]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %bitcast.4830.0 = bf16[256,256]{1,0} bitcast(bf16[256,8,32]{2,1,0} %wrapped_convert.8)
  %bitcast.5463.0 = bf16[256,256]{0,1} bitcast(bf16[256,8,32]{2,1,0} %wrapped_convert.8)
  %wrapped_convert.9 = bf16[8,32,256]{2,1,0} fusion(f32[8,32,256]{2,1,0} %Arg_25.26.0), kind=kLoop, calls=%wrapped_convert_computation.9, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/MultiHeadDotProductAttention_0/out/convert_element_type[new_dtype=bfloat16 weak_type=False]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %bitcast.4890.0 = bf16[256,256]{1,0} bitcast(bf16[8,32,256]{2,1,0} %wrapped_convert.9)
  %bitcast.5374.0 = bf16[256,256]{0,1} bitcast(bf16[8,32,256]{2,1,0} %wrapped_convert.9)
  %wrapped_convert.7 = bf16[256,8,32]{2,1,0} fusion(f32[256,8,32]{2,1,0} %Arg_27.28.0), kind=kLoop, calls=%wrapped_convert_computation.7, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/MultiHeadDotProductAttention_0/query/convert_element_type[new_dtype=bfloat16 weak_type=False]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %bitcast.4804.0 = bf16[256,256]{1,0} bitcast(bf16[256,8,32]{2,1,0} %wrapped_convert.7)
  %bitcast.5494.0 = bf16[256,256]{0,1} bitcast(bf16[256,8,32]{2,1,0} %wrapped_convert.7)
  %wrapped_convert.6 = bf16[256,8,32]{2,1,0} fusion(f32[256,8,32]{2,1,0} %Arg_29.30.0), kind=kLoop, calls=%wrapped_convert_computation.6, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/MultiHeadDotProductAttention_0/value/convert_element_type[new_dtype=bfloat16 weak_type=False]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %bitcast.4782.0 = bf16[256,256]{1,0} bitcast(bf16[256,8,32]{2,1,0} %wrapped_convert.6)
  %bitcast.5396.0 = bf16[256,256]{0,1} bitcast(bf16[256,8,32]{2,1,0} %wrapped_convert.6)
  %wrapped_convert = bf16[1728,256]{1,0} fusion(f32[1728,256]{1,0} %Arg_33.34.0), kind=kLoop, calls=%wrapped_convert_computation, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/im_embed/vmap(inner)/vmap(Patchify_0)/patch_proj/convert_element_type[new_dtype=bfloat16 weak_type=False]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=40}
  %loop_transpose_fusion = bf16[52,8,8,8,3,3,3,64]{7,6,5,4,3,2,1,0} fusion(bf16[13824,5,52]{2,1,0} %constant_124_0, bf16[260,1,64]{2,1,0} %loop_gather_fusion), kind=kLoop, calls=%fused_transpose.11, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/im_embed/vmap(inner)/transpose[permutation=(0, 1, 3, 5, 2, 4, 6, 7)]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=103}
  %bitcast.6371.0 = bf16[26624,1728]{1,0} bitcast(bf16[52,8,8,8,3,3,3,64]{7,6,5,4,3,2,1,0} %loop_transpose_fusion)
  %custom-call.45.0 = (bf16[26624,256]{1,0}, s8[4194304]{0}) custom-call(bf16[26624,1728]{1,0} %bitcast.6371.0, bf16[1728,256]{1,0} %wrapped_convert), custom_call_target="__cublas$gemm", metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/im_embed/vmap(inner)/vmap(Patchify_0)/patch_proj/dot_general[dimension_numbers=(((2,), (0,)), ((), ())) precision=None preferred_element_type=None]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=40}, backend_config={"operation_queue_id":"0","wait_on_operation_queues":[],"gemm_backend_config":{"alpha_real":1,"alpha_imag":0,"beta":0,"dot_dimension_numbers":{"lhs_contracting_dimensions":["1"],"rhs_contracting_dimensions":["0"],"lhs_batch_dimensions":[],"rhs_batch_dimensions":[]},"precision_config":{"operand_precision":["DEFAULT","DEFAULT"]},"epilogue":"DEFAULT","selected_algorithm":"-1","lhs_stride":"46006272","rhs_stride":"442368","grad_x":false,"grad_y":false}}
  %get-tuple-element.34.0 = bf16[26624,256]{1,0} get-tuple-element((bf16[26624,256]{1,0}, s8[4194304]{0}) %custom-call.45.0), index=0, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/im_embed/vmap(inner)/vmap(Patchify_0)/patch_proj/dot_general[dimension_numbers=(((2,), (0,)), ((), ())) precision=None preferred_element_type=None]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=40}
  %input_transpose_fusion.10 = bf16[512,256,52]{2,1,0} fusion(f32[256]{0} %Arg_32.33.0, bf16[26624,256]{1,0} %get-tuple-element.34.0), kind=kInput, calls=%fused_transpose.10, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/im_embed/vmap(inner)/vmap(Patchify_0)/patch_proj/add" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=40}
  %input_reduce_fusion.25 = (f32[512,52]{1,0}, f32[512,52]{1,0}) fusion(bf16[512,256,52]{2,1,0} %input_transpose_fusion.10, bf16[512,256]{1,0} %Arg_34.35.0), kind=kInput, calls=%fused_reduce.25
  %get-tuple-element.162 = f32[512,52]{1,0} get-tuple-element((f32[512,52]{1,0}, f32[512,52]{1,0}) %input_reduce_fusion.25), index=1
  %get-tuple-element.161 = f32[512,52]{1,0} get-tuple-element((f32[512,52]{1,0}, f32[512,52]{1,0}) %input_reduce_fusion.25), index=0
  %loop_multiply_rsqrt_fusion.4 = (f32[1,512,52]{2,1,0}, f32[512,52]{1,0}) fusion(f32[512,52]{1,0} %get-tuple-element.162, f32[512,52]{1,0} %get-tuple-element.161), kind=kLoop, calls=%fused_multiply_rsqrt.4, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/LayerNorm_0/rsqrt" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156 deduplicated_name="loop_multiply_rsqrt_fusion"}
  %get-tuple-element.159 = f32[1,512,52]{2,1,0} get-tuple-element((f32[1,512,52]{2,1,0}, f32[512,52]{1,0}) %loop_multiply_rsqrt_fusion.4), index=0
  %get-tuple-element.160 = f32[512,52]{1,0} get-tuple-element((f32[1,512,52]{2,1,0}, f32[512,52]{1,0}) %loop_multiply_rsqrt_fusion.4), index=1
  %input_transpose_fusion.19 = bf16[52,512,256]{2,1,0} fusion(f32[256]{0} %Arg_2.3.0, f32[256]{0} %Arg_3.4.0, f32[1,512,52]{2,1,0} %get-tuple-element.159, f32[512,52]{1,0} %get-tuple-element.160, bf16[512,256]{1,0} %Arg_34.35.0, /*index=5*/bf16[512,256,52]{2,1,0} %input_transpose_fusion.10), kind=kInput, calls=%fused_transpose.20, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/LayerNorm_0/convert_element_type[new_dtype=bfloat16 weak_type=False]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
  %bitcast.6031.0 = bf16[26624,256]{1,0} bitcast(bf16[52,512,256]{2,1,0} %input_transpose_fusion.19)
  %custom-call.48.0 = (bf16[26624,256]{1,0}, s8[4194304]{0}) custom-call(bf16[26624,256]{1,0} %bitcast.6031.0, bf16[256,256]{1,0} %bitcast.4551.0), custom_call_target="__cublas$gemm", metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/MultiHeadDotProductAttention_0/key/dot_general[dimension_numbers=(((2,), (0,)), ((), ())) precision=None preferred_element_type=None]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}, backend_config={"operation_queue_id":"0","wait_on_operation_queues":[],"gemm_backend_config":{"alpha_real":1,"alpha_imag":0,"beta":0,"dot_dimension_numbers":{"lhs_contracting_dimensions":["1"],"rhs_contracting_dimensions":["0"],"lhs_batch_dimensions":[],"rhs_batch_dimensions":[]},"precision_config":{"operand_precision":["DEFAULT","DEFAULT"]},"epilogue":"DEFAULT","selected_algorithm":"-1","lhs_stride":"6815744","rhs_stride":"65536","grad_x":false,"grad_y":false}}
  %get-tuple-element.37.0 = bf16[26624,256]{1,0} get-tuple-element((bf16[26624,256]{1,0}, s8[4194304]{0}) %custom-call.48.0), index=0, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/MultiHeadDotProductAttention_0/key/dot_general[dimension_numbers=(((2,), (0,)), ((), ())) precision=None preferred_element_type=None]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %input_transpose_fusion.28 = bf16[52,8,512,32]{3,2,1,0} fusion(f32[8,32]{1,0} %Arg_8.9.0, bf16[26624,256]{1,0} %get-tuple-element.37.0), kind=kInput, calls=%fused_transpose.29, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/MultiHeadDotProductAttention_0/key/add" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158 deduplicated_name="input_transpose_fusion.28"}
  %input_transpose_fusion.13 = bf16[52,8,32,512]{3,2,1,0} fusion(f32[8,32]{1,0} %Arg_8.9.0, bf16[26624,256]{1,0} %get-tuple-element.37.0), kind=kInput, calls=%fused_transpose.14
  %bitcast.4566.0 = bf16[416,32,512]{2,1,0} bitcast(bf16[52,8,32,512]{3,2,1,0} %input_transpose_fusion.13)
  %bitcast.5825.0 = bf16[416,512,32]{2,1,0} bitcast(bf16[52,8,512,32]{3,2,1,0} %input_transpose_fusion.28)
  %custom-call.47.0 = (bf16[26624,256]{1,0}, s8[4194304]{0}) custom-call(bf16[26624,256]{1,0} %bitcast.6031.0, bf16[256,256]{1,0} %bitcast.4525.0), custom_call_target="__cublas$gemm", metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/MultiHeadDotProductAttention_0/query/dot_general[dimension_numbers=(((2,), (0,)), ((), ())) precision=None preferred_element_type=None]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}, backend_config={"operation_queue_id":"0","wait_on_operation_queues":[],"gemm_backend_config":{"alpha_real":1,"alpha_imag":0,"beta":0,"dot_dimension_numbers":{"lhs_contracting_dimensions":["1"],"rhs_contracting_dimensions":["0"],"lhs_batch_dimensions":[],"rhs_batch_dimensions":[]},"precision_config":{"operand_precision":["DEFAULT","DEFAULT"]},"epilogue":"DEFAULT","selected_algorithm":"-1","lhs_stride":"6815744","rhs_stride":"65536","grad_x":false,"grad_y":false}}
  %get-tuple-element.36.0 = bf16[26624,256]{1,0} get-tuple-element((bf16[26624,256]{1,0}, s8[4194304]{0}) %custom-call.47.0), index=0, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/MultiHeadDotProductAttention_0/query/dot_general[dimension_numbers=(((2,), (0,)), ((), ())) precision=None preferred_element_type=None]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %loop_convert_fusion.14 = bf16[52,8,512,32]{3,2,1,0} fusion(f32[8,32]{1,0} %Arg_12.13.0, bf16[26624,256]{1,0} %get-tuple-element.36.0), kind=kLoop, calls=%fused_convert.14
  %bitcast.4544.0 = bf16[416,512,32]{2,1,0} bitcast(bf16[52,8,512,32]{3,2,1,0} %loop_convert_fusion.14)
  %custom-call.46.0 = (bf16[26624,256]{1,0}, s8[4194304]{0}) custom-call(bf16[26624,256]{1,0} %bitcast.6031.0, bf16[256,256]{1,0} %bitcast.4503.0), custom_call_target="__cublas$gemm", metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/MultiHeadDotProductAttention_0/value/dot_general[dimension_numbers=(((2,), (0,)), ((), ())) precision=None preferred_element_type=None]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}, backend_config={"operation_queue_id":"0","wait_on_operation_queues":[],"gemm_backend_config":{"alpha_real":1,"alpha_imag":0,"beta":0,"dot_dimension_numbers":{"lhs_contracting_dimensions":["1"],"rhs_contracting_dimensions":["0"],"lhs_batch_dimensions":[],"rhs_batch_dimensions":[]},"precision_config":{"operand_precision":["DEFAULT","DEFAULT"]},"epilogue":"DEFAULT","selected_algorithm":"-1","lhs_stride":"6815744","rhs_stride":"65536","grad_x":false,"grad_y":false}}
  %get-tuple-element.35.0 = bf16[26624,256]{1,0} get-tuple-element((bf16[26624,256]{1,0}, s8[4194304]{0}) %custom-call.46.0), index=0, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/MultiHeadDotProductAttention_0/value/dot_general[dimension_numbers=(((2,), (0,)), ((), ())) precision=None preferred_element_type=None]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %input_transpose_fusion.14 = bf16[52,8,32,512]{3,2,1,0} fusion(f32[8,32]{1,0} %Arg_14.15.0, bf16[26624,256]{1,0} %get-tuple-element.35.0), kind=kInput, calls=%fused_transpose.15
  %bitcast.4518.0 = bf16[416,32,512]{2,1,0} bitcast(bf16[52,8,32,512]{3,2,1,0} %input_transpose_fusion.14)
  %custom-call.49.0 = (bf16[416,512,512]{2,1,0}, s8[4194304]{0}) custom-call(bf16[416,512,32]{2,1,0} %bitcast.4544.0, bf16[416,32,512]{2,1,0} %bitcast.4566.0), custom_call_target="__cublas$gemm", metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/MultiHeadDotProductAttention_0/...qhd,...khd->...hqk/dot_general[dimension_numbers=(((3,), (3,)), ((0, 2), (0, 2))) precision=None preferred_element_type=bfloat16]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}, backend_config={"operation_queue_id":"0","wait_on_operation_queues":[],"gemm_backend_config":{"alpha_real":1,"alpha_imag":0,"beta":0,"dot_dimension_numbers":{"lhs_contracting_dimensions":["2"],"rhs_contracting_dimensions":["1"],"lhs_batch_dimensions":["0"],"rhs_batch_dimensions":["0"]},"precision_config":{"operand_precision":["DEFAULT","DEFAULT"]},"epilogue":"DEFAULT","selected_algorithm":"-1","lhs_stride":"16384","rhs_stride":"16384","grad_x":false,"grad_y":false}}
  %get-tuple-element.38.0 = bf16[416,512,512]{2,1,0} get-tuple-element((bf16[416,512,512]{2,1,0}, s8[4194304]{0}) %custom-call.49.0), index=0, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/MultiHeadDotProductAttention_0/...qhd,...khd->...hqk/dot_general[dimension_numbers=(((3,), (3,)), ((0, 2), (0, 2))) precision=None preferred_element_type=bfloat16]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %input_reduce_fusion.6 = f32[52,8,512]{2,1,0} fusion(bf16[416,512,512]{2,1,0} %get-tuple-element.38.0), kind=kInput, calls=%fused_reduce.6, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/MultiHeadDotProductAttention_0/reduce_max[axes=(3,)]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158 deduplicated_name="input_reduce_fusion.6"}
  %input_reduce_fusion.8 = f32[52,8,512]{2,1,0} fusion(f32[52,8,512]{2,1,0} %input_reduce_fusion.6, bf16[416,512,512]{2,1,0} %get-tuple-element.38.0), kind=kInput, calls=%fused_reduce.8, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/MultiHeadDotProductAttention_0/reduce_sum[axes=(3,)]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158 deduplicated_name="input_reduce_fusion.8"}
  %loop_convert_divide_fusion.1 = (bf16[52,8,512]{2,1,0}, f32[52,8,512]{2,1,0}, bf16[52,8,512]{2,1,0}) fusion(f32[52,8,512]{2,1,0} %input_reduce_fusion.8), kind=kLoop, calls=%fused_convert_divide.1
  %get-tuple-element.134 = f32[52,8,512]{2,1,0} get-tuple-element((bf16[52,8,512]{2,1,0}, f32[52,8,512]{2,1,0}, bf16[52,8,512]{2,1,0}) %loop_convert_divide_fusion.1), index=1
  %loop_convert_fusion.9 = bf16[52,8,512,512]{3,2,1,0} fusion(f32[52,8,512]{2,1,0} %input_reduce_fusion.8, f32[52,8,512]{2,1,0} %input_reduce_fusion.6, bf16[416,512,512]{2,1,0} %get-tuple-element.38.0), kind=kLoop, calls=%fused_convert.9
  %bitcast.4598.0 = bf16[416,512,512]{2,1,0} bitcast(bf16[52,8,512,512]{3,2,1,0} %loop_convert_fusion.9)
  %custom-call.50.0 = (bf16[416,32,512]{2,1,0}, s8[4194304]{0}) custom-call(bf16[416,32,512]{2,1,0} %bitcast.4518.0, bf16[416,512,512]{2,1,0} %bitcast.4598.0), custom_call_target="__cublas$gemm", metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/MultiHeadDotProductAttention_0/...hqk,...khd->...qhd/dot_general[dimension_numbers=(((1,), (3,)), ((0, 2), (0, 1))) precision=None preferred_element_type=bfloat16]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}, backend_config={"operation_queue_id":"0","wait_on_operation_queues":[],"gemm_backend_config":{"alpha_real":1,"alpha_imag":0,"beta":0,"dot_dimension_numbers":{"lhs_contracting_dimensions":["2"],"rhs_contracting_dimensions":["2"],"lhs_batch_dimensions":["0"],"rhs_batch_dimensions":["0"]},"precision_config":{"operand_precision":["DEFAULT","DEFAULT"]},"epilogue":"DEFAULT","selected_algorithm":"-1","lhs_stride":"16384","rhs_stride":"262144","grad_x":false,"grad_y":false}}
  %get-tuple-element.39.0 = bf16[416,32,512]{2,1,0} get-tuple-element((bf16[416,32,512]{2,1,0}, s8[4194304]{0}) %custom-call.50.0), index=0, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/MultiHeadDotProductAttention_0/...hqk,...khd->...qhd/dot_general[dimension_numbers=(((1,), (3,)), ((0, 2), (0, 1))) precision=None preferred_element_type=bfloat16]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %input_transpose_fusion.9 = bf16[52,512,8,32]{3,2,1,0} fusion(bf16[416,32,512]{2,1,0} %get-tuple-element.39.0), kind=kInput, calls=%fused_transpose.9, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/MultiHeadDotProductAttention_0/...hqk,...khd->...qhd/transpose[permutation=(0, 3, 1, 2)]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158 deduplicated_name="input_transpose_fusion.8"}
  %bitcast.5978.0 = bf16[26624,256]{1,0} bitcast(bf16[52,512,8,32]{3,2,1,0} %input_transpose_fusion.9)
  %custom-call.51.0 = (bf16[26624,256]{1,0}, s8[4194304]{0}) custom-call(bf16[26624,256]{1,0} %bitcast.5978.0, bf16[256,256]{1,0} %bitcast.4610.0), custom_call_target="__cublas$gemm", metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/MultiHeadDotProductAttention_0/out/dot_general[dimension_numbers=(((2, 3), (0, 1)), ((), ())) precision=None preferred_element_type=None]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}, backend_config={"operation_queue_id":"0","wait_on_operation_queues":[],"gemm_backend_config":{"alpha_real":1,"alpha_imag":0,"beta":0,"dot_dimension_numbers":{"lhs_contracting_dimensions":["1"],"rhs_contracting_dimensions":["0"],"lhs_batch_dimensions":[],"rhs_batch_dimensions":[]},"precision_config":{"operand_precision":["DEFAULT","DEFAULT"]},"epilogue":"DEFAULT","selected_algorithm":"-1","lhs_stride":"6815744","rhs_stride":"65536","grad_x":false,"grad_y":false}}
  %get-tuple-element.40.0 = bf16[26624,256]{1,0} get-tuple-element((bf16[26624,256]{1,0}, s8[4194304]{0}) %custom-call.51.0), index=0, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/MultiHeadDotProductAttention_0/out/dot_general[dimension_numbers=(((2, 3), (0, 1)), ((), ())) precision=None preferred_element_type=None]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %input_transpose_fusion.18 = f32[512,256,52]{2,1,0} fusion(bf16[512,256,52]{2,1,0} %input_transpose_fusion.10, bf16[512,256]{1,0} %Arg_34.35.0, f32[256]{0} %Arg_10.11.0, bf16[26624,256]{1,0} %get-tuple-element.40.0), kind=kInput, calls=%fused_transpose.19, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/add" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=168}
  %input_reduce_fusion.14 = (f32[512,52]{1,0}, f32[512,52]{1,0}) fusion(f32[512,256,52]{2,1,0} %input_transpose_fusion.18), kind=kInput, calls=%fused_reduce.14
  %get-tuple-element.157 = f32[512,52]{1,0} get-tuple-element((f32[512,52]{1,0}, f32[512,52]{1,0}) %input_reduce_fusion.14), index=1
  %get-tuple-element.156 = f32[512,52]{1,0} get-tuple-element((f32[512,52]{1,0}, f32[512,52]{1,0}) %input_reduce_fusion.14), index=0
  %loop_multiply_rsqrt_fusion.3 = (f32[1,512,52]{2,1,0}, f32[512,52]{1,0}) fusion(f32[512,52]{1,0} %get-tuple-element.156, f32[512,52]{1,0} %get-tuple-element.157), kind=kLoop, calls=%fused_multiply_rsqrt.3, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/LayerNorm_1/rsqrt" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171 deduplicated_name="loop_multiply_rsqrt_fusion"}
  %get-tuple-element.154 = f32[1,512,52]{2,1,0} get-tuple-element((f32[1,512,52]{2,1,0}, f32[512,52]{1,0}) %loop_multiply_rsqrt_fusion.3), index=0
  %get-tuple-element.155 = f32[512,52]{1,0} get-tuple-element((f32[1,512,52]{2,1,0}, f32[512,52]{1,0}) %loop_multiply_rsqrt_fusion.3), index=1
  %input_transpose_fusion.20 = bf16[52,512,256]{2,1,0} fusion(f32[256]{0} %Arg_4.5.0, f32[256]{0} %Arg_5.6.0, f32[1,512,52]{2,1,0} %get-tuple-element.154, f32[512,256,52]{2,1,0} %input_transpose_fusion.18, f32[512,52]{1,0} %get-tuple-element.155), kind=kInput, calls=%fused_transpose.21, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/LayerNorm_1/convert_element_type[new_dtype=bfloat16 weak_type=False]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171 deduplicated_name="input_transpose_fusion.20"}
  %bitcast.5917.0 = bf16[26624,256]{1,0} bitcast(bf16[52,512,256]{2,1,0} %input_transpose_fusion.20)
  %custom-call.52.0 = (bf16[26624,256]{1,0}, s8[4194304]{0}) custom-call(bf16[26624,256]{1,0} %bitcast.5917.0, bf16[256,256]{1,0} %wrapped_convert.5), custom_call_target="__cublas$gemm", metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/vmap(vmap(LazyInMLP_0))/Dense_0/dot_general[dimension_numbers=(((2,), (0,)), ((), ())) precision=None preferred_element_type=None]" source_file="/home/nicholas/programs/avid/avid/layers.py" source_line=49}, backend_config={"operation_queue_id":"0","wait_on_operation_queues":[],"gemm_backend_config":{"alpha_real":1,"alpha_imag":0,"beta":0,"dot_dimension_numbers":{"lhs_contracting_dimensions":["1"],"rhs_contracting_dimensions":["0"],"lhs_batch_dimensions":[],"rhs_batch_dimensions":[]},"precision_config":{"operand_precision":["DEFAULT","DEFAULT"]},"epilogue":"DEFAULT","selected_algorithm":"-1","lhs_stride":"6815744","rhs_stride":"65536","grad_x":false,"grad_y":false}}
  %get-tuple-element.41.0 = bf16[26624,256]{1,0} get-tuple-element((bf16[26624,256]{1,0}, s8[4194304]{0}) %custom-call.52.0), index=0, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/vmap(vmap(LazyInMLP_0))/Dense_0/dot_general[dimension_numbers=(((2,), (0,)), ((), ())) precision=None preferred_element_type=None]" source_file="/home/nicholas/programs/avid/avid/layers.py" source_line=49}
  %input_transpose_fusion.17 = f32[512,256,52]{2,1,0} fusion(f32[512,256,52]{2,1,0} %input_transpose_fusion.18, f32[256]{0} %Arg_6.7.0, bf16[26624,256]{1,0} %get-tuple-element.41.0), kind=kInput, calls=%fused_transpose.18, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/add" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=185 deduplicated_name="input_transpose_fusion.15"}
  %input_reduce_fusion.13 = (f32[512,52]{1,0}, f32[512,52]{1,0}) fusion(f32[512,256,52]{2,1,0} %input_transpose_fusion.17), kind=kInput, calls=%fused_reduce.13
  %get-tuple-element.153 = f32[512,52]{1,0} get-tuple-element((f32[512,52]{1,0}, f32[512,52]{1,0}) %input_reduce_fusion.13), index=1
  %get-tuple-element.152 = f32[512,52]{1,0} get-tuple-element((f32[512,52]{1,0}, f32[512,52]{1,0}) %input_reduce_fusion.13), index=0
  %loop_multiply_rsqrt_fusion.2 = (f32[1,512,52]{2,1,0}, f32[512,52]{1,0}) fusion(f32[512,52]{1,0} %get-tuple-element.152, f32[512,52]{1,0} %get-tuple-element.153), kind=kLoop, calls=%fused_multiply_rsqrt.2, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/LayerNorm_0/rsqrt" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156 deduplicated_name="loop_multiply_rsqrt_fusion"}
  %get-tuple-element.150 = f32[1,512,52]{2,1,0} get-tuple-element((f32[1,512,52]{2,1,0}, f32[512,52]{1,0}) %loop_multiply_rsqrt_fusion.2), index=0
  %get-tuple-element.151 = f32[512,52]{1,0} get-tuple-element((f32[1,512,52]{2,1,0}, f32[512,52]{1,0}) %loop_multiply_rsqrt_fusion.2), index=1
  %input_transpose_fusion.21 = bf16[52,512,256]{2,1,0} fusion(f32[256]{0} %Arg_16.17.0, f32[256]{0} %Arg_17.18.0, f32[1,512,52]{2,1,0} %get-tuple-element.150, f32[512,256,52]{2,1,0} %input_transpose_fusion.17, f32[512,52]{1,0} %get-tuple-element.151), kind=kInput, calls=%fused_transpose.22, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/LayerNorm_0/convert_element_type[new_dtype=bfloat16 weak_type=False]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156 deduplicated_name="input_transpose_fusion.20"}
  %bitcast.6219.0 = bf16[26624,256]{1,0} bitcast(bf16[52,512,256]{2,1,0} %input_transpose_fusion.21)
  %custom-call.55.0 = (bf16[26624,256]{1,0}, s8[4194304]{0}) custom-call(bf16[26624,256]{1,0} %bitcast.6219.0, bf16[256,256]{1,0} %bitcast.4830.0), custom_call_target="__cublas$gemm", metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/MultiHeadDotProductAttention_0/key/dot_general[dimension_numbers=(((2,), (0,)), ((), ())) precision=None preferred_element_type=None]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}, backend_config={"operation_queue_id":"0","wait_on_operation_queues":[],"gemm_backend_config":{"alpha_real":1,"alpha_imag":0,"beta":0,"dot_dimension_numbers":{"lhs_contracting_dimensions":["1"],"rhs_contracting_dimensions":["0"],"lhs_batch_dimensions":[],"rhs_batch_dimensions":[]},"precision_config":{"operand_precision":["DEFAULT","DEFAULT"]},"epilogue":"DEFAULT","selected_algorithm":"-1","lhs_stride":"6815744","rhs_stride":"65536","grad_x":false,"grad_y":false}}
  %get-tuple-element.44.0 = bf16[26624,256]{1,0} get-tuple-element((bf16[26624,256]{1,0}, s8[4194304]{0}) %custom-call.55.0), index=0, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/MultiHeadDotProductAttention_0/key/dot_general[dimension_numbers=(((2,), (0,)), ((), ())) precision=None preferred_element_type=None]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %input_transpose_fusion.29 = bf16[52,8,512,32]{3,2,1,0} fusion(f32[8,32]{1,0} %Arg_22.23.0, bf16[26624,256]{1,0} %get-tuple-element.44.0), kind=kInput, calls=%fused_transpose.30, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/MultiHeadDotProductAttention_0/key/add" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158 deduplicated_name="input_transpose_fusion.28"}
  %input_transpose_fusion.11 = bf16[52,8,32,512]{3,2,1,0} fusion(f32[8,32]{1,0} %Arg_22.23.0, bf16[26624,256]{1,0} %get-tuple-element.44.0), kind=kInput, calls=%fused_transpose.12
  %bitcast.4845.0 = bf16[416,32,512]{2,1,0} bitcast(bf16[52,8,32,512]{3,2,1,0} %input_transpose_fusion.11)
  %bitcast.5477.0 = bf16[416,512,32]{2,1,0} bitcast(bf16[52,8,512,32]{3,2,1,0} %input_transpose_fusion.29)
  %custom-call.54.0 = (bf16[26624,256]{1,0}, s8[4194304]{0}) custom-call(bf16[26624,256]{1,0} %bitcast.6219.0, bf16[256,256]{1,0} %bitcast.4804.0), custom_call_target="__cublas$gemm", metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/MultiHeadDotProductAttention_0/query/dot_general[dimension_numbers=(((2,), (0,)), ((), ())) precision=None preferred_element_type=None]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}, backend_config={"operation_queue_id":"0","wait_on_operation_queues":[],"gemm_backend_config":{"alpha_real":1,"alpha_imag":0,"beta":0,"dot_dimension_numbers":{"lhs_contracting_dimensions":["1"],"rhs_contracting_dimensions":["0"],"lhs_batch_dimensions":[],"rhs_batch_dimensions":[]},"precision_config":{"operand_precision":["DEFAULT","DEFAULT"]},"epilogue":"DEFAULT","selected_algorithm":"-1","lhs_stride":"6815744","rhs_stride":"65536","grad_x":false,"grad_y":false}}
  %get-tuple-element.43.0 = bf16[26624,256]{1,0} get-tuple-element((bf16[26624,256]{1,0}, s8[4194304]{0}) %custom-call.54.0), index=0, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/MultiHeadDotProductAttention_0/query/dot_general[dimension_numbers=(((2,), (0,)), ((), ())) precision=None preferred_element_type=None]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %loop_convert_fusion.13 = bf16[52,8,512,32]{3,2,1,0} fusion(f32[8,32]{1,0} %Arg_26.27.0, bf16[26624,256]{1,0} %get-tuple-element.43.0), kind=kLoop, calls=%fused_convert.13
  %bitcast.4823.0 = bf16[416,512,32]{2,1,0} bitcast(bf16[52,8,512,32]{3,2,1,0} %loop_convert_fusion.13)
  %custom-call.53.0 = (bf16[26624,256]{1,0}, s8[4194304]{0}) custom-call(bf16[26624,256]{1,0} %bitcast.6219.0, bf16[256,256]{1,0} %bitcast.4782.0), custom_call_target="__cublas$gemm", metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/MultiHeadDotProductAttention_0/value/dot_general[dimension_numbers=(((2,), (0,)), ((), ())) precision=None preferred_element_type=None]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}, backend_config={"operation_queue_id":"0","wait_on_operation_queues":[],"gemm_backend_config":{"alpha_real":1,"alpha_imag":0,"beta":0,"dot_dimension_numbers":{"lhs_contracting_dimensions":["1"],"rhs_contracting_dimensions":["0"],"lhs_batch_dimensions":[],"rhs_batch_dimensions":[]},"precision_config":{"operand_precision":["DEFAULT","DEFAULT"]},"epilogue":"DEFAULT","selected_algorithm":"-1","lhs_stride":"6815744","rhs_stride":"65536","grad_x":false,"grad_y":false}}
  %get-tuple-element.42.0 = bf16[26624,256]{1,0} get-tuple-element((bf16[26624,256]{1,0}, s8[4194304]{0}) %custom-call.53.0), index=0, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/MultiHeadDotProductAttention_0/value/dot_general[dimension_numbers=(((2,), (0,)), ((), ())) precision=None preferred_element_type=None]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %input_transpose_fusion.12 = bf16[52,8,32,512]{3,2,1,0} fusion(f32[8,32]{1,0} %Arg_28.29.0, bf16[26624,256]{1,0} %get-tuple-element.42.0), kind=kInput, calls=%fused_transpose.13
  %bitcast.4797.0 = bf16[416,32,512]{2,1,0} bitcast(bf16[52,8,32,512]{3,2,1,0} %input_transpose_fusion.12)
  %custom-call.56.0 = (bf16[416,512,512]{2,1,0}, s8[4194304]{0}) custom-call(bf16[416,512,32]{2,1,0} %bitcast.4823.0, bf16[416,32,512]{2,1,0} %bitcast.4845.0), custom_call_target="__cublas$gemm", metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/MultiHeadDotProductAttention_0/...qhd,...khd->...hqk/dot_general[dimension_numbers=(((3,), (3,)), ((0, 2), (0, 2))) precision=None preferred_element_type=bfloat16]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}, backend_config={"operation_queue_id":"0","wait_on_operation_queues":[],"gemm_backend_config":{"alpha_real":1,"alpha_imag":0,"beta":0,"dot_dimension_numbers":{"lhs_contracting_dimensions":["2"],"rhs_contracting_dimensions":["1"],"lhs_batch_dimensions":["0"],"rhs_batch_dimensions":["0"]},"precision_config":{"operand_precision":["DEFAULT","DEFAULT"]},"epilogue":"DEFAULT","selected_algorithm":"-1","lhs_stride":"16384","rhs_stride":"16384","grad_x":false,"grad_y":false}}
  %get-tuple-element.45.0 = bf16[416,512,512]{2,1,0} get-tuple-element((bf16[416,512,512]{2,1,0}, s8[4194304]{0}) %custom-call.56.0), index=0, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/MultiHeadDotProductAttention_0/...qhd,...khd->...hqk/dot_general[dimension_numbers=(((3,), (3,)), ((0, 2), (0, 2))) precision=None preferred_element_type=bfloat16]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %input_reduce_fusion.7 = f32[52,8,512]{2,1,0} fusion(bf16[416,512,512]{2,1,0} %get-tuple-element.45.0), kind=kInput, calls=%fused_reduce.7, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/MultiHeadDotProductAttention_0/reduce_max[axes=(3,)]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158 deduplicated_name="input_reduce_fusion.6"}
  %input_reduce_fusion.9 = f32[52,8,512]{2,1,0} fusion(f32[52,8,512]{2,1,0} %input_reduce_fusion.7, bf16[416,512,512]{2,1,0} %get-tuple-element.45.0), kind=kInput, calls=%fused_reduce.9, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/MultiHeadDotProductAttention_0/reduce_sum[axes=(3,)]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158 deduplicated_name="input_reduce_fusion.8"}
  %loop_convert_divide_fusion = (bf16[52,8,512]{2,1,0}, f32[52,8,512]{2,1,0}, bf16[52,8,512]{2,1,0}) fusion(f32[52,8,512]{2,1,0} %input_reduce_fusion.9), kind=kLoop, calls=%fused_convert_divide
  %get-tuple-element.132 = f32[52,8,512]{2,1,0} get-tuple-element((bf16[52,8,512]{2,1,0}, f32[52,8,512]{2,1,0}, bf16[52,8,512]{2,1,0}) %loop_convert_divide_fusion), index=1
  %loop_convert_fusion.10 = bf16[52,8,512,512]{3,2,1,0} fusion(f32[52,8,512]{2,1,0} %input_reduce_fusion.9, f32[52,8,512]{2,1,0} %input_reduce_fusion.7, bf16[416,512,512]{2,1,0} %get-tuple-element.45.0), kind=kLoop, calls=%fused_convert.10
  %bitcast.4878.0 = bf16[416,512,512]{2,1,0} bitcast(bf16[52,8,512,512]{3,2,1,0} %loop_convert_fusion.10)
  %custom-call.57.0 = (bf16[416,32,512]{2,1,0}, s8[4194304]{0}) custom-call(bf16[416,32,512]{2,1,0} %bitcast.4797.0, bf16[416,512,512]{2,1,0} %bitcast.4878.0), custom_call_target="__cublas$gemm", metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/MultiHeadDotProductAttention_0/...hqk,...khd->...qhd/dot_general[dimension_numbers=(((1,), (3,)), ((0, 2), (0, 1))) precision=None preferred_element_type=bfloat16]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}, backend_config={"operation_queue_id":"0","wait_on_operation_queues":[],"gemm_backend_config":{"alpha_real":1,"alpha_imag":0,"beta":0,"dot_dimension_numbers":{"lhs_contracting_dimensions":["2"],"rhs_contracting_dimensions":["2"],"lhs_batch_dimensions":["0"],"rhs_batch_dimensions":["0"]},"precision_config":{"operand_precision":["DEFAULT","DEFAULT"]},"epilogue":"DEFAULT","selected_algorithm":"-1","lhs_stride":"16384","rhs_stride":"262144","grad_x":false,"grad_y":false}}
  %get-tuple-element.46.0 = bf16[416,32,512]{2,1,0} get-tuple-element((bf16[416,32,512]{2,1,0}, s8[4194304]{0}) %custom-call.57.0), index=0, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/MultiHeadDotProductAttention_0/...hqk,...khd->...qhd/dot_general[dimension_numbers=(((1,), (3,)), ((0, 2), (0, 1))) precision=None preferred_element_type=bfloat16]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %input_transpose_fusion.8 = bf16[52,512,8,32]{3,2,1,0} fusion(bf16[416,32,512]{2,1,0} %get-tuple-element.46.0), kind=kInput, calls=%fused_transpose.8, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/MultiHeadDotProductAttention_0/...hqk,...khd->...qhd/transpose[permutation=(0, 3, 1, 2)]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158 deduplicated_name="input_transpose_fusion.8"}
  %bitcast.6166.0 = bf16[26624,256]{1,0} bitcast(bf16[52,512,8,32]{3,2,1,0} %input_transpose_fusion.8)
  %custom-call.58.0 = (bf16[26624,256]{1,0}, s8[4194304]{0}) custom-call(bf16[26624,256]{1,0} %bitcast.6166.0, bf16[256,256]{1,0} %bitcast.4890.0), custom_call_target="__cublas$gemm", metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/MultiHeadDotProductAttention_0/out/dot_general[dimension_numbers=(((2, 3), (0, 1)), ((), ())) precision=None preferred_element_type=None]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}, backend_config={"operation_queue_id":"0","wait_on_operation_queues":[],"gemm_backend_config":{"alpha_real":1,"alpha_imag":0,"beta":0,"dot_dimension_numbers":{"lhs_contracting_dimensions":["1"],"rhs_contracting_dimensions":["0"],"lhs_batch_dimensions":[],"rhs_batch_dimensions":[]},"precision_config":{"operand_precision":["DEFAULT","DEFAULT"]},"epilogue":"DEFAULT","selected_algorithm":"-1","lhs_stride":"6815744","rhs_stride":"65536","grad_x":false,"grad_y":false}}
  %get-tuple-element.47.0 = bf16[26624,256]{1,0} get-tuple-element((bf16[26624,256]{1,0}, s8[4194304]{0}) %custom-call.58.0), index=0, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/MultiHeadDotProductAttention_0/out/dot_general[dimension_numbers=(((2, 3), (0, 1)), ((), ())) precision=None preferred_element_type=None]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %input_transpose_fusion.16 = f32[512,256,52]{2,1,0} fusion(f32[512,256,52]{2,1,0} %input_transpose_fusion.17, f32[256]{0} %Arg_24.25.0, bf16[26624,256]{1,0} %get-tuple-element.47.0), kind=kInput, calls=%fused_transpose.17, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/add" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=168}
  %input_reduce_fusion.12 = (f32[512,52]{1,0}, f32[512,52]{1,0}) fusion(f32[512,256,52]{2,1,0} %input_transpose_fusion.16), kind=kInput, calls=%fused_reduce.12
  %get-tuple-element.148 = f32[512,52]{1,0} get-tuple-element((f32[512,52]{1,0}, f32[512,52]{1,0}) %input_reduce_fusion.12), index=1
  %get-tuple-element.147 = f32[512,52]{1,0} get-tuple-element((f32[512,52]{1,0}, f32[512,52]{1,0}) %input_reduce_fusion.12), index=0
  %loop_multiply_rsqrt_fusion.1 = (f32[1,512,52]{2,1,0}, f32[512,52]{1,0}) fusion(f32[512,52]{1,0} %get-tuple-element.147, f32[512,52]{1,0} %get-tuple-element.148), kind=kLoop, calls=%fused_multiply_rsqrt.1, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/LayerNorm_1/rsqrt" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171 deduplicated_name="loop_multiply_rsqrt_fusion"}
  %get-tuple-element.145 = f32[1,512,52]{2,1,0} get-tuple-element((f32[1,512,52]{2,1,0}, f32[512,52]{1,0}) %loop_multiply_rsqrt_fusion.1), index=0
  %get-tuple-element.146 = f32[512,52]{1,0} get-tuple-element((f32[1,512,52]{2,1,0}, f32[512,52]{1,0}) %loop_multiply_rsqrt_fusion.1), index=1
  %input_transpose_fusion.22 = bf16[52,512,256]{2,1,0} fusion(f32[256]{0} %Arg_18.19.0, f32[256]{0} %Arg_19.20.0, f32[1,512,52]{2,1,0} %get-tuple-element.145, f32[512,256,52]{2,1,0} %input_transpose_fusion.16, f32[512,52]{1,0} %get-tuple-element.146), kind=kInput, calls=%fused_transpose.23, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/LayerNorm_1/convert_element_type[new_dtype=bfloat16 weak_type=False]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171 deduplicated_name="input_transpose_fusion.20"}
  %bitcast.6105.0 = bf16[26624,256]{1,0} bitcast(bf16[52,512,256]{2,1,0} %input_transpose_fusion.22)
  %custom-call.59.0 = (bf16[26624,256]{1,0}, s8[4194304]{0}) custom-call(bf16[26624,256]{1,0} %bitcast.6105.0, bf16[256,256]{1,0} %wrapped_convert.10), custom_call_target="__cublas$gemm", metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/vmap(vmap(LazyInMLP_0))/Dense_0/dot_general[dimension_numbers=(((2,), (0,)), ((), ())) precision=None preferred_element_type=None]" source_file="/home/nicholas/programs/avid/avid/layers.py" source_line=49}, backend_config={"operation_queue_id":"0","wait_on_operation_queues":[],"gemm_backend_config":{"alpha_real":1,"alpha_imag":0,"beta":0,"dot_dimension_numbers":{"lhs_contracting_dimensions":["1"],"rhs_contracting_dimensions":["0"],"lhs_batch_dimensions":[],"rhs_batch_dimensions":[]},"precision_config":{"operand_precision":["DEFAULT","DEFAULT"]},"epilogue":"DEFAULT","selected_algorithm":"-1","lhs_stride":"6815744","rhs_stride":"65536","grad_x":false,"grad_y":false}}
  %get-tuple-element.48.0 = bf16[26624,256]{1,0} get-tuple-element((bf16[26624,256]{1,0}, s8[4194304]{0}) %custom-call.59.0), index=0, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/vmap(vmap(LazyInMLP_0))/Dense_0/dot_general[dimension_numbers=(((2,), (0,)), ((), ())) precision=None preferred_element_type=None]" source_file="/home/nicholas/programs/avid/avid/layers.py" source_line=49}
  %input_transpose_fusion.15 = f32[512,256,52]{2,1,0} fusion(f32[512,256,52]{2,1,0} %input_transpose_fusion.16, f32[256]{0} %Arg_20.21.0, bf16[26624,256]{1,0} %get-tuple-element.48.0), kind=kInput, calls=%fused_transpose.16, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/add" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=185 deduplicated_name="input_transpose_fusion.15"}
  %input_reduce_fusion.11 = (f32[512,52]{1,0}, f32[512,52]{1,0}) fusion(f32[512,256,52]{2,1,0} %input_transpose_fusion.15), kind=kInput, calls=%fused_reduce.11
  %get-tuple-element.144 = f32[512,52]{1,0} get-tuple-element((f32[512,52]{1,0}, f32[512,52]{1,0}) %input_reduce_fusion.11), index=1
  %get-tuple-element.143 = f32[512,52]{1,0} get-tuple-element((f32[512,52]{1,0}, f32[512,52]{1,0}) %input_reduce_fusion.11), index=0
  %loop_multiply_rsqrt_fusion = (f32[1,512,52]{2,1,0}, f32[512,52]{1,0}) fusion(f32[512,52]{1,0} %get-tuple-element.143, f32[512,52]{1,0} %get-tuple-element.144), kind=kLoop, calls=%fused_multiply_rsqrt, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoder_norm/rsqrt" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=228 deduplicated_name="loop_multiply_rsqrt_fusion"}
  %get-tuple-element.141 = f32[1,512,52]{2,1,0} get-tuple-element((f32[1,512,52]{2,1,0}, f32[512,52]{1,0}) %loop_multiply_rsqrt_fusion), index=0
  %get-tuple-element.142 = f32[512,52]{1,0} get-tuple-element((f32[1,512,52]{2,1,0}, f32[512,52]{1,0}) %loop_multiply_rsqrt_fusion), index=1
  %input_reduce_fusion.15 = f32[256,52]{1,0} fusion(f32[256]{0} %Arg_1.2.0, f32[1,512,52]{2,1,0} %get-tuple-element.141, f32[256]{0} %Arg_0.1.0, f32[512,256,52]{2,1,0} %input_transpose_fusion.15, f32[512,52]{1,0} %get-tuple-element.142), kind=kInput, calls=%fused_reduce.15
  %input_reduce_fusion.38 = f32[52]{0} fusion(f32[256,52]{1,0} %input_reduce_fusion.15, f32[256,1]{1,0} %Arg_31.32.0), kind=kInput, calls=%fused_reduce.38
  %input_reduce_fusion.37 = f32[] fusion(bf16[52]{0} %constant_222_0, f32[52]{0} %input_reduce_fusion.38, f32[1]{0} %Arg_30.31.0), kind=kInput, calls=%fused_reduce.37, metadata={op_name="jit(loss)/jit(main)/jvp(cond)/branch_1_fun/reduce_sum[axes=(0, 1)]" source_file="/home/nicholas/programs/avid/avid/config.py" source_line=380}
  %loop_convert_fusion.15 = bf16[] fusion(f32[] %input_reduce_fusion.37), kind=kLoop, calls=%fused_convert.15
  %input_reduce_fusion = f32[1]{0} fusion(f32[] %input_reduce_fusion.37, bf16[52]{0} %constant_222_0, f32[52]{0} %input_reduce_fusion.38, f32[1]{0} %Arg_30.31.0), kind=kInput, calls=%fused_reduce, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/vmap(head)/Dense_0/convert_element_type[new_dtype=float32 weak_type=False]" source_file="/home/nicholas/programs/avid/avid/layers.py" source_line=49}
  %input_multiply_reduce_fusion = (f32[256,1]{1,0}, f32[256,52]{1,0}) fusion(f32[256,52]{1,0} %input_reduce_fusion.15, f32[] %input_reduce_fusion.37, bf16[52]{0} %constant_222_0, f32[52]{0} %input_reduce_fusion.38, f32[1]{0} %Arg_30.31.0, /*index=5*/f32[256,1]{1,0} %Arg_31.32.0), kind=kInput, calls=%fused_multiply_reduce, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/vmap(head)/Dense_0/convert_element_type[new_dtype=float32 weak_type=False]" source_file="/home/nicholas/programs/avid/avid/layers.py" source_line=49}
  %get-tuple-element.140 = f32[256,52]{1,0} get-tuple-element((f32[256,1]{1,0}, f32[256,52]{1,0}) %input_multiply_reduce_fusion), index=1
  %get-tuple-element.139 = f32[256,1]{1,0} get-tuple-element((f32[256,1]{1,0}, f32[256,52]{1,0}) %input_multiply_reduce_fusion), index=0
  %input_reduce_fusion.36 = (f32[512,52]{1,0}, f32[512,52]{1,0}) fusion(f32[256]{0} %Arg_1.2.0, f32[1,512,52]{2,1,0} %get-tuple-element.141, f32[256,52]{1,0} %get-tuple-element.140, f32[512,256,52]{2,1,0} %input_transpose_fusion.15, f32[512,52]{1,0} %get-tuple-element.142), kind=kInput, calls=%fused_reduce.36, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoder_norm/neg" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=228}
  %get-tuple-element.138 = f32[512,52]{1,0} get-tuple-element((f32[512,52]{1,0}, f32[512,52]{1,0}) %input_reduce_fusion.36), index=1
  %get-tuple-element.137 = f32[512,52]{1,0} get-tuple-element((f32[512,52]{1,0}, f32[512,52]{1,0}) %input_reduce_fusion.36), index=0
  %loop_multiply_fusion = (f32[512,52]{1,0}, f32[512,52]{1,0}) fusion(f32[1,512,52]{2,1,0} %get-tuple-element.141, f32[512,52]{1,0} %get-tuple-element.142, f32[512,52]{1,0} %get-tuple-element.143, f32[512,52]{1,0} %get-tuple-element.138, f32[512,52]{1,0} %get-tuple-element.137, /*index=5*/f32[512,52]{1,0} %get-tuple-element.144), kind=kLoop, calls=%fused_multiply, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoder_norm/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=228 deduplicated_name="loop_multiply_fusion"}
  %get-tuple-element.130 = f32[512,52]{1,0} get-tuple-element((f32[512,52]{1,0}, f32[512,52]{1,0}) %loop_multiply_fusion), index=1
  %get-tuple-element.129 = f32[512,52]{1,0} get-tuple-element((f32[512,52]{1,0}, f32[512,52]{1,0}) %loop_multiply_fusion), index=0
  %input_reduce_fusion.10 = (f32[512,256]{1,0}, f32[512,256]{1,0}) fusion(f32[256,52]{1,0} %get-tuple-element.140, f32[512,256,52]{2,1,0} %input_transpose_fusion.15, f32[512,52]{1,0} %get-tuple-element.142, f32[1,512,52]{2,1,0} %get-tuple-element.141), kind=kInput, calls=%fused_reduce.10
  %get-tuple-element.136 = f32[512,256]{1,0} get-tuple-element((f32[512,256]{1,0}, f32[512,256]{1,0}) %input_reduce_fusion.10), index=1
  %get-tuple-element.135 = f32[512,256]{1,0} get-tuple-element((f32[512,256]{1,0}, f32[512,256]{1,0}) %input_reduce_fusion.10), index=0
  %input_add_transpose_fusion.4 = (bf16[52,512,256]{2,1,0}, f32[512,256,52]{2,1,0}) fusion(f32[512,52]{1,0} %get-tuple-element.130, f32[512,256,52]{2,1,0} %input_transpose_fusion.15, f32[512,52]{1,0} %get-tuple-element.129, f32[256]{0} %Arg_1.2.0, f32[1,512,52]{2,1,0} %get-tuple-element.141, /*index=5*/f32[256,52]{1,0} %get-tuple-element.140), kind=kInput, calls=%fused_add_transpose.4, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoder_norm/add_any" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=228}
  %get-tuple-element.128 = f32[512,256,52]{2,1,0} get-tuple-element((bf16[52,512,256]{2,1,0}, f32[512,256,52]{2,1,0}) %input_add_transpose_fusion.4), index=1
  %get-tuple-element.127 = bf16[52,512,256]{2,1,0} get-tuple-element((bf16[52,512,256]{2,1,0}, f32[512,256,52]{2,1,0}) %input_add_transpose_fusion.4), index=0
  %bitcast.5257.0 = bf16[26624,256]{1,0} bitcast(bf16[52,512,256]{2,1,0} %get-tuple-element.127)
  %input_reduce_fusion.31 = f32[512,256]{1,0} fusion(f32[512,256,52]{2,1,0} %get-tuple-element.128), kind=kInput, calls=%fused_reduce.31
  %custom-call.60.0 = (bf16[26624,256]{1,0}, s8[4194304]{0}) custom-call(bf16[26624,256]{1,0} %bitcast.5257.0, bf16[256,256]{1,0} %wrapped_convert.10), custom_call_target="__cublas$gemm", metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/vmap(vmap(LazyInMLP_0))/Dense_0/dot_general[dimension_numbers=(((2,), (1,)), ((), ())) precision=None preferred_element_type=None]" source_file="/home/nicholas/programs/avid/avid/layers.py" source_line=49}, backend_config={"operation_queue_id":"0","wait_on_operation_queues":[],"gemm_backend_config":{"alpha_real":1,"alpha_imag":0,"beta":0,"dot_dimension_numbers":{"lhs_contracting_dimensions":["1"],"rhs_contracting_dimensions":["1"],"lhs_batch_dimensions":[],"rhs_batch_dimensions":[]},"precision_config":{"operand_precision":["DEFAULT","DEFAULT"]},"epilogue":"DEFAULT","selected_algorithm":"-1","lhs_stride":"6815744","rhs_stride":"65536","grad_x":false,"grad_y":false}}
  %get-tuple-element.49.0 = bf16[26624,256]{1,0} get-tuple-element((bf16[26624,256]{1,0}, s8[4194304]{0}) %custom-call.60.0), index=0, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/vmap(vmap(LazyInMLP_0))/Dense_0/dot_general[dimension_numbers=(((2,), (1,)), ((), ())) precision=None preferred_element_type=None]" source_file="/home/nicholas/programs/avid/avid/layers.py" source_line=49}
  %input_reduce_fusion.1 = f32[208,256]{1,0} fusion(bf16[26624,256]{1,0} %get-tuple-element.49.0), kind=kInput, calls=%fused_reduce.1, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/LayerNorm_1/reduce_sum[axes=(0, 1)]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171 deduplicated_name="input_reduce_fusion.1"}
  %input_transpose_fusion.7 = f32[512,256,52]{2,1,0} fusion(bf16[26624,256]{1,0} %get-tuple-element.49.0), kind=kInput, calls=%fused_transpose.7, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/LayerNorm_1/convert_element_type[new_dtype=float32 weak_type=False]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171 deduplicated_name="input_transpose_fusion.3"}
  %input_reduce_fusion.22 = (f32[512,52]{1,0}, f32[512,52]{1,0}) fusion(f32[256]{0} %Arg_19.20.0, f32[512,256,52]{2,1,0} %input_transpose_fusion.7, f32[512,256,52]{2,1,0} %input_transpose_fusion.16, f32[512,52]{1,0} %get-tuple-element.146, f32[1,512,52]{2,1,0} %get-tuple-element.145), kind=kInput, calls=%fused_reduce.22
  %get-tuple-element.126 = f32[512,52]{1,0} get-tuple-element((f32[512,52]{1,0}, f32[512,52]{1,0}) %input_reduce_fusion.22), index=1
  %get-tuple-element.125 = f32[512,52]{1,0} get-tuple-element((f32[512,52]{1,0}, f32[512,52]{1,0}) %input_reduce_fusion.22), index=0
  %loop_multiply_fusion.1 = (f32[512,52]{1,0}, f32[512,52]{1,0}) fusion(f32[1,512,52]{2,1,0} %get-tuple-element.145, f32[512,52]{1,0} %get-tuple-element.146, f32[512,52]{1,0} %get-tuple-element.147, f32[512,52]{1,0} %get-tuple-element.125, f32[512,52]{1,0} %get-tuple-element.126, /*index=5*/f32[512,52]{1,0} %get-tuple-element.148), kind=kLoop, calls=%fused_multiply.1, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/LayerNorm_1/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171 deduplicated_name="loop_multiply_fusion"}
  %get-tuple-element.124 = f32[512,52]{1,0} get-tuple-element((f32[512,52]{1,0}, f32[512,52]{1,0}) %loop_multiply_fusion.1), index=1
  %get-tuple-element.123 = f32[512,52]{1,0} get-tuple-element((f32[512,52]{1,0}, f32[512,52]{1,0}) %loop_multiply_fusion.1), index=0
  %input_reduce_fusion.16 = f32[512,256]{1,0} fusion(f32[1,512,52]{2,1,0} %get-tuple-element.145, f32[512,256,52]{2,1,0} %input_transpose_fusion.7, f32[512,256,52]{2,1,0} %input_transpose_fusion.16, f32[512,52]{1,0} %get-tuple-element.146), kind=kInput, calls=%fused_reduce.16
  %input_add_transpose_fusion.3 = (bf16[52,512,256]{2,1,0}, f32[512,256,52]{2,1,0}) fusion(f32[512,52]{1,0} %get-tuple-element.124, f32[512,256,52]{2,1,0} %input_transpose_fusion.16, f32[512,52]{1,0} %get-tuple-element.123, f32[512,256,52]{2,1,0} %get-tuple-element.128, f32[512,256,52]{2,1,0} %input_transpose_fusion.7, /*index=5*/f32[256]{0} %Arg_19.20.0, f32[1,512,52]{2,1,0} %get-tuple-element.145), kind=kInput, calls=%fused_add_transpose.3, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/LayerNorm_1/add_any" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171 deduplicated_name="input_add_transpose_fusion.1"}
  %input_transpose_fusion.27 = bf16[256,52,512]{2,1,0} fusion(f32[512,256,52]{2,1,0} %get-tuple-element.128), kind=kInput, calls=%fused_transpose.28, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=183 deduplicated_name="input_transpose_fusion.23"}
  %get-tuple-element.122 = f32[512,256,52]{2,1,0} get-tuple-element((bf16[52,512,256]{2,1,0}, f32[512,256,52]{2,1,0}) %input_add_transpose_fusion.3), index=1
  %get-tuple-element.121 = bf16[52,512,256]{2,1,0} get-tuple-element((bf16[52,512,256]{2,1,0}, f32[512,256,52]{2,1,0}) %input_add_transpose_fusion.3), index=0
  %bitcast.5370.0 = bf16[26624,256]{1,0} bitcast(bf16[52,512,256]{2,1,0} %get-tuple-element.121)
  %bitcast.6110.0 = bf16[256,26624]{1,0} bitcast(bf16[256,52,512]{2,1,0} %input_transpose_fusion.27)
  %custom-call.81.0 = (bf16[256,256]{1,0}, s8[4194304]{0}) custom-call(bf16[26624,256]{1,0} %bitcast.6105.0, bf16[256,26624]{1,0} %bitcast.6110.0), custom_call_target="__cublas$gemm", metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/vmap(vmap(LazyInMLP_0))/Dense_0/transpose[permutation=(1, 0)]" source_file="/home/nicholas/programs/avid/avid/layers.py" source_line=49}, backend_config={"operation_queue_id":"0","wait_on_operation_queues":[],"gemm_backend_config":{"alpha_real":1,"alpha_imag":0,"beta":0,"dot_dimension_numbers":{"lhs_contracting_dimensions":["0"],"rhs_contracting_dimensions":["1"],"lhs_batch_dimensions":[],"rhs_batch_dimensions":[]},"precision_config":{"operand_precision":["DEFAULT","DEFAULT"]},"epilogue":"DEFAULT","selected_algorithm":"-1","lhs_stride":"6815744","rhs_stride":"6815744","grad_x":false,"grad_y":false}}
  %get-tuple-element.72.0 = bf16[256,256]{1,0} get-tuple-element((bf16[256,256]{1,0}, s8[4194304]{0}) %custom-call.81.0), index=0, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/vmap(vmap(LazyInMLP_0))/Dense_0/transpose[permutation=(1, 0)]" source_file="/home/nicholas/programs/avid/avid/layers.py" source_line=49}
  %input_reduce_fusion.32 = f32[512,256]{1,0} fusion(f32[512,256,52]{2,1,0} %get-tuple-element.122), kind=kInput, calls=%fused_reduce.32
  %custom-call.61.0 = (bf16[26624,256]{1,0}, s8[4194304]{0}) custom-call(bf16[26624,256]{1,0} %bitcast.5370.0, bf16[256,256]{0,1} %bitcast.5374.0), custom_call_target="__cublas$gemm", metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/MultiHeadDotProductAttention_0/out/dot_general[dimension_numbers=(((2,), (2,)), ((), ())) precision=None preferred_element_type=None]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}, backend_config={"operation_queue_id":"0","wait_on_operation_queues":[],"gemm_backend_config":{"alpha_real":1,"alpha_imag":0,"beta":0,"dot_dimension_numbers":{"lhs_contracting_dimensions":["1"],"rhs_contracting_dimensions":["0"],"lhs_batch_dimensions":[],"rhs_batch_dimensions":[]},"precision_config":{"operand_precision":["DEFAULT","DEFAULT"]},"epilogue":"DEFAULT","selected_algorithm":"-1","lhs_stride":"6815744","rhs_stride":"65536","grad_x":false,"grad_y":false}}
  %get-tuple-element.50.0 = bf16[26624,256]{1,0} get-tuple-element((bf16[26624,256]{1,0}, s8[4194304]{0}) %custom-call.61.0), index=0, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/MultiHeadDotProductAttention_0/out/dot_general[dimension_numbers=(((2,), (2,)), ((), ())) precision=None preferred_element_type=None]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %input_transpose_fusion.26 = bf16[256,52,512]{2,1,0} fusion(f32[512,256,52]{2,1,0} %get-tuple-element.122), kind=kInput, calls=%fused_transpose.27, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=167 deduplicated_name="input_transpose_fusion.23"}
  %bitcast.6164.0 = bf16[256,26624]{1,0} bitcast(bf16[256,52,512]{2,1,0} %input_transpose_fusion.26)
  %custom-call.83.0 = (bf16[256,256]{0,1}, s8[4194304]{0}) custom-call(bf16[256,26624]{1,0} %bitcast.6164.0, bf16[26624,256]{1,0} %bitcast.6166.0), custom_call_target="__cublas$gemm", metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/MultiHeadDotProductAttention_0/out/dot_general[dimension_numbers=(((0, 1), (0, 1)), ((), ())) precision=None preferred_element_type=None]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}, backend_config={"operation_queue_id":"0","wait_on_operation_queues":[],"gemm_backend_config":{"alpha_real":1,"alpha_imag":0,"beta":0,"dot_dimension_numbers":{"lhs_contracting_dimensions":["1"],"rhs_contracting_dimensions":["0"],"lhs_batch_dimensions":[],"rhs_batch_dimensions":[]},"precision_config":{"operand_precision":["DEFAULT","DEFAULT"]},"epilogue":"DEFAULT","selected_algorithm":"-1","lhs_stride":"6815744","rhs_stride":"6815744","grad_x":false,"grad_y":false}}
  %get-tuple-element.74.0 = bf16[256,256]{0,1} get-tuple-element((bf16[256,256]{0,1}, s8[4194304]{0}) %custom-call.83.0), index=0, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/MultiHeadDotProductAttention_0/out/dot_general[dimension_numbers=(((0, 1), (0, 1)), ((), ())) precision=None preferred_element_type=None]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %loop_convert_fusion.3 = f32[8,32,256]{2,1,0} fusion(bf16[256,256]{0,1} %get-tuple-element.74.0), kind=kLoop, calls=%fused_convert.3, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/MultiHeadDotProductAttention_0/out/convert_element_type[new_dtype=float32 weak_type=False]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158 deduplicated_name="loop_convert_fusion.3"}
  %input_transpose_fusion.6 = (bf16[52,8,512,32]{3,2,1,0}, bf16[52,8,32,512]{3,2,1,0}) fusion(bf16[26624,256]{1,0} %get-tuple-element.50.0), kind=kInput, calls=%fused_transpose.6, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/MultiHeadDotProductAttention_0/...hqk,...khd->...qhd/transpose[permutation=(0, 2, 3, 1)]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158 deduplicated_name="input_transpose_fusion.2"}
  %get-tuple-element.120 = bf16[52,8,32,512]{3,2,1,0} get-tuple-element((bf16[52,8,512,32]{3,2,1,0}, bf16[52,8,32,512]{3,2,1,0}) %input_transpose_fusion.6), index=1
  %get-tuple-element.119 = bf16[52,8,512,32]{3,2,1,0} get-tuple-element((bf16[52,8,512,32]{3,2,1,0}, bf16[52,8,32,512]{3,2,1,0}) %input_transpose_fusion.6), index=0
  %bitcast.5403.0 = bf16[416,512,32]{2,1,0} bitcast(bf16[52,8,512,32]{3,2,1,0} %get-tuple-element.119)
  %bitcast.5381.0 = bf16[416,32,512]{2,1,0} bitcast(bf16[52,8,32,512]{3,2,1,0} %get-tuple-element.120)
  %custom-call.62.0 = (bf16[416,32,512]{2,1,0}, s8[4194304]{0}) custom-call(bf16[416,32,512]{2,1,0} %bitcast.5381.0, bf16[416,512,512]{2,1,0} %bitcast.4878.0), custom_call_target="__cublas$gemm", metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/MultiHeadDotProductAttention_0/...hqk,...khd->...qhd/dot_general[dimension_numbers=(((3,), (2,)), ((0, 1), (0, 1))) precision=None preferred_element_type=bfloat16]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}, backend_config={"operation_queue_id":"0","wait_on_operation_queues":[],"gemm_backend_config":{"alpha_real":1,"alpha_imag":0,"beta":0,"dot_dimension_numbers":{"lhs_contracting_dimensions":["2"],"rhs_contracting_dimensions":["1"],"lhs_batch_dimensions":["0"],"rhs_batch_dimensions":["0"]},"precision_config":{"operand_precision":["DEFAULT","DEFAULT"]},"epilogue":"DEFAULT","selected_algorithm":"-1","lhs_stride":"16384","rhs_stride":"262144","grad_x":false,"grad_y":false}}
  %get-tuple-element.51.0 = bf16[416,32,512]{2,1,0} get-tuple-element((bf16[416,32,512]{2,1,0}, s8[4194304]{0}) %custom-call.62.0), index=0, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/MultiHeadDotProductAttention_0/...hqk,...khd->...qhd/dot_general[dimension_numbers=(((3,), (2,)), ((0, 1), (0, 1))) precision=None preferred_element_type=bfloat16]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %input_reduce_fusion.23 = f32[52,8,32]{2,1,0} fusion(bf16[416,32,512]{2,1,0} %get-tuple-element.51.0), kind=kInput, calls=%fused_reduce.23
  %input_reduce_fusion.33 = f32[8,32]{1,0} fusion(f32[52,8,32]{2,1,0} %input_reduce_fusion.23), kind=kInput, calls=%fused_reduce.33, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/MultiHeadDotProductAttention_0/value/reduce_sum[axes=(0, 1)]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %input_transpose_fusion.5 = (bf16[8,32,52,512]{3,2,1,0}, bf16[52,512,8,32]{3,2,1,0}) fusion(bf16[416,32,512]{2,1,0} %get-tuple-element.51.0), kind=kInput, calls=%fused_transpose.5, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/MultiHeadDotProductAttention_0/...hqk,...khd->...qhd/transpose[permutation=(0, 3, 1, 2)]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158 deduplicated_name="input_transpose_fusion.1"}
  %get-tuple-element.115 = bf16[52,512,8,32]{3,2,1,0} get-tuple-element((bf16[8,32,52,512]{3,2,1,0}, bf16[52,512,8,32]{3,2,1,0}) %input_transpose_fusion.5), index=1
  %get-tuple-element.114 = bf16[8,32,52,512]{3,2,1,0} get-tuple-element((bf16[8,32,52,512]{3,2,1,0}, bf16[52,512,8,32]{3,2,1,0}) %input_transpose_fusion.5), index=0
  %bitcast.6217.0 = bf16[256,26624]{1,0} bitcast(bf16[8,32,52,512]{3,2,1,0} %get-tuple-element.114)
  %custom-call.85.0 = (bf16[256,256]{0,1}, s8[4194304]{0}) custom-call(bf16[256,26624]{1,0} %bitcast.6217.0, bf16[26624,256]{1,0} %bitcast.6219.0), custom_call_target="__cublas$gemm", metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/MultiHeadDotProductAttention_0/value/dot_general[dimension_numbers=(((0, 1), (0, 1)), ((), ())) precision=None preferred_element_type=None]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}, backend_config={"operation_queue_id":"0","wait_on_operation_queues":[],"gemm_backend_config":{"alpha_real":1,"alpha_imag":0,"beta":0,"dot_dimension_numbers":{"lhs_contracting_dimensions":["1"],"rhs_contracting_dimensions":["0"],"lhs_batch_dimensions":[],"rhs_batch_dimensions":[]},"precision_config":{"operand_precision":["DEFAULT","DEFAULT"]},"epilogue":"DEFAULT","selected_algorithm":"-1","lhs_stride":"6815744","rhs_stride":"6815744","grad_x":false,"grad_y":false}}
  %get-tuple-element.76.0 = bf16[256,256]{0,1} get-tuple-element((bf16[256,256]{0,1}, s8[4194304]{0}) %custom-call.85.0), index=0, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/MultiHeadDotProductAttention_0/value/dot_general[dimension_numbers=(((0, 1), (0, 1)), ((), ())) precision=None preferred_element_type=None]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %bitcast.5392.0 = bf16[26624,256]{1,0} bitcast(bf16[52,512,8,32]{3,2,1,0} %get-tuple-element.115)
  %loop_convert_fusion.1 = f32[256,8,32]{2,1,0} fusion(bf16[256,256]{0,1} %get-tuple-element.76.0), kind=kLoop, calls=%fused_convert.1, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/MultiHeadDotProductAttention_0/value/convert_element_type[new_dtype=float32 weak_type=False]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158 deduplicated_name="loop_convert_fusion.1"}
  %custom-call.63.0 = (bf16[416,512,512]{2,1,0}, s8[4194304]{0}) custom-call(bf16[416,512,32]{2,1,0} %bitcast.5403.0, bf16[416,32,512]{2,1,0} %bitcast.4797.0), custom_call_target="__cublas$gemm", metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/MultiHeadDotProductAttention_0/...hqk,...khd->...qhd/dot_general[dimension_numbers=(((2,), (3,)), ((0, 1), (0, 2))) precision=None preferred_element_type=bfloat16]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}, backend_config={"operation_queue_id":"0","wait_on_operation_queues":[],"gemm_backend_config":{"alpha_real":1,"alpha_imag":0,"beta":0,"dot_dimension_numbers":{"lhs_contracting_dimensions":["2"],"rhs_contracting_dimensions":["1"],"lhs_batch_dimensions":["0"],"rhs_batch_dimensions":["0"]},"precision_config":{"operand_precision":["DEFAULT","DEFAULT"]},"epilogue":"DEFAULT","selected_algorithm":"-1","lhs_stride":"16384","rhs_stride":"16384","grad_x":false,"grad_y":false}}
  %get-tuple-element.52.0 = bf16[416,512,512]{2,1,0} get-tuple-element((bf16[416,512,512]{2,1,0}, s8[4194304]{0}) %custom-call.63.0), index=0, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/MultiHeadDotProductAttention_0/...hqk,...khd->...qhd/dot_general[dimension_numbers=(((2,), (3,)), ((0, 1), (0, 2))) precision=None preferred_element_type=bfloat16]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %input_reduce_fusion.26 = f32[52,8,512]{2,1,0} fusion(f32[52,8,512]{2,1,0} %input_reduce_fusion.7, bf16[416,512,512]{2,1,0} %get-tuple-element.45.0, f32[52,8,512]{2,1,0} %get-tuple-element.132, bf16[416,512,512]{2,1,0} %get-tuple-element.52.0), kind=kInput, calls=%fused_reduce.26, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/MultiHeadDotProductAttention_0/neg" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158 deduplicated_name="input_reduce_fusion.26"}
  %loop_convert_fusion.11 = bf16[52,8,512,512]{3,2,1,0} fusion(f32[52,8,512]{2,1,0} %input_reduce_fusion.26, f32[52,8,512]{2,1,0} %input_reduce_fusion.9, bf16[416,512,512]{2,1,0} %get-tuple-element.52.0, f32[52,8,512]{2,1,0} %input_reduce_fusion.7, bf16[416,512,512]{2,1,0} %get-tuple-element.45.0), kind=kLoop, calls=%fused_convert.11
  %bitcast.5448.0 = bf16[416,512,512]{2,1,0} bitcast(bf16[52,8,512,512]{3,2,1,0} %loop_convert_fusion.11)
  %custom-call.66.0 = (bf16[416,512,32]{2,1,0}, s8[4194304]{0}) custom-call(bf16[416,512,512]{2,1,0} %bitcast.5448.0, bf16[416,512,32]{2,1,0} %bitcast.5477.0), custom_call_target="__cublas$gemm", metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/MultiHeadDotProductAttention_0/...qhd,...khd->...hqk/dot_general[dimension_numbers=(((3,), (1,)), ((0, 1), (0, 2))) precision=None preferred_element_type=bfloat16]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}, backend_config={"operation_queue_id":"0","wait_on_operation_queues":[],"gemm_backend_config":{"alpha_real":1,"alpha_imag":0,"beta":0,"dot_dimension_numbers":{"lhs_contracting_dimensions":["2"],"rhs_contracting_dimensions":["1"],"lhs_batch_dimensions":["0"],"rhs_batch_dimensions":["0"]},"precision_config":{"operand_precision":["DEFAULT","DEFAULT"]},"epilogue":"DEFAULT","selected_algorithm":"-1","lhs_stride":"262144","rhs_stride":"16384","grad_x":false,"grad_y":false}}
  %custom-call.64.0 = (bf16[416,512,32]{2,1,0}, s8[4194304]{0}) custom-call(bf16[416,512,512]{2,1,0} %bitcast.5448.0, bf16[416,512,32]{2,1,0} %bitcast.4823.0), custom_call_target="__cublas$gemm", metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/MultiHeadDotProductAttention_0/...qhd,...khd->...hqk/dot_general[dimension_numbers=(((2,), (1,)), ((0, 1), (0, 2))) precision=None preferred_element_type=bfloat16]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}, backend_config={"operation_queue_id":"0","wait_on_operation_queues":[],"gemm_backend_config":{"alpha_real":1,"alpha_imag":0,"beta":0,"dot_dimension_numbers":{"lhs_contracting_dimensions":["1"],"rhs_contracting_dimensions":["1"],"lhs_batch_dimensions":["0"],"rhs_batch_dimensions":["0"]},"precision_config":{"operand_precision":["DEFAULT","DEFAULT"]},"epilogue":"DEFAULT","selected_algorithm":"-1","lhs_stride":"262144","rhs_stride":"16384","grad_x":false,"grad_y":false}}
  %get-tuple-element.53.0 = bf16[416,512,32]{2,1,0} get-tuple-element((bf16[416,512,32]{2,1,0}, s8[4194304]{0}) %custom-call.64.0), index=0, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/MultiHeadDotProductAttention_0/...qhd,...khd->...hqk/dot_general[dimension_numbers=(((2,), (1,)), ((0, 1), (0, 2))) precision=None preferred_element_type=bfloat16]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %get-tuple-element.56.0 = bf16[416,512,32]{2,1,0} get-tuple-element((bf16[416,512,32]{2,1,0}, s8[4194304]{0}) %custom-call.66.0), index=0, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/MultiHeadDotProductAttention_0/...qhd,...khd->...hqk/dot_general[dimension_numbers=(((3,), (1,)), ((0, 1), (0, 2))) precision=None preferred_element_type=bfloat16]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %input_reduce_transpose_fusion.3 = (bf16[52,512,8,32]{3,2,1,0}, f32[52,8,32]{2,1,0}, bf16[8,32,52,512]{3,2,1,0}) fusion(bf16[416,512,32]{2,1,0} %get-tuple-element.56.0), kind=kInput, calls=%fused_reduce_transpose.3, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/MultiHeadDotProductAttention_0/div" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158 deduplicated_name="input_reduce_transpose_fusion.2"}
  %get-tuple-element.118 = bf16[8,32,52,512]{3,2,1,0} get-tuple-element((bf16[52,512,8,32]{3,2,1,0}, f32[52,8,32]{2,1,0}, bf16[8,32,52,512]{3,2,1,0}) %input_reduce_transpose_fusion.3), index=2
  %bitcast.6188.0 = bf16[256,26624]{1,0} bitcast(bf16[8,32,52,512]{3,2,1,0} %get-tuple-element.118)
  %get-tuple-element.117 = f32[52,8,32]{2,1,0} get-tuple-element((bf16[52,512,8,32]{3,2,1,0}, f32[52,8,32]{2,1,0}, bf16[8,32,52,512]{3,2,1,0}) %input_reduce_transpose_fusion.3), index=1
  %get-tuple-element.116 = bf16[52,512,8,32]{3,2,1,0} get-tuple-element((bf16[52,512,8,32]{3,2,1,0}, f32[52,8,32]{2,1,0}, bf16[8,32,52,512]{3,2,1,0}) %input_reduce_transpose_fusion.3), index=0
  %bitcast.5490.0 = bf16[26624,256]{1,0} bitcast(bf16[52,512,8,32]{3,2,1,0} %get-tuple-element.116)
  %custom-call.67.0 = (bf16[26624,256]{1,0}, s8[4194304]{0}) custom-call(bf16[26624,256]{1,0} %bitcast.5490.0, bf16[256,256]{0,1} %bitcast.5494.0), custom_call_target="__cublas$gemm", metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/MultiHeadDotProductAttention_0/query/dot_general[dimension_numbers=(((2, 3), (1, 2)), ((), ())) precision=None preferred_element_type=None]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}, backend_config={"operation_queue_id":"0","wait_on_operation_queues":[],"gemm_backend_config":{"alpha_real":1,"alpha_imag":0,"beta":0,"dot_dimension_numbers":{"lhs_contracting_dimensions":["1"],"rhs_contracting_dimensions":["0"],"lhs_batch_dimensions":[],"rhs_batch_dimensions":[]},"precision_config":{"operand_precision":["DEFAULT","DEFAULT"]},"epilogue":"DEFAULT","selected_algorithm":"-1","lhs_stride":"6815744","rhs_stride":"65536","grad_x":false,"grad_y":false}}
  %get-tuple-element.57.0 = bf16[26624,256]{1,0} get-tuple-element((bf16[26624,256]{1,0}, s8[4194304]{0}) %custom-call.67.0), index=0, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/MultiHeadDotProductAttention_0/query/dot_general[dimension_numbers=(((2, 3), (1, 2)), ((), ())) precision=None preferred_element_type=None]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %custom-call.84.0 = (bf16[256,256]{0,1}, s8[4194304]{0}) custom-call(bf16[256,26624]{1,0} %bitcast.6188.0, bf16[26624,256]{1,0} %bitcast.6219.0), custom_call_target="__cublas$gemm", metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/MultiHeadDotProductAttention_0/query/dot_general[dimension_numbers=(((0, 1), (0, 1)), ((), ())) precision=None preferred_element_type=None]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}, backend_config={"operation_queue_id":"0","wait_on_operation_queues":[],"gemm_backend_config":{"alpha_real":1,"alpha_imag":0,"beta":0,"dot_dimension_numbers":{"lhs_contracting_dimensions":["1"],"rhs_contracting_dimensions":["0"],"lhs_batch_dimensions":[],"rhs_batch_dimensions":[]},"precision_config":{"operand_precision":["DEFAULT","DEFAULT"]},"epilogue":"DEFAULT","selected_algorithm":"-1","lhs_stride":"6815744","rhs_stride":"6815744","grad_x":false,"grad_y":false}}
  %get-tuple-element.75.0 = bf16[256,256]{0,1} get-tuple-element((bf16[256,256]{0,1}, s8[4194304]{0}) %custom-call.84.0), index=0, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/MultiHeadDotProductAttention_0/query/dot_general[dimension_numbers=(((0, 1), (0, 1)), ((), ())) precision=None preferred_element_type=None]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %loop_convert_fusion.2 = f32[256,8,32]{2,1,0} fusion(bf16[256,256]{0,1} %get-tuple-element.75.0), kind=kLoop, calls=%fused_convert.2, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/MultiHeadDotProductAttention_0/query/convert_element_type[new_dtype=float32 weak_type=False]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158 deduplicated_name="loop_convert_fusion.1"}
  %input_reduce_transpose_fusion.1 = (bf16[8,32,52,512]{3,2,1,0}, bf16[52,512,8,32]{3,2,1,0}, f32[52,8,32]{2,1,0}) fusion(bf16[416,512,32]{2,1,0} %get-tuple-element.53.0), kind=kInput, calls=%fused_reduce_transpose.1, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/MultiHeadDotProductAttention_0/...qhd,...khd->...hqk/transpose[permutation=(0, 2, 1, 3)]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158 deduplicated_name="input_reduce_transpose_fusion"}
  %get-tuple-element.111 = f32[52,8,32]{2,1,0} get-tuple-element((bf16[8,32,52,512]{3,2,1,0}, bf16[52,512,8,32]{3,2,1,0}, f32[52,8,32]{2,1,0}) %input_reduce_transpose_fusion.1), index=2
  %get-tuple-element.110 = bf16[52,512,8,32]{3,2,1,0} get-tuple-element((bf16[8,32,52,512]{3,2,1,0}, bf16[52,512,8,32]{3,2,1,0}, f32[52,8,32]{2,1,0}) %input_reduce_transpose_fusion.1), index=1
  %get-tuple-element.109 = bf16[8,32,52,512]{3,2,1,0} get-tuple-element((bf16[8,32,52,512]{3,2,1,0}, bf16[52,512,8,32]{3,2,1,0}, f32[52,8,32]{2,1,0}) %input_reduce_transpose_fusion.1), index=0
  %bitcast.6135.0 = bf16[256,26624]{1,0} bitcast(bf16[8,32,52,512]{3,2,1,0} %get-tuple-element.109)
  %custom-call.82.0 = (bf16[256,256]{0,1}, s8[4194304]{0}) custom-call(bf16[256,26624]{1,0} %bitcast.6135.0, bf16[26624,256]{1,0} %bitcast.6219.0), custom_call_target="__cublas$gemm", metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/MultiHeadDotProductAttention_0/key/dot_general[dimension_numbers=(((0, 1), (0, 1)), ((), ())) precision=None preferred_element_type=None]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}, backend_config={"operation_queue_id":"0","wait_on_operation_queues":[],"gemm_backend_config":{"alpha_real":1,"alpha_imag":0,"beta":0,"dot_dimension_numbers":{"lhs_contracting_dimensions":["1"],"rhs_contracting_dimensions":["0"],"lhs_batch_dimensions":[],"rhs_batch_dimensions":[]},"precision_config":{"operand_precision":["DEFAULT","DEFAULT"]},"epilogue":"DEFAULT","selected_algorithm":"-1","lhs_stride":"6815744","rhs_stride":"6815744","grad_x":false,"grad_y":false}}
  %get-tuple-element.73.0 = bf16[256,256]{0,1} get-tuple-element((bf16[256,256]{0,1}, s8[4194304]{0}) %custom-call.82.0), index=0, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/MultiHeadDotProductAttention_0/key/dot_general[dimension_numbers=(((0, 1), (0, 1)), ((), ())) precision=None preferred_element_type=None]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %bitcast.5459.0 = bf16[26624,256]{1,0} bitcast(bf16[52,512,8,32]{3,2,1,0} %get-tuple-element.110)
  %loop_convert_fusion.4 = f32[256,8,32]{2,1,0} fusion(bf16[256,256]{0,1} %get-tuple-element.73.0), kind=kLoop, calls=%fused_convert.4, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/MultiHeadDotProductAttention_0/key/convert_element_type[new_dtype=float32 weak_type=False]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158 deduplicated_name="loop_convert_fusion.1"}
  %custom-call.65.0 = (bf16[26624,256]{1,0}, s8[4194304]{0}) custom-call(bf16[26624,256]{1,0} %bitcast.5459.0, bf16[256,256]{0,1} %bitcast.5463.0), custom_call_target="__cublas$gemm", metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/MultiHeadDotProductAttention_0/key/dot_general[dimension_numbers=(((2, 3), (1, 2)), ((), ())) precision=None preferred_element_type=None]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}, backend_config={"operation_queue_id":"0","wait_on_operation_queues":[],"gemm_backend_config":{"alpha_real":1,"alpha_imag":0,"beta":0,"dot_dimension_numbers":{"lhs_contracting_dimensions":["1"],"rhs_contracting_dimensions":["0"],"lhs_batch_dimensions":[],"rhs_batch_dimensions":[]},"precision_config":{"operand_precision":["DEFAULT","DEFAULT"]},"epilogue":"DEFAULT","selected_algorithm":"-1","lhs_stride":"6815744","rhs_stride":"65536","grad_x":false,"grad_y":false}}
  %get-tuple-element.54.0 = bf16[26624,256]{1,0} get-tuple-element((bf16[26624,256]{1,0}, s8[4194304]{0}) %custom-call.65.0), index=0, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/MultiHeadDotProductAttention_0/key/dot_general[dimension_numbers=(((2, 3), (1, 2)), ((), ())) precision=None preferred_element_type=None]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %cublas-gemm.4.0 = (bf16[26624,256]{1,0}, s8[4194304]{0}) custom-call(bf16[26624,256]{1,0} %bitcast.5392.0, bf16[256,256]{0,1} %bitcast.5396.0, bf16[26624,256]{1,0} %get-tuple-element.54.0), custom_call_target="__cublas$gemm", output_to_operand_aliasing={{0}: (2, {})}, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/MultiHeadDotProductAttention_0/value/dot_general[dimension_numbers=(((2, 3), (1, 2)), ((), ())) precision=None preferred_element_type=None]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}, backend_config={"operation_queue_id":"0","wait_on_operation_queues":[],"gemm_backend_config":{"alpha_real":1,"alpha_imag":0,"beta":1,"dot_dimension_numbers":{"lhs_contracting_dimensions":["1"],"rhs_contracting_dimensions":["0"],"lhs_batch_dimensions":[],"rhs_batch_dimensions":[]},"precision_config":{"operand_precision":["DEFAULT","DEFAULT"]},"epilogue":"DEFAULT","selected_algorithm":"-1","lhs_stride":"6815744","rhs_stride":"65536","grad_x":false,"grad_y":false}}
  %get-tuple-element.55.0 = bf16[26624,256]{1,0} get-tuple-element((bf16[26624,256]{1,0}, s8[4194304]{0}) %cublas-gemm.4.0), index=0, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/MultiHeadDotProductAttention_0/value/dot_general[dimension_numbers=(((2, 3), (1, 2)), ((), ())) precision=None preferred_element_type=None]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %input_reduce_fusion.2 = f32[208,256]{1,0} fusion(bf16[26624,256]{1,0} %get-tuple-element.57.0, bf16[26624,256]{1,0} %get-tuple-element.55.0), kind=kInput, calls=%fused_reduce.2, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/LayerNorm_0/reduce_sum[axes=(0, 1)]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156 deduplicated_name="input_reduce_fusion.2"}
  %input_transpose_fusion.4 = f32[512,256,52]{2,1,0} fusion(bf16[26624,256]{1,0} %get-tuple-element.57.0, bf16[26624,256]{1,0} %get-tuple-element.55.0), kind=kInput, calls=%fused_transpose.4, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/LayerNorm_0/convert_element_type[new_dtype=float32 weak_type=False]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156 deduplicated_name="input_transpose_fusion"}
  %input_reduce_fusion.21 = (f32[512,52]{1,0}, f32[512,52]{1,0}) fusion(f32[256]{0} %Arg_17.18.0, f32[512,256,52]{2,1,0} %input_transpose_fusion.4, f32[512,256,52]{2,1,0} %input_transpose_fusion.17, f32[512,52]{1,0} %get-tuple-element.151, f32[1,512,52]{2,1,0} %get-tuple-element.150), kind=kInput, calls=%fused_reduce.21
  %get-tuple-element.108 = f32[512,52]{1,0} get-tuple-element((f32[512,52]{1,0}, f32[512,52]{1,0}) %input_reduce_fusion.21), index=1
  %get-tuple-element.107 = f32[512,52]{1,0} get-tuple-element((f32[512,52]{1,0}, f32[512,52]{1,0}) %input_reduce_fusion.21), index=0
  %loop_multiply_fusion.2 = (f32[512,52]{1,0}, f32[512,52]{1,0}) fusion(f32[1,512,52]{2,1,0} %get-tuple-element.150, f32[512,52]{1,0} %get-tuple-element.151, f32[512,52]{1,0} %get-tuple-element.152, f32[512,52]{1,0} %get-tuple-element.107, f32[512,52]{1,0} %get-tuple-element.108, /*index=5*/f32[512,52]{1,0} %get-tuple-element.153), kind=kLoop, calls=%fused_multiply.2, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/LayerNorm_0/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156 deduplicated_name="loop_multiply_fusion"}
  %get-tuple-element.106 = f32[512,52]{1,0} get-tuple-element((f32[512,52]{1,0}, f32[512,52]{1,0}) %loop_multiply_fusion.2), index=1
  %get-tuple-element.105 = f32[512,52]{1,0} get-tuple-element((f32[512,52]{1,0}, f32[512,52]{1,0}) %loop_multiply_fusion.2), index=0
  %input_reduce_fusion.17 = f32[512,256]{1,0} fusion(f32[1,512,52]{2,1,0} %get-tuple-element.150, f32[512,256,52]{2,1,0} %input_transpose_fusion.4, f32[512,256,52]{2,1,0} %input_transpose_fusion.17, f32[512,52]{1,0} %get-tuple-element.151), kind=kInput, calls=%fused_reduce.17
  %input_add_transpose_fusion.2 = (bf16[52,512,256]{2,1,0}, f32[512,256,52]{2,1,0}) fusion(f32[512,52]{1,0} %get-tuple-element.106, f32[512,256,52]{2,1,0} %input_transpose_fusion.17, f32[512,52]{1,0} %get-tuple-element.105, f32[512,256,52]{2,1,0} %get-tuple-element.122, f32[512,256,52]{2,1,0} %input_transpose_fusion.4, /*index=5*/f32[256]{0} %Arg_17.18.0, f32[1,512,52]{2,1,0} %get-tuple-element.150), kind=kInput, calls=%fused_add_transpose.2, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/LayerNorm_0/add_any" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156 deduplicated_name="input_add_transpose_fusion.1"}
  %get-tuple-element.104 = f32[512,256,52]{2,1,0} get-tuple-element((bf16[52,512,256]{2,1,0}, f32[512,256,52]{2,1,0}) %input_add_transpose_fusion.2), index=1
  %get-tuple-element.103 = bf16[52,512,256]{2,1,0} get-tuple-element((bf16[52,512,256]{2,1,0}, f32[512,256,52]{2,1,0}) %input_add_transpose_fusion.2), index=0
  %bitcast.5606.0 = bf16[26624,256]{1,0} bitcast(bf16[52,512,256]{2,1,0} %get-tuple-element.103)
  %input_reduce_fusion.28 = f32[512,256]{1,0} fusion(f32[512,256,52]{2,1,0} %get-tuple-element.104), kind=kInput, calls=%fused_reduce.28
  %custom-call.68.0 = (bf16[26624,256]{1,0}, s8[4194304]{0}) custom-call(bf16[26624,256]{1,0} %bitcast.5606.0, bf16[256,256]{1,0} %wrapped_convert.5), custom_call_target="__cublas$gemm", metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/vmap(vmap(LazyInMLP_0))/Dense_0/dot_general[dimension_numbers=(((2,), (1,)), ((), ())) precision=None preferred_element_type=None]" source_file="/home/nicholas/programs/avid/avid/layers.py" source_line=49}, backend_config={"operation_queue_id":"0","wait_on_operation_queues":[],"gemm_backend_config":{"alpha_real":1,"alpha_imag":0,"beta":0,"dot_dimension_numbers":{"lhs_contracting_dimensions":["1"],"rhs_contracting_dimensions":["1"],"lhs_batch_dimensions":[],"rhs_batch_dimensions":[]},"precision_config":{"operand_precision":["DEFAULT","DEFAULT"]},"epilogue":"DEFAULT","selected_algorithm":"-1","lhs_stride":"6815744","rhs_stride":"65536","grad_x":false,"grad_y":false}}
  %get-tuple-element.58.0 = bf16[26624,256]{1,0} get-tuple-element((bf16[26624,256]{1,0}, s8[4194304]{0}) %custom-call.68.0), index=0, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/vmap(vmap(LazyInMLP_0))/Dense_0/dot_general[dimension_numbers=(((2,), (1,)), ((), ())) precision=None preferred_element_type=None]" source_file="/home/nicholas/programs/avid/avid/layers.py" source_line=49}
  %input_reduce_fusion.3 = f32[208,256]{1,0} fusion(bf16[26624,256]{1,0} %get-tuple-element.58.0), kind=kInput, calls=%fused_reduce.3, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/LayerNorm_1/reduce_sum[axes=(0, 1)]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171 deduplicated_name="input_reduce_fusion.1"}
  %input_transpose_fusion.3 = f32[512,256,52]{2,1,0} fusion(bf16[26624,256]{1,0} %get-tuple-element.58.0), kind=kInput, calls=%fused_transpose.3, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/LayerNorm_1/convert_element_type[new_dtype=float32 weak_type=False]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171 deduplicated_name="input_transpose_fusion.3"}
  %input_reduce_fusion.20 = (f32[512,52]{1,0}, f32[512,52]{1,0}) fusion(f32[256]{0} %Arg_5.6.0, f32[512,256,52]{2,1,0} %input_transpose_fusion.3, f32[512,256,52]{2,1,0} %input_transpose_fusion.18, f32[512,52]{1,0} %get-tuple-element.155, f32[1,512,52]{2,1,0} %get-tuple-element.154), kind=kInput, calls=%fused_reduce.20
  %get-tuple-element.102 = f32[512,52]{1,0} get-tuple-element((f32[512,52]{1,0}, f32[512,52]{1,0}) %input_reduce_fusion.20), index=1
  %get-tuple-element.101 = f32[512,52]{1,0} get-tuple-element((f32[512,52]{1,0}, f32[512,52]{1,0}) %input_reduce_fusion.20), index=0
  %loop_multiply_fusion.3 = (f32[512,52]{1,0}, f32[512,52]{1,0}) fusion(f32[1,512,52]{2,1,0} %get-tuple-element.154, f32[512,52]{1,0} %get-tuple-element.155, f32[512,52]{1,0} %get-tuple-element.156, f32[512,52]{1,0} %get-tuple-element.101, f32[512,52]{1,0} %get-tuple-element.102, /*index=5*/f32[512,52]{1,0} %get-tuple-element.157), kind=kLoop, calls=%fused_multiply.3, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/LayerNorm_1/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171 deduplicated_name="loop_multiply_fusion"}
  %get-tuple-element.100 = f32[512,52]{1,0} get-tuple-element((f32[512,52]{1,0}, f32[512,52]{1,0}) %loop_multiply_fusion.3), index=1
  %get-tuple-element.99 = f32[512,52]{1,0} get-tuple-element((f32[512,52]{1,0}, f32[512,52]{1,0}) %loop_multiply_fusion.3), index=0
  %input_reduce_fusion.18 = f32[512,256]{1,0} fusion(f32[1,512,52]{2,1,0} %get-tuple-element.154, f32[512,256,52]{2,1,0} %input_transpose_fusion.3, f32[512,256,52]{2,1,0} %input_transpose_fusion.18, f32[512,52]{1,0} %get-tuple-element.155), kind=kInput, calls=%fused_reduce.18
  %input_add_transpose_fusion.1 = (bf16[52,512,256]{2,1,0}, f32[512,256,52]{2,1,0}) fusion(f32[512,52]{1,0} %get-tuple-element.100, f32[512,256,52]{2,1,0} %input_transpose_fusion.18, f32[512,52]{1,0} %get-tuple-element.99, f32[512,256,52]{2,1,0} %get-tuple-element.104, f32[512,256,52]{2,1,0} %input_transpose_fusion.3, /*index=5*/f32[256]{0} %Arg_5.6.0, f32[1,512,52]{2,1,0} %get-tuple-element.154), kind=kInput, calls=%fused_add_transpose.1, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/LayerNorm_1/add_any" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171 deduplicated_name="input_add_transpose_fusion.1"}
  %input_transpose_fusion.25 = bf16[256,52,512]{2,1,0} fusion(f32[512,256,52]{2,1,0} %get-tuple-element.104), kind=kInput, calls=%fused_transpose.26, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=183 deduplicated_name="input_transpose_fusion.23"}
  %get-tuple-element.98 = f32[512,256,52]{2,1,0} get-tuple-element((bf16[52,512,256]{2,1,0}, f32[512,256,52]{2,1,0}) %input_add_transpose_fusion.1), index=1
  %get-tuple-element.97 = bf16[52,512,256]{2,1,0} get-tuple-element((bf16[52,512,256]{2,1,0}, f32[512,256,52]{2,1,0}) %input_add_transpose_fusion.1), index=0
  %bitcast.5717.0 = bf16[26624,256]{1,0} bitcast(bf16[52,512,256]{2,1,0} %get-tuple-element.97)
  %bitcast.5922.0 = bf16[256,26624]{1,0} bitcast(bf16[256,52,512]{2,1,0} %input_transpose_fusion.25)
  %custom-call.76.0 = (bf16[256,256]{1,0}, s8[4194304]{0}) custom-call(bf16[26624,256]{1,0} %bitcast.5917.0, bf16[256,26624]{1,0} %bitcast.5922.0), custom_call_target="__cublas$gemm", metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/vmap(vmap(LazyInMLP_0))/Dense_0/transpose[permutation=(1, 0)]" source_file="/home/nicholas/programs/avid/avid/layers.py" source_line=49}, backend_config={"operation_queue_id":"0","wait_on_operation_queues":[],"gemm_backend_config":{"alpha_real":1,"alpha_imag":0,"beta":0,"dot_dimension_numbers":{"lhs_contracting_dimensions":["0"],"rhs_contracting_dimensions":["1"],"lhs_batch_dimensions":[],"rhs_batch_dimensions":[]},"precision_config":{"operand_precision":["DEFAULT","DEFAULT"]},"epilogue":"DEFAULT","selected_algorithm":"-1","lhs_stride":"6815744","rhs_stride":"6815744","grad_x":false,"grad_y":false}}
  %get-tuple-element.67.0 = bf16[256,256]{1,0} get-tuple-element((bf16[256,256]{1,0}, s8[4194304]{0}) %custom-call.76.0), index=0, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/vmap(vmap(LazyInMLP_0))/Dense_0/transpose[permutation=(1, 0)]" source_file="/home/nicholas/programs/avid/avid/layers.py" source_line=49}
  %loop_convert_fusion.16 = (f32[256,256]{1,0}, f32[256,256]{1,0}) fusion(bf16[256,256]{1,0} %get-tuple-element.67.0, bf16[256,256]{1,0} %get-tuple-element.72.0), kind=kLoop, calls=%fused_convert.16
  %get-tuple-element.170 = f32[256,256]{1,0} get-tuple-element((f32[256,256]{1,0}, f32[256,256]{1,0}) %loop_convert_fusion.16), index=1, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/vmap(vmap(LazyInMLP_0))/Dense_0/convert_element_type[new_dtype=float32 weak_type=False]" source_file="/home/nicholas/programs/avid/avid/layers.py" source_line=49}
  %get-tuple-element.163 = f32[256,256]{1,0} get-tuple-element((f32[256,256]{1,0}, f32[256,256]{1,0}) %loop_convert_fusion.16), index=0, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/vmap(vmap(LazyInMLP_0))/Dense_0/convert_element_type[new_dtype=float32 weak_type=False]" source_file="/home/nicholas/programs/avid/avid/layers.py" source_line=49}
  %input_reduce_fusion.29 = f32[512,256]{1,0} fusion(f32[512,256,52]{2,1,0} %get-tuple-element.98), kind=kInput, calls=%fused_reduce.29
  %input_reduce_fusion.39 = (f32[256]{0}, f32[256]{0}, f32[256]{0}, f32[256]{0}, f32[256]{0}) fusion(f32[512,256]{1,0} %get-tuple-element.135, f32[512,256]{1,0} %input_reduce_fusion.29, f32[512,256]{1,0} %input_reduce_fusion.28, f32[512,256]{1,0} %input_reduce_fusion.31, f32[512,256]{1,0} %input_reduce_fusion.32), kind=kInput, calls=%fused_reduce.39, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoder_norm/reduce_sum[axes=(0, 1)]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=228}
  %get-tuple-element.184 = f32[256]{0} get-tuple-element((f32[256]{0}, f32[256]{0}, f32[256]{0}, f32[256]{0}, f32[256]{0}) %input_reduce_fusion.39), index=4
  %get-tuple-element.183 = f32[256]{0} get-tuple-element((f32[256]{0}, f32[256]{0}, f32[256]{0}, f32[256]{0}, f32[256]{0}) %input_reduce_fusion.39), index=3
  %get-tuple-element.182 = f32[256]{0} get-tuple-element((f32[256]{0}, f32[256]{0}, f32[256]{0}, f32[256]{0}, f32[256]{0}) %input_reduce_fusion.39), index=2
  %get-tuple-element.181 = f32[256]{0} get-tuple-element((f32[256]{0}, f32[256]{0}, f32[256]{0}, f32[256]{0}, f32[256]{0}) %input_reduce_fusion.39), index=1
  %get-tuple-element.180 = f32[256]{0} get-tuple-element((f32[256]{0}, f32[256]{0}, f32[256]{0}, f32[256]{0}, f32[256]{0}) %input_reduce_fusion.39), index=0
  %custom-call.69.0 = (bf16[26624,256]{1,0}, s8[4194304]{0}) custom-call(bf16[26624,256]{1,0} %bitcast.5717.0, bf16[256,256]{0,1} %bitcast.5721.0), custom_call_target="__cublas$gemm", metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/MultiHeadDotProductAttention_0/out/dot_general[dimension_numbers=(((2,), (2,)), ((), ())) precision=None preferred_element_type=None]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}, backend_config={"operation_queue_id":"0","wait_on_operation_queues":[],"gemm_backend_config":{"alpha_real":1,"alpha_imag":0,"beta":0,"dot_dimension_numbers":{"lhs_contracting_dimensions":["1"],"rhs_contracting_dimensions":["0"],"lhs_batch_dimensions":[],"rhs_batch_dimensions":[]},"precision_config":{"operand_precision":["DEFAULT","DEFAULT"]},"epilogue":"DEFAULT","selected_algorithm":"-1","lhs_stride":"6815744","rhs_stride":"65536","grad_x":false,"grad_y":false}}
  %get-tuple-element.59.0 = bf16[26624,256]{1,0} get-tuple-element((bf16[26624,256]{1,0}, s8[4194304]{0}) %custom-call.69.0), index=0, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/MultiHeadDotProductAttention_0/out/dot_general[dimension_numbers=(((2,), (2,)), ((), ())) precision=None preferred_element_type=None]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %input_transpose_fusion.24 = bf16[256,52,512]{2,1,0} fusion(f32[512,256,52]{2,1,0} %get-tuple-element.98), kind=kInput, calls=%fused_transpose.25, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=167 deduplicated_name="input_transpose_fusion.23"}
  %bitcast.5976.0 = bf16[256,26624]{1,0} bitcast(bf16[256,52,512]{2,1,0} %input_transpose_fusion.24)
  %custom-call.78.0 = (bf16[256,256]{0,1}, s8[4194304]{0}) custom-call(bf16[256,26624]{1,0} %bitcast.5976.0, bf16[26624,256]{1,0} %bitcast.5978.0), custom_call_target="__cublas$gemm", metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/MultiHeadDotProductAttention_0/out/dot_general[dimension_numbers=(((0, 1), (0, 1)), ((), ())) precision=None preferred_element_type=None]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}, backend_config={"operation_queue_id":"0","wait_on_operation_queues":[],"gemm_backend_config":{"alpha_real":1,"alpha_imag":0,"beta":0,"dot_dimension_numbers":{"lhs_contracting_dimensions":["1"],"rhs_contracting_dimensions":["0"],"lhs_batch_dimensions":[],"rhs_batch_dimensions":[]},"precision_config":{"operand_precision":["DEFAULT","DEFAULT"]},"epilogue":"DEFAULT","selected_algorithm":"-1","lhs_stride":"6815744","rhs_stride":"6815744","grad_x":false,"grad_y":false}}
  %get-tuple-element.69.0 = bf16[256,256]{0,1} get-tuple-element((bf16[256,256]{0,1}, s8[4194304]{0}) %custom-call.78.0), index=0, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/MultiHeadDotProductAttention_0/out/dot_general[dimension_numbers=(((0, 1), (0, 1)), ((), ())) precision=None preferred_element_type=None]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %loop_convert_fusion.7 = f32[8,32,256]{2,1,0} fusion(bf16[256,256]{0,1} %get-tuple-element.69.0), kind=kLoop, calls=%fused_convert.7, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/MultiHeadDotProductAttention_0/out/convert_element_type[new_dtype=float32 weak_type=False]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158 deduplicated_name="loop_convert_fusion.3"}
  %input_transpose_fusion.2 = (bf16[52,8,512,32]{3,2,1,0}, bf16[52,8,32,512]{3,2,1,0}) fusion(bf16[26624,256]{1,0} %get-tuple-element.59.0), kind=kInput, calls=%fused_transpose.2, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/MultiHeadDotProductAttention_0/...hqk,...khd->...qhd/transpose[permutation=(0, 2, 3, 1)]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158 deduplicated_name="input_transpose_fusion.2"}
  %get-tuple-element.96 = bf16[52,8,32,512]{3,2,1,0} get-tuple-element((bf16[52,8,512,32]{3,2,1,0}, bf16[52,8,32,512]{3,2,1,0}) %input_transpose_fusion.2), index=1
  %get-tuple-element.95 = bf16[52,8,512,32]{3,2,1,0} get-tuple-element((bf16[52,8,512,32]{3,2,1,0}, bf16[52,8,32,512]{3,2,1,0}) %input_transpose_fusion.2), index=0
  %bitcast.5750.0 = bf16[416,512,32]{2,1,0} bitcast(bf16[52,8,512,32]{3,2,1,0} %get-tuple-element.95)
  %bitcast.5728.0 = bf16[416,32,512]{2,1,0} bitcast(bf16[52,8,32,512]{3,2,1,0} %get-tuple-element.96)
  %custom-call.70.0 = (bf16[416,32,512]{2,1,0}, s8[4194304]{0}) custom-call(bf16[416,32,512]{2,1,0} %bitcast.5728.0, bf16[416,512,512]{2,1,0} %bitcast.4598.0), custom_call_target="__cublas$gemm", metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/MultiHeadDotProductAttention_0/...hqk,...khd->...qhd/dot_general[dimension_numbers=(((3,), (2,)), ((0, 1), (0, 1))) precision=None preferred_element_type=bfloat16]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}, backend_config={"operation_queue_id":"0","wait_on_operation_queues":[],"gemm_backend_config":{"alpha_real":1,"alpha_imag":0,"beta":0,"dot_dimension_numbers":{"lhs_contracting_dimensions":["2"],"rhs_contracting_dimensions":["1"],"lhs_batch_dimensions":["0"],"rhs_batch_dimensions":["0"]},"precision_config":{"operand_precision":["DEFAULT","DEFAULT"]},"epilogue":"DEFAULT","selected_algorithm":"-1","lhs_stride":"16384","rhs_stride":"262144","grad_x":false,"grad_y":false}}
  %get-tuple-element.60.0 = bf16[416,32,512]{2,1,0} get-tuple-element((bf16[416,32,512]{2,1,0}, s8[4194304]{0}) %custom-call.70.0), index=0, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/MultiHeadDotProductAttention_0/...hqk,...khd->...qhd/dot_general[dimension_numbers=(((3,), (2,)), ((0, 1), (0, 1))) precision=None preferred_element_type=bfloat16]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %input_reduce_fusion.24 = f32[52,8,32]{2,1,0} fusion(bf16[416,32,512]{2,1,0} %get-tuple-element.60.0), kind=kInput, calls=%fused_reduce.24
  %input_transpose_fusion.1 = (bf16[8,32,52,512]{3,2,1,0}, bf16[52,512,8,32]{3,2,1,0}) fusion(bf16[416,32,512]{2,1,0} %get-tuple-element.60.0), kind=kInput, calls=%fused_transpose.1, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/MultiHeadDotProductAttention_0/...hqk,...khd->...qhd/transpose[permutation=(0, 3, 1, 2)]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158 deduplicated_name="input_transpose_fusion.1"}
  %get-tuple-element.91 = bf16[52,512,8,32]{3,2,1,0} get-tuple-element((bf16[8,32,52,512]{3,2,1,0}, bf16[52,512,8,32]{3,2,1,0}) %input_transpose_fusion.1), index=1
  %get-tuple-element.90 = bf16[8,32,52,512]{3,2,1,0} get-tuple-element((bf16[8,32,52,512]{3,2,1,0}, bf16[52,512,8,32]{3,2,1,0}) %input_transpose_fusion.1), index=0
  %bitcast.6029.0 = bf16[256,26624]{1,0} bitcast(bf16[8,32,52,512]{3,2,1,0} %get-tuple-element.90)
  %custom-call.80.0 = (bf16[256,256]{0,1}, s8[4194304]{0}) custom-call(bf16[256,26624]{1,0} %bitcast.6029.0, bf16[26624,256]{1,0} %bitcast.6031.0), custom_call_target="__cublas$gemm", metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/MultiHeadDotProductAttention_0/value/dot_general[dimension_numbers=(((0, 1), (0, 1)), ((), ())) precision=None preferred_element_type=None]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}, backend_config={"operation_queue_id":"0","wait_on_operation_queues":[],"gemm_backend_config":{"alpha_real":1,"alpha_imag":0,"beta":0,"dot_dimension_numbers":{"lhs_contracting_dimensions":["1"],"rhs_contracting_dimensions":["0"],"lhs_batch_dimensions":[],"rhs_batch_dimensions":[]},"precision_config":{"operand_precision":["DEFAULT","DEFAULT"]},"epilogue":"DEFAULT","selected_algorithm":"-1","lhs_stride":"6815744","rhs_stride":"6815744","grad_x":false,"grad_y":false}}
  %get-tuple-element.71.0 = bf16[256,256]{0,1} get-tuple-element((bf16[256,256]{0,1}, s8[4194304]{0}) %custom-call.80.0), index=0, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/MultiHeadDotProductAttention_0/value/dot_general[dimension_numbers=(((0, 1), (0, 1)), ((), ())) precision=None preferred_element_type=None]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %bitcast.5739.0 = bf16[26624,256]{1,0} bitcast(bf16[52,512,8,32]{3,2,1,0} %get-tuple-element.91)
  %loop_convert_fusion.5 = f32[256,8,32]{2,1,0} fusion(bf16[256,256]{0,1} %get-tuple-element.71.0), kind=kLoop, calls=%fused_convert.5, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/MultiHeadDotProductAttention_0/value/convert_element_type[new_dtype=float32 weak_type=False]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158 deduplicated_name="loop_convert_fusion.1"}
  %custom-call.71.0 = (bf16[416,512,512]{2,1,0}, s8[4194304]{0}) custom-call(bf16[416,512,32]{2,1,0} %bitcast.5750.0, bf16[416,32,512]{2,1,0} %bitcast.4518.0), custom_call_target="__cublas$gemm", metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/MultiHeadDotProductAttention_0/...hqk,...khd->...qhd/dot_general[dimension_numbers=(((2,), (3,)), ((0, 1), (0, 2))) precision=None preferred_element_type=bfloat16]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}, backend_config={"operation_queue_id":"0","wait_on_operation_queues":[],"gemm_backend_config":{"alpha_real":1,"alpha_imag":0,"beta":0,"dot_dimension_numbers":{"lhs_contracting_dimensions":["2"],"rhs_contracting_dimensions":["1"],"lhs_batch_dimensions":["0"],"rhs_batch_dimensions":["0"]},"precision_config":{"operand_precision":["DEFAULT","DEFAULT"]},"epilogue":"DEFAULT","selected_algorithm":"-1","lhs_stride":"16384","rhs_stride":"16384","grad_x":false,"grad_y":false}}
  %get-tuple-element.61.0 = bf16[416,512,512]{2,1,0} get-tuple-element((bf16[416,512,512]{2,1,0}, s8[4194304]{0}) %custom-call.71.0), index=0, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/MultiHeadDotProductAttention_0/...hqk,...khd->...qhd/dot_general[dimension_numbers=(((2,), (3,)), ((0, 1), (0, 2))) precision=None preferred_element_type=bfloat16]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %input_reduce_fusion.27 = f32[52,8,512]{2,1,0} fusion(f32[52,8,512]{2,1,0} %input_reduce_fusion.6, bf16[416,512,512]{2,1,0} %get-tuple-element.38.0, f32[52,8,512]{2,1,0} %get-tuple-element.134, bf16[416,512,512]{2,1,0} %get-tuple-element.61.0), kind=kInput, calls=%fused_reduce.27, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/MultiHeadDotProductAttention_0/neg" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158 deduplicated_name="input_reduce_fusion.26"}
  %loop_convert_fusion.12 = bf16[52,8,512,512]{3,2,1,0} fusion(f32[52,8,512]{2,1,0} %input_reduce_fusion.27, f32[52,8,512]{2,1,0} %input_reduce_fusion.8, bf16[416,512,512]{2,1,0} %get-tuple-element.61.0, f32[52,8,512]{2,1,0} %input_reduce_fusion.6, bf16[416,512,512]{2,1,0} %get-tuple-element.38.0), kind=kLoop, calls=%fused_convert.12
  %bitcast.5796.0 = bf16[416,512,512]{2,1,0} bitcast(bf16[52,8,512,512]{3,2,1,0} %loop_convert_fusion.12)
  %custom-call.74.0 = (bf16[416,512,32]{2,1,0}, s8[4194304]{0}) custom-call(bf16[416,512,512]{2,1,0} %bitcast.5796.0, bf16[416,512,32]{2,1,0} %bitcast.5825.0), custom_call_target="__cublas$gemm", metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/MultiHeadDotProductAttention_0/...qhd,...khd->...hqk/dot_general[dimension_numbers=(((3,), (1,)), ((0, 1), (0, 2))) precision=None preferred_element_type=bfloat16]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}, backend_config={"operation_queue_id":"0","wait_on_operation_queues":[],"gemm_backend_config":{"alpha_real":1,"alpha_imag":0,"beta":0,"dot_dimension_numbers":{"lhs_contracting_dimensions":["2"],"rhs_contracting_dimensions":["1"],"lhs_batch_dimensions":["0"],"rhs_batch_dimensions":["0"]},"precision_config":{"operand_precision":["DEFAULT","DEFAULT"]},"epilogue":"DEFAULT","selected_algorithm":"-1","lhs_stride":"262144","rhs_stride":"16384","grad_x":false,"grad_y":false}}
  %custom-call.72.0 = (bf16[416,512,32]{2,1,0}, s8[4194304]{0}) custom-call(bf16[416,512,512]{2,1,0} %bitcast.5796.0, bf16[416,512,32]{2,1,0} %bitcast.4544.0), custom_call_target="__cublas$gemm", metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/MultiHeadDotProductAttention_0/...qhd,...khd->...hqk/dot_general[dimension_numbers=(((2,), (1,)), ((0, 1), (0, 2))) precision=None preferred_element_type=bfloat16]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}, backend_config={"operation_queue_id":"0","wait_on_operation_queues":[],"gemm_backend_config":{"alpha_real":1,"alpha_imag":0,"beta":0,"dot_dimension_numbers":{"lhs_contracting_dimensions":["1"],"rhs_contracting_dimensions":["1"],"lhs_batch_dimensions":["0"],"rhs_batch_dimensions":["0"]},"precision_config":{"operand_precision":["DEFAULT","DEFAULT"]},"epilogue":"DEFAULT","selected_algorithm":"-1","lhs_stride":"262144","rhs_stride":"16384","grad_x":false,"grad_y":false}}
  %get-tuple-element.62.0 = bf16[416,512,32]{2,1,0} get-tuple-element((bf16[416,512,32]{2,1,0}, s8[4194304]{0}) %custom-call.72.0), index=0, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/MultiHeadDotProductAttention_0/...qhd,...khd->...hqk/dot_general[dimension_numbers=(((2,), (1,)), ((0, 1), (0, 2))) precision=None preferred_element_type=bfloat16]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %get-tuple-element.65.0 = bf16[416,512,32]{2,1,0} get-tuple-element((bf16[416,512,32]{2,1,0}, s8[4194304]{0}) %custom-call.74.0), index=0, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/MultiHeadDotProductAttention_0/...qhd,...khd->...hqk/dot_general[dimension_numbers=(((3,), (1,)), ((0, 1), (0, 2))) precision=None preferred_element_type=bfloat16]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %input_reduce_transpose_fusion.2 = (bf16[52,512,8,32]{3,2,1,0}, f32[52,8,32]{2,1,0}, bf16[8,32,52,512]{3,2,1,0}) fusion(bf16[416,512,32]{2,1,0} %get-tuple-element.65.0), kind=kInput, calls=%fused_reduce_transpose.2, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/MultiHeadDotProductAttention_0/div" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158 deduplicated_name="input_reduce_transpose_fusion.2"}
  %get-tuple-element.94 = bf16[8,32,52,512]{3,2,1,0} get-tuple-element((bf16[52,512,8,32]{3,2,1,0}, f32[52,8,32]{2,1,0}, bf16[8,32,52,512]{3,2,1,0}) %input_reduce_transpose_fusion.2), index=2
  %bitcast.6000.0 = bf16[256,26624]{1,0} bitcast(bf16[8,32,52,512]{3,2,1,0} %get-tuple-element.94)
  %get-tuple-element.93 = f32[52,8,32]{2,1,0} get-tuple-element((bf16[52,512,8,32]{3,2,1,0}, f32[52,8,32]{2,1,0}, bf16[8,32,52,512]{3,2,1,0}) %input_reduce_transpose_fusion.2), index=1
  %get-tuple-element.92 = bf16[52,512,8,32]{3,2,1,0} get-tuple-element((bf16[52,512,8,32]{3,2,1,0}, f32[52,8,32]{2,1,0}, bf16[8,32,52,512]{3,2,1,0}) %input_reduce_transpose_fusion.2), index=0
  %bitcast.5838.0 = bf16[26624,256]{1,0} bitcast(bf16[52,512,8,32]{3,2,1,0} %get-tuple-element.92)
  %custom-call.75.0 = (bf16[26624,256]{1,0}, s8[4194304]{0}) custom-call(bf16[26624,256]{1,0} %bitcast.5838.0, bf16[256,256]{0,1} %bitcast.5842.0), custom_call_target="__cublas$gemm", metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/MultiHeadDotProductAttention_0/query/dot_general[dimension_numbers=(((2, 3), (1, 2)), ((), ())) precision=None preferred_element_type=None]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}, backend_config={"operation_queue_id":"0","wait_on_operation_queues":[],"gemm_backend_config":{"alpha_real":1,"alpha_imag":0,"beta":0,"dot_dimension_numbers":{"lhs_contracting_dimensions":["1"],"rhs_contracting_dimensions":["0"],"lhs_batch_dimensions":[],"rhs_batch_dimensions":[]},"precision_config":{"operand_precision":["DEFAULT","DEFAULT"]},"epilogue":"DEFAULT","selected_algorithm":"-1","lhs_stride":"6815744","rhs_stride":"65536","grad_x":false,"grad_y":false}}
  %get-tuple-element.66.0 = bf16[26624,256]{1,0} get-tuple-element((bf16[26624,256]{1,0}, s8[4194304]{0}) %custom-call.75.0), index=0, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/MultiHeadDotProductAttention_0/query/dot_general[dimension_numbers=(((2, 3), (1, 2)), ((), ())) precision=None preferred_element_type=None]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %custom-call.79.0 = (bf16[256,256]{0,1}, s8[4194304]{0}) custom-call(bf16[256,26624]{1,0} %bitcast.6000.0, bf16[26624,256]{1,0} %bitcast.6031.0), custom_call_target="__cublas$gemm", metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/MultiHeadDotProductAttention_0/query/dot_general[dimension_numbers=(((0, 1), (0, 1)), ((), ())) precision=None preferred_element_type=None]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}, backend_config={"operation_queue_id":"0","wait_on_operation_queues":[],"gemm_backend_config":{"alpha_real":1,"alpha_imag":0,"beta":0,"dot_dimension_numbers":{"lhs_contracting_dimensions":["1"],"rhs_contracting_dimensions":["0"],"lhs_batch_dimensions":[],"rhs_batch_dimensions":[]},"precision_config":{"operand_precision":["DEFAULT","DEFAULT"]},"epilogue":"DEFAULT","selected_algorithm":"-1","lhs_stride":"6815744","rhs_stride":"6815744","grad_x":false,"grad_y":false}}
  %get-tuple-element.70.0 = bf16[256,256]{0,1} get-tuple-element((bf16[256,256]{0,1}, s8[4194304]{0}) %custom-call.79.0), index=0, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/MultiHeadDotProductAttention_0/query/dot_general[dimension_numbers=(((0, 1), (0, 1)), ((), ())) precision=None preferred_element_type=None]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %loop_convert_fusion.6 = f32[256,8,32]{2,1,0} fusion(bf16[256,256]{0,1} %get-tuple-element.70.0), kind=kLoop, calls=%fused_convert.6, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/MultiHeadDotProductAttention_0/query/convert_element_type[new_dtype=float32 weak_type=False]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158 deduplicated_name="loop_convert_fusion.1"}
  %input_reduce_transpose_fusion = (bf16[8,32,52,512]{3,2,1,0}, bf16[52,512,8,32]{3,2,1,0}, f32[52,8,32]{2,1,0}) fusion(bf16[416,512,32]{2,1,0} %get-tuple-element.62.0), kind=kInput, calls=%fused_reduce_transpose, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/MultiHeadDotProductAttention_0/...qhd,...khd->...hqk/transpose[permutation=(0, 2, 1, 3)]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158 deduplicated_name="input_reduce_transpose_fusion"}
  %get-tuple-element.89 = f32[52,8,32]{2,1,0} get-tuple-element((bf16[8,32,52,512]{3,2,1,0}, bf16[52,512,8,32]{3,2,1,0}, f32[52,8,32]{2,1,0}) %input_reduce_transpose_fusion), index=2
  %input_reduce_fusion.30 = (f32[8,32]{1,0}, f32[8,32]{1,0}, f32[8,32]{1,0}, f32[8,32]{1,0}, f32[8,32]{1,0}) fusion(f32[52,8,32]{2,1,0} %get-tuple-element.93, f32[52,8,32]{2,1,0} %input_reduce_fusion.24, f32[52,8,32]{2,1,0} %get-tuple-element.89, f32[52,8,32]{2,1,0} %get-tuple-element.111, f32[52,8,32]{2,1,0} %get-tuple-element.117), kind=kInput, calls=%fused_reduce.30, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/MultiHeadDotProductAttention_0/query/reduce_sum[axes=(0, 1)]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %get-tuple-element.189 = f32[8,32]{1,0} get-tuple-element((f32[8,32]{1,0}, f32[8,32]{1,0}, f32[8,32]{1,0}, f32[8,32]{1,0}, f32[8,32]{1,0}) %input_reduce_fusion.30), index=4
  %get-tuple-element.188 = f32[8,32]{1,0} get-tuple-element((f32[8,32]{1,0}, f32[8,32]{1,0}, f32[8,32]{1,0}, f32[8,32]{1,0}, f32[8,32]{1,0}) %input_reduce_fusion.30), index=3
  %get-tuple-element.187 = f32[8,32]{1,0} get-tuple-element((f32[8,32]{1,0}, f32[8,32]{1,0}, f32[8,32]{1,0}, f32[8,32]{1,0}, f32[8,32]{1,0}) %input_reduce_fusion.30), index=2
  %get-tuple-element.186 = f32[8,32]{1,0} get-tuple-element((f32[8,32]{1,0}, f32[8,32]{1,0}, f32[8,32]{1,0}, f32[8,32]{1,0}, f32[8,32]{1,0}) %input_reduce_fusion.30), index=1
  %get-tuple-element.185 = f32[8,32]{1,0} get-tuple-element((f32[8,32]{1,0}, f32[8,32]{1,0}, f32[8,32]{1,0}, f32[8,32]{1,0}, f32[8,32]{1,0}) %input_reduce_fusion.30), index=0
  %get-tuple-element.88 = bf16[52,512,8,32]{3,2,1,0} get-tuple-element((bf16[8,32,52,512]{3,2,1,0}, bf16[52,512,8,32]{3,2,1,0}, f32[52,8,32]{2,1,0}) %input_reduce_transpose_fusion), index=1
  %get-tuple-element.87 = bf16[8,32,52,512]{3,2,1,0} get-tuple-element((bf16[8,32,52,512]{3,2,1,0}, bf16[52,512,8,32]{3,2,1,0}, f32[52,8,32]{2,1,0}) %input_reduce_transpose_fusion), index=0
  %bitcast.5947.0 = bf16[256,26624]{1,0} bitcast(bf16[8,32,52,512]{3,2,1,0} %get-tuple-element.87)
  %custom-call.77.0 = (bf16[256,256]{0,1}, s8[4194304]{0}) custom-call(bf16[256,26624]{1,0} %bitcast.5947.0, bf16[26624,256]{1,0} %bitcast.6031.0), custom_call_target="__cublas$gemm", metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/MultiHeadDotProductAttention_0/key/dot_general[dimension_numbers=(((0, 1), (0, 1)), ((), ())) precision=None preferred_element_type=None]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}, backend_config={"operation_queue_id":"0","wait_on_operation_queues":[],"gemm_backend_config":{"alpha_real":1,"alpha_imag":0,"beta":0,"dot_dimension_numbers":{"lhs_contracting_dimensions":["1"],"rhs_contracting_dimensions":["0"],"lhs_batch_dimensions":[],"rhs_batch_dimensions":[]},"precision_config":{"operand_precision":["DEFAULT","DEFAULT"]},"epilogue":"DEFAULT","selected_algorithm":"-1","lhs_stride":"6815744","rhs_stride":"6815744","grad_x":false,"grad_y":false}}
  %get-tuple-element.68.0 = bf16[256,256]{0,1} get-tuple-element((bf16[256,256]{0,1}, s8[4194304]{0}) %custom-call.77.0), index=0, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/MultiHeadDotProductAttention_0/key/dot_general[dimension_numbers=(((0, 1), (0, 1)), ((), ())) precision=None preferred_element_type=None]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %bitcast.5807.0 = bf16[26624,256]{1,0} bitcast(bf16[52,512,8,32]{3,2,1,0} %get-tuple-element.88)
  %loop_convert_fusion.8 = f32[256,8,32]{2,1,0} fusion(bf16[256,256]{0,1} %get-tuple-element.68.0), kind=kLoop, calls=%fused_convert.8, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/MultiHeadDotProductAttention_0/key/convert_element_type[new_dtype=float32 weak_type=False]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158 deduplicated_name="loop_convert_fusion.1"}
  %custom-call.73.0 = (bf16[26624,256]{1,0}, s8[4194304]{0}) custom-call(bf16[26624,256]{1,0} %bitcast.5807.0, bf16[256,256]{0,1} %bitcast.5811.0), custom_call_target="__cublas$gemm", metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/MultiHeadDotProductAttention_0/key/dot_general[dimension_numbers=(((2, 3), (1, 2)), ((), ())) precision=None preferred_element_type=None]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}, backend_config={"operation_queue_id":"0","wait_on_operation_queues":[],"gemm_backend_config":{"alpha_real":1,"alpha_imag":0,"beta":0,"dot_dimension_numbers":{"lhs_contracting_dimensions":["1"],"rhs_contracting_dimensions":["0"],"lhs_batch_dimensions":[],"rhs_batch_dimensions":[]},"precision_config":{"operand_precision":["DEFAULT","DEFAULT"]},"epilogue":"DEFAULT","selected_algorithm":"-1","lhs_stride":"6815744","rhs_stride":"65536","grad_x":false,"grad_y":false}}
  %get-tuple-element.63.0 = bf16[26624,256]{1,0} get-tuple-element((bf16[26624,256]{1,0}, s8[4194304]{0}) %custom-call.73.0), index=0, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/MultiHeadDotProductAttention_0/key/dot_general[dimension_numbers=(((2, 3), (1, 2)), ((), ())) precision=None preferred_element_type=None]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %cublas-gemm.5.0 = (bf16[26624,256]{1,0}, s8[4194304]{0}) custom-call(bf16[26624,256]{1,0} %bitcast.5739.0, bf16[256,256]{0,1} %bitcast.5743.0, bf16[26624,256]{1,0} %get-tuple-element.63.0), custom_call_target="__cublas$gemm", output_to_operand_aliasing={{0}: (2, {})}, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/MultiHeadDotProductAttention_0/value/dot_general[dimension_numbers=(((2, 3), (1, 2)), ((), ())) precision=None preferred_element_type=None]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}, backend_config={"operation_queue_id":"0","wait_on_operation_queues":[],"gemm_backend_config":{"alpha_real":1,"alpha_imag":0,"beta":1,"dot_dimension_numbers":{"lhs_contracting_dimensions":["1"],"rhs_contracting_dimensions":["0"],"lhs_batch_dimensions":[],"rhs_batch_dimensions":[]},"precision_config":{"operand_precision":["DEFAULT","DEFAULT"]},"epilogue":"DEFAULT","selected_algorithm":"-1","lhs_stride":"6815744","rhs_stride":"65536","grad_x":false,"grad_y":false}}
  %get-tuple-element.64.0 = bf16[26624,256]{1,0} get-tuple-element((bf16[26624,256]{1,0}, s8[4194304]{0}) %cublas-gemm.5.0), index=0, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/MultiHeadDotProductAttention_0/value/dot_general[dimension_numbers=(((2, 3), (1, 2)), ((), ())) precision=None preferred_element_type=None]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %input_reduce_fusion.4 = f32[208,256]{1,0} fusion(bf16[26624,256]{1,0} %get-tuple-element.66.0, bf16[26624,256]{1,0} %get-tuple-element.64.0), kind=kInput, calls=%fused_reduce.4, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/LayerNorm_0/reduce_sum[axes=(0, 1)]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156 deduplicated_name="input_reduce_fusion.2"}
  %input_reduce_fusion.41 = (f32[256]{0}, f32[256]{0}, f32[256]{0}, f32[256]{0}) fusion(f32[208,256]{1,0} %input_reduce_fusion.4, f32[208,256]{1,0} %input_reduce_fusion.3, f32[208,256]{1,0} %input_reduce_fusion.1, f32[208,256]{1,0} %input_reduce_fusion.2), kind=kInput, calls=%fused_reduce.41, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/LayerNorm_0/reduce_sum[axes=(0, 1)]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
  %input_transpose_fusion = f32[512,256,52]{2,1,0} fusion(bf16[26624,256]{1,0} %get-tuple-element.66.0, bf16[26624,256]{1,0} %get-tuple-element.64.0), kind=kInput, calls=%fused_transpose, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/LayerNorm_0/convert_element_type[new_dtype=float32 weak_type=False]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156 deduplicated_name="input_transpose_fusion"}
  %get-tuple-element.174 = f32[256]{0} get-tuple-element((f32[256]{0}, f32[256]{0}, f32[256]{0}, f32[256]{0}) %input_reduce_fusion.41), index=3
  %get-tuple-element.173 = f32[256]{0} get-tuple-element((f32[256]{0}, f32[256]{0}, f32[256]{0}, f32[256]{0}) %input_reduce_fusion.41), index=2
  %get-tuple-element.172 = f32[256]{0} get-tuple-element((f32[256]{0}, f32[256]{0}, f32[256]{0}, f32[256]{0}) %input_reduce_fusion.41), index=1
  %get-tuple-element.171 = f32[256]{0} get-tuple-element((f32[256]{0}, f32[256]{0}, f32[256]{0}, f32[256]{0}) %input_reduce_fusion.41), index=0
  %input_reduce_fusion.35 = (f32[512,52]{1,0}, f32[512,52]{1,0}) fusion(f32[512,256,52]{2,1,0} %input_transpose_fusion, f32[256]{0} %Arg_3.4.0, f32[1,512,52]{2,1,0} %get-tuple-element.159, f32[512,52]{1,0} %get-tuple-element.160, bf16[512,256]{1,0} %Arg_34.35.0, /*index=5*/bf16[512,256,52]{2,1,0} %input_transpose_fusion.10), kind=kInput, calls=%fused_reduce.35, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/LayerNorm_0/neg" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
  %get-tuple-element.86 = f32[512,52]{1,0} get-tuple-element((f32[512,52]{1,0}, f32[512,52]{1,0}) %input_reduce_fusion.35), index=1
  %get-tuple-element.85 = f32[512,52]{1,0} get-tuple-element((f32[512,52]{1,0}, f32[512,52]{1,0}) %input_reduce_fusion.35), index=0
  %loop_multiply_fusion.4 = (f32[512,52]{1,0}, f32[512,52]{1,0}) fusion(f32[1,512,52]{2,1,0} %get-tuple-element.159, f32[512,52]{1,0} %get-tuple-element.160, f32[512,52]{1,0} %get-tuple-element.162, f32[512,52]{1,0} %get-tuple-element.86, f32[512,52]{1,0} %get-tuple-element.85, /*index=5*/f32[512,52]{1,0} %get-tuple-element.161), kind=kLoop, calls=%fused_multiply.4, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/LayerNorm_0/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156 deduplicated_name="loop_multiply_fusion"}
  %get-tuple-element.84 = f32[512,52]{1,0} get-tuple-element((f32[512,52]{1,0}, f32[512,52]{1,0}) %loop_multiply_fusion.4), index=1
  %get-tuple-element.83 = f32[512,52]{1,0} get-tuple-element((f32[512,52]{1,0}, f32[512,52]{1,0}) %loop_multiply_fusion.4), index=0
  %input_reduce_fusion.19 = f32[512,256]{1,0} fusion(f32[1,512,52]{2,1,0} %get-tuple-element.159, f32[512,256,52]{2,1,0} %input_transpose_fusion, f32[512,52]{1,0} %get-tuple-element.160, bf16[512,256]{1,0} %Arg_34.35.0, bf16[512,256,52]{2,1,0} %input_transpose_fusion.10), kind=kInput, calls=%fused_reduce.19
  %input_add_transpose_fusion = (bf16[52,512,256]{2,1,0}, f32[512,256,52]{2,1,0}) fusion(f32[512,52]{1,0} %get-tuple-element.84, f32[512,52]{1,0} %get-tuple-element.83, bf16[512,256]{1,0} %Arg_34.35.0, bf16[512,256,52]{2,1,0} %input_transpose_fusion.10, f32[512,256,52]{2,1,0} %get-tuple-element.98, /*index=5*/f32[512,256,52]{2,1,0} %input_transpose_fusion, f32[256]{0} %Arg_3.4.0, f32[1,512,52]{2,1,0} %get-tuple-element.159), kind=kInput, calls=%fused_add_transpose, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/LayerNorm_0/add_any" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
  %input_reduce_fusion.40 = (f32[256]{0}, f32[256]{0}, f32[256]{0}, f32[256]{0}, f32[256]{0}) fusion(f32[512,256]{1,0} %get-tuple-element.136, f32[512,256]{1,0} %input_reduce_fusion.16, f32[512,256]{1,0} %input_reduce_fusion.17, f32[512,256]{1,0} %input_reduce_fusion.18, f32[512,256]{1,0} %input_reduce_fusion.19), kind=kInput, calls=%fused_reduce.40, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoder_norm/reduce_sum[axes=(0, 1)]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=228}
  %get-tuple-element.82 = f32[512,256,52]{2,1,0} get-tuple-element((bf16[52,512,256]{2,1,0}, f32[512,256,52]{2,1,0}) %input_add_transpose_fusion), index=1
  %get-tuple-element.81 = bf16[52,512,256]{2,1,0} get-tuple-element((bf16[52,512,256]{2,1,0}, f32[512,256,52]{2,1,0}) %input_add_transpose_fusion), index=0
  %bitcast.6400.0 = bf16[26624,256]{1,0} bitcast(bf16[52,512,256]{2,1,0} %get-tuple-element.81)
  %get-tuple-element.179 = f32[256]{0} get-tuple-element((f32[256]{0}, f32[256]{0}, f32[256]{0}, f32[256]{0}, f32[256]{0}) %input_reduce_fusion.40), index=4
  %get-tuple-element.178 = f32[256]{0} get-tuple-element((f32[256]{0}, f32[256]{0}, f32[256]{0}, f32[256]{0}, f32[256]{0}) %input_reduce_fusion.40), index=3
  %get-tuple-element.177 = f32[256]{0} get-tuple-element((f32[256]{0}, f32[256]{0}, f32[256]{0}, f32[256]{0}, f32[256]{0}) %input_reduce_fusion.40), index=2
  %get-tuple-element.176 = f32[256]{0} get-tuple-element((f32[256]{0}, f32[256]{0}, f32[256]{0}, f32[256]{0}, f32[256]{0}) %input_reduce_fusion.40), index=1
  %get-tuple-element.175 = f32[256]{0} get-tuple-element((f32[256]{0}, f32[256]{0}, f32[256]{0}, f32[256]{0}, f32[256]{0}) %input_reduce_fusion.40), index=0
  %input_reduce_fusion.34 = f32[512,256]{1,0} fusion(f32[512,256,52]{2,1,0} %get-tuple-element.82), kind=kInput, calls=%fused_reduce.34
  %input_transpose_fusion.23 = bf16[256,52,512]{2,1,0} fusion(f32[512,256,52]{2,1,0} %get-tuple-element.82), kind=kInput, calls=%fused_transpose.24, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/LayerNorm_0/add_any" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156 deduplicated_name="input_transpose_fusion.23"}
  %input_convert_reduce_fusion = (f32[256]{0}, bf16[512,256]{1,0}) fusion(f32[512,256]{1,0} %input_reduce_fusion.34), kind=kInput, calls=%fused_convert_reduce, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/im_embed/vmap(inner)/vmap(Patchify_0)/patch_proj/reduce_sum[axes=(0, 1)]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=40}
  %get-tuple-element.80 = bf16[512,256]{1,0} get-tuple-element((f32[256]{0}, bf16[512,256]{1,0}) %input_convert_reduce_fusion), index=1
  %get-tuple-element.79 = f32[256]{0} get-tuple-element((f32[256]{0}, bf16[512,256]{1,0}) %input_convert_reduce_fusion), index=0
  %bitcast.6376.0 = bf16[256,26624]{1,0} bitcast(bf16[256,52,512]{2,1,0} %input_transpose_fusion.23)
  %custom-call.86.0 = (bf16[1728,256]{1,0}, s8[4194304]{0}) custom-call(bf16[26624,1728]{1,0} %bitcast.6371.0, bf16[256,26624]{1,0} %bitcast.6376.0), custom_call_target="__cublas$gemm", metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/im_embed/vmap(inner)/vmap(Patchify_0)/patch_proj/transpose[permutation=(1, 0)]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=40}, backend_config={"operation_queue_id":"0","wait_on_operation_queues":[],"gemm_backend_config":{"alpha_real":1,"alpha_imag":0,"beta":0,"dot_dimension_numbers":{"lhs_contracting_dimensions":["0"],"rhs_contracting_dimensions":["1"],"lhs_batch_dimensions":[],"rhs_batch_dimensions":[]},"precision_config":{"operand_precision":["DEFAULT","DEFAULT"]},"epilogue":"DEFAULT","selected_algorithm":"-1","lhs_stride":"46006272","rhs_stride":"6815744","grad_x":false,"grad_y":false}}
  %get-tuple-element.77.0 = bf16[1728,256]{1,0} get-tuple-element((bf16[1728,256]{1,0}, s8[4194304]{0}) %custom-call.86.0), index=0, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/im_embed/vmap(inner)/vmap(Patchify_0)/patch_proj/transpose[permutation=(1, 0)]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=40}
  %wrapped_convert.11 = f32[1728,256]{1,0} fusion(bf16[1728,256]{1,0} %get-tuple-element.77.0), kind=kLoop, calls=%wrapped_convert_computation.11, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/im_embed/vmap(inner)/vmap(Patchify_0)/patch_proj/convert_element_type[new_dtype=float32 weak_type=False]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=40}
  %custom-call.87.0 = (bf16[26624,1728]{1,0}, s8[4194304]{0}) custom-call(bf16[26624,256]{1,0} %bitcast.6400.0, bf16[1728,256]{1,0} %wrapped_convert), custom_call_target="__cublas$gemm", metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/im_embed/vmap(inner)/vmap(Patchify_0)/patch_proj/dot_general[dimension_numbers=(((2,), (1,)), ((), ())) precision=None preferred_element_type=None]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=40}, backend_config={"operation_queue_id":"0","wait_on_operation_queues":[],"gemm_backend_config":{"alpha_real":1,"alpha_imag":0,"beta":0,"dot_dimension_numbers":{"lhs_contracting_dimensions":["1"],"rhs_contracting_dimensions":["1"],"lhs_batch_dimensions":[],"rhs_batch_dimensions":[]},"precision_config":{"operand_precision":["DEFAULT","DEFAULT"]},"epilogue":"DEFAULT","selected_algorithm":"-1","lhs_stride":"6815744","rhs_stride":"442368","grad_x":false,"grad_y":false}}
  %get-tuple-element.78.0 = bf16[26624,1728]{1,0} get-tuple-element((bf16[26624,1728]{1,0}, s8[4194304]{0}) %custom-call.87.0), index=0, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/im_embed/vmap(inner)/vmap(Patchify_0)/patch_proj/dot_general[dimension_numbers=(((2,), (1,)), ((), ())) precision=None preferred_element_type=None]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=40}
  %input_reduce_fusion.5 = f32[216,5,52,64]{3,2,1,0} fusion(bf16[13824,5,52]{2,1,0} %constant_124_0, bf16[26624,1728]{1,0} %get-tuple-element.78.0), kind=kInput, calls=%fused_reduce.5, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/spec_embed/vmap(vmap(vmap(species_embed)))/reduce_sum[axes=(0,)]" source_file="/home/nicholas/programs/avid/avid/encoder.py" source_line=38}
  %input_scatter_fusion = bf16[56,64]{1,0} fusion(bf16[56,64]{1,0} %loop_broadcast_fusion, s32[260,1]{1,0} %constant_121_0, f32[216,5,52,64]{3,2,1,0} %input_reduce_fusion.5), kind=kInput, calls=%fused_scatter, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/spec_embed/vmap(vmap(vmap(species_embed)))/species_embed/jit(_take)/scatter-add[update_consts=() dimension_numbers=ScatterDimensionNumbers(update_window_dims=(2,), inserted_window_dims=(0,), scatter_dims_to_operand_dims=(0,)) indices_are_sorted=False unique_indices=False mode=GatherScatterMode.FILL_OR_DROP]" source_file="/home/nicholas/programs/avid/avid/encoder.py" source_line=38}
  %wrapped_convert.12 = f32[56,64]{1,0} fusion(bf16[56,64]{1,0} %input_scatter_fusion), kind=kLoop, calls=%wrapped_convert_computation.12, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/spec_embed/vmap(vmap(vmap(species_embed)))/species_embed/convert_element_type[new_dtype=float32 weak_type=False]" source_file="/home/nicholas/programs/avid/avid/encoder.py" source_line=38}
  ROOT %tuple.1335.0 = (bf16[], f32[256]{0}, f32[256]{0}, f32[256]{0}, f32[256]{0}, /*index=5*/f32[256]{0}, f32[256]{0}, f32[256]{0}, f32[256,256]{1,0}, f32[8,32]{1,0}, /*index=10*/f32[256,8,32]{2,1,0}, f32[256]{0}, f32[8,32,256]{2,1,0}, f32[8,32]{1,0}, f32[256,8,32]{2,1,0}, /*index=15*/f32[8,32]{1,0}, f32[256,8,32]{2,1,0}, f32[256]{0}, f32[256]{0}, f32[256]{0}, /*index=20*/f32[256]{0}, f32[256]{0}, f32[256,256]{1,0}, f32[8,32]{1,0}, f32[256,8,32]{2,1,0}, /*index=25*/f32[256]{0}, f32[8,32,256]{2,1,0}, f32[8,32]{1,0}, f32[256,8,32]{2,1,0}, f32[8,32]{1,0}, /*index=30*/f32[256,8,32]{2,1,0}, f32[1]{0}, f32[256,1]{1,0}, f32[256]{0}, f32[1728,256]{1,0}, /*index=35*/bf16[512,256]{1,0}, f32[56,64]{1,0}) tuple(bf16[] %loop_convert_fusion.15, f32[256]{0} %get-tuple-element.180, f32[256]{0} %get-tuple-element.175, f32[256]{0} %get-tuple-element.171, f32[256]{0} %get-tuple-element.179, /*index=5*/f32[256]{0} %get-tuple-element.172, f32[256]{0} %get-tuple-element.178, f32[256]{0} %get-tuple-element.182, f32[256,256]{1,0} %get-tuple-element.163, f32[8,32]{1,0} %get-tuple-element.187, /*index=10*/f32[256,8,32]{2,1,0} %loop_convert_fusion.8, f32[256]{0} %get-tuple-element.181, f32[8,32,256]{2,1,0} %loop_convert_fusion.7, f32[8,32]{1,0} %get-tuple-element.185, f32[256,8,32]{2,1,0} %loop_convert_fusion.6, /*index=15*/f32[8,32]{1,0} %get-tuple-element.186, f32[256,8,32]{2,1,0} %loop_convert_fusion.5, f32[256]{0} %get-tuple-element.174, f32[256]{0} %get-tuple-element.177, f32[256]{0} %get-tuple-element.173, /*index=20*/f32[256]{0} %get-tuple-element.176, f32[256]{0} %get-tuple-element.183, f32[256,256]{1,0} %get-tuple-element.170, f32[8,32]{1,0} %get-tuple-element.188, f32[256,8,32]{2,1,0} %loop_convert_fusion.4, /*index=25*/f32[256]{0} %get-tuple-element.184, f32[8,32,256]{2,1,0} %loop_convert_fusion.3, f32[8,32]{1,0} %get-tuple-element.189, f32[256,8,32]{2,1,0} %loop_convert_fusion.2, f32[8,32]{1,0} %input_reduce_fusion.33, /*index=30*/f32[256,8,32]{2,1,0} %loop_convert_fusion.1, f32[1]{0} %input_reduce_fusion, f32[256,1]{1,0} %get-tuple-element.139, f32[256]{0} %get-tuple-element.79, f32[1728,256]{1,0} %wrapped_convert.11, /*index=35*/bf16[512,256]{1,0} %get-tuple-element.80, f32[56,64]{1,0} %wrapped_convert.12)
}


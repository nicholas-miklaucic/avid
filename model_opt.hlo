HloModule jit_loss, is_scheduled=true, entry_computation_layout={(f32[256]{0}, f32[256]{0}, f32[256]{0}, f32[256]{0}, f32[256]{0}, /*index=5*/f32[256]{0}, f32[256]{0}, f32[256,256]{1,0}, f32[4,64]{1,0}, f32[256,4,64]{2,1,0}, /*index=10*/f32[256]{0}, f32[4,64,256]{2,1,0}, f32[4,64]{1,0}, f32[256,4,64]{2,1,0}, f32[4,64]{1,0}, /*index=15*/f32[256,4,64]{2,1,0}, f32[256]{0}, f32[256]{0}, f32[256]{0}, f32[256]{0}, /*index=20*/f32[256]{0}, f32[256,256]{1,0}, f32[4,64]{1,0}, f32[256,4,64]{2,1,0}, f32[256]{0}, /*index=25*/f32[4,64,256]{2,1,0}, f32[4,64]{1,0}, f32[256,4,64]{2,1,0}, f32[4,64]{1,0}, f32[256,4,64]{2,1,0}, /*index=30*/f32[1]{0}, f32[256,1]{1,0}, f32[256]{0}, f32[1728,256]{1,0}, bf16[512,256]{1,0}, /*index=35*/f32[64]{0}, f32[64,64]{1,0}, f32[56,63]{1,0})->(bf16[], f32[256]{0}, f32[256]{0}, f32[256]{0}, f32[256]{0}, /*index=5*/f32[256]{0}, f32[256]{0}, f32[256]{0}, f32[256,256]{1,0}, f32[4,64]{1,0}, /*index=10*/f32[256,4,64]{2,1,0}, f32[256]{0}, f32[4,64,256]{2,1,0}, f32[4,64]{1,0}, f32[256,4,64]{2,1,0}, /*index=15*/f32[4,64]{1,0}, f32[256,4,64]{2,1,0}, f32[256]{0}, f32[256]{0}, f32[256]{0}, /*index=20*/f32[256]{0}, f32[256]{0}, f32[256,256]{1,0}, f32[4,64]{1,0}, f32[256,4,64]{2,1,0}, /*index=25*/f32[256]{0}, f32[4,64,256]{2,1,0}, f32[4,64]{1,0}, f32[256,4,64]{2,1,0}, f32[4,64]{1,0}, /*index=30*/f32[256,4,64]{2,1,0}, f32[1]{0}, f32[256,1]{1,0}, f32[256]{0}, f32[1728,256]{1,0}, /*index=35*/bf16[512,256]{1,0}, f32[64]{0}, f32[64,64]{1,0}, f32[56,63]{1,0})}, allow_spmd_sharding_propagation_to_output={true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true}, frontend_attributes={fingerprint_before_lhs="934d5b60df8d01668e6097c87a469e4d"}

%fused_convert (param_0.2: bf16[], param_1.2: bf16[]) -> bf16[] {
  %param_1.2 = bf16[] parameter(1)
  %convert.1389.1 = f32[] convert(bf16[] %param_1.2)
  %param_0.2 = bf16[] parameter(0)
  %convert.1390.1 = f32[] convert(bf16[] %param_0.2)
  %add.184.1 = f32[] add(f32[] %convert.1389.1, f32[] %convert.1390.1), metadata={op_name="jit(loss)/jit(main)/reduce_sum[axes=(1,)]" source_file="/home/nicholas/programs/avid/avid/config.py" source_line=371}
  ROOT %convert.1392.1 = bf16[] convert(f32[] %add.184.1)
}

%region_18.769 (Arg_0.770.0: bf16[], Arg_1.771.0: bf16[]) -> bf16[] {
  %Arg_1.771.0 = bf16[] parameter(1)
  %Arg_0.770.0 = bf16[] parameter(0)
  ROOT %loop_convert_fusion = bf16[] fusion(bf16[] %Arg_1.771.0, bf16[] %Arg_0.770.0), kind=kLoop, calls=%fused_convert
}

%region_18.769.clone.30 (Arg_0.33.0: f32[], Arg_1.33.0: f32[]) -> f32[] {
  %Arg_1.33.0 = f32[] parameter(1)
  %Arg_0.33.0 = f32[] parameter(0)
  ROOT %add.214.0 = f32[] add(f32[] %Arg_0.33.0, f32[] %Arg_1.33.0), metadata={op_name="jit(loss)/jit(main)/reduce_sum[axes=(1,)]" source_file="/home/nicholas/programs/avid/avid/config.py" source_line=371}
}

%fused_scatter (param_0.3: bf16[56,63], param_1.3: s32[260,1], param_2.646: f32[216,5,52,63]) -> bf16[56,63] {
  %param_0.3 = bf16[56,63]{1,0} parameter(0)
  %param_1.3 = s32[260,1]{1,0} parameter(1)
  %param_2.646 = f32[216,5,52,63]{3,2,1,0} parameter(2)
  %constant_55_3 = bf16[] constant(0)
  %convert.1640.35 = f32[] convert(bf16[] %constant_55_3)
  %reduce.1398.5 = f32[5,52,63]{2,1,0} reduce(f32[216,5,52,63]{3,2,1,0} %param_2.646, f32[] %convert.1640.35), dimensions={0}, to_apply=%region_18.769.clone.30, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/spec_embed/vmap(vmap(vmap(species_embed)))/reduce_sum[axes=(0,)]" source_file="/home/nicholas/programs/avid/avid/encoder.py" source_line=36}
  %convert.1612.3 = bf16[5,52,63]{2,1,0} convert(f32[5,52,63]{2,1,0} %reduce.1398.5)
  %bitcast.6817.1 = bf16[260,1,63]{2,0,1} bitcast(bf16[5,52,63]{2,1,0} %convert.1612.3)
  ROOT %scatter.0.1 = bf16[56,63]{1,0} scatter(bf16[56,63]{1,0} %param_0.3, s32[260,1]{1,0} %param_1.3, bf16[260,1,63]{2,0,1} %bitcast.6817.1), update_window_dims={1,2}, inserted_window_dims={}, scatter_dims_to_operand_dims={0}, index_vector_dim=1, to_apply=%region_18.769, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/spec_embed/vmap(vmap(vmap(species_embed)))/species_embed/jit(_take)/scatter-add[update_consts=() dimension_numbers=ScatterDimensionNumbers(update_window_dims=(2,), inserted_window_dims=(0,), scatter_dims_to_operand_dims=(0,)) indices_are_sorted=False unique_indices=False mode=GatherScatterMode.FILL_OR_DROP]" source_file="/home/nicholas/programs/avid/avid/encoder.py" source_line=36}
}

%region_18.769.clone.23 (Arg_0.26.0: f32[], Arg_1.26.0: f32[]) -> f32[] {
  %Arg_1.26.0 = f32[] parameter(1)
  %Arg_0.26.0 = f32[] parameter(0)
  ROOT %add.186.0 = f32[] add(f32[] %Arg_0.26.0, f32[] %Arg_1.26.0), metadata={op_name="jit(loss)/jit(main)/reduce_sum[axes=(1,)]" source_file="/home/nicholas/programs/avid/avid/config.py" source_line=371}
}

%fused_reduce (param_0.1304: bf16[52,52], param_1.1399: bf16[52,52]) -> f32[1] {
  %param_1.1399 = bf16[52,52]{1,0} parameter(1)
  %convert.1506.7 = f32[52,52]{1,0} convert(bf16[52,52]{1,0} %param_1.1399)
  %param_0.1304 = bf16[52,52]{1,0} parameter(0)
  %convert.1507.7 = f32[52,52]{1,0} convert(bf16[52,52]{1,0} %param_0.1304)
  %negate.34.7 = f32[52,52]{1,0} negate(f32[52,52]{1,0} %convert.1507.7), metadata={op_name="jit(loss)/jit(main)/neg" source_file="/home/nicholas/programs/avid/avid/config.py" source_line=371}
  %add.248.7 = f32[52,52]{1,0} add(f32[52,52]{1,0} %convert.1506.7, f32[52,52]{1,0} %negate.34.7), metadata={op_name="jit(loss)/jit(main)/add_any" source_file="/home/nicholas/programs/avid/avid/config.py" source_line=371}
  %convert.1586.3 = bf16[52,52]{1,0} convert(f32[52,52]{1,0} %add.248.7)
  %bitcast.6574.7 = bf16[2704]{0} bitcast(bf16[52,52]{1,0} %convert.1586.3)
  %convert.1587.7 = f32[2704]{0} convert(bf16[2704]{0} %bitcast.6574.7)
  %constant_55_28 = bf16[] constant(0)
  %convert.1640.45 = f32[] convert(bf16[] %constant_55_28)
  %reduce.5.5 = f32[] reduce(f32[2704]{0} %convert.1587.7, f32[] %convert.1640.45), dimensions={0}, to_apply=%region_18.769.clone.23, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/vmap(head)/Dense_0/reduce_sum[axes=(0,)]" source_file="/home/nicholas/programs/avid/avid/layers.py" source_line=49}
  %convert.1589.3 = bf16[] convert(f32[] %reduce.5.5)
  %bitcast.6583.1 = bf16[1]{0} bitcast(bf16[] %convert.1589.3)
  ROOT %convert.1590.1 = f32[1]{0} convert(bf16[1]{0} %bitcast.6583.1), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/vmap(head)/Dense_0/convert_element_type[new_dtype=float32 weak_type=False]" source_file="/home/nicholas/programs/avid/avid/layers.py" source_line=49}
}

%fused_convert.1 (param_0.27: bf16[256,256]) -> f32[256,4,64] {
  %param_0.27 = bf16[256,256]{0,1} parameter(0)
  %bitcast.6568.1 = bf16[256,4,64]{2,1,0} bitcast(bf16[256,256]{0,1} %param_0.27)
  ROOT %convert.1585.1 = f32[256,4,64]{2,1,0} convert(bf16[256,4,64]{2,1,0} %bitcast.6568.1), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/MultiHeadDotProductAttention_0/value/convert_element_type[new_dtype=float32 weak_type=False]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
}

%fused_convert.2 (param_0.29: bf16[256,256]) -> f32[256,4,64] {
  %param_0.29 = bf16[256,256]{0,1} parameter(0)
  %bitcast.6539.1 = bf16[256,4,64]{2,1,0} bitcast(bf16[256,256]{0,1} %param_0.29)
  ROOT %convert.1581.1 = f32[256,4,64]{2,1,0} convert(bf16[256,4,64]{2,1,0} %bitcast.6539.1), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/MultiHeadDotProductAttention_0/query/convert_element_type[new_dtype=float32 weak_type=False]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
}

%fused_convert.3 (param_0.31: bf16[256,256]) -> f32[4,64,256] {
  %param_0.31 = bf16[256,256]{0,1} parameter(0)
  %bitcast.6515.1 = bf16[4,64,256]{2,1,0} bitcast(bf16[256,256]{0,1} %param_0.31)
  ROOT %convert.1578.1 = f32[4,64,256]{2,1,0} convert(bf16[4,64,256]{2,1,0} %bitcast.6515.1), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/MultiHeadDotProductAttention_0/out/convert_element_type[new_dtype=float32 weak_type=False]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
}

%fused_convert.4 (param_0.33: bf16[256,256]) -> f32[256,4,64] {
  %param_0.33 = bf16[256,256]{0,1} parameter(0)
  %bitcast.6486.1 = bf16[256,4,64]{2,1,0} bitcast(bf16[256,256]{0,1} %param_0.33)
  ROOT %convert.1574.1 = f32[256,4,64]{2,1,0} convert(bf16[256,4,64]{2,1,0} %bitcast.6486.1), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/MultiHeadDotProductAttention_0/key/convert_element_type[new_dtype=float32 weak_type=False]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
}

%region_2.202 (Arg_0.203.0: f32[], Arg_1.204.0: f32[]) -> f32[] {
  %Arg_1.204.0 = f32[] parameter(1)
  %Arg_0.203.0 = f32[] parameter(0)
  ROOT %add.180.0 = f32[] add(f32[] %Arg_0.203.0, f32[] %Arg_1.204.0), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/LayerNorm_0/reduce_sum[axes=(2,)]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
}

%fused_reduce.1 (param_0.1311: bf16[26624,256]) -> f32[208,256] {
  %param_0.1311 = bf16[26624,256]{1,0} parameter(0)
  %convert.1513.1 = f32[26624,256]{1,0} convert(bf16[26624,256]{1,0} %param_0.1311), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/LayerNorm_1/convert_element_type[new_dtype=float32 weak_type=False]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
  %bitcast.6411.1 = f32[208,128,256]{2,1,0} bitcast(f32[26624,256]{1,0} %convert.1513.1)
  %constant_68_2 = f32[] constant(0)
  ROOT %reduce.86.1 = f32[208,256]{1,0} reduce(f32[208,128,256]{2,1,0} %bitcast.6411.1, f32[] %constant_68_2), dimensions={1}, to_apply=%region_2.202, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/LayerNorm_1/reduce_sum[axes=(0, 1)]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
}

%fused_reduce.2 (param_0.1356: bf16[26624,256], param_1.1448: bf16[26624,256]) -> f32[208,256] {
  %param_1.1448 = bf16[26624,256]{1,0} parameter(1)
  %convert.1525.5 = f32[26624,256]{1,0} convert(bf16[26624,256]{1,0} %param_1.1448)
  %param_0.1356 = bf16[26624,256]{1,0} parameter(0)
  %convert.1529.5 = f32[26624,256]{1,0} convert(bf16[26624,256]{1,0} %param_0.1356)
  %add.258.5 = f32[26624,256]{1,0} add(f32[26624,256]{1,0} %convert.1525.5, f32[26624,256]{1,0} %convert.1529.5), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/MultiHeadDotProductAttention_0/query/add_any" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %bitcast.6386.1 = f32[208,128,256]{2,1,0} bitcast(f32[26624,256]{1,0} %add.258.5)
  %constant_68_47 = f32[] constant(0)
  ROOT %reduce.82.1 = f32[208,256]{1,0} reduce(f32[208,128,256]{2,1,0} %bitcast.6386.1, f32[] %constant_68_47), dimensions={1}, to_apply=%region_2.202, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/LayerNorm_0/reduce_sum[axes=(0, 1)]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
}

%fused_convert.5 (param_0.39: bf16[256,256]) -> f32[256,4,64] {
  %param_0.39 = bf16[256,256]{0,1} parameter(0)
  %bitcast.6380.1 = bf16[256,4,64]{2,1,0} bitcast(bf16[256,256]{0,1} %param_0.39)
  ROOT %convert.1566.1 = f32[256,4,64]{2,1,0} convert(bf16[256,4,64]{2,1,0} %bitcast.6380.1), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/MultiHeadDotProductAttention_0/value/convert_element_type[new_dtype=float32 weak_type=False]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
}

%fused_convert.6 (param_0.41: bf16[256,256]) -> f32[256,4,64] {
  %param_0.41 = bf16[256,256]{0,1} parameter(0)
  %bitcast.6351.1 = bf16[256,4,64]{2,1,0} bitcast(bf16[256,256]{0,1} %param_0.41)
  ROOT %convert.1562.1 = f32[256,4,64]{2,1,0} convert(bf16[256,4,64]{2,1,0} %bitcast.6351.1), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/MultiHeadDotProductAttention_0/query/convert_element_type[new_dtype=float32 weak_type=False]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
}

%fused_convert.7 (param_0.43: bf16[256,256]) -> f32[4,64,256] {
  %param_0.43 = bf16[256,256]{0,1} parameter(0)
  %bitcast.6327.1 = bf16[4,64,256]{2,1,0} bitcast(bf16[256,256]{0,1} %param_0.43)
  ROOT %convert.1559.1 = f32[4,64,256]{2,1,0} convert(bf16[4,64,256]{2,1,0} %bitcast.6327.1), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/MultiHeadDotProductAttention_0/out/convert_element_type[new_dtype=float32 weak_type=False]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
}

%fused_convert.8 (param_0.45: bf16[256,256]) -> f32[256,4,64] {
  %param_0.45 = bf16[256,256]{0,1} parameter(0)
  %bitcast.6298.1 = bf16[256,4,64]{2,1,0} bitcast(bf16[256,256]{0,1} %param_0.45)
  ROOT %convert.1555.1 = f32[256,4,64]{2,1,0} convert(bf16[256,4,64]{2,1,0} %bitcast.6298.1), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/MultiHeadDotProductAttention_0/key/convert_element_type[new_dtype=float32 weak_type=False]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
}

%fused_reduce.3 (param_0.1354: bf16[26624,256]) -> f32[208,256] {
  %param_0.1354 = bf16[26624,256]{1,0} parameter(0)
  %convert.1531.1 = f32[26624,256]{1,0} convert(bf16[26624,256]{1,0} %param_0.1354), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/LayerNorm_1/convert_element_type[new_dtype=float32 weak_type=False]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
  %bitcast.6223.1 = f32[208,128,256]{2,1,0} bitcast(f32[26624,256]{1,0} %convert.1531.1)
  %constant_68_45 = f32[] constant(0)
  ROOT %reduce.72.1 = f32[208,256]{1,0} reduce(f32[208,128,256]{2,1,0} %bitcast.6223.1, f32[] %constant_68_45), dimensions={1}, to_apply=%region_2.202, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/LayerNorm_1/reduce_sum[axes=(0, 1)]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
}

%fused_transpose (param_0.616: bf16[26624,256], param_1.562: bf16[26624,256]) -> f32[512,256,52] {
  %param_1.562 = bf16[26624,256]{1,0} parameter(1)
  %convert.1543.3 = f32[26624,256]{1,0} convert(bf16[26624,256]{1,0} %param_1.562)
  %param_0.616 = bf16[26624,256]{1,0} parameter(0)
  %convert.1547.3 = f32[26624,256]{1,0} convert(bf16[26624,256]{1,0} %param_0.616)
  %add.270.3 = f32[26624,256]{1,0} add(f32[26624,256]{1,0} %convert.1543.3, f32[26624,256]{1,0} %convert.1547.3), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/MultiHeadDotProductAttention_0/query/add_any" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %bitcast.6205.1 = f32[52,512,256]{2,1,0} bitcast(f32[26624,256]{1,0} %add.270.3)
  ROOT %transpose.1222.1 = f32[512,256,52]{2,1,0} transpose(f32[52,512,256]{2,1,0} %bitcast.6205.1), dimensions={1,2,0}, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/LayerNorm_0/convert_element_type[new_dtype=float32 weak_type=False]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
}

%fused_reduce.4 (param_0.1352: bf16[26624,256], param_1.1445: bf16[26624,256]) -> f32[208,256] {
  %param_1.1445 = bf16[26624,256]{1,0} parameter(1)
  %convert.1543.5 = f32[26624,256]{1,0} convert(bf16[26624,256]{1,0} %param_1.1445)
  %param_0.1352 = bf16[26624,256]{1,0} parameter(0)
  %convert.1547.5 = f32[26624,256]{1,0} convert(bf16[26624,256]{1,0} %param_0.1352)
  %add.270.5 = f32[26624,256]{1,0} add(f32[26624,256]{1,0} %convert.1543.5, f32[26624,256]{1,0} %convert.1547.5), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/MultiHeadDotProductAttention_0/query/add_any" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %bitcast.6194.1 = f32[208,128,256]{2,1,0} bitcast(f32[26624,256]{1,0} %add.270.5)
  %constant_68_43 = f32[] constant(0)
  ROOT %reduce.68.1 = f32[208,256]{1,0} reduce(f32[208,128,256]{2,1,0} %bitcast.6194.1, f32[] %constant_68_43), dimensions={1}, to_apply=%region_2.202, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/LayerNorm_0/reduce_sum[axes=(0, 1)]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
}

%region_18.769.clone.5 (Arg_0.8.0: f32[], Arg_1.8.0: f32[]) -> f32[] {
  %Arg_1.8.0 = f32[] parameter(1)
  %Arg_0.8.0 = f32[] parameter(0)
  ROOT %add.187.0 = f32[] add(f32[] %Arg_0.8.0, f32[] %Arg_1.8.0), metadata={op_name="jit(loss)/jit(main)/reduce_sum[axes=(1,)]" source_file="/home/nicholas/programs/avid/avid/config.py" source_line=371}
}

%fused_reduce_transpose (param_0.59: bf16[208,512,64]) -> (bf16[4,64,52,512], bf16[52,512,4,64], f32[52,4,64]) {
  %param_0.59 = bf16[208,512,64]{2,1,0} parameter(0)
  %bitcast.6149.3 = bf16[52,4,512,64]{3,2,1,0} bitcast(bf16[208,512,64]{2,1,0} %param_0.59)
  %transpose.1224.1 = bf16[4,64,52,512]{3,2,1,0} transpose(bf16[52,4,512,64]{3,2,1,0} %bitcast.6149.3), dimensions={1,3,0,2}, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/MultiHeadDotProductAttention_0/...qhd,...khd->...hqk/transpose[permutation=(0, 2, 1, 3)]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %transpose.1219.1.clone.1 = bf16[52,512,4,64]{3,2,1,0} transpose(bf16[52,4,512,64]{3,2,1,0} %bitcast.6149.3), dimensions={0,2,1,3}, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/MultiHeadDotProductAttention_0/...qhd,...khd->...hqk/transpose[permutation=(0, 2, 1, 3)]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %convert.1552.3.clone.1 = f32[52,4,512,64]{3,2,1,0} convert(bf16[52,4,512,64]{3,2,1,0} %bitcast.6149.3)
  %constant_55_10_clone_1 = bf16[] constant(0)
  %convert.1640.7.clone.1 = f32[] convert(bf16[] %constant_55_10_clone_1)
  %reduce.56.1.clone.1 = f32[52,4,64]{2,1,0} reduce(f32[52,4,512,64]{3,2,1,0} %convert.1552.3.clone.1, f32[] %convert.1640.7.clone.1), dimensions={2}, to_apply=%region_18.769.clone.5, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/MultiHeadDotProductAttention_0/key/reduce_sum[axes=(0, 1)]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  ROOT %tuple.24 = (bf16[4,64,52,512]{3,2,1,0}, bf16[52,512,4,64]{3,2,1,0}, f32[52,4,64]{2,1,0}) tuple(bf16[4,64,52,512]{3,2,1,0} %transpose.1224.1, bf16[52,512,4,64]{3,2,1,0} %transpose.1219.1.clone.1, f32[52,4,64]{2,1,0} %reduce.56.1.clone.1)
}

%fused_transpose.1 (param_0.67: bf16[208,64,512]) -> (bf16[4,64,52,512], bf16[52,512,4,64]) {
  %param_0.67 = bf16[208,64,512]{2,1,0} parameter(0)
  %bitcast.6081.3 = bf16[52,4,64,512]{3,2,1,0} bitcast(bf16[208,64,512]{2,1,0} %param_0.67)
  %transpose.1227.1 = bf16[4,64,52,512]{3,2,1,0} transpose(bf16[52,4,64,512]{3,2,1,0} %bitcast.6081.3), dimensions={1,2,0,3}, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/MultiHeadDotProductAttention_0/...hqk,...khd->...qhd/transpose[permutation=(0, 3, 1, 2)]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %transpose.1217.1.clone.1 = bf16[52,512,4,64]{3,2,1,0} transpose(bf16[52,4,64,512]{3,2,1,0} %bitcast.6081.3), dimensions={0,3,1,2}, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/MultiHeadDotProductAttention_0/...hqk,...khd->...qhd/transpose[permutation=(0, 3, 1, 2)]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  ROOT %tuple.25 = (bf16[4,64,52,512]{3,2,1,0}, bf16[52,512,4,64]{3,2,1,0}) tuple(bf16[4,64,52,512]{3,2,1,0} %transpose.1227.1, bf16[52,512,4,64]{3,2,1,0} %transpose.1217.1.clone.1)
}

%fused_transpose.2 (param_0.71: bf16[26624,256]) -> (bf16[52,4,512,64], bf16[52,4,64,512]) {
  %param_0.71 = bf16[26624,256]{1,0} parameter(0)
  %bitcast.6070.2 = bf16[52,512,4,64]{3,2,1,0} bitcast(bf16[26624,256]{1,0} %param_0.71)
  %transpose.1218.1 = bf16[52,4,512,64]{3,2,1,0} transpose(bf16[52,512,4,64]{3,2,1,0} %bitcast.6070.2), dimensions={0,2,1,3}, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/MultiHeadDotProductAttention_0/...hqk,...khd->...qhd/transpose[permutation=(0, 2, 3, 1)]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %transpose.1216.1.clone.1 = bf16[52,4,64,512]{3,2,1,0} transpose(bf16[52,512,4,64]{3,2,1,0} %bitcast.6070.2), dimensions={0,2,3,1}, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/MultiHeadDotProductAttention_0/out/dot_general[dimension_numbers=(((2,), (2,)), ((), ())) precision=None preferred_element_type=None]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  ROOT %tuple.29 = (bf16[52,4,512,64]{3,2,1,0}, bf16[52,4,64,512]{3,2,1,0}) tuple(bf16[52,4,512,64]{3,2,1,0} %transpose.1218.1, bf16[52,4,64,512]{3,2,1,0} %transpose.1216.1.clone.1)
}

%fused_transpose.3 (param_0.412: bf16[26624,256]) -> f32[512,256,52] {
  %param_0.412 = bf16[26624,256]{1,0} parameter(0)
  %convert.1531.2 = f32[26624,256]{1,0} convert(bf16[26624,256]{1,0} %param_0.412), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/LayerNorm_1/convert_element_type[new_dtype=float32 weak_type=False]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
  %bitcast.5958.1 = f32[52,512,256]{2,1,0} bitcast(f32[26624,256]{1,0} %convert.1531.2)
  ROOT %transpose.1214.1 = f32[512,256,52]{2,1,0} transpose(f32[52,512,256]{2,1,0} %bitcast.5958.1), dimensions={1,2,0}, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/LayerNorm_1/convert_element_type[new_dtype=float32 weak_type=False]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
}

%fused_transpose.4 (param_0.612: bf16[26624,256], param_1.555: bf16[26624,256]) -> f32[512,256,52] {
  %param_1.555 = bf16[26624,256]{1,0} parameter(1)
  %convert.1525.3 = f32[26624,256]{1,0} convert(bf16[26624,256]{1,0} %param_1.555)
  %param_0.612 = bf16[26624,256]{1,0} parameter(0)
  %convert.1529.3 = f32[26624,256]{1,0} convert(bf16[26624,256]{1,0} %param_0.612)
  %add.258.3 = f32[26624,256]{1,0} add(f32[26624,256]{1,0} %convert.1525.3, f32[26624,256]{1,0} %convert.1529.3), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/MultiHeadDotProductAttention_0/query/add_any" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %bitcast.5845.1 = f32[52,512,256]{2,1,0} bitcast(f32[26624,256]{1,0} %add.258.3)
  ROOT %transpose.1212.1 = f32[512,256,52]{2,1,0} transpose(f32[52,512,256]{2,1,0} %bitcast.5845.1), dimensions={1,2,0}, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/LayerNorm_0/convert_element_type[new_dtype=float32 weak_type=False]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
}

%region_18.769.clone.15 (Arg_0.18.0: f32[], Arg_1.18.0: f32[]) -> f32[] {
  %Arg_1.18.0 = f32[] parameter(1)
  %Arg_0.18.0 = f32[] parameter(0)
  ROOT %add.191.0 = f32[] add(f32[] %Arg_0.18.0, f32[] %Arg_1.18.0), metadata={op_name="jit(loss)/jit(main)/reduce_sum[axes=(1,)]" source_file="/home/nicholas/programs/avid/avid/config.py" source_line=371}
}

%fused_reduce_transpose.1 (param_0.91: bf16[208,512,64]) -> (bf16[4,64,52,512], bf16[52,512,4,64], f32[52,4,64]) {
  %param_0.91 = bf16[208,512,64]{2,1,0} parameter(0)
  %bitcast.5801.3 = bf16[52,4,512,64]{3,2,1,0} bitcast(bf16[208,512,64]{2,1,0} %param_0.91)
  %transpose.1229.1 = bf16[4,64,52,512]{3,2,1,0} transpose(bf16[52,4,512,64]{3,2,1,0} %bitcast.5801.3), dimensions={1,3,0,2}, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/MultiHeadDotProductAttention_0/...qhd,...khd->...hqk/transpose[permutation=(0, 2, 1, 3)]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %transpose.1209.1.clone.1 = bf16[52,512,4,64]{3,2,1,0} transpose(bf16[52,4,512,64]{3,2,1,0} %bitcast.5801.3), dimensions={0,2,1,3}, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/MultiHeadDotProductAttention_0/...qhd,...khd->...hqk/transpose[permutation=(0, 2, 1, 3)]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %convert.1571.3.clone.1 = f32[52,4,512,64]{3,2,1,0} convert(bf16[52,4,512,64]{3,2,1,0} %bitcast.5801.3)
  %constant_55_20_clone_1 = bf16[] constant(0)
  %convert.1640.17.clone.1 = f32[] convert(bf16[] %constant_55_20_clone_1)
  %reduce.60.1.clone.1 = f32[52,4,64]{2,1,0} reduce(f32[52,4,512,64]{3,2,1,0} %convert.1571.3.clone.1, f32[] %convert.1640.17.clone.1), dimensions={2}, to_apply=%region_18.769.clone.15, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/MultiHeadDotProductAttention_0/key/reduce_sum[axes=(0, 1)]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  ROOT %tuple.37 = (bf16[4,64,52,512]{3,2,1,0}, bf16[52,512,4,64]{3,2,1,0}, f32[52,4,64]{2,1,0}) tuple(bf16[4,64,52,512]{3,2,1,0} %transpose.1229.1, bf16[52,512,4,64]{3,2,1,0} %transpose.1209.1.clone.1, f32[52,4,64]{2,1,0} %reduce.60.1.clone.1)
}

%fused_transpose.5 (param_0.99: bf16[208,64,512]) -> (bf16[4,64,52,512], bf16[52,512,4,64]) {
  %param_0.99 = bf16[208,64,512]{2,1,0} parameter(0)
  %bitcast.5732.3 = bf16[52,4,64,512]{3,2,1,0} bitcast(bf16[208,64,512]{2,1,0} %param_0.99)
  %transpose.1233.1 = bf16[4,64,52,512]{3,2,1,0} transpose(bf16[52,4,64,512]{3,2,1,0} %bitcast.5732.3), dimensions={1,2,0,3}, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/MultiHeadDotProductAttention_0/...hqk,...khd->...qhd/transpose[permutation=(0, 3, 1, 2)]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %transpose.1207.1.clone.1 = bf16[52,512,4,64]{3,2,1,0} transpose(bf16[52,4,64,512]{3,2,1,0} %bitcast.5732.3), dimensions={0,3,1,2}, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/MultiHeadDotProductAttention_0/...hqk,...khd->...qhd/transpose[permutation=(0, 3, 1, 2)]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  ROOT %tuple.38 = (bf16[4,64,52,512]{3,2,1,0}, bf16[52,512,4,64]{3,2,1,0}) tuple(bf16[4,64,52,512]{3,2,1,0} %transpose.1233.1, bf16[52,512,4,64]{3,2,1,0} %transpose.1207.1.clone.1)
}

%fused_transpose.6 (param_0.103: bf16[26624,256]) -> (bf16[52,4,512,64], bf16[52,4,64,512]) {
  %param_0.103 = bf16[26624,256]{1,0} parameter(0)
  %bitcast.5721.2 = bf16[52,512,4,64]{3,2,1,0} bitcast(bf16[26624,256]{1,0} %param_0.103)
  %transpose.1208.1 = bf16[52,4,512,64]{3,2,1,0} transpose(bf16[52,512,4,64]{3,2,1,0} %bitcast.5721.2), dimensions={0,2,1,3}, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/MultiHeadDotProductAttention_0/...hqk,...khd->...qhd/transpose[permutation=(0, 2, 3, 1)]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %transpose.1206.1.clone.1 = bf16[52,4,64,512]{3,2,1,0} transpose(bf16[52,512,4,64]{3,2,1,0} %bitcast.5721.2), dimensions={0,2,3,1}, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/MultiHeadDotProductAttention_0/out/dot_general[dimension_numbers=(((2,), (2,)), ((), ())) precision=None preferred_element_type=None]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  ROOT %tuple.42 = (bf16[52,4,512,64]{3,2,1,0}, bf16[52,4,64,512]{3,2,1,0}) tuple(bf16[52,4,512,64]{3,2,1,0} %transpose.1208.1, bf16[52,4,64,512]{3,2,1,0} %transpose.1206.1.clone.1)
}

%fused_transpose.7 (param_0.413: bf16[26624,256]) -> f32[512,256,52] {
  %param_0.413 = bf16[26624,256]{1,0} parameter(0)
  %convert.1513.2 = f32[26624,256]{1,0} convert(bf16[26624,256]{1,0} %param_0.413), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/LayerNorm_1/convert_element_type[new_dtype=float32 weak_type=False]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
  %bitcast.5607.1 = f32[52,512,256]{2,1,0} bitcast(f32[26624,256]{1,0} %convert.1513.2)
  ROOT %transpose.1204.1 = f32[512,256,52]{2,1,0} transpose(f32[52,512,256]{2,1,0} %bitcast.5607.1), dimensions={1,2,0}, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/LayerNorm_1/convert_element_type[new_dtype=float32 weak_type=False]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
}

%fused_reduce.5 (param_0.1331: f32[52,52]) -> f32[] {
  %param_0.1331 = f32[52,52]{1,0} parameter(0)
  %bitcast.5388.1 = f32[2704]{0} bitcast(f32[52,52]{1,0} %param_0.1331)
  %constant_68_22 = f32[] constant(0)
  ROOT %reduce.757.1 = f32[] reduce(f32[2704]{0} %bitcast.5388.1, f32[] %constant_68_22), dimensions={0}, to_apply=%region_2.202, metadata={op_name="jit(loss)/jit(main)/reduce_sum[axes=(0, 1)]" source_file="/home/nicholas/programs/avid/avid/config.py" source_line=372}
}

%fused_multiply_rsqrt (param_0.1391: f32[512,52], param_1.1536: f32[512,52]) -> (f32[1,512,52], f32[512,52]) {
  %param_0.1391 = f32[512,52]{1,0} parameter(0)
  %constant_35_20 = f32[] constant(0.00390625)
  %broadcast.555.43 = f32[512,52]{1,0} broadcast(f32[] %constant_35_20), dimensions={}
  %multiply.346.5 = f32[512,52]{1,0} multiply(f32[512,52]{1,0} %param_0.1391, f32[512,52]{1,0} %broadcast.555.43), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoder_norm/div" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=228}
  %param_1.1536 = f32[512,52]{1,0} parameter(1)
  %multiply.344.1.clone.1 = f32[512,52]{1,0} multiply(f32[512,52]{1,0} %param_1.1536, f32[512,52]{1,0} %broadcast.555.43), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoder_norm/div" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=228}
  %multiply.347.3 = f32[512,52]{1,0} multiply(f32[512,52]{1,0} %multiply.344.1.clone.1, f32[512,52]{1,0} %multiply.344.1.clone.1), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoder_norm/integer_pow[y=2]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=228}
  %subtract.39.3 = f32[512,52]{1,0} subtract(f32[512,52]{1,0} %multiply.346.5, f32[512,52]{1,0} %multiply.347.3), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoder_norm/sub" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=228}
  %constant_68_53 = f32[] constant(0)
  %broadcast.557.49 = f32[512,52]{1,0} broadcast(f32[] %constant_68_53), dimensions={}
  %maximum.20.11 = f32[512,52]{1,0} maximum(f32[512,52]{1,0} %subtract.39.3, f32[512,52]{1,0} %broadcast.557.49), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoder_norm/max" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=228}
  %constant_64_1 = f32[] constant(1e-06)
  %broadcast.558.9 = f32[512,52]{1,0} broadcast(f32[] %constant_64_1), dimensions={}
  %add.241.5 = f32[512,52]{1,0} add(f32[512,52]{1,0} %maximum.20.11, f32[512,52]{1,0} %broadcast.558.9), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoder_norm/add" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=228}
  %bitcast.5306.1 = f32[1,512,52]{2,1,0} bitcast(f32[512,52]{1,0} %add.241.5)
  %rsqrt.14.1 = f32[1,512,52]{2,1,0} rsqrt(f32[1,512,52]{2,1,0} %bitcast.5306.1), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoder_norm/rsqrt" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=228}
  ROOT %tuple.54 = (f32[1,512,52]{2,1,0}, f32[512,52]{1,0}) tuple(f32[1,512,52]{2,1,0} %rsqrt.14.1, f32[512,52]{1,0} %multiply.344.1.clone.1)
}

%fused_multiply_rsqrt.1 (param_0.1392: f32[512,52], param_1.1538: f32[512,52]) -> (f32[1,512,52], f32[512,52]) {
  %param_0.1392 = f32[512,52]{1,0} parameter(0)
  %constant_35_19 = f32[] constant(0.00390625)
  %broadcast.555.39 = f32[512,52]{1,0} broadcast(f32[] %constant_35_19), dimensions={}
  %multiply.340.5 = f32[512,52]{1,0} multiply(f32[512,52]{1,0} %param_0.1392, f32[512,52]{1,0} %broadcast.555.39), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/LayerNorm_1/div" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
  %param_1.1538 = f32[512,52]{1,0} parameter(1)
  %multiply.337.1.clone.1 = f32[512,52]{1,0} multiply(f32[512,52]{1,0} %param_1.1538, f32[512,52]{1,0} %broadcast.555.39), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/LayerNorm_1/div" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
  %multiply.341.3 = f32[512,52]{1,0} multiply(f32[512,52]{1,0} %multiply.337.1.clone.1, f32[512,52]{1,0} %multiply.337.1.clone.1), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/LayerNorm_1/integer_pow[y=2]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
  %subtract.37.3 = f32[512,52]{1,0} subtract(f32[512,52]{1,0} %multiply.340.5, f32[512,52]{1,0} %multiply.341.3), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/LayerNorm_1/sub" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
  %constant_68_52 = f32[] constant(0)
  %broadcast.557.53 = f32[512,52]{1,0} broadcast(f32[] %constant_68_52), dimensions={}
  %maximum.19.11 = f32[512,52]{1,0} maximum(f32[512,52]{1,0} %subtract.37.3, f32[512,52]{1,0} %broadcast.557.53), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/LayerNorm_1/max" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
  %constant_64_5 = f32[] constant(1e-06)
  %broadcast.558.13 = f32[512,52]{1,0} broadcast(f32[] %constant_64_5), dimensions={}
  %add.237.5 = f32[512,52]{1,0} add(f32[512,52]{1,0} %maximum.19.11, f32[512,52]{1,0} %broadcast.558.13), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/LayerNorm_1/add" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
  %bitcast.5222.1 = f32[1,512,52]{2,1,0} bitcast(f32[512,52]{1,0} %add.237.5)
  %rsqrt.13.1 = f32[1,512,52]{2,1,0} rsqrt(f32[1,512,52]{2,1,0} %bitcast.5222.1), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/LayerNorm_1/rsqrt" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
  ROOT %tuple.56 = (f32[1,512,52]{2,1,0}, f32[512,52]{1,0}) tuple(f32[1,512,52]{2,1,0} %rsqrt.13.1, f32[512,52]{1,0} %multiply.337.1.clone.1)
}

%fused_transpose.8 (param_0.139: bf16[208,64,512]) -> bf16[52,512,4,64] {
  %param_0.139 = bf16[208,64,512]{2,1,0} parameter(0)
  %bitcast.5148.1 = bf16[52,4,64,512]{3,2,1,0} bitcast(bf16[208,64,512]{2,1,0} %param_0.139)
  ROOT %transpose.1198.1 = bf16[52,512,4,64]{3,2,1,0} transpose(bf16[52,4,64,512]{3,2,1,0} %bitcast.5148.1), dimensions={0,3,1,2}, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/MultiHeadDotProductAttention_0/...hqk,...khd->...qhd/transpose[permutation=(0, 3, 1, 2)]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
}

%fused_multiply_rsqrt.2 (param_0.1393: f32[512,52], param_1.1540: f32[512,52]) -> (f32[1,512,52], f32[512,52]) {
  %param_0.1393 = f32[512,52]{1,0} parameter(0)
  %constant_35_18 = f32[] constant(0.00390625)
  %broadcast.555.35 = f32[512,52]{1,0} broadcast(f32[] %constant_35_18), dimensions={}
  %multiply.330.5 = f32[512,52]{1,0} multiply(f32[512,52]{1,0} %param_0.1393, f32[512,52]{1,0} %broadcast.555.35), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/LayerNorm_0/div" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
  %param_1.1540 = f32[512,52]{1,0} parameter(1)
  %multiply.328.1.clone.1 = f32[512,52]{1,0} multiply(f32[512,52]{1,0} %param_1.1540, f32[512,52]{1,0} %broadcast.555.35), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/LayerNorm_0/div" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
  %multiply.331.3 = f32[512,52]{1,0} multiply(f32[512,52]{1,0} %multiply.328.1.clone.1, f32[512,52]{1,0} %multiply.328.1.clone.1), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/LayerNorm_0/integer_pow[y=2]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
  %subtract.34.3 = f32[512,52]{1,0} subtract(f32[512,52]{1,0} %multiply.330.5, f32[512,52]{1,0} %multiply.331.3), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/LayerNorm_0/sub" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
  %constant_68_51 = f32[] constant(0)
  %broadcast.557.57 = f32[512,52]{1,0} broadcast(f32[] %constant_68_51), dimensions={}
  %maximum.18.11 = f32[512,52]{1,0} maximum(f32[512,52]{1,0} %subtract.34.3, f32[512,52]{1,0} %broadcast.557.57), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/LayerNorm_0/max" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
  %constant_64_4 = f32[] constant(1e-06)
  %broadcast.558.17 = f32[512,52]{1,0} broadcast(f32[] %constant_64_4), dimensions={}
  %add.229.5 = f32[512,52]{1,0} add(f32[512,52]{1,0} %maximum.18.11, f32[512,52]{1,0} %broadcast.558.17), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/LayerNorm_0/add" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
  %bitcast.5026.1 = f32[1,512,52]{2,1,0} bitcast(f32[512,52]{1,0} %add.229.5)
  %rsqrt.12.1 = f32[1,512,52]{2,1,0} rsqrt(f32[1,512,52]{2,1,0} %bitcast.5026.1), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/LayerNorm_0/rsqrt" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
  ROOT %tuple.59 = (f32[1,512,52]{2,1,0}, f32[512,52]{1,0}) tuple(f32[1,512,52]{2,1,0} %rsqrt.12.1, f32[512,52]{1,0} %multiply.328.1.clone.1)
}

%fused_multiply_rsqrt.3 (param_0.1394: f32[512,52], param_1.1542: f32[512,52]) -> (f32[1,512,52], f32[512,52]) {
  %param_0.1394 = f32[512,52]{1,0} parameter(0)
  %constant_35_17 = f32[] constant(0.00390625)
  %broadcast.555.31 = f32[512,52]{1,0} broadcast(f32[] %constant_35_17), dimensions={}
  %multiply.324.5 = f32[512,52]{1,0} multiply(f32[512,52]{1,0} %param_0.1394, f32[512,52]{1,0} %broadcast.555.31), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/LayerNorm_1/div" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
  %param_1.1542 = f32[512,52]{1,0} parameter(1)
  %multiply.322.1.clone.1 = f32[512,52]{1,0} multiply(f32[512,52]{1,0} %param_1.1542, f32[512,52]{1,0} %broadcast.555.31), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/LayerNorm_1/div" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
  %multiply.325.3 = f32[512,52]{1,0} multiply(f32[512,52]{1,0} %multiply.322.1.clone.1, f32[512,52]{1,0} %multiply.322.1.clone.1), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/LayerNorm_1/integer_pow[y=2]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
  %subtract.32.3 = f32[512,52]{1,0} subtract(f32[512,52]{1,0} %multiply.324.5, f32[512,52]{1,0} %multiply.325.3), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/LayerNorm_1/sub" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
  %constant_68_49 = f32[] constant(0)
  %broadcast.557.65 = f32[512,52]{1,0} broadcast(f32[] %constant_68_49), dimensions={}
  %maximum.17.11 = f32[512,52]{1,0} maximum(f32[512,52]{1,0} %subtract.32.3, f32[512,52]{1,0} %broadcast.557.65), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/LayerNorm_1/max" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
  %constant_64_2 = f32[] constant(1e-06)
  %broadcast.558.25 = f32[512,52]{1,0} broadcast(f32[] %constant_64_2), dimensions={}
  %add.225.5 = f32[512,52]{1,0} add(f32[512,52]{1,0} %maximum.17.11, f32[512,52]{1,0} %broadcast.558.25), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/LayerNorm_1/add" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
  %bitcast.4942.1 = f32[1,512,52]{2,1,0} bitcast(f32[512,52]{1,0} %add.225.5)
  %rsqrt.11.1 = f32[1,512,52]{2,1,0} rsqrt(f32[1,512,52]{2,1,0} %bitcast.4942.1), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/LayerNorm_1/rsqrt" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
  ROOT %tuple.61 = (f32[1,512,52]{2,1,0}, f32[512,52]{1,0}) tuple(f32[1,512,52]{2,1,0} %rsqrt.11.1, f32[512,52]{1,0} %multiply.322.1.clone.1)
}

%fused_transpose.9 (param_0.163: bf16[208,64,512]) -> bf16[52,512,4,64] {
  %param_0.163 = bf16[208,64,512]{2,1,0} parameter(0)
  %bitcast.4868.1 = bf16[52,4,64,512]{3,2,1,0} bitcast(bf16[208,64,512]{2,1,0} %param_0.163)
  ROOT %transpose.1187.1 = bf16[52,512,4,64]{3,2,1,0} transpose(bf16[52,4,64,512]{3,2,1,0} %bitcast.4868.1), dimensions={0,3,1,2}, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/MultiHeadDotProductAttention_0/...hqk,...khd->...qhd/transpose[permutation=(0, 3, 1, 2)]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
}

%fused_multiply_rsqrt.4 (param_0.1395: f32[512,52], param_1.1544: f32[512,52]) -> (f32[1,512,52], f32[512,52]) {
  %param_0.1395 = f32[512,52]{1,0} parameter(0)
  %constant_35_16 = f32[] constant(0.00390625)
  %broadcast.555.27 = f32[512,52]{1,0} broadcast(f32[] %constant_35_16), dimensions={}
  %multiply.317.5 = f32[512,52]{1,0} multiply(f32[512,52]{1,0} %param_0.1395, f32[512,52]{1,0} %broadcast.555.27), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/LayerNorm_0/div" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
  %param_1.1544 = f32[512,52]{1,0} parameter(1)
  %multiply.314.1.clone.1 = f32[512,52]{1,0} multiply(f32[512,52]{1,0} %param_1.1544, f32[512,52]{1,0} %broadcast.555.27), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/LayerNorm_0/div" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
  %multiply.318.3 = f32[512,52]{1,0} multiply(f32[512,52]{1,0} %multiply.314.1.clone.1, f32[512,52]{1,0} %multiply.314.1.clone.1), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/LayerNorm_0/integer_pow[y=2]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
  %subtract.29.3 = f32[512,52]{1,0} subtract(f32[512,52]{1,0} %multiply.317.5, f32[512,52]{1,0} %multiply.318.3), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/LayerNorm_0/sub" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
  %constant_68_50 = f32[] constant(0)
  %broadcast.557.61 = f32[512,52]{1,0} broadcast(f32[] %constant_68_50), dimensions={}
  %maximum.16.11 = f32[512,52]{1,0} maximum(f32[512,52]{1,0} %subtract.29.3, f32[512,52]{1,0} %broadcast.557.61), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/LayerNorm_0/max" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
  %constant_64_3 = f32[] constant(1e-06)
  %broadcast.558.21 = f32[512,52]{1,0} broadcast(f32[] %constant_64_3), dimensions={}
  %add.218.5 = f32[512,52]{1,0} add(f32[512,52]{1,0} %maximum.16.11, f32[512,52]{1,0} %broadcast.558.21), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/LayerNorm_0/add" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
  %bitcast.4747.1 = f32[1,512,52]{2,1,0} bitcast(f32[512,52]{1,0} %add.218.5)
  %rsqrt.10.1 = f32[1,512,52]{2,1,0} rsqrt(f32[1,512,52]{2,1,0} %bitcast.4747.1), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/LayerNorm_0/rsqrt" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
  ROOT %tuple.64 = (f32[1,512,52]{2,1,0}, f32[512,52]{1,0}) tuple(f32[1,512,52]{2,1,0} %rsqrt.10.1, f32[512,52]{1,0} %multiply.314.1.clone.1)
}

%fused_transpose.10 (param_0.663: f32[256], param_1.619: bf16[26624,256]) -> bf16[512,256,52] {
  %param_1.619 = bf16[26624,256]{1,0} parameter(1)
  %convert.1403.3 = f32[26624,256]{1,0} convert(bf16[26624,256]{1,0} %param_1.619)
  %param_0.663 = f32[256]{0} parameter(0)
  %broadcast.653.5 = f32[26624,256]{1,0} broadcast(f32[256]{0} %param_0.663), dimensions={1}, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/im_embed/vmap(inner)/vmap(Patchify_0)/patch_proj/add" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=40}
  %add.216.5 = f32[26624,256]{1,0} add(f32[26624,256]{1,0} %convert.1403.3, f32[26624,256]{1,0} %broadcast.653.5), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/im_embed/vmap(inner)/vmap(Patchify_0)/patch_proj/add" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=40}
  %convert.1406.3 = bf16[26624,256]{1,0} convert(f32[26624,256]{1,0} %add.216.5)
  %bitcast.4690.1 = bf16[52,512,256]{2,1,0} bitcast(bf16[26624,256]{1,0} %convert.1406.3)
  ROOT %transpose.1182.1 = bf16[512,256,52]{2,1,0} transpose(bf16[52,512,256]{2,1,0} %bitcast.4690.1), dimensions={1,2,0}, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/im_embed/vmap(inner)/vmap(Patchify_0)/patch_proj/add" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=40}
}

%fused_transpose.11 (param_0.1317: f32[64], param_1.1416: bf16[3594240,64], param_2.848: bf16[5,52]) -> bf16[52,8,8,8,3,3,3,64] {
  %param_1.1416 = bf16[3594240,64]{1,0} parameter(1)
  %convert.1395.7 = f32[3594240,64]{1,0} convert(bf16[3594240,64]{1,0} %param_1.1416)
  %param_0.1317 = f32[64]{0} parameter(0)
  %broadcast.650.9 = f32[3594240,64]{1,0} broadcast(f32[64]{0} %param_0.1317), dimensions={1}, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/spec_embed/vmap(vmap(vmap(species_embed)))/embed_module/Dense_0/add" source_file="/home/nicholas/programs/avid/avid/layers.py" source_line=49}
  %add.215.9 = f32[3594240,64]{1,0} add(f32[3594240,64]{1,0} %convert.1395.7, f32[3594240,64]{1,0} %broadcast.650.9), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/spec_embed/vmap(vmap(vmap(species_embed)))/embed_module/Dense_0/add" source_file="/home/nicholas/programs/avid/avid/layers.py" source_line=49}
  %convert.1398.7 = bf16[3594240,64]{1,0} convert(f32[3594240,64]{1,0} %add.215.9)
  %bitcast.4661.7 = bf16[13824,5,52,64]{3,2,1,0} bitcast(bf16[3594240,64]{1,0} %convert.1398.7)
  %convert.1399.7 = f32[13824,5,52,64]{3,2,1,0} convert(bf16[13824,5,52,64]{3,2,1,0} %bitcast.4661.7)
  %param_2.848 = bf16[5,52]{1,0} parameter(2)
  %convert.1615.2 = f32[5,52]{1,0} convert(bf16[5,52]{1,0} %param_2.848)
  %broadcast.652.10 = f32[13824,5,52,64]{3,2,1,0} broadcast(f32[5,52]{1,0} %convert.1615.2), dimensions={1,2}, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/spec_embed/vmap(vmap(vmap(species_embed)))/mul" source_file="/home/nicholas/programs/avid/avid/encoder.py" source_line=37}
  %multiply.313.7 = f32[13824,5,52,64]{3,2,1,0} multiply(f32[13824,5,52,64]{3,2,1,0} %convert.1399.7, f32[13824,5,52,64]{3,2,1,0} %broadcast.652.10), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/spec_embed/vmap(vmap(vmap(species_embed)))/mul" source_file="/home/nicholas/programs/avid/avid/encoder.py" source_line=37}
  %constant_68_8 = f32[] constant(0)
  %reduce.6.5 = f32[13824,52,64]{2,1,0} reduce(f32[13824,5,52,64]{3,2,1,0} %multiply.313.7, f32[] %constant_68_8), dimensions={1}, to_apply=%region_2.202, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/spec_embed/reduce_sum[axes=(3,)]" source_file="/home/nicholas/programs/avid/avid/encoder.py" source_line=56}
  %convert.1401.3 = bf16[13824,52,64]{2,1,0} convert(f32[13824,52,64]{2,1,0} %reduce.6.5), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/spec_embed/convert_element_type[new_dtype=bfloat16 weak_type=False]" source_file="/home/nicholas/programs/avid/avid/encoder.py" source_line=56}
  %bitcast.4672.1 = bf16[8,3,8,3,8,3,52,64]{7,6,5,4,3,2,1,0} bitcast(bf16[13824,52,64]{2,1,0} %convert.1401.3)
  ROOT %transpose.1181.1 = bf16[52,8,8,8,3,3,3,64]{7,6,5,4,3,2,1,0} transpose(bf16[8,3,8,3,8,3,52,64]{7,6,5,4,3,2,1,0} %bitcast.4672.1), dimensions={6,0,2,4,1,3,5,7}, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/im_embed/vmap(inner)/transpose[permutation=(0, 1, 3, 5, 2, 4, 6, 7)]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=103}
}

%fused_convert.9 (param_0.625: bf16[26624,1728], param_1.576: bf16[5,52]) -> bf16[13824,5,52,64] {
  %param_0.625 = bf16[26624,1728]{1,0} parameter(0)
  %bitcast.6750.3 = bf16[52,8,8,8,3,3,3,64]{7,6,5,4,3,2,1,0} bitcast(bf16[26624,1728]{1,0} %param_0.625)
  %transpose.1237.3 = bf16[8,3,8,3,8,3,52,64]{7,6,5,4,3,2,1,0} transpose(bf16[52,8,8,8,3,3,3,64]{7,6,5,4,3,2,1,0} %bitcast.6750.3), dimensions={1,4,2,5,3,6,0,7}, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/im_embed/vmap(inner)/vmap(Patchify_0)/patch_proj/dot_general[dimension_numbers=(((2,), (1,)), ((), ())) precision=None preferred_element_type=None]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=40}
  %bitcast.6753.6 = bf16[13824,52,64]{2,1,0} bitcast(bf16[8,3,8,3,8,3,52,64]{7,6,5,4,3,2,1,0} %transpose.1237.3)
  %convert.1650.3 = f32[13824,52,64]{2,1,0} convert(bf16[13824,52,64]{2,1,0} %bitcast.6753.6)
  %broadcast.706.1 = f32[13824,5,52,64]{3,2,1,0} broadcast(f32[13824,52,64]{2,1,0} %convert.1650.3), dimensions={0,2,3}, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/spec_embed/broadcast_in_dim[shape=(52, 13824, 64, 5) broadcast_dimensions=(0, 1, 2)]" source_file="/home/nicholas/programs/avid/avid/encoder.py" source_line=56}
  %param_1.576 = bf16[5,52]{1,0} parameter(1)
  %convert.1615.1 = f32[5,52]{1,0} convert(bf16[5,52]{1,0} %param_1.576)
  %broadcast.652.4 = f32[13824,5,52,64]{3,2,1,0} broadcast(f32[5,52]{1,0} %convert.1615.1), dimensions={1,2}, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/spec_embed/vmap(vmap(vmap(species_embed)))/mul" source_file="/home/nicholas/programs/avid/avid/encoder.py" source_line=37}
  %multiply.440.3 = f32[13824,5,52,64]{3,2,1,0} multiply(f32[13824,5,52,64]{3,2,1,0} %broadcast.706.1, f32[13824,5,52,64]{3,2,1,0} %broadcast.652.4), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/spec_embed/vmap(vmap(vmap(species_embed)))/mul" source_file="/home/nicholas/programs/avid/avid/encoder.py" source_line=37}
  ROOT %convert.1604.1 = bf16[13824,5,52,64]{3,2,1,0} convert(f32[13824,5,52,64]{3,2,1,0} %multiply.440.3)
}

%region_18.769.clone.27 (Arg_0.30.0: f32[], Arg_1.30.0: f32[]) -> f32[] {
  %Arg_1.30.0 = f32[] parameter(1)
  %Arg_0.30.0 = f32[] parameter(0)
  ROOT %add.210.0 = f32[] add(f32[] %Arg_0.30.0, f32[] %Arg_1.30.0), metadata={op_name="jit(loss)/jit(main)/reduce_sum[axes=(1,)]" source_file="/home/nicholas/programs/avid/avid/config.py" source_line=371}
}

%fused_reduce.6 (param_0.901: bf16[13824,5,52,64]) -> f32[3510,64] {
  %param_0.901 = bf16[13824,5,52,64]{3,2,1,0} parameter(0)
  %bitcast.6764.3 = bf16[3510,1024,64]{2,1,0} bitcast(bf16[13824,5,52,64]{3,2,1,0} %param_0.901)
  %convert.1605.3 = f32[3510,1024,64]{2,1,0} convert(bf16[3510,1024,64]{2,1,0} %bitcast.6764.3)
  %constant_55_31 = bf16[] constant(0)
  %convert.1640.28 = f32[] convert(bf16[] %constant_55_31)
  ROOT %reduce.98.1 = f32[3510,64]{1,0} reduce(f32[3510,1024,64]{2,1,0} %convert.1605.3, f32[] %convert.1640.28), dimensions={1}, to_apply=%region_18.769.clone.27, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/spec_embed/vmap(vmap(vmap(species_embed)))/embed_module/Dense_0/reduce_sum[axes=(0, 1, 2)]" source_file="/home/nicholas/programs/avid/avid/layers.py" source_line=49}
}

%region_18.769.clone.29 (Arg_0.32.0: f32[], Arg_1.32.0: f32[]) -> f32[] {
  %Arg_1.32.0 = f32[] parameter(1)
  %Arg_0.32.0 = f32[] parameter(0)
  ROOT %add.213.0 = f32[] add(f32[] %Arg_0.32.0, f32[] %Arg_1.32.0), metadata={op_name="jit(loss)/jit(main)/reduce_sum[axes=(1,)]" source_file="/home/nicholas/programs/avid/avid/config.py" source_line=371}
}

%fused_reduce.7 (param_0.903: bf16[3594240,64]) -> f32[216,5,52,63] {
  %param_0.903 = bf16[3594240,64]{1,0} parameter(0)
  %bitcast.6799.3 = bf16[13824,5,52,64]{3,2,1,0} bitcast(bf16[3594240,64]{1,0} %param_0.903)
  %slice.26.3 = bf16[13824,5,52,63]{3,2,1,0} slice(bf16[13824,5,52,64]{3,2,1,0} %bitcast.6799.3), slice={[0:13824], [0:5], [0:52], [0:63]}, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/spec_embed/vmap(vmap(vmap(species_embed)))/slice[start_indices=(0, 0, 0, 0) limit_indices=(13824, 5, 52, 63) strides=None]" source_file="/home/nicholas/programs/avid/avid/encoder.py" source_line=36}
  %bitcast.6802.3 = bf16[216,64,5,52,63]{4,3,2,1,0} bitcast(bf16[13824,5,52,63]{3,2,1,0} %slice.26.3)
  %convert.1609.3 = f32[216,64,5,52,63]{4,3,2,1,0} convert(bf16[216,64,5,52,63]{4,3,2,1,0} %bitcast.6802.3)
  %constant_55_33 = bf16[] constant(0)
  %convert.1640.30 = f32[] convert(bf16[] %constant_55_33)
  ROOT %reduce.100.1 = f32[216,5,52,63]{3,2,1,0} reduce(f32[216,64,5,52,63]{4,3,2,1,0} %convert.1609.3, f32[] %convert.1640.30), dimensions={1}, to_apply=%region_18.769.clone.29, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/spec_embed/vmap(vmap(vmap(species_embed)))/reduce_sum[axes=(0,)]" source_file="/home/nicholas/programs/avid/avid/encoder.py" source_line=36}
}

%region_4.288.clone (Arg_0.0.0: f32[], Arg_1.0.0: f32[]) -> f32[] {
  %Arg_1.0.0 = f32[] parameter(1)
  %Arg_0.0.0 = f32[] parameter(0)
  ROOT %maximum.14.0 = f32[] maximum(f32[] %Arg_0.0.0, f32[] %Arg_1.0.0), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/MultiHeadDotProductAttention_0/reduce_max[axes=(3,)]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
}

%fused_reduce.8 (param_0.1194: bf16[208,512,512]) -> f32[52,4,512] {
  %param_0.1194 = bf16[208,512,512]{2,1,0} parameter(0)
  %bitcast.4836.5 = bf16[52,4,512,512]{3,2,1,0} bitcast(bf16[208,512,512]{2,1,0} %param_0.1194)
  %convert.1427.5 = f32[52,4,512,512]{3,2,1,0} convert(bf16[52,4,512,512]{3,2,1,0} %bitcast.4836.5)
  %constant_79_2 = bf16[] constant(-inf)
  %convert.1429.1 = f32[] convert(bf16[] %constant_79_2)
  ROOT %reduce.292.1 = f32[52,4,512]{2,1,0} reduce(f32[52,4,512,512]{3,2,1,0} %convert.1427.5, f32[] %convert.1429.1), dimensions={3}, to_apply=%region_4.288.clone, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/MultiHeadDotProductAttention_0/reduce_max[axes=(3,)]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
}

%region_4.288.clone.1 (Arg_0.2.0: f32[], Arg_1.1.0: f32[]) -> f32[] {
  %Arg_1.1.0 = f32[] parameter(1)
  %Arg_0.2.0 = f32[] parameter(0)
  ROOT %maximum.15.0 = f32[] maximum(f32[] %Arg_0.2.0, f32[] %Arg_1.1.0), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/MultiHeadDotProductAttention_0/reduce_max[axes=(3,)]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
}

%fused_reduce.9 (param_0.1195: bf16[208,512,512]) -> f32[52,4,512] {
  %param_0.1195 = bf16[208,512,512]{2,1,0} parameter(0)
  %bitcast.5115.5 = bf16[52,4,512,512]{3,2,1,0} bitcast(bf16[208,512,512]{2,1,0} %param_0.1195)
  %convert.1465.5 = f32[52,4,512,512]{3,2,1,0} convert(bf16[52,4,512,512]{3,2,1,0} %bitcast.5115.5)
  %constant_79_1 = bf16[] constant(-inf)
  %convert.1429.2 = f32[] convert(bf16[] %constant_79_1)
  ROOT %reduce.532.1 = f32[52,4,512]{2,1,0} reduce(f32[52,4,512,512]{3,2,1,0} %convert.1465.5, f32[] %convert.1429.2), dimensions={3}, to_apply=%region_4.288.clone.1, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/MultiHeadDotProductAttention_0/reduce_max[axes=(3,)]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
}

%fused_concatenate (param_0.245: bf16[13824,5,52,1], param_1.105: bf16[260,1,63]) -> bf16[13824,5,52,64] {
  %param_1.105 = bf16[260,1,63]{2,1,0} parameter(1)
  %bitcast.4641.3 = bf16[5,52,63]{2,1,0} bitcast(bf16[260,1,63]{2,1,0} %param_1.105)
  %broadcast.548.3 = bf16[13824,5,52,63]{3,2,1,0} broadcast(bf16[5,52,63]{2,1,0} %bitcast.4641.3), dimensions={1,2,3}, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/spec_embed/vmap(vmap(vmap(species_embed)))/broadcast_in_dim[shape=(13824, 5, 52, 63) broadcast_dimensions=(1, 2, 3)]" source_file="/home/nicholas/programs/avid/avid/encoder.py" source_line=36}
  %param_0.245 = bf16[13824,5,52,1]{3,2,1,0} parameter(0)
  ROOT %concatenate.4.1 = bf16[13824,5,52,64]{3,2,1,0} concatenate(bf16[13824,5,52,63]{3,2,1,0} %broadcast.548.3, bf16[13824,5,52,1]{3,2,1,0} %param_0.245), dimensions={3}, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/spec_embed/vmap(vmap(vmap(species_embed)))/concatenate[dimension=3]" source_file="/home/nicholas/programs/avid/avid/encoder.py" source_line=36}
}

%fused_convert.10 (param_0.297: f32[52,4,512], param_1.169: bf16[208,512,512], param_2.55: f32[52,4,512], param_3.33: f32[52,4,512], param_4.3: bf16[208,512,512]) -> bf16[52,4,512,512] {
  %param_1.169 = bf16[208,512,512]{2,1,0} parameter(1)
  %bitcast.6103.15 = bf16[52,4,512,512]{3,2,1,0} bitcast(bf16[208,512,512]{2,1,0} %param_1.169)
  %convert.1533.15 = f32[52,4,512,512]{3,2,1,0} convert(bf16[52,4,512,512]{3,2,1,0} %bitcast.6103.15)
  %param_0.297 = f32[52,4,512]{2,1,0} parameter(0)
  %broadcast.661.8 = f32[52,4,512,512]{3,2,1,0} broadcast(f32[52,4,512]{2,1,0} %param_0.297), dimensions={0,1,2}, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/MultiHeadDotProductAttention_0/div" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %divide.51.7 = f32[52,4,512,512]{3,2,1,0} divide(f32[52,4,512,512]{3,2,1,0} %convert.1533.15, f32[52,4,512,512]{3,2,1,0} %broadcast.661.8), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/MultiHeadDotProductAttention_0/div" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %param_2.55 = f32[52,4,512]{2,1,0} parameter(2)
  %broadcast.704.1 = f32[52,4,512,512]{3,2,1,0} broadcast(f32[52,4,512]{2,1,0} %param_2.55), dimensions={0,1,2}, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/MultiHeadDotProductAttention_0/broadcast_in_dim[shape=(52, 4, 512, 512) broadcast_dimensions=(0, 1, 2)]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %add.268.5 = f32[52,4,512,512]{3,2,1,0} add(f32[52,4,512,512]{3,2,1,0} %divide.51.7, f32[52,4,512,512]{3,2,1,0} %broadcast.704.1), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/MultiHeadDotProductAttention_0/add_any" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %param_4.3 = bf16[208,512,512]{2,1,0} parameter(4)
  %bitcast.4836.11 = bf16[52,4,512,512]{3,2,1,0} bitcast(bf16[208,512,512]{2,1,0} %param_4.3)
  %convert.1427.11 = f32[52,4,512,512]{3,2,1,0} convert(bf16[52,4,512,512]{3,2,1,0} %bitcast.4836.11)
  %param_3.33 = f32[52,4,512]{2,1,0} parameter(3)
  %broadcast.660.5 = f32[52,4,512,512]{3,2,1,0} broadcast(f32[52,4,512]{2,1,0} %param_3.33), dimensions={0,1,2}, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/MultiHeadDotProductAttention_0/sub" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %subtract.30.7 = f32[52,4,512,512]{3,2,1,0} subtract(f32[52,4,512,512]{3,2,1,0} %convert.1427.11, f32[52,4,512,512]{3,2,1,0} %broadcast.660.5), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/MultiHeadDotProductAttention_0/sub" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %exponential.4.5 = f32[52,4,512,512]{3,2,1,0} exponential(f32[52,4,512,512]{3,2,1,0} %subtract.30.7), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/MultiHeadDotProductAttention_0/exp" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %multiply.421.3 = f32[52,4,512,512]{3,2,1,0} multiply(f32[52,4,512,512]{3,2,1,0} %add.268.5, f32[52,4,512,512]{3,2,1,0} %exponential.4.5), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/MultiHeadDotProductAttention_0/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  ROOT %convert.1542.1 = bf16[52,4,512,512]{3,2,1,0} convert(f32[52,4,512,512]{3,2,1,0} %multiply.421.3)
}

%fused_convert.11 (param_0.295: f32[52,4,512], param_1.167: f32[52,4,512], param_2.54: bf16[208,512,512]) -> bf16[52,4,512,512] {
  %param_2.54 = bf16[208,512,512]{2,1,0} parameter(2)
  %bitcast.4836.9 = bf16[52,4,512,512]{3,2,1,0} bitcast(bf16[208,512,512]{2,1,0} %param_2.54)
  %convert.1427.9 = f32[52,4,512,512]{3,2,1,0} convert(bf16[52,4,512,512]{3,2,1,0} %bitcast.4836.9)
  %param_1.167 = f32[52,4,512]{2,1,0} parameter(1)
  %broadcast.660.3 = f32[52,4,512,512]{3,2,1,0} broadcast(f32[52,4,512]{2,1,0} %param_1.167), dimensions={0,1,2}, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/MultiHeadDotProductAttention_0/sub" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %subtract.30.5 = f32[52,4,512,512]{3,2,1,0} subtract(f32[52,4,512,512]{3,2,1,0} %convert.1427.9, f32[52,4,512,512]{3,2,1,0} %broadcast.660.3), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/MultiHeadDotProductAttention_0/sub" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %exponential.4.3 = f32[52,4,512,512]{3,2,1,0} exponential(f32[52,4,512,512]{3,2,1,0} %subtract.30.5), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/MultiHeadDotProductAttention_0/exp" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %param_0.295 = f32[52,4,512]{2,1,0} parameter(0)
  %broadcast.661.10 = f32[52,4,512,512]{3,2,1,0} broadcast(f32[52,4,512]{2,1,0} %param_0.295), dimensions={0,1,2}, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/MultiHeadDotProductAttention_0/div" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %divide.38.3 = f32[52,4,512,512]{3,2,1,0} divide(f32[52,4,512,512]{3,2,1,0} %exponential.4.3, f32[52,4,512,512]{3,2,1,0} %broadcast.661.10), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/MultiHeadDotProductAttention_0/div" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  ROOT %convert.1434.1 = bf16[52,4,512,512]{3,2,1,0} convert(f32[52,4,512,512]{3,2,1,0} %divide.38.3)
}

%fused_convert.12 (param_0.305: f32[52,4,512], param_1.182: bf16[208,512,512], param_2.65: f32[52,4,512], param_3.39: f32[52,4,512], param_4.11: bf16[208,512,512]) -> bf16[52,4,512,512] {
  %param_1.182 = bf16[208,512,512]{2,1,0} parameter(1)
  %bitcast.5754.15 = bf16[52,4,512,512]{3,2,1,0} bitcast(bf16[208,512,512]{2,1,0} %param_1.182)
  %convert.1515.15 = f32[52,4,512,512]{3,2,1,0} convert(bf16[52,4,512,512]{3,2,1,0} %bitcast.5754.15)
  %param_0.305 = f32[52,4,512]{2,1,0} parameter(0)
  %broadcast.668.8 = f32[52,4,512,512]{3,2,1,0} broadcast(f32[52,4,512]{2,1,0} %param_0.305), dimensions={0,1,2}, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/MultiHeadDotProductAttention_0/div" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %divide.45.7 = f32[52,4,512,512]{3,2,1,0} divide(f32[52,4,512,512]{3,2,1,0} %convert.1515.15, f32[52,4,512,512]{3,2,1,0} %broadcast.668.8), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/MultiHeadDotProductAttention_0/div" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %param_2.65 = f32[52,4,512]{2,1,0} parameter(2)
  %broadcast.702.1 = f32[52,4,512,512]{3,2,1,0} broadcast(f32[52,4,512]{2,1,0} %param_2.65), dimensions={0,1,2}, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/MultiHeadDotProductAttention_0/broadcast_in_dim[shape=(52, 4, 512, 512) broadcast_dimensions=(0, 1, 2)]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %add.257.5 = f32[52,4,512,512]{3,2,1,0} add(f32[52,4,512,512]{3,2,1,0} %divide.45.7, f32[52,4,512,512]{3,2,1,0} %broadcast.702.1), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/MultiHeadDotProductAttention_0/add_any" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %param_4.11 = bf16[208,512,512]{2,1,0} parameter(4)
  %bitcast.5115.11 = bf16[52,4,512,512]{3,2,1,0} bitcast(bf16[208,512,512]{2,1,0} %param_4.11)
  %convert.1465.11 = f32[52,4,512,512]{3,2,1,0} convert(bf16[52,4,512,512]{3,2,1,0} %bitcast.5115.11)
  %param_3.39 = f32[52,4,512]{2,1,0} parameter(3)
  %broadcast.667.5 = f32[52,4,512,512]{3,2,1,0} broadcast(f32[52,4,512]{2,1,0} %param_3.39), dimensions={0,1,2}, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/MultiHeadDotProductAttention_0/sub" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %subtract.35.7 = f32[52,4,512,512]{3,2,1,0} subtract(f32[52,4,512,512]{3,2,1,0} %convert.1465.11, f32[52,4,512,512]{3,2,1,0} %broadcast.667.5), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/MultiHeadDotProductAttention_0/sub" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %exponential.5.5 = f32[52,4,512,512]{3,2,1,0} exponential(f32[52,4,512,512]{3,2,1,0} %subtract.35.7), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/MultiHeadDotProductAttention_0/exp" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %multiply.392.3 = f32[52,4,512,512]{3,2,1,0} multiply(f32[52,4,512,512]{3,2,1,0} %add.257.5, f32[52,4,512,512]{3,2,1,0} %exponential.5.5), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/MultiHeadDotProductAttention_0/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  ROOT %convert.1524.1 = bf16[52,4,512,512]{3,2,1,0} convert(f32[52,4,512,512]{3,2,1,0} %multiply.392.3)
}

%fused_convert.13 (param_0.303: f32[52,4,512], param_1.180: f32[52,4,512], param_2.64: bf16[208,512,512]) -> bf16[52,4,512,512] {
  %param_2.64 = bf16[208,512,512]{2,1,0} parameter(2)
  %bitcast.5115.9 = bf16[52,4,512,512]{3,2,1,0} bitcast(bf16[208,512,512]{2,1,0} %param_2.64)
  %convert.1465.9 = f32[52,4,512,512]{3,2,1,0} convert(bf16[52,4,512,512]{3,2,1,0} %bitcast.5115.9)
  %param_1.180 = f32[52,4,512]{2,1,0} parameter(1)
  %broadcast.667.3 = f32[52,4,512,512]{3,2,1,0} broadcast(f32[52,4,512]{2,1,0} %param_1.180), dimensions={0,1,2}, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/MultiHeadDotProductAttention_0/sub" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %subtract.35.5 = f32[52,4,512,512]{3,2,1,0} subtract(f32[52,4,512,512]{3,2,1,0} %convert.1465.9, f32[52,4,512,512]{3,2,1,0} %broadcast.667.3), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/MultiHeadDotProductAttention_0/sub" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %exponential.5.3 = f32[52,4,512,512]{3,2,1,0} exponential(f32[52,4,512,512]{3,2,1,0} %subtract.35.5), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/MultiHeadDotProductAttention_0/exp" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %param_0.303 = f32[52,4,512]{2,1,0} parameter(0)
  %broadcast.668.10 = f32[52,4,512,512]{3,2,1,0} broadcast(f32[52,4,512]{2,1,0} %param_0.303), dimensions={0,1,2}, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/MultiHeadDotProductAttention_0/div" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %divide.39.3 = f32[52,4,512,512]{3,2,1,0} divide(f32[52,4,512,512]{3,2,1,0} %exponential.5.3, f32[52,4,512,512]{3,2,1,0} %broadcast.668.10), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/MultiHeadDotProductAttention_0/div" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  ROOT %convert.1472.1 = bf16[52,4,512,512]{3,2,1,0} convert(f32[52,4,512,512]{3,2,1,0} %divide.39.3)
}

%fused_reduce.10 (param_0.1320: f32[52,4,512], param_1.1419: bf16[208,512,512]) -> f32[52,4,512] {
  %param_1.1419 = bf16[208,512,512]{2,1,0} parameter(1)
  %bitcast.4836.13 = bf16[52,4,512,512]{3,2,1,0} bitcast(bf16[208,512,512]{2,1,0} %param_1.1419)
  %convert.1427.13 = f32[52,4,512,512]{3,2,1,0} convert(bf16[52,4,512,512]{3,2,1,0} %bitcast.4836.13)
  %param_0.1320 = f32[52,4,512]{2,1,0} parameter(0)
  %broadcast.660.7 = f32[52,4,512,512]{3,2,1,0} broadcast(f32[52,4,512]{2,1,0} %param_0.1320), dimensions={0,1,2}, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/MultiHeadDotProductAttention_0/sub" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %subtract.30.9 = f32[52,4,512,512]{3,2,1,0} subtract(f32[52,4,512,512]{3,2,1,0} %convert.1427.13, f32[52,4,512,512]{3,2,1,0} %broadcast.660.7), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/MultiHeadDotProductAttention_0/sub" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %exponential.4.7 = f32[52,4,512,512]{3,2,1,0} exponential(f32[52,4,512,512]{3,2,1,0} %subtract.30.9), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/MultiHeadDotProductAttention_0/exp" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %constant_68_11 = f32[] constant(0)
  ROOT %reduce.304.1 = f32[52,4,512]{2,1,0} reduce(f32[52,4,512,512]{3,2,1,0} %exponential.4.7, f32[] %constant_68_11), dimensions={3}, to_apply=%region_2.202, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/MultiHeadDotProductAttention_0/reduce_sum[axes=(3,)]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
}

%fused_reduce.11 (param_0.1325: f32[52,4,512], param_1.1422: bf16[208,512,512]) -> f32[52,4,512] {
  %param_1.1422 = bf16[208,512,512]{2,1,0} parameter(1)
  %bitcast.5115.13 = bf16[52,4,512,512]{3,2,1,0} bitcast(bf16[208,512,512]{2,1,0} %param_1.1422)
  %convert.1465.13 = f32[52,4,512,512]{3,2,1,0} convert(bf16[52,4,512,512]{3,2,1,0} %bitcast.5115.13)
  %param_0.1325 = f32[52,4,512]{2,1,0} parameter(0)
  %broadcast.667.7 = f32[52,4,512,512]{3,2,1,0} broadcast(f32[52,4,512]{2,1,0} %param_0.1325), dimensions={0,1,2}, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/MultiHeadDotProductAttention_0/sub" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %subtract.35.9 = f32[52,4,512,512]{3,2,1,0} subtract(f32[52,4,512,512]{3,2,1,0} %convert.1465.13, f32[52,4,512,512]{3,2,1,0} %broadcast.667.7), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/MultiHeadDotProductAttention_0/sub" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %exponential.5.7 = f32[52,4,512,512]{3,2,1,0} exponential(f32[52,4,512,512]{3,2,1,0} %subtract.35.9), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/MultiHeadDotProductAttention_0/exp" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %constant_68_16 = f32[] constant(0)
  ROOT %reduce.544.1 = f32[52,4,512]{2,1,0} reduce(f32[52,4,512,512]{3,2,1,0} %exponential.5.7, f32[] %constant_68_16), dimensions={3}, to_apply=%region_2.202, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/MultiHeadDotProductAttention_0/reduce_sum[axes=(3,)]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
}

%fused_reduce.12 (param_0.1350: f32[256,52], param_1.1529: f32[512,256,52], param_2.940: f32[512,52], param_3.603: f32[1,512,52]) -> (f32[512,256], f32[512,256]) {
  %param_0.1350 = f32[256,52]{1,0} parameter(0)
  %broadcast.615.3 = f32[512,256,52]{2,1,0} broadcast(f32[256,52]{1,0} %param_0.1350), dimensions={1,2}, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/transpose[permutation=(0, 2, 1)]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=250}
  %constant_68_41 = f32[] constant(0)
  %reduce.64.1 = f32[512,256]{1,0} reduce(f32[512,256,52]{2,1,0} %broadcast.615.3, f32[] %constant_68_41), dimensions={2}, to_apply=%region_2.202
  %param_3.603 = f32[1,512,52]{2,1,0} parameter(3)
  %bitcast.5309.19.clone.1 = f32[512,52]{1,0} bitcast(f32[1,512,52]{2,1,0} %param_3.603)
  %broadcast.594.19.clone.1 = f32[512,256,52]{2,1,0} broadcast(f32[512,52]{1,0} %bitcast.5309.19.clone.1), dimensions={0,2}, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoder_norm/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=228}
  %param_1.1529 = f32[512,256,52]{2,1,0} parameter(1)
  %param_2.940 = f32[512,52]{1,0} parameter(2)
  %broadcast.593.3.clone.1 = f32[512,256,52]{2,1,0} broadcast(f32[512,52]{1,0} %param_2.940), dimensions={0,2}, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoder_norm/sub" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=228}
  %subtract.38.3.clone.1 = f32[512,256,52]{2,1,0} subtract(f32[512,256,52]{2,1,0} %param_1.1529, f32[512,256,52]{2,1,0} %broadcast.593.3.clone.1), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoder_norm/sub" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=228}
  %multiply.363.5.clone.1 = f32[512,256,52]{2,1,0} multiply(f32[512,256,52]{2,1,0} %subtract.38.3.clone.1, f32[512,256,52]{2,1,0} %broadcast.615.3), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoder_norm/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=228}
  %multiply.364.3.clone.1 = f32[512,256,52]{2,1,0} multiply(f32[512,256,52]{2,1,0} %broadcast.594.19.clone.1, f32[512,256,52]{2,1,0} %multiply.363.5.clone.1), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoder_norm/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=228}
  %reduce.66.1.clone.1 = f32[512,256]{1,0} reduce(f32[512,256,52]{2,1,0} %multiply.364.3.clone.1, f32[] %constant_68_41), dimensions={2}, to_apply=%region_2.202
  ROOT %tuple.48 = (f32[512,256]{1,0}, f32[512,256]{1,0}) tuple(f32[512,256]{1,0} %reduce.64.1, f32[512,256]{1,0} %reduce.66.1.clone.1)
}

%fused_reduce.13 (param_0.1329: f32[512,256,52]) -> (f32[512,52], f32[512,52]) {
  %param_0.1329 = f32[512,256,52]{2,1,0} parameter(0)
  %multiply.345.1 = f32[512,256,52]{2,1,0} multiply(f32[512,256,52]{2,1,0} %param_0.1329, f32[512,256,52]{2,1,0} %param_0.1329), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoder_norm/integer_pow[y=2]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=228}
  %constant_68_20 = f32[] constant(0)
  %reduce.27.1 = f32[512,52]{1,0} reduce(f32[512,256,52]{2,1,0} %multiply.345.1, f32[] %constant_68_20), dimensions={1}, to_apply=%region_2.202
  %reduce.26.1.clone.1 = f32[512,52]{1,0} reduce(f32[512,256,52]{2,1,0} %param_0.1329, f32[] %constant_68_20), dimensions={1}, to_apply=%region_2.202
  ROOT %tuple.55 = (f32[512,52]{1,0}, f32[512,52]{1,0}) tuple(f32[512,52]{1,0} %reduce.27.1, f32[512,52]{1,0} %reduce.26.1.clone.1)
}

%fused_reduce.14 (param_0.1327: f32[512,256,52]) -> (f32[512,52], f32[512,52]) {
  %param_0.1327 = f32[512,256,52]{2,1,0} parameter(0)
  %multiply.338.1 = f32[512,256,52]{2,1,0} multiply(f32[512,256,52]{2,1,0} %param_0.1327, f32[512,256,52]{2,1,0} %param_0.1327), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/LayerNorm_1/integer_pow[y=2]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
  %constant_68_18 = f32[] constant(0)
  %reduce.25.1 = f32[512,52]{1,0} reduce(f32[512,256,52]{2,1,0} %multiply.338.1, f32[] %constant_68_18), dimensions={1}, to_apply=%region_2.202
  %reduce.24.1.clone.1 = f32[512,52]{1,0} reduce(f32[512,256,52]{2,1,0} %param_0.1327, f32[] %constant_68_18), dimensions={1}, to_apply=%region_2.202
  ROOT %tuple.57 = (f32[512,52]{1,0}, f32[512,52]{1,0}) tuple(f32[512,52]{1,0} %reduce.25.1, f32[512,52]{1,0} %reduce.24.1.clone.1)
}

%fused_reduce.15 (param_0.1324: f32[512,256,52]) -> (f32[512,52], f32[512,52]) {
  %param_0.1324 = f32[512,256,52]{2,1,0} parameter(0)
  %multiply.329.1 = f32[512,256,52]{2,1,0} multiply(f32[512,256,52]{2,1,0} %param_0.1324, f32[512,256,52]{2,1,0} %param_0.1324), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/LayerNorm_0/integer_pow[y=2]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
  %constant_68_15 = f32[] constant(0)
  %reduce.23.1 = f32[512,52]{1,0} reduce(f32[512,256,52]{2,1,0} %multiply.329.1, f32[] %constant_68_15), dimensions={1}, to_apply=%region_2.202
  %reduce.22.1.clone.1 = f32[512,52]{1,0} reduce(f32[512,256,52]{2,1,0} %param_0.1324, f32[] %constant_68_15), dimensions={1}, to_apply=%region_2.202
  ROOT %tuple.60 = (f32[512,52]{1,0}, f32[512,52]{1,0}) tuple(f32[512,52]{1,0} %reduce.23.1, f32[512,52]{1,0} %reduce.22.1.clone.1)
}

%fused_reduce.16 (param_0.1322: f32[512,256,52]) -> (f32[512,52], f32[512,52]) {
  %param_0.1322 = f32[512,256,52]{2,1,0} parameter(0)
  %multiply.323.1 = f32[512,256,52]{2,1,0} multiply(f32[512,256,52]{2,1,0} %param_0.1322, f32[512,256,52]{2,1,0} %param_0.1322), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/LayerNorm_1/integer_pow[y=2]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
  %constant_68_13 = f32[] constant(0)
  %reduce.21.1 = f32[512,52]{1,0} reduce(f32[512,256,52]{2,1,0} %multiply.323.1, f32[] %constant_68_13), dimensions={1}, to_apply=%region_2.202
  %reduce.20.1.clone.1 = f32[512,52]{1,0} reduce(f32[512,256,52]{2,1,0} %param_0.1322, f32[] %constant_68_13), dimensions={1}, to_apply=%region_2.202
  ROOT %tuple.62 = (f32[512,52]{1,0}, f32[512,52]{1,0}) tuple(f32[512,52]{1,0} %reduce.21.1, f32[512,52]{1,0} %reduce.20.1.clone.1)
}

%fused_reduce.17 (param_0.1330: f32[256], param_1.1425: f32[1,512,52], param_2.849: f32[256], param_3.542: f32[512,256,52], param_4.322: f32[512,52]) -> f32[256,52] {
  %param_3.542 = f32[512,256,52]{2,1,0} parameter(3)
  %param_4.322 = f32[512,52]{1,0} parameter(4)
  %broadcast.593.5 = f32[512,256,52]{2,1,0} broadcast(f32[512,52]{1,0} %param_4.322), dimensions={0,2}, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoder_norm/sub" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=228}
  %subtract.38.5 = f32[512,256,52]{2,1,0} subtract(f32[512,256,52]{2,1,0} %param_3.542, f32[512,256,52]{2,1,0} %broadcast.593.5), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoder_norm/sub" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=228}
  %param_1.1425 = f32[1,512,52]{2,1,0} parameter(1)
  %bitcast.5309.17 = f32[512,52]{1,0} bitcast(f32[1,512,52]{2,1,0} %param_1.1425)
  %broadcast.594.17 = f32[512,256,52]{2,1,0} broadcast(f32[512,52]{1,0} %bitcast.5309.17), dimensions={0,2}, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoder_norm/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=228}
  %param_0.1330 = f32[256]{0} parameter(0)
  %broadcast.595.14 = f32[512,256,52]{2,1,0} broadcast(f32[256]{0} %param_0.1330), dimensions={1}, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoder_norm/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=228}
  %multiply.348.13 = f32[512,256,52]{2,1,0} multiply(f32[512,256,52]{2,1,0} %broadcast.594.17, f32[512,256,52]{2,1,0} %broadcast.595.14), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoder_norm/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=228}
  %multiply.349.5 = f32[512,256,52]{2,1,0} multiply(f32[512,256,52]{2,1,0} %subtract.38.5, f32[512,256,52]{2,1,0} %multiply.348.13), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoder_norm/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=228}
  %param_2.849 = f32[256]{0} parameter(2)
  %broadcast.596.1 = f32[512,256,52]{2,1,0} broadcast(f32[256]{0} %param_2.849), dimensions={1}, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoder_norm/add" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=228}
  %add.242.3 = f32[512,256,52]{2,1,0} add(f32[512,256,52]{2,1,0} %multiply.349.5, f32[512,256,52]{2,1,0} %broadcast.596.1), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoder_norm/add" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=228}
  %constant_68_21 = f32[] constant(0)
  ROOT %reduce.28.1 = f32[256,52]{1,0} reduce(f32[512,256,52]{2,1,0} %add.242.3, f32[] %constant_68_21), dimensions={0}, to_apply=%region_2.202
}

%fused_reduce.18 (param_0.1312: f32[1,512,52], param_1.1411: f32[512,256,52], param_2.844: f32[512,256,52], param_3.541: f32[512,52]) -> f32[512,256] {
  %param_0.1312 = f32[1,512,52]{2,1,0} parameter(0)
  %bitcast.5225.15 = f32[512,52]{1,0} bitcast(f32[1,512,52]{2,1,0} %param_0.1312)
  %broadcast.589.15 = f32[512,256,52]{2,1,0} broadcast(f32[512,52]{1,0} %bitcast.5225.15), dimensions={0,2}, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/LayerNorm_1/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
  %param_2.844 = f32[512,256,52]{2,1,0} parameter(2)
  %param_3.541 = f32[512,52]{1,0} parameter(3)
  %broadcast.588.9 = f32[512,256,52]{2,1,0} broadcast(f32[512,52]{1,0} %param_3.541), dimensions={0,2}, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/LayerNorm_1/sub" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
  %subtract.36.9 = f32[512,256,52]{2,1,0} subtract(f32[512,256,52]{2,1,0} %param_2.844, f32[512,256,52]{2,1,0} %broadcast.588.9), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/LayerNorm_1/sub" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
  %param_1.1411 = f32[512,256,52]{2,1,0} parameter(1)
  %multiply.377.3 = f32[512,256,52]{2,1,0} multiply(f32[512,256,52]{2,1,0} %subtract.36.9, f32[512,256,52]{2,1,0} %param_1.1411), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/LayerNorm_1/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
  %multiply.427.3 = f32[512,256,52]{2,1,0} multiply(f32[512,256,52]{2,1,0} %broadcast.589.15, f32[512,256,52]{2,1,0} %multiply.377.3), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/LayerNorm_1/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
  %constant_68_3 = f32[] constant(0)
  ROOT %reduce.88.1 = f32[512,256]{1,0} reduce(f32[512,256,52]{2,1,0} %multiply.427.3, f32[] %constant_68_3), dimensions={2}, to_apply=%region_2.202
}

%fused_reduce.19 (param_0.1357: f32[1,512,52], param_1.1449: f32[512,256,52], param_2.862: f32[512,256,52], param_3.551: f32[512,52]) -> f32[512,256] {
  %param_0.1357 = f32[1,512,52]{2,1,0} parameter(0)
  %bitcast.5029.15 = f32[512,52]{1,0} bitcast(f32[1,512,52]{2,1,0} %param_0.1357)
  %broadcast.579.15 = f32[512,256,52]{2,1,0} broadcast(f32[512,52]{1,0} %bitcast.5029.15), dimensions={0,2}, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/LayerNorm_0/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
  %param_2.862 = f32[512,256,52]{2,1,0} parameter(2)
  %param_3.551 = f32[512,52]{1,0} parameter(3)
  %broadcast.578.9 = f32[512,256,52]{2,1,0} broadcast(f32[512,52]{1,0} %param_3.551), dimensions={0,2}, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/LayerNorm_0/sub" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
  %subtract.33.9 = f32[512,256,52]{2,1,0} subtract(f32[512,256,52]{2,1,0} %param_2.862, f32[512,256,52]{2,1,0} %broadcast.578.9), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/LayerNorm_0/sub" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
  %param_1.1449 = f32[512,256,52]{2,1,0} parameter(1)
  %multiply.396.3 = f32[512,256,52]{2,1,0} multiply(f32[512,256,52]{2,1,0} %subtract.33.9, f32[512,256,52]{2,1,0} %param_1.1449), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/LayerNorm_0/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
  %multiply.426.3 = f32[512,256,52]{2,1,0} multiply(f32[512,256,52]{2,1,0} %broadcast.579.15, f32[512,256,52]{2,1,0} %multiply.396.3), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/LayerNorm_0/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
  %constant_68_48 = f32[] constant(0)
  ROOT %reduce.84.1 = f32[512,256]{1,0} reduce(f32[512,256,52]{2,1,0} %multiply.426.3, f32[] %constant_68_48), dimensions={2}, to_apply=%region_2.202
}

%fused_reduce.20 (param_0.1355: f32[1,512,52], param_1.1447: f32[512,256,52], param_2.861: f32[512,256,52], param_3.550: f32[512,52]) -> f32[512,256] {
  %param_0.1355 = f32[1,512,52]{2,1,0} parameter(0)
  %bitcast.4945.15 = f32[512,52]{1,0} bitcast(f32[1,512,52]{2,1,0} %param_0.1355)
  %broadcast.574.15 = f32[512,256,52]{2,1,0} broadcast(f32[512,52]{1,0} %bitcast.4945.15), dimensions={0,2}, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/LayerNorm_1/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
  %param_2.861 = f32[512,256,52]{2,1,0} parameter(2)
  %param_3.550 = f32[512,52]{1,0} parameter(3)
  %broadcast.573.9 = f32[512,256,52]{2,1,0} broadcast(f32[512,52]{1,0} %param_3.550), dimensions={0,2}, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/LayerNorm_1/sub" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
  %subtract.31.9 = f32[512,256,52]{2,1,0} subtract(f32[512,256,52]{2,1,0} %param_2.861, f32[512,256,52]{2,1,0} %broadcast.573.9), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/LayerNorm_1/sub" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
  %param_1.1447 = f32[512,256,52]{2,1,0} parameter(1)
  %multiply.407.3 = f32[512,256,52]{2,1,0} multiply(f32[512,256,52]{2,1,0} %subtract.31.9, f32[512,256,52]{2,1,0} %param_1.1447), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/LayerNorm_1/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
  %multiply.425.3 = f32[512,256,52]{2,1,0} multiply(f32[512,256,52]{2,1,0} %broadcast.574.15, f32[512,256,52]{2,1,0} %multiply.407.3), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/LayerNorm_1/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
  %constant_68_46 = f32[] constant(0)
  ROOT %reduce.74.1 = f32[512,256]{1,0} reduce(f32[512,256,52]{2,1,0} %multiply.425.3, f32[] %constant_68_46), dimensions={2}, to_apply=%region_2.202
}

%fused_reduce.21 (param_0.1353: f32[1,512,52], param_1.1446: f32[512,256,52], param_2.860: f32[512,52], param_3.549: bf16[512,256], param_4.324: bf16[512,256,52]) -> f32[512,256] {
  %param_0.1353 = f32[1,512,52]{2,1,0} parameter(0)
  %bitcast.4750.15 = f32[512,52]{1,0} bitcast(f32[1,512,52]{2,1,0} %param_0.1353)
  %broadcast.559.15 = f32[512,256,52]{2,1,0} broadcast(f32[512,52]{1,0} %bitcast.4750.15), dimensions={0,2}, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/LayerNorm_0/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
  %param_4.324 = bf16[512,256,52]{2,1,0} parameter(4)
  %convert.1407.21 = f32[512,256,52]{2,1,0} convert(bf16[512,256,52]{2,1,0} %param_4.324)
  %param_3.549 = bf16[512,256]{1,0} parameter(3)
  %convert.1617.12 = f32[512,256]{1,0} convert(bf16[512,256]{1,0} %param_3.549)
  %broadcast.654.21 = f32[512,256,52]{2,1,0} broadcast(f32[512,256]{1,0} %convert.1617.12), dimensions={0,1}, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/im_embed/vmap(inner)/pos_embed/add" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=64}
  %add.217.21 = f32[512,256,52]{2,1,0} add(f32[512,256,52]{2,1,0} %convert.1407.21, f32[512,256,52]{2,1,0} %broadcast.654.21), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/im_embed/vmap(inner)/pos_embed/add" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=64}
  %param_2.860 = f32[512,52]{1,0} parameter(2)
  %broadcast.556.11 = f32[512,256,52]{2,1,0} broadcast(f32[512,52]{1,0} %param_2.860), dimensions={0,2}, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/LayerNorm_0/sub" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
  %subtract.28.11 = f32[512,256,52]{2,1,0} subtract(f32[512,256,52]{2,1,0} %add.217.21, f32[512,256,52]{2,1,0} %broadcast.556.11), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/LayerNorm_0/sub" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
  %param_1.1446 = f32[512,256,52]{2,1,0} parameter(1)
  %multiply.423.5 = f32[512,256,52]{2,1,0} multiply(f32[512,256,52]{2,1,0} %subtract.28.11, f32[512,256,52]{2,1,0} %param_1.1446), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/LayerNorm_0/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
  %multiply.424.3 = f32[512,256,52]{2,1,0} multiply(f32[512,256,52]{2,1,0} %broadcast.559.15, f32[512,256,52]{2,1,0} %multiply.423.5), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/LayerNorm_0/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
  %constant_68_44 = f32[] constant(0)
  ROOT %reduce.70.1 = f32[512,256]{1,0} reduce(f32[512,256,52]{2,1,0} %multiply.424.3, f32[] %constant_68_44), dimensions={2}, to_apply=%region_2.202
}

%fused_reduce.22 (param_0.1341: f32[256], param_1.1435: f32[512,256,52], param_2.854: f32[512,256,52], param_3.545: f32[512,52], param_4.378: f32[1,512,52]) -> (f32[512,52], f32[512,52]) {
  %param_2.854 = f32[512,256,52]{2,1,0} parameter(2)
  %param_3.545 = f32[512,52]{1,0} parameter(3)
  %broadcast.573.11 = f32[512,256,52]{2,1,0} broadcast(f32[512,52]{1,0} %param_3.545), dimensions={0,2}, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/LayerNorm_1/sub" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
  %subtract.31.11 = f32[512,256,52]{2,1,0} subtract(f32[512,256,52]{2,1,0} %param_2.854, f32[512,256,52]{2,1,0} %broadcast.573.11), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/LayerNorm_1/sub" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
  %param_1.1435 = f32[512,256,52]{2,1,0} parameter(1)
  %multiply.407.5 = f32[512,256,52]{2,1,0} multiply(f32[512,256,52]{2,1,0} %subtract.31.11, f32[512,256,52]{2,1,0} %param_1.1435), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/LayerNorm_1/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
  %param_0.1341 = f32[256]{0} parameter(0)
  %broadcast.575.12 = f32[512,256,52]{2,1,0} broadcast(f32[256]{0} %param_0.1341), dimensions={1}, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/LayerNorm_1/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
  %multiply.408.3 = f32[512,256,52]{2,1,0} multiply(f32[512,256,52]{2,1,0} %multiply.407.5, f32[512,256,52]{2,1,0} %broadcast.575.12), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/LayerNorm_1/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
  %constant_68_32 = f32[] constant(0)
  %reduce.38.1 = f32[512,52]{1,0} reduce(f32[512,256,52]{2,1,0} %multiply.408.3, f32[] %constant_68_32), dimensions={1}, to_apply=%region_2.202
  %param_4.378 = f32[1,512,52]{2,1,0} parameter(4)
  %bitcast.4945.23.clone.1 = f32[512,52]{1,0} bitcast(f32[1,512,52]{2,1,0} %param_4.378)
  %broadcast.574.23.clone.1 = f32[512,256,52]{2,1,0} broadcast(f32[512,52]{1,0} %bitcast.4945.23.clone.1), dimensions={0,2}, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/LayerNorm_1/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
  %multiply.326.17.clone.1 = f32[512,256,52]{2,1,0} multiply(f32[512,256,52]{2,1,0} %broadcast.574.23.clone.1, f32[512,256,52]{2,1,0} %broadcast.575.12), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/LayerNorm_1/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
  %multiply.406.7.clone.1 = f32[512,256,52]{2,1,0} multiply(f32[512,256,52]{2,1,0} %param_1.1435, f32[512,256,52]{2,1,0} %multiply.326.17.clone.1), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/LayerNorm_1/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
  %reduce.39.3.clone.1 = f32[512,52]{1,0} reduce(f32[512,256,52]{2,1,0} %multiply.406.7.clone.1, f32[] %constant_68_32), dimensions={1}, to_apply=%region_2.202
  %negate.43.1.clone.1 = f32[512,52]{1,0} negate(f32[512,52]{1,0} %reduce.39.3.clone.1), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/LayerNorm_1/neg" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
  ROOT %tuple.32 = (f32[512,52]{1,0}, f32[512,52]{1,0}) tuple(f32[512,52]{1,0} %reduce.38.1, f32[512,52]{1,0} %negate.43.1.clone.1)
}

%fused_reduce.23 (param_0.1347: f32[256], param_1.1441: f32[512,256,52], param_2.857: f32[512,256,52], param_3.547: f32[512,52], param_4.389: f32[1,512,52]) -> (f32[512,52], f32[512,52]) {
  %param_2.857 = f32[512,256,52]{2,1,0} parameter(2)
  %param_3.547 = f32[512,52]{1,0} parameter(3)
  %broadcast.578.11 = f32[512,256,52]{2,1,0} broadcast(f32[512,52]{1,0} %param_3.547), dimensions={0,2}, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/LayerNorm_0/sub" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
  %subtract.33.11 = f32[512,256,52]{2,1,0} subtract(f32[512,256,52]{2,1,0} %param_2.857, f32[512,256,52]{2,1,0} %broadcast.578.11), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/LayerNorm_0/sub" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
  %param_1.1441 = f32[512,256,52]{2,1,0} parameter(1)
  %multiply.396.5 = f32[512,256,52]{2,1,0} multiply(f32[512,256,52]{2,1,0} %subtract.33.11, f32[512,256,52]{2,1,0} %param_1.1441), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/LayerNorm_0/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
  %param_0.1347 = f32[256]{0} parameter(0)
  %broadcast.580.12 = f32[512,256,52]{2,1,0} broadcast(f32[256]{0} %param_0.1347), dimensions={1}, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/LayerNorm_0/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
  %multiply.397.3 = f32[512,256,52]{2,1,0} multiply(f32[512,256,52]{2,1,0} %multiply.396.5, f32[512,256,52]{2,1,0} %broadcast.580.12), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/LayerNorm_0/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
  %constant_68_38 = f32[] constant(0)
  %reduce.36.1 = f32[512,52]{1,0} reduce(f32[512,256,52]{2,1,0} %multiply.397.3, f32[] %constant_68_38), dimensions={1}, to_apply=%region_2.202
  %param_4.389 = f32[1,512,52]{2,1,0} parameter(4)
  %bitcast.5029.23.clone.1 = f32[512,52]{1,0} bitcast(f32[1,512,52]{2,1,0} %param_4.389)
  %broadcast.579.23.clone.1 = f32[512,256,52]{2,1,0} broadcast(f32[512,52]{1,0} %bitcast.5029.23.clone.1), dimensions={0,2}, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/LayerNorm_0/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
  %multiply.333.17.clone.1 = f32[512,256,52]{2,1,0} multiply(f32[512,256,52]{2,1,0} %broadcast.579.23.clone.1, f32[512,256,52]{2,1,0} %broadcast.580.12), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/LayerNorm_0/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
  %multiply.395.7.clone.1 = f32[512,256,52]{2,1,0} multiply(f32[512,256,52]{2,1,0} %param_1.1441, f32[512,256,52]{2,1,0} %multiply.333.17.clone.1), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/LayerNorm_0/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
  %reduce.37.3.clone.1 = f32[512,52]{1,0} reduce(f32[512,256,52]{2,1,0} %multiply.395.7.clone.1, f32[] %constant_68_38), dimensions={1}, to_apply=%region_2.202
  %negate.41.1.clone.1 = f32[512,52]{1,0} negate(f32[512,52]{1,0} %reduce.37.3.clone.1), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/LayerNorm_0/neg" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
  ROOT %tuple.35 = (f32[512,52]{1,0}, f32[512,52]{1,0}) tuple(f32[512,52]{1,0} %reduce.36.1, f32[512,52]{1,0} %negate.41.1.clone.1)
}

%fused_reduce.24 (param_0.1340: f32[256], param_1.1434: f32[512,256,52], param_2.853: f32[512,256,52], param_3.544: f32[512,52], param_4.400: f32[1,512,52]) -> (f32[512,52], f32[512,52]) {
  %param_2.853 = f32[512,256,52]{2,1,0} parameter(2)
  %param_3.544 = f32[512,52]{1,0} parameter(3)
  %broadcast.588.11 = f32[512,256,52]{2,1,0} broadcast(f32[512,52]{1,0} %param_3.544), dimensions={0,2}, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/LayerNorm_1/sub" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
  %subtract.36.11 = f32[512,256,52]{2,1,0} subtract(f32[512,256,52]{2,1,0} %param_2.853, f32[512,256,52]{2,1,0} %broadcast.588.11), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/LayerNorm_1/sub" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
  %param_1.1434 = f32[512,256,52]{2,1,0} parameter(1)
  %multiply.377.5 = f32[512,256,52]{2,1,0} multiply(f32[512,256,52]{2,1,0} %subtract.36.11, f32[512,256,52]{2,1,0} %param_1.1434), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/LayerNorm_1/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
  %param_0.1340 = f32[256]{0} parameter(0)
  %broadcast.590.12 = f32[512,256,52]{2,1,0} broadcast(f32[256]{0} %param_0.1340), dimensions={1}, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/LayerNorm_1/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
  %multiply.378.3 = f32[512,256,52]{2,1,0} multiply(f32[512,256,52]{2,1,0} %multiply.377.5, f32[512,256,52]{2,1,0} %broadcast.590.12), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/LayerNorm_1/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
  %constant_68_31 = f32[] constant(0)
  %reduce.34.1 = f32[512,52]{1,0} reduce(f32[512,256,52]{2,1,0} %multiply.378.3, f32[] %constant_68_31), dimensions={1}, to_apply=%region_2.202
  %param_4.400 = f32[1,512,52]{2,1,0} parameter(4)
  %bitcast.5225.23.clone.1 = f32[512,52]{1,0} bitcast(f32[1,512,52]{2,1,0} %param_4.400)
  %broadcast.589.23.clone.1 = f32[512,256,52]{2,1,0} broadcast(f32[512,52]{1,0} %bitcast.5225.23.clone.1), dimensions={0,2}, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/LayerNorm_1/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
  %multiply.342.17.clone.1 = f32[512,256,52]{2,1,0} multiply(f32[512,256,52]{2,1,0} %broadcast.589.23.clone.1, f32[512,256,52]{2,1,0} %broadcast.590.12), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/LayerNorm_1/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
  %multiply.376.7.clone.1 = f32[512,256,52]{2,1,0} multiply(f32[512,256,52]{2,1,0} %param_1.1434, f32[512,256,52]{2,1,0} %multiply.342.17.clone.1), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/LayerNorm_1/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
  %reduce.35.3.clone.1 = f32[512,52]{1,0} reduce(f32[512,256,52]{2,1,0} %multiply.376.7.clone.1, f32[] %constant_68_31), dimensions={1}, to_apply=%region_2.202
  %negate.38.1.clone.1 = f32[512,52]{1,0} negate(f32[512,52]{1,0} %reduce.35.3.clone.1), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/LayerNorm_1/neg" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
  ROOT %tuple.45 = (f32[512,52]{1,0}, f32[512,52]{1,0}) tuple(f32[512,52]{1,0} %reduce.34.1, f32[512,52]{1,0} %negate.38.1.clone.1)
}

%fused_convert.14 (param_0.797: f32[4,64], param_1.734: bf16[26624,256]) -> bf16[52,4,512,64] {
  %param_1.734 = bf16[26624,256]{1,0} parameter(1)
  %bitcast.5074.3 = bf16[52,512,4,64]{3,2,1,0} bitcast(bf16[26624,256]{1,0} %param_1.734)
  %transpose.1196.3 = bf16[52,4,512,64]{3,2,1,0} transpose(bf16[52,512,4,64]{3,2,1,0} %bitcast.5074.3), dimensions={0,2,1,3}, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/MultiHeadDotProductAttention_0/query/dot_general[dimension_numbers=(((2,), (0,)), ((), ())) precision=None preferred_element_type=None]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %convert.1455.1 = f32[52,4,512,64]{3,2,1,0} convert(bf16[52,4,512,64]{3,2,1,0} %transpose.1196.3)
  %param_0.797 = f32[4,64]{1,0} parameter(0)
  %broadcast.665.3 = f32[52,4,512,64]{3,2,1,0} broadcast(f32[4,64]{1,0} %param_0.797), dimensions={1,3}, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/MultiHeadDotProductAttention_0/query/add" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %add.232.3 = f32[52,4,512,64]{3,2,1,0} add(f32[52,4,512,64]{3,2,1,0} %convert.1455.1, f32[52,4,512,64]{3,2,1,0} %broadcast.665.3), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/MultiHeadDotProductAttention_0/query/add" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %constant_37_5 = bf16[] constant(0.125)
  %convert.1620.3 = f32[] convert(bf16[] %constant_37_5)
  %broadcast.658.6 = f32[52,4,512,64]{3,2,1,0} broadcast(f32[] %convert.1620.3), dimensions={}
  %multiply.336.3 = f32[52,4,512,64]{3,2,1,0} multiply(f32[52,4,512,64]{3,2,1,0} %add.232.3, f32[52,4,512,64]{3,2,1,0} %broadcast.658.6), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/MultiHeadDotProductAttention_0/div" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  ROOT %convert.1459.1 = bf16[52,4,512,64]{3,2,1,0} convert(f32[52,4,512,64]{3,2,1,0} %multiply.336.3)
}

%fused_convert.15 (param_0.796: f32[4,64], param_1.733: bf16[26624,256]) -> bf16[52,4,512,64] {
  %param_1.733 = bf16[26624,256]{1,0} parameter(1)
  %bitcast.4795.3 = bf16[52,512,4,64]{3,2,1,0} bitcast(bf16[26624,256]{1,0} %param_1.733)
  %transpose.1185.3 = bf16[52,4,512,64]{3,2,1,0} transpose(bf16[52,512,4,64]{3,2,1,0} %bitcast.4795.3), dimensions={0,2,1,3}, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/MultiHeadDotProductAttention_0/query/dot_general[dimension_numbers=(((2,), (0,)), ((), ())) precision=None preferred_element_type=None]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %convert.1417.1 = f32[52,4,512,64]{3,2,1,0} convert(bf16[52,4,512,64]{3,2,1,0} %transpose.1185.3)
  %param_0.796 = f32[4,64]{1,0} parameter(0)
  %broadcast.656.3 = f32[52,4,512,64]{3,2,1,0} broadcast(f32[4,64]{1,0} %param_0.796), dimensions={1,3}, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/MultiHeadDotProductAttention_0/query/add" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %add.221.3 = f32[52,4,512,64]{3,2,1,0} add(f32[52,4,512,64]{3,2,1,0} %convert.1417.1, f32[52,4,512,64]{3,2,1,0} %broadcast.656.3), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/MultiHeadDotProductAttention_0/query/add" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %constant_37_4 = bf16[] constant(0.125)
  %convert.1620.2 = f32[] convert(bf16[] %constant_37_4)
  %broadcast.658.8 = f32[52,4,512,64]{3,2,1,0} broadcast(f32[] %convert.1620.2), dimensions={}
  %multiply.321.3 = f32[52,4,512,64]{3,2,1,0} multiply(f32[52,4,512,64]{3,2,1,0} %add.221.3, f32[52,4,512,64]{3,2,1,0} %broadcast.658.8), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/MultiHeadDotProductAttention_0/div" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  ROOT %convert.1421.1 = bf16[52,4,512,64]{3,2,1,0} convert(f32[52,4,512,64]{3,2,1,0} %multiply.321.3)
}

%region_18.769.clone.21 (Arg_0.24.0: f32[], Arg_1.24.0: f32[]) -> f32[] {
  %Arg_1.24.0 = f32[] parameter(1)
  %Arg_0.24.0 = f32[] parameter(0)
  ROOT %add.206.0 = f32[] add(f32[] %Arg_0.24.0, f32[] %Arg_1.24.0), metadata={op_name="jit(loss)/jit(main)/reduce_sum[axes=(1,)]" source_file="/home/nicholas/programs/avid/avid/config.py" source_line=371}
}

%fused_reduce.25 (param_0.896: bf16[208,64,512]) -> f32[52,4,64] {
  %param_0.896 = bf16[208,64,512]{2,1,0} parameter(0)
  %bitcast.5732.5 = bf16[52,4,64,512]{3,2,1,0} bitcast(bf16[208,64,512]{2,1,0} %param_0.896)
  %convert.1582.3 = f32[52,4,64,512]{3,2,1,0} convert(bf16[52,4,64,512]{3,2,1,0} %bitcast.5732.5)
  %constant_55_26 = bf16[] constant(0)
  %convert.1640.23 = f32[] convert(bf16[] %constant_55_26)
  ROOT %reduce.94.1 = f32[52,4,64]{2,1,0} reduce(f32[52,4,64,512]{3,2,1,0} %convert.1582.3, f32[] %convert.1640.23), dimensions={3}, to_apply=%region_18.769.clone.21
}

%region_18.769.clone.11 (Arg_0.14.0: f32[], Arg_1.14.0: f32[]) -> f32[] {
  %Arg_1.14.0 = f32[] parameter(1)
  %Arg_0.14.0 = f32[] parameter(0)
  ROOT %add.199.0 = f32[] add(f32[] %Arg_0.14.0, f32[] %Arg_1.14.0), metadata={op_name="jit(loss)/jit(main)/reduce_sum[axes=(1,)]" source_file="/home/nicholas/programs/avid/avid/config.py" source_line=371}
}

%fused_reduce.26 (param_0.886: bf16[208,64,512]) -> f32[52,4,64] {
  %param_0.886 = bf16[208,64,512]{2,1,0} parameter(0)
  %bitcast.6081.5 = bf16[52,4,64,512]{3,2,1,0} bitcast(bf16[208,64,512]{2,1,0} %param_0.886)
  %convert.1563.3 = f32[52,4,64,512]{3,2,1,0} convert(bf16[52,4,64,512]{3,2,1,0} %bitcast.6081.5)
  %constant_55_16 = bf16[] constant(0)
  %convert.1640.13 = f32[] convert(bf16[] %constant_55_16)
  ROOT %reduce.80.1 = f32[52,4,64]{2,1,0} reduce(f32[52,4,64,512]{3,2,1,0} %convert.1563.3, f32[] %convert.1640.13), dimensions={3}, to_apply=%region_18.769.clone.11
}

%fused_transpose.12 (param_0.584: f32[4,64], param_1.671: bf16[26624,256]) -> bf16[52,4,64,512] {
  %param_1.671 = bf16[26624,256]{1,0} parameter(1)
  %bitcast.5100.3 = bf16[52,512,4,64]{3,2,1,0} bitcast(bf16[26624,256]{1,0} %param_1.671)
  %transpose.1197.3 = bf16[52,4,64,512]{3,2,1,0} transpose(bf16[52,512,4,64]{3,2,1,0} %bitcast.5100.3), dimensions={0,2,3,1}, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/MultiHeadDotProductAttention_0/key/dot_general[dimension_numbers=(((2,), (0,)), ((), ())) precision=None preferred_element_type=None]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %convert.1461.1 = f32[52,4,64,512]{3,2,1,0} convert(bf16[52,4,64,512]{3,2,1,0} %transpose.1197.3)
  %param_0.584 = f32[4,64]{1,0} parameter(0)
  %broadcast.666.3 = f32[52,4,64,512]{3,2,1,0} broadcast(f32[4,64]{1,0} %param_0.584), dimensions={1,2}, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/MultiHeadDotProductAttention_0/key/add" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %add.234.3 = f32[52,4,64,512]{3,2,1,0} add(f32[52,4,64,512]{3,2,1,0} %convert.1461.1, f32[52,4,64,512]{3,2,1,0} %broadcast.666.3), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/MultiHeadDotProductAttention_0/key/add" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  ROOT %convert.1464.1 = bf16[52,4,64,512]{3,2,1,0} convert(f32[52,4,64,512]{3,2,1,0} %add.234.3)
}

%fused_transpose.13 (param_0.585: f32[4,64], param_1.669: bf16[26624,256]) -> bf16[52,4,64,512] {
  %param_1.669 = bf16[26624,256]{1,0} parameter(1)
  %bitcast.5052.3 = bf16[52,512,4,64]{3,2,1,0} bitcast(bf16[26624,256]{1,0} %param_1.669)
  %transpose.1195.3 = bf16[52,4,64,512]{3,2,1,0} transpose(bf16[52,512,4,64]{3,2,1,0} %bitcast.5052.3), dimensions={0,2,3,1}, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/MultiHeadDotProductAttention_0/value/dot_general[dimension_numbers=(((2,), (0,)), ((), ())) precision=None preferred_element_type=None]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %convert.1450.1 = f32[52,4,64,512]{3,2,1,0} convert(bf16[52,4,64,512]{3,2,1,0} %transpose.1195.3)
  %param_0.585 = f32[4,64]{1,0} parameter(0)
  %broadcast.664.3 = f32[52,4,64,512]{3,2,1,0} broadcast(f32[4,64]{1,0} %param_0.585), dimensions={1,2}, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/MultiHeadDotProductAttention_0/value/add" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %add.231.3 = f32[52,4,64,512]{3,2,1,0} add(f32[52,4,64,512]{3,2,1,0} %convert.1450.1, f32[52,4,64,512]{3,2,1,0} %broadcast.664.3), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/MultiHeadDotProductAttention_0/value/add" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  ROOT %convert.1453.1 = bf16[52,4,64,512]{3,2,1,0} convert(f32[52,4,64,512]{3,2,1,0} %add.231.3)
}

%fused_transpose.14 (param_0.595: f32[4,64], param_1.659: bf16[26624,256]) -> bf16[52,4,64,512] {
  %param_1.659 = bf16[26624,256]{1,0} parameter(1)
  %bitcast.4821.3 = bf16[52,512,4,64]{3,2,1,0} bitcast(bf16[26624,256]{1,0} %param_1.659)
  %transpose.1186.3 = bf16[52,4,64,512]{3,2,1,0} transpose(bf16[52,512,4,64]{3,2,1,0} %bitcast.4821.3), dimensions={0,2,3,1}, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/MultiHeadDotProductAttention_0/key/dot_general[dimension_numbers=(((2,), (0,)), ((), ())) precision=None preferred_element_type=None]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %convert.1423.1 = f32[52,4,64,512]{3,2,1,0} convert(bf16[52,4,64,512]{3,2,1,0} %transpose.1186.3)
  %param_0.595 = f32[4,64]{1,0} parameter(0)
  %broadcast.659.3 = f32[52,4,64,512]{3,2,1,0} broadcast(f32[4,64]{1,0} %param_0.595), dimensions={1,2}, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/MultiHeadDotProductAttention_0/key/add" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %add.222.3 = f32[52,4,64,512]{3,2,1,0} add(f32[52,4,64,512]{3,2,1,0} %convert.1423.1, f32[52,4,64,512]{3,2,1,0} %broadcast.659.3), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/MultiHeadDotProductAttention_0/key/add" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  ROOT %convert.1426.1 = bf16[52,4,64,512]{3,2,1,0} convert(f32[52,4,64,512]{3,2,1,0} %add.222.3)
}

%fused_transpose.15 (param_0.596: f32[4,64], param_1.657: bf16[26624,256]) -> bf16[52,4,64,512] {
  %param_1.657 = bf16[26624,256]{1,0} parameter(1)
  %bitcast.4773.3 = bf16[52,512,4,64]{3,2,1,0} bitcast(bf16[26624,256]{1,0} %param_1.657)
  %transpose.1184.3 = bf16[52,4,64,512]{3,2,1,0} transpose(bf16[52,512,4,64]{3,2,1,0} %bitcast.4773.3), dimensions={0,2,3,1}, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/MultiHeadDotProductAttention_0/value/dot_general[dimension_numbers=(((2,), (0,)), ((), ())) precision=None preferred_element_type=None]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %convert.1412.1 = f32[52,4,64,512]{3,2,1,0} convert(bf16[52,4,64,512]{3,2,1,0} %transpose.1184.3)
  %param_0.596 = f32[4,64]{1,0} parameter(0)
  %broadcast.655.3 = f32[52,4,64,512]{3,2,1,0} broadcast(f32[4,64]{1,0} %param_0.596), dimensions={1,2}, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/MultiHeadDotProductAttention_0/value/add" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %add.220.3 = f32[52,4,64,512]{3,2,1,0} add(f32[52,4,64,512]{3,2,1,0} %convert.1412.1, f32[52,4,64,512]{3,2,1,0} %broadcast.655.3), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/MultiHeadDotProductAttention_0/value/add" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  ROOT %convert.1415.1 = bf16[52,4,64,512]{3,2,1,0} convert(f32[52,4,64,512]{3,2,1,0} %add.220.3)
}

%fused_transpose.16 (param_0.577: f32[512,256,52], param_1.683: f32[256], param_2.339: bf16[26624,256]) -> f32[512,256,52] {
  %param_0.577 = f32[512,256,52]{2,1,0} parameter(0)
  %param_2.339 = bf16[26624,256]{1,0} parameter(2)
  %convert.1481.5 = f32[26624,256]{1,0} convert(bf16[26624,256]{1,0} %param_2.339)
  %param_1.683 = f32[256]{0} parameter(1)
  %broadcast.670.7 = f32[26624,256]{1,0} broadcast(f32[256]{0} %param_1.683), dimensions={1}, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/vmap(vmap(LazyInMLP_0))/Dense_0/add" source_file="/home/nicholas/programs/avid/avid/layers.py" source_line=49}
  %add.239.7 = f32[26624,256]{1,0} add(f32[26624,256]{1,0} %convert.1481.5, f32[26624,256]{1,0} %broadcast.670.7), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/vmap(vmap(LazyInMLP_0))/Dense_0/add" source_file="/home/nicholas/programs/avid/avid/layers.py" source_line=49}
  %convert.1484.5 = bf16[26624,256]{1,0} convert(f32[26624,256]{1,0} %add.239.7)
  %bitcast.5254.3 = bf16[52,512,256]{2,1,0} bitcast(bf16[26624,256]{1,0} %convert.1484.5)
  %transpose.1201.3 = bf16[512,256,52]{2,1,0} transpose(bf16[52,512,256]{2,1,0} %bitcast.5254.3), dimensions={1,2,0}, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/vmap(vmap(LazyInMLP_0))/Dense_0/add" source_file="/home/nicholas/programs/avid/avid/layers.py" source_line=49}
  %convert.1485.1 = f32[512,256,52]{2,1,0} convert(bf16[512,256,52]{2,1,0} %transpose.1201.3)
  ROOT %add.240.1 = f32[512,256,52]{2,1,0} add(f32[512,256,52]{2,1,0} %param_0.577, f32[512,256,52]{2,1,0} %convert.1485.1), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/add" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=185}
}

%fused_transpose.17 (param_0.582: f32[512,256,52], param_1.677: f32[256], param_2.336: bf16[26624,256]) -> f32[512,256,52] {
  %param_2.336 = bf16[26624,256]{1,0} parameter(2)
  %convert.1474.5 = f32[26624,256]{1,0} convert(bf16[26624,256]{1,0} %param_2.336)
  %param_1.677 = f32[256]{0} parameter(1)
  %broadcast.669.7 = f32[26624,256]{1,0} broadcast(f32[256]{0} %param_1.677), dimensions={1}, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/MultiHeadDotProductAttention_0/out/add" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %add.235.7 = f32[26624,256]{1,0} add(f32[26624,256]{1,0} %convert.1474.5, f32[26624,256]{1,0} %broadcast.669.7), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/MultiHeadDotProductAttention_0/out/add" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %convert.1477.5 = bf16[26624,256]{1,0} convert(f32[26624,256]{1,0} %add.235.7)
  %bitcast.5168.3 = bf16[52,512,256]{2,1,0} bitcast(bf16[26624,256]{1,0} %convert.1477.5)
  %transpose.1199.3 = bf16[512,256,52]{2,1,0} transpose(bf16[52,512,256]{2,1,0} %bitcast.5168.3), dimensions={1,2,0}, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/MultiHeadDotProductAttention_0/out/add" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %convert.1478.1 = f32[512,256,52]{2,1,0} convert(bf16[512,256,52]{2,1,0} %transpose.1199.3)
  %param_0.582 = f32[512,256,52]{2,1,0} parameter(0)
  ROOT %add.236.1 = f32[512,256,52]{2,1,0} add(f32[512,256,52]{2,1,0} %convert.1478.1, f32[512,256,52]{2,1,0} %param_0.582), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/add" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=168}
}

%fused_transpose.18 (param_0.588: f32[512,256,52], param_1.667: f32[256], param_2.331: bf16[26624,256]) -> f32[512,256,52] {
  %param_0.588 = f32[512,256,52]{2,1,0} parameter(0)
  %param_2.331 = bf16[26624,256]{1,0} parameter(2)
  %convert.1443.5 = f32[26624,256]{1,0} convert(bf16[26624,256]{1,0} %param_2.331)
  %param_1.667 = f32[256]{0} parameter(1)
  %broadcast.663.7 = f32[26624,256]{1,0} broadcast(f32[256]{0} %param_1.667), dimensions={1}, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/vmap(vmap(LazyInMLP_0))/Dense_0/add" source_file="/home/nicholas/programs/avid/avid/layers.py" source_line=49}
  %add.227.7 = f32[26624,256]{1,0} add(f32[26624,256]{1,0} %convert.1443.5, f32[26624,256]{1,0} %broadcast.663.7), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/vmap(vmap(LazyInMLP_0))/Dense_0/add" source_file="/home/nicholas/programs/avid/avid/layers.py" source_line=49}
  %convert.1446.5 = bf16[26624,256]{1,0} convert(f32[26624,256]{1,0} %add.227.7)
  %bitcast.4974.3 = bf16[52,512,256]{2,1,0} bitcast(bf16[26624,256]{1,0} %convert.1446.5)
  %transpose.1192.3 = bf16[512,256,52]{2,1,0} transpose(bf16[52,512,256]{2,1,0} %bitcast.4974.3), dimensions={1,2,0}, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/vmap(vmap(LazyInMLP_0))/Dense_0/add" source_file="/home/nicholas/programs/avid/avid/layers.py" source_line=49}
  %convert.1447.1 = f32[512,256,52]{2,1,0} convert(bf16[512,256,52]{2,1,0} %transpose.1192.3)
  ROOT %add.228.1 = f32[512,256,52]{2,1,0} add(f32[512,256,52]{2,1,0} %param_0.588, f32[512,256,52]{2,1,0} %convert.1447.1), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/add" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=185}
}

%fused_transpose.19 (param_0.704: bf16[512,256,52], param_1.661: bf16[512,256], param_2.328: f32[256], param_3.187: bf16[26624,256]) -> f32[512,256,52] {
  %param_3.187 = bf16[26624,256]{1,0} parameter(3)
  %convert.1436.5 = f32[26624,256]{1,0} convert(bf16[26624,256]{1,0} %param_3.187)
  %param_2.328 = f32[256]{0} parameter(2)
  %broadcast.662.7 = f32[26624,256]{1,0} broadcast(f32[256]{0} %param_2.328), dimensions={1}, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/MultiHeadDotProductAttention_0/out/add" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %add.223.7 = f32[26624,256]{1,0} add(f32[26624,256]{1,0} %convert.1436.5, f32[26624,256]{1,0} %broadcast.662.7), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/MultiHeadDotProductAttention_0/out/add" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %convert.1439.5 = bf16[26624,256]{1,0} convert(f32[26624,256]{1,0} %add.223.7)
  %bitcast.4888.3 = bf16[52,512,256]{2,1,0} bitcast(bf16[26624,256]{1,0} %convert.1439.5)
  %transpose.1189.3 = bf16[512,256,52]{2,1,0} transpose(bf16[52,512,256]{2,1,0} %bitcast.4888.3), dimensions={1,2,0}, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/MultiHeadDotProductAttention_0/out/add" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %convert.1440.1 = f32[512,256,52]{2,1,0} convert(bf16[512,256,52]{2,1,0} %transpose.1189.3)
  %param_0.704 = bf16[512,256,52]{2,1,0} parameter(0)
  %convert.1407.5 = f32[512,256,52]{2,1,0} convert(bf16[512,256,52]{2,1,0} %param_0.704)
  %param_1.661 = bf16[512,256]{1,0} parameter(1)
  %convert.1617.3 = f32[512,256]{1,0} convert(bf16[512,256]{1,0} %param_1.661)
  %broadcast.654.5 = f32[512,256,52]{2,1,0} broadcast(f32[512,256]{1,0} %convert.1617.3), dimensions={0,1}, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/im_embed/vmap(inner)/pos_embed/add" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=64}
  %add.217.5 = f32[512,256,52]{2,1,0} add(f32[512,256,52]{2,1,0} %convert.1407.5, f32[512,256,52]{2,1,0} %broadcast.654.5), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/im_embed/vmap(inner)/pos_embed/add" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=64}
  ROOT %add.224.1 = f32[512,256,52]{2,1,0} add(f32[512,256,52]{2,1,0} %convert.1440.1, f32[512,256,52]{2,1,0} %add.217.5), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/add" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=168}
}

%fused_reduce.27 (param_0.1318: bf16[512,256,52], param_1.1417: bf16[512,256]) -> (f32[512,52], f32[512,52]) {
  %param_0.1318 = bf16[512,256,52]{2,1,0} parameter(0)
  %convert.1407.11 = f32[512,256,52]{2,1,0} convert(bf16[512,256,52]{2,1,0} %param_0.1318)
  %param_1.1417 = bf16[512,256]{1,0} parameter(1)
  %convert.1617.1 = f32[512,256]{1,0} convert(bf16[512,256]{1,0} %param_1.1417)
  %broadcast.654.11 = f32[512,256,52]{2,1,0} broadcast(f32[512,256]{1,0} %convert.1617.1), dimensions={0,1}, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/im_embed/vmap(inner)/pos_embed/add" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=64}
  %add.217.11 = f32[512,256,52]{2,1,0} add(f32[512,256,52]{2,1,0} %convert.1407.11, f32[512,256,52]{2,1,0} %broadcast.654.11), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/im_embed/vmap(inner)/pos_embed/add" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=64}
  %constant_68_9 = f32[] constant(0)
  %reduce.18.1 = f32[512,52]{1,0} reduce(f32[512,256,52]{2,1,0} %add.217.11, f32[] %constant_68_9), dimensions={1}, to_apply=%region_2.202
  %multiply.316.1.clone.1 = f32[512,256,52]{2,1,0} multiply(f32[512,256,52]{2,1,0} %add.217.11, f32[512,256,52]{2,1,0} %add.217.11), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/LayerNorm_0/integer_pow[y=2]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
  %reduce.19.1.clone.1 = f32[512,52]{1,0} reduce(f32[512,256,52]{2,1,0} %multiply.316.1.clone.1, f32[] %constant_68_9), dimensions={1}, to_apply=%region_2.202
  ROOT %tuple.65 = (f32[512,52]{1,0}, f32[512,52]{1,0}) tuple(f32[512,52]{1,0} %reduce.18.1, f32[512,52]{1,0} %reduce.19.1.clone.1)
}

%fused_transpose.20 (param_0.684: f32[256], param_1.640: f32[256], param_2.306: f32[1,512,52], param_3.166: f32[512,52], param_4.55: bf16[512,256], param_5.26: bf16[512,256,52]) -> bf16[52,512,256] {
  %param_5.26 = bf16[512,256,52]{2,1,0} parameter(5)
  %convert.1407.17 = f32[512,256,52]{2,1,0} convert(bf16[512,256,52]{2,1,0} %param_5.26)
  %param_4.55 = bf16[512,256]{1,0} parameter(4)
  %convert.1617.8 = f32[512,256]{1,0} convert(bf16[512,256]{1,0} %param_4.55)
  %broadcast.654.17 = f32[512,256,52]{2,1,0} broadcast(f32[512,256]{1,0} %convert.1617.8), dimensions={0,1}, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/im_embed/vmap(inner)/pos_embed/add" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=64}
  %add.217.17 = f32[512,256,52]{2,1,0} add(f32[512,256,52]{2,1,0} %convert.1407.17, f32[512,256,52]{2,1,0} %broadcast.654.17), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/im_embed/vmap(inner)/pos_embed/add" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=64}
  %param_3.166 = f32[512,52]{1,0} parameter(3)
  %broadcast.556.7 = f32[512,256,52]{2,1,0} broadcast(f32[512,52]{1,0} %param_3.166), dimensions={0,2}, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/LayerNorm_0/sub" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
  %subtract.28.7 = f32[512,256,52]{2,1,0} subtract(f32[512,256,52]{2,1,0} %add.217.17, f32[512,256,52]{2,1,0} %broadcast.556.7), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/LayerNorm_0/sub" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
  %param_2.306 = f32[1,512,52]{2,1,0} parameter(2)
  %bitcast.4750.21 = f32[512,52]{1,0} bitcast(f32[1,512,52]{2,1,0} %param_2.306)
  %broadcast.559.21 = f32[512,256,52]{2,1,0} broadcast(f32[512,52]{1,0} %bitcast.4750.21), dimensions={0,2}, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/LayerNorm_0/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
  %param_1.640 = f32[256]{0} parameter(1)
  %broadcast.560.18 = f32[512,256,52]{2,1,0} broadcast(f32[256]{0} %param_1.640), dimensions={1}, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/LayerNorm_0/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
  %multiply.319.15 = f32[512,256,52]{2,1,0} multiply(f32[512,256,52]{2,1,0} %broadcast.559.21, f32[512,256,52]{2,1,0} %broadcast.560.18), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/LayerNorm_0/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
  %multiply.320.7 = f32[512,256,52]{2,1,0} multiply(f32[512,256,52]{2,1,0} %subtract.28.7, f32[512,256,52]{2,1,0} %multiply.319.15), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/LayerNorm_0/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
  %param_0.684 = f32[256]{0} parameter(0)
  %broadcast.561.3 = f32[512,256,52]{2,1,0} broadcast(f32[256]{0} %param_0.684), dimensions={1}, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/LayerNorm_0/add" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
  %add.219.5 = f32[512,256,52]{2,1,0} add(f32[512,256,52]{2,1,0} %multiply.320.7, f32[512,256,52]{2,1,0} %broadcast.561.3), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/LayerNorm_0/add" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
  %convert.1409.3 = bf16[512,256,52]{2,1,0} convert(f32[512,256,52]{2,1,0} %add.219.5), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/LayerNorm_0/convert_element_type[new_dtype=bfloat16 weak_type=False]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
  ROOT %transpose.1183.1 = bf16[52,512,256]{2,1,0} transpose(bf16[512,256,52]{2,1,0} %convert.1409.3), dimensions={2,0,1}, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/LayerNorm_0/convert_element_type[new_dtype=bfloat16 weak_type=False]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
}

%fused_transpose.21 (param_0.689: f32[256], param_1.645: f32[256], param_2.311: f32[1,512,52], param_3.172: f32[512,256,52], param_4.58: f32[512,52]) -> bf16[52,512,256] {
  %param_3.172 = f32[512,256,52]{2,1,0} parameter(3)
  %param_4.58 = f32[512,52]{1,0} parameter(4)
  %broadcast.573.7 = f32[512,256,52]{2,1,0} broadcast(f32[512,52]{1,0} %param_4.58), dimensions={0,2}, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/LayerNorm_1/sub" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
  %subtract.31.7 = f32[512,256,52]{2,1,0} subtract(f32[512,256,52]{2,1,0} %param_3.172, f32[512,256,52]{2,1,0} %broadcast.573.7), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/LayerNorm_1/sub" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
  %param_2.311 = f32[1,512,52]{2,1,0} parameter(2)
  %bitcast.4945.21 = f32[512,52]{1,0} bitcast(f32[1,512,52]{2,1,0} %param_2.311)
  %broadcast.574.21 = f32[512,256,52]{2,1,0} broadcast(f32[512,52]{1,0} %bitcast.4945.21), dimensions={0,2}, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/LayerNorm_1/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
  %param_1.645 = f32[256]{0} parameter(1)
  %broadcast.575.18 = f32[512,256,52]{2,1,0} broadcast(f32[256]{0} %param_1.645), dimensions={1}, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/LayerNorm_1/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
  %multiply.326.15 = f32[512,256,52]{2,1,0} multiply(f32[512,256,52]{2,1,0} %broadcast.574.21, f32[512,256,52]{2,1,0} %broadcast.575.18), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/LayerNorm_1/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
  %multiply.327.7 = f32[512,256,52]{2,1,0} multiply(f32[512,256,52]{2,1,0} %subtract.31.7, f32[512,256,52]{2,1,0} %multiply.326.15), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/LayerNorm_1/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
  %param_0.689 = f32[256]{0} parameter(0)
  %broadcast.576.3 = f32[512,256,52]{2,1,0} broadcast(f32[256]{0} %param_0.689), dimensions={1}, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/LayerNorm_1/add" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
  %add.226.5 = f32[512,256,52]{2,1,0} add(f32[512,256,52]{2,1,0} %multiply.327.7, f32[512,256,52]{2,1,0} %broadcast.576.3), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/LayerNorm_1/add" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
  %convert.1441.3 = bf16[512,256,52]{2,1,0} convert(f32[512,256,52]{2,1,0} %add.226.5), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/LayerNorm_1/convert_element_type[new_dtype=bfloat16 weak_type=False]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
  ROOT %transpose.1190.1 = bf16[52,512,256]{2,1,0} transpose(bf16[512,256,52]{2,1,0} %convert.1441.3), dimensions={2,0,1}, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/LayerNorm_1/convert_element_type[new_dtype=bfloat16 weak_type=False]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
}

%fused_transpose.22 (param_0.694: f32[256], param_1.650: f32[256], param_2.316: f32[1,512,52], param_3.178: f32[512,256,52], param_4.61: f32[512,52]) -> bf16[52,512,256] {
  %param_3.178 = f32[512,256,52]{2,1,0} parameter(3)
  %param_4.61 = f32[512,52]{1,0} parameter(4)
  %broadcast.578.7 = f32[512,256,52]{2,1,0} broadcast(f32[512,52]{1,0} %param_4.61), dimensions={0,2}, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/LayerNorm_0/sub" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
  %subtract.33.7 = f32[512,256,52]{2,1,0} subtract(f32[512,256,52]{2,1,0} %param_3.178, f32[512,256,52]{2,1,0} %broadcast.578.7), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/LayerNorm_0/sub" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
  %param_2.316 = f32[1,512,52]{2,1,0} parameter(2)
  %bitcast.5029.21 = f32[512,52]{1,0} bitcast(f32[1,512,52]{2,1,0} %param_2.316)
  %broadcast.579.21 = f32[512,256,52]{2,1,0} broadcast(f32[512,52]{1,0} %bitcast.5029.21), dimensions={0,2}, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/LayerNorm_0/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
  %param_1.650 = f32[256]{0} parameter(1)
  %broadcast.580.18 = f32[512,256,52]{2,1,0} broadcast(f32[256]{0} %param_1.650), dimensions={1}, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/LayerNorm_0/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
  %multiply.333.15 = f32[512,256,52]{2,1,0} multiply(f32[512,256,52]{2,1,0} %broadcast.579.21, f32[512,256,52]{2,1,0} %broadcast.580.18), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/LayerNorm_0/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
  %multiply.334.7 = f32[512,256,52]{2,1,0} multiply(f32[512,256,52]{2,1,0} %subtract.33.7, f32[512,256,52]{2,1,0} %multiply.333.15), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/LayerNorm_0/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
  %param_0.694 = f32[256]{0} parameter(0)
  %broadcast.581.3 = f32[512,256,52]{2,1,0} broadcast(f32[256]{0} %param_0.694), dimensions={1}, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/LayerNorm_0/add" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
  %add.230.5 = f32[512,256,52]{2,1,0} add(f32[512,256,52]{2,1,0} %multiply.334.7, f32[512,256,52]{2,1,0} %broadcast.581.3), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/LayerNorm_0/add" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
  %convert.1448.3 = bf16[512,256,52]{2,1,0} convert(f32[512,256,52]{2,1,0} %add.230.5), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/LayerNorm_0/convert_element_type[new_dtype=bfloat16 weak_type=False]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
  ROOT %transpose.1193.1 = bf16[52,512,256]{2,1,0} transpose(bf16[512,256,52]{2,1,0} %convert.1448.3), dimensions={2,0,1}, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/LayerNorm_0/convert_element_type[new_dtype=bfloat16 weak_type=False]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
}

%fused_transpose.23 (param_0.699: f32[256], param_1.655: f32[256], param_2.321: f32[1,512,52], param_3.184: f32[512,256,52], param_4.64: f32[512,52]) -> bf16[52,512,256] {
  %param_3.184 = f32[512,256,52]{2,1,0} parameter(3)
  %param_4.64 = f32[512,52]{1,0} parameter(4)
  %broadcast.588.7 = f32[512,256,52]{2,1,0} broadcast(f32[512,52]{1,0} %param_4.64), dimensions={0,2}, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/LayerNorm_1/sub" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
  %subtract.36.7 = f32[512,256,52]{2,1,0} subtract(f32[512,256,52]{2,1,0} %param_3.184, f32[512,256,52]{2,1,0} %broadcast.588.7), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/LayerNorm_1/sub" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
  %param_2.321 = f32[1,512,52]{2,1,0} parameter(2)
  %bitcast.5225.21 = f32[512,52]{1,0} bitcast(f32[1,512,52]{2,1,0} %param_2.321)
  %broadcast.589.21 = f32[512,256,52]{2,1,0} broadcast(f32[512,52]{1,0} %bitcast.5225.21), dimensions={0,2}, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/LayerNorm_1/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
  %param_1.655 = f32[256]{0} parameter(1)
  %broadcast.590.18 = f32[512,256,52]{2,1,0} broadcast(f32[256]{0} %param_1.655), dimensions={1}, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/LayerNorm_1/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
  %multiply.342.15 = f32[512,256,52]{2,1,0} multiply(f32[512,256,52]{2,1,0} %broadcast.589.21, f32[512,256,52]{2,1,0} %broadcast.590.18), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/LayerNorm_1/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
  %multiply.343.7 = f32[512,256,52]{2,1,0} multiply(f32[512,256,52]{2,1,0} %subtract.36.7, f32[512,256,52]{2,1,0} %multiply.342.15), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/LayerNorm_1/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
  %param_0.699 = f32[256]{0} parameter(0)
  %broadcast.591.3 = f32[512,256,52]{2,1,0} broadcast(f32[256]{0} %param_0.699), dimensions={1}, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/LayerNorm_1/add" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
  %add.238.5 = f32[512,256,52]{2,1,0} add(f32[512,256,52]{2,1,0} %multiply.343.7, f32[512,256,52]{2,1,0} %broadcast.591.3), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/LayerNorm_1/add" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
  %convert.1479.3 = bf16[512,256,52]{2,1,0} convert(f32[512,256,52]{2,1,0} %add.238.5), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/LayerNorm_1/convert_element_type[new_dtype=bfloat16 weak_type=False]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
  ROOT %transpose.1200.1 = bf16[52,512,256]{2,1,0} transpose(bf16[512,256,52]{2,1,0} %convert.1479.3), dimensions={2,0,1}, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/LayerNorm_1/convert_element_type[new_dtype=bfloat16 weak_type=False]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
}

%region_18.769.clone.9 (Arg_0.12.0: f32[], Arg_1.12.0: f32[]) -> f32[] {
  %Arg_1.12.0 = f32[] parameter(1)
  %Arg_0.12.0 = f32[] parameter(0)
  ROOT %add.189.0 = f32[] add(f32[] %Arg_0.12.0, f32[] %Arg_1.12.0), metadata={op_name="jit(loss)/jit(main)/reduce_sum[axes=(1,)]" source_file="/home/nicholas/programs/avid/avid/config.py" source_line=371}
}

%fused_reduce_transpose.2 (param_0.795: bf16[208,512,64]) -> (bf16[52,512,4,64], f32[52,4,64], bf16[4,64,52,512]) {
  %param_0.795 = bf16[208,512,64]{2,1,0} parameter(0)
  %bitcast.6174.11 = bf16[52,4,512,64]{3,2,1,0} bitcast(bf16[208,512,64]{2,1,0} %param_0.795)
  %convert.1544.11 = f32[52,4,512,64]{3,2,1,0} convert(bf16[52,4,512,64]{3,2,1,0} %bitcast.6174.11)
  %constant_37_3 = bf16[] constant(0.125)
  %convert.1620.1 = f32[] convert(bf16[] %constant_37_3)
  %broadcast.658.20 = f32[52,4,512,64]{3,2,1,0} broadcast(f32[] %convert.1620.1), dimensions={}
  %multiply.422.9 = f32[52,4,512,64]{3,2,1,0} multiply(f32[52,4,512,64]{3,2,1,0} %convert.1544.11, f32[52,4,512,64]{3,2,1,0} %broadcast.658.20), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/MultiHeadDotProductAttention_0/div" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %convert.1546.5 = bf16[52,4,512,64]{3,2,1,0} convert(f32[52,4,512,64]{3,2,1,0} %multiply.422.9)
  %transpose.1221.1 = bf16[52,512,4,64]{3,2,1,0} transpose(bf16[52,4,512,64]{3,2,1,0} %convert.1546.5), dimensions={0,2,1,3}, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/MultiHeadDotProductAttention_0/div" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %constant_55_14_clone_1 = bf16[] constant(0)
  %convert.1640.11.clone.1 = f32[] convert(bf16[] %constant_55_14_clone_1)
  %reduce.58.1.clone.1 = f32[52,4,64]{2,1,0} reduce(f32[52,4,512,64]{3,2,1,0} %multiply.422.9, f32[] %convert.1640.11.clone.1), dimensions={2}, to_apply=%region_18.769.clone.9, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/MultiHeadDotProductAttention_0/query/reduce_sum[axes=(0, 1)]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %transpose.1226.1.clone.1 = bf16[4,64,52,512]{3,2,1,0} transpose(bf16[52,4,512,64]{3,2,1,0} %convert.1546.5), dimensions={1,3,0,2}, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/MultiHeadDotProductAttention_0/div" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  ROOT %tuple.27 = (bf16[52,512,4,64]{3,2,1,0}, f32[52,4,64]{2,1,0}, bf16[4,64,52,512]{3,2,1,0}) tuple(bf16[52,512,4,64]{3,2,1,0} %transpose.1221.1, f32[52,4,64]{2,1,0} %reduce.58.1.clone.1, bf16[4,64,52,512]{3,2,1,0} %transpose.1226.1.clone.1)
}

%region_18.769.clone.19 (Arg_0.22.0: f32[], Arg_1.22.0: f32[]) -> f32[] {
  %Arg_1.22.0 = f32[] parameter(1)
  %Arg_0.22.0 = f32[] parameter(0)
  ROOT %add.193.0 = f32[] add(f32[] %Arg_0.22.0, f32[] %Arg_1.22.0), metadata={op_name="jit(loss)/jit(main)/reduce_sum[axes=(1,)]" source_file="/home/nicholas/programs/avid/avid/config.py" source_line=371}
}

%fused_reduce_transpose.3 (param_0.798: bf16[208,512,64]) -> (bf16[52,512,4,64], f32[52,4,64], bf16[4,64,52,512]) {
  %param_0.798 = bf16[208,512,64]{2,1,0} parameter(0)
  %bitcast.5826.11 = bf16[52,4,512,64]{3,2,1,0} bitcast(bf16[208,512,64]{2,1,0} %param_0.798)
  %convert.1526.11 = f32[52,4,512,64]{3,2,1,0} convert(bf16[52,4,512,64]{3,2,1,0} %bitcast.5826.11)
  %constant_37_6 = bf16[] constant(0.125)
  %convert.1620.4 = f32[] convert(bf16[] %constant_37_6)
  %broadcast.658.24 = f32[52,4,512,64]{3,2,1,0} broadcast(f32[] %convert.1620.4), dimensions={}
  %multiply.393.9 = f32[52,4,512,64]{3,2,1,0} multiply(f32[52,4,512,64]{3,2,1,0} %convert.1526.11, f32[52,4,512,64]{3,2,1,0} %broadcast.658.24), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/MultiHeadDotProductAttention_0/div" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %convert.1528.5 = bf16[52,4,512,64]{3,2,1,0} convert(f32[52,4,512,64]{3,2,1,0} %multiply.393.9)
  %transpose.1211.1 = bf16[52,512,4,64]{3,2,1,0} transpose(bf16[52,4,512,64]{3,2,1,0} %convert.1528.5), dimensions={0,2,1,3}, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/MultiHeadDotProductAttention_0/div" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %constant_55_24_clone_1 = bf16[] constant(0)
  %convert.1640.21.clone.1 = f32[] convert(bf16[] %constant_55_24_clone_1)
  %reduce.62.1.clone.1 = f32[52,4,64]{2,1,0} reduce(f32[52,4,512,64]{3,2,1,0} %multiply.393.9, f32[] %convert.1640.21.clone.1), dimensions={2}, to_apply=%region_18.769.clone.19, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/MultiHeadDotProductAttention_0/query/reduce_sum[axes=(0, 1)]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %transpose.1231.1.clone.1 = bf16[4,64,52,512]{3,2,1,0} transpose(bf16[52,4,512,64]{3,2,1,0} %convert.1528.5), dimensions={1,3,0,2}, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/MultiHeadDotProductAttention_0/div" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  ROOT %tuple.40 = (bf16[52,512,4,64]{3,2,1,0}, f32[52,4,64]{2,1,0}, bf16[4,64,52,512]{3,2,1,0}) tuple(bf16[52,512,4,64]{3,2,1,0} %transpose.1211.1, f32[52,4,64]{2,1,0} %reduce.62.1.clone.1, bf16[4,64,52,512]{3,2,1,0} %transpose.1231.1.clone.1)
}

%fused_transpose.24 (param_0.766: f32[512,256,52]) -> bf16[256,52,512] {
  %param_0.766 = f32[512,256,52]{2,1,0} parameter(0)
  %convert.1594.1 = bf16[512,256,52]{2,1,0} convert(f32[512,256,52]{2,1,0} %param_0.766)
  ROOT %transpose.1235.1 = bf16[256,52,512]{2,1,0} transpose(bf16[512,256,52]{2,1,0} %convert.1594.1), dimensions={1,2,0}, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/LayerNorm_0/add_any" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
}

%fused_add_transpose (param_0.1375: f32[512,52], param_1.1478: f32[512,52], param_2.899: bf16[512,256], param_3.580: bf16[512,256,52], param_4.358: f32[512,256,52], param_5.284: f32[512,256,52], param_6.253: f32[256], param_7.221: f32[1,512,52]) -> (bf16[52,512,256], f32[512,256,52]) {
  %param_4.358 = f32[512,256,52]{2,1,0} parameter(4)
  %param_5.284 = f32[512,256,52]{2,1,0} parameter(5)
  %param_7.221 = f32[1,512,52]{2,1,0} parameter(7)
  %bitcast.4750.19.clone.1 = f32[512,52]{1,0} bitcast(f32[1,512,52]{2,1,0} %param_7.221)
  %broadcast.559.19.clone.1 = f32[512,256,52]{2,1,0} broadcast(f32[512,52]{1,0} %bitcast.4750.19.clone.1), dimensions={0,2}, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/LayerNorm_0/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
  %param_6.253 = f32[256]{0} parameter(6)
  %broadcast.560.16.clone.1 = f32[512,256,52]{2,1,0} broadcast(f32[256]{0} %param_6.253), dimensions={1}, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/LayerNorm_0/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
  %multiply.319.13.clone.1 = f32[512,256,52]{2,1,0} multiply(f32[512,256,52]{2,1,0} %broadcast.559.19.clone.1, f32[512,256,52]{2,1,0} %broadcast.560.16.clone.1), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/LayerNorm_0/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
  %multiply.429.5.clone.1 = f32[512,256,52]{2,1,0} multiply(f32[512,256,52]{2,1,0} %param_5.284, f32[512,256,52]{2,1,0} %multiply.319.13.clone.1), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/LayerNorm_0/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
  %add.271.1.clone.1 = f32[512,256,52]{2,1,0} add(f32[512,256,52]{2,1,0} %param_4.358, f32[512,256,52]{2,1,0} %multiply.429.5.clone.1), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/LayerNorm_0/add_any" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
  %param_3.580 = bf16[512,256,52]{2,1,0} parameter(3)
  %convert.1407.7.clone.1 = f32[512,256,52]{2,1,0} convert(bf16[512,256,52]{2,1,0} %param_3.580)
  %param_2.899 = bf16[512,256]{1,0} parameter(2)
  %convert.1617.4.clone.1 = f32[512,256]{1,0} convert(bf16[512,256]{1,0} %param_2.899)
  %broadcast.654.7.clone.1 = f32[512,256,52]{2,1,0} broadcast(f32[512,256]{1,0} %convert.1617.4.clone.1), dimensions={0,1}, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/im_embed/vmap(inner)/pos_embed/add" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=64}
  %add.217.7.clone.1 = f32[512,256,52]{2,1,0} add(f32[512,256,52]{2,1,0} %convert.1407.7.clone.1, f32[512,256,52]{2,1,0} %broadcast.654.7.clone.1), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/im_embed/vmap(inner)/pos_embed/add" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=64}
  %param_1.1478 = f32[512,52]{1,0} parameter(1)
  %broadcast.643.1.clone.1 = f32[512,256,52]{2,1,0} broadcast(f32[512,52]{1,0} %param_1.1478), dimensions={0,2}, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/LayerNorm_0/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
  %multiply.435.1.clone.1 = f32[512,256,52]{2,1,0} multiply(f32[512,256,52]{2,1,0} %add.217.7.clone.1, f32[512,256,52]{2,1,0} %broadcast.643.1.clone.1), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/LayerNorm_0/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
  %param_0.1375 = f32[512,52]{1,0} parameter(0)
  %broadcast.645.1.clone.1 = f32[512,256,52]{2,1,0} broadcast(f32[512,52]{1,0} %param_0.1375), dimensions={0,2}, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/LayerNorm_0/broadcast_in_dim[shape=(52, 512, 256) broadcast_dimensions=(0, 1)]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
  %add.273.1.clone.1 = f32[512,256,52]{2,1,0} add(f32[512,256,52]{2,1,0} %multiply.435.1.clone.1, f32[512,256,52]{2,1,0} %broadcast.645.1.clone.1), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/LayerNorm_0/add_any" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
  %add.274.1.clone.1 = f32[512,256,52]{2,1,0} add(f32[512,256,52]{2,1,0} %add.271.1.clone.1, f32[512,256,52]{2,1,0} %add.273.1.clone.1), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/LayerNorm_0/add_any" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
  %convert.1594.2 = bf16[512,256,52]{2,1,0} convert(f32[512,256,52]{2,1,0} %add.274.1.clone.1)
  %transpose.1236.1 = bf16[52,512,256]{2,1,0} transpose(bf16[512,256,52]{2,1,0} %convert.1594.2), dimensions={2,0,1}, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/LayerNorm_0/add_any" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
  ROOT %tuple.20 = (bf16[52,512,256]{2,1,0}, f32[512,256,52]{2,1,0}) tuple(bf16[52,512,256]{2,1,0} %transpose.1236.1, f32[512,256,52]{2,1,0} %add.274.1.clone.1)
}

%fused_transpose.25 (param_0.770: f32[512,256,52]) -> bf16[256,52,512] {
  %param_0.770 = f32[512,256,52]{2,1,0} parameter(0)
  %convert.1532.1 = bf16[512,256,52]{2,1,0} convert(f32[512,256,52]{2,1,0} %param_0.770)
  ROOT %transpose.1225.1 = bf16[256,52,512]{2,1,0} transpose(bf16[512,256,52]{2,1,0} %convert.1532.1), dimensions={1,2,0}, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=167}
}

%fused_add_transpose.1 (param_0.1380: f32[512,52], param_1.1498: f32[512,256,52], param_2.913: f32[512,52], param_3.588: f32[512,256,52], param_4.369: f32[512,256,52], param_5.295: f32[256], param_6.261: f32[1,512,52]) -> (bf16[52,512,256], f32[512,256,52]) {
  %param_3.588 = f32[512,256,52]{2,1,0} parameter(3)
  %param_4.369 = f32[512,256,52]{2,1,0} parameter(4)
  %param_6.261 = f32[1,512,52]{2,1,0} parameter(6)
  %bitcast.4945.19.clone.1 = f32[512,52]{1,0} bitcast(f32[1,512,52]{2,1,0} %param_6.261)
  %broadcast.574.19.clone.1 = f32[512,256,52]{2,1,0} broadcast(f32[512,52]{1,0} %bitcast.4945.19.clone.1), dimensions={0,2}, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/LayerNorm_1/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
  %param_5.295 = f32[256]{0} parameter(5)
  %broadcast.575.16.clone.1 = f32[512,256,52]{2,1,0} broadcast(f32[256]{0} %param_5.295), dimensions={1}, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/LayerNorm_1/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
  %multiply.326.13.clone.1 = f32[512,256,52]{2,1,0} multiply(f32[512,256,52]{2,1,0} %broadcast.574.19.clone.1, f32[512,256,52]{2,1,0} %broadcast.575.16.clone.1), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/LayerNorm_1/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
  %multiply.406.5.clone.1 = f32[512,256,52]{2,1,0} multiply(f32[512,256,52]{2,1,0} %param_4.369, f32[512,256,52]{2,1,0} %multiply.326.13.clone.1), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/LayerNorm_1/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
  %add.264.1.clone.1 = f32[512,256,52]{2,1,0} add(f32[512,256,52]{2,1,0} %param_3.588, f32[512,256,52]{2,1,0} %multiply.406.5.clone.1), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/LayerNorm_1/add_any" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
  %param_1.1498 = f32[512,256,52]{2,1,0} parameter(1)
  %param_2.913 = f32[512,52]{1,0} parameter(2)
  %broadcast.639.1.clone.1 = f32[512,256,52]{2,1,0} broadcast(f32[512,52]{1,0} %param_2.913), dimensions={0,2}, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/LayerNorm_1/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
  %multiply.414.1.clone.1 = f32[512,256,52]{2,1,0} multiply(f32[512,256,52]{2,1,0} %param_1.1498, f32[512,256,52]{2,1,0} %broadcast.639.1.clone.1), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/LayerNorm_1/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
  %param_0.1380 = f32[512,52]{1,0} parameter(0)
  %broadcast.640.1.clone.1 = f32[512,256,52]{2,1,0} broadcast(f32[512,52]{1,0} %param_0.1380), dimensions={0,2}, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/LayerNorm_1/broadcast_in_dim[shape=(52, 512, 256) broadcast_dimensions=(0, 1)]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
  %add.266.1.clone.1 = f32[512,256,52]{2,1,0} add(f32[512,256,52]{2,1,0} %multiply.414.1.clone.1, f32[512,256,52]{2,1,0} %broadcast.640.1.clone.1), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/LayerNorm_1/add_any" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
  %add.267.1.clone.1 = f32[512,256,52]{2,1,0} add(f32[512,256,52]{2,1,0} %add.264.1.clone.1, f32[512,256,52]{2,1,0} %add.266.1.clone.1), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/LayerNorm_1/add_any" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
  %convert.1532.2 = bf16[512,256,52]{2,1,0} convert(f32[512,256,52]{2,1,0} %add.267.1.clone.1)
  %transpose.1215.1 = bf16[52,512,256]{2,1,0} transpose(bf16[512,256,52]{2,1,0} %convert.1532.2), dimensions={2,0,1}, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/LayerNorm_1/add_any" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
  ROOT %tuple.30 = (bf16[52,512,256]{2,1,0}, f32[512,256,52]{2,1,0}) tuple(bf16[52,512,256]{2,1,0} %transpose.1215.1, f32[512,256,52]{2,1,0} %add.267.1.clone.1)
}

%fused_transpose.26 (param_0.774: f32[512,256,52]) -> bf16[256,52,512] {
  %param_0.774 = f32[512,256,52]{2,1,0} parameter(0)
  %convert.1530.1 = bf16[512,256,52]{2,1,0} convert(f32[512,256,52]{2,1,0} %param_0.774)
  ROOT %transpose.1223.1 = bf16[256,52,512]{2,1,0} transpose(bf16[512,256,52]{2,1,0} %convert.1530.1), dimensions={1,2,0}, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=183}
}

%fused_add_transpose.2 (param_0.1382: f32[512,52], param_1.1502: f32[512,256,52], param_2.917: f32[512,52], param_3.591: f32[512,256,52], param_4.380: f32[512,256,52], param_5.304: f32[256], param_6.269: f32[1,512,52]) -> (bf16[52,512,256], f32[512,256,52]) {
  %param_3.591 = f32[512,256,52]{2,1,0} parameter(3)
  %param_4.380 = f32[512,256,52]{2,1,0} parameter(4)
  %param_6.269 = f32[1,512,52]{2,1,0} parameter(6)
  %bitcast.5029.19.clone.1 = f32[512,52]{1,0} bitcast(f32[1,512,52]{2,1,0} %param_6.269)
  %broadcast.579.19.clone.1 = f32[512,256,52]{2,1,0} broadcast(f32[512,52]{1,0} %bitcast.5029.19.clone.1), dimensions={0,2}, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/LayerNorm_0/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
  %param_5.304 = f32[256]{0} parameter(5)
  %broadcast.580.16.clone.1 = f32[512,256,52]{2,1,0} broadcast(f32[256]{0} %param_5.304), dimensions={1}, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/LayerNorm_0/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
  %multiply.333.13.clone.1 = f32[512,256,52]{2,1,0} multiply(f32[512,256,52]{2,1,0} %broadcast.579.19.clone.1, f32[512,256,52]{2,1,0} %broadcast.580.16.clone.1), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/LayerNorm_0/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
  %multiply.395.5.clone.1 = f32[512,256,52]{2,1,0} multiply(f32[512,256,52]{2,1,0} %param_4.380, f32[512,256,52]{2,1,0} %multiply.333.13.clone.1), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/LayerNorm_0/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
  %add.259.1.clone.1 = f32[512,256,52]{2,1,0} add(f32[512,256,52]{2,1,0} %param_3.591, f32[512,256,52]{2,1,0} %multiply.395.5.clone.1), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/LayerNorm_0/add_any" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
  %param_1.1502 = f32[512,256,52]{2,1,0} parameter(1)
  %param_2.917 = f32[512,52]{1,0} parameter(2)
  %broadcast.635.1.clone.1 = f32[512,256,52]{2,1,0} broadcast(f32[512,52]{1,0} %param_2.917), dimensions={0,2}, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/LayerNorm_0/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
  %multiply.402.1.clone.1 = f32[512,256,52]{2,1,0} multiply(f32[512,256,52]{2,1,0} %param_1.1502, f32[512,256,52]{2,1,0} %broadcast.635.1.clone.1), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/LayerNorm_0/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
  %param_0.1382 = f32[512,52]{1,0} parameter(0)
  %broadcast.637.1.clone.1 = f32[512,256,52]{2,1,0} broadcast(f32[512,52]{1,0} %param_0.1382), dimensions={0,2}, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/LayerNorm_0/broadcast_in_dim[shape=(52, 512, 256) broadcast_dimensions=(0, 1)]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
  %add.262.1.clone.1 = f32[512,256,52]{2,1,0} add(f32[512,256,52]{2,1,0} %multiply.402.1.clone.1, f32[512,256,52]{2,1,0} %broadcast.637.1.clone.1), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/LayerNorm_0/add_any" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
  %add.263.1.clone.1 = f32[512,256,52]{2,1,0} add(f32[512,256,52]{2,1,0} %add.259.1.clone.1, f32[512,256,52]{2,1,0} %add.262.1.clone.1), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/LayerNorm_0/add_any" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
  %convert.1530.2 = bf16[512,256,52]{2,1,0} convert(f32[512,256,52]{2,1,0} %add.263.1.clone.1)
  %transpose.1213.1 = bf16[52,512,256]{2,1,0} transpose(bf16[512,256,52]{2,1,0} %convert.1530.2), dimensions={2,0,1}, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/LayerNorm_0/add_any" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
  ROOT %tuple.33 = (bf16[52,512,256]{2,1,0}, f32[512,256,52]{2,1,0}) tuple(bf16[52,512,256]{2,1,0} %transpose.1213.1, f32[512,256,52]{2,1,0} %add.263.1.clone.1)
}

%fused_transpose.27 (param_0.778: f32[512,256,52]) -> bf16[256,52,512] {
  %param_0.778 = f32[512,256,52]{2,1,0} parameter(0)
  %convert.1514.1 = bf16[512,256,52]{2,1,0} convert(f32[512,256,52]{2,1,0} %param_0.778)
  ROOT %transpose.1230.1 = bf16[256,52,512]{2,1,0} transpose(bf16[512,256,52]{2,1,0} %convert.1514.1), dimensions={1,2,0}, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=167}
}

%fused_add_transpose.3 (param_0.1387: f32[512,52], param_1.1522: f32[512,256,52], param_2.931: f32[512,52], param_3.594: f32[512,256,52], param_4.391: f32[512,256,52], param_5.313: f32[256], param_6.277: f32[1,512,52]) -> (bf16[52,512,256], f32[512,256,52]) {
  %param_3.594 = f32[512,256,52]{2,1,0} parameter(3)
  %param_4.391 = f32[512,256,52]{2,1,0} parameter(4)
  %param_6.277 = f32[1,512,52]{2,1,0} parameter(6)
  %bitcast.5225.19.clone.1 = f32[512,52]{1,0} bitcast(f32[1,512,52]{2,1,0} %param_6.277)
  %broadcast.589.19.clone.1 = f32[512,256,52]{2,1,0} broadcast(f32[512,52]{1,0} %bitcast.5225.19.clone.1), dimensions={0,2}, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/LayerNorm_1/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
  %param_5.313 = f32[256]{0} parameter(5)
  %broadcast.590.16.clone.1 = f32[512,256,52]{2,1,0} broadcast(f32[256]{0} %param_5.313), dimensions={1}, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/LayerNorm_1/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
  %multiply.342.13.clone.1 = f32[512,256,52]{2,1,0} multiply(f32[512,256,52]{2,1,0} %broadcast.589.19.clone.1, f32[512,256,52]{2,1,0} %broadcast.590.16.clone.1), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/LayerNorm_1/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
  %multiply.376.5.clone.1 = f32[512,256,52]{2,1,0} multiply(f32[512,256,52]{2,1,0} %param_4.391, f32[512,256,52]{2,1,0} %multiply.342.13.clone.1), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/LayerNorm_1/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
  %add.253.1.clone.1 = f32[512,256,52]{2,1,0} add(f32[512,256,52]{2,1,0} %param_3.594, f32[512,256,52]{2,1,0} %multiply.376.5.clone.1), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/LayerNorm_1/add_any" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
  %param_1.1522 = f32[512,256,52]{2,1,0} parameter(1)
  %param_2.931 = f32[512,52]{1,0} parameter(2)
  %broadcast.628.1.clone.1 = f32[512,256,52]{2,1,0} broadcast(f32[512,52]{1,0} %param_2.931), dimensions={0,2}, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/LayerNorm_1/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
  %multiply.385.1.clone.1 = f32[512,256,52]{2,1,0} multiply(f32[512,256,52]{2,1,0} %param_1.1522, f32[512,256,52]{2,1,0} %broadcast.628.1.clone.1), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/LayerNorm_1/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
  %param_0.1387 = f32[512,52]{1,0} parameter(0)
  %broadcast.629.1.clone.1 = f32[512,256,52]{2,1,0} broadcast(f32[512,52]{1,0} %param_0.1387), dimensions={0,2}, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/LayerNorm_1/broadcast_in_dim[shape=(52, 512, 256) broadcast_dimensions=(0, 1)]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
  %add.255.1.clone.1 = f32[512,256,52]{2,1,0} add(f32[512,256,52]{2,1,0} %multiply.385.1.clone.1, f32[512,256,52]{2,1,0} %broadcast.629.1.clone.1), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/LayerNorm_1/add_any" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
  %add.256.1.clone.1 = f32[512,256,52]{2,1,0} add(f32[512,256,52]{2,1,0} %add.253.1.clone.1, f32[512,256,52]{2,1,0} %add.255.1.clone.1), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/LayerNorm_1/add_any" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
  %convert.1514.2 = bf16[512,256,52]{2,1,0} convert(f32[512,256,52]{2,1,0} %add.256.1.clone.1)
  %transpose.1205.1 = bf16[52,512,256]{2,1,0} transpose(bf16[512,256,52]{2,1,0} %convert.1514.2), dimensions={2,0,1}, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/LayerNorm_1/add_any" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
  ROOT %tuple.43 = (bf16[52,512,256]{2,1,0}, f32[512,256,52]{2,1,0}) tuple(bf16[52,512,256]{2,1,0} %transpose.1205.1, f32[512,256,52]{2,1,0} %add.256.1.clone.1)
}

%fused_transpose.28 (param_0.782: f32[512,256,52]) -> bf16[256,52,512] {
  %param_0.782 = f32[512,256,52]{2,1,0} parameter(0)
  %convert.1512.1 = bf16[512,256,52]{2,1,0} convert(f32[512,256,52]{2,1,0} %param_0.782)
  ROOT %transpose.1228.1 = bf16[256,52,512]{2,1,0} transpose(bf16[512,256,52]{2,1,0} %convert.1512.1), dimensions={1,2,0}, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=183}
}

%fused_add_transpose.4 (param_0.1389: f32[512,52], param_1.1526: f32[512,256,52], param_2.935: f32[512,52], param_3.598: f32[256], param_4.404: f32[1,512,52], param_5.324: f32[256,52]) -> (bf16[52,512,256], f32[512,256,52]) {
  %param_5.324 = f32[256,52]{1,0} parameter(5)
  %broadcast.615.5.clone.1 = f32[512,256,52]{2,1,0} broadcast(f32[256,52]{1,0} %param_5.324), dimensions={1,2}, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/transpose[permutation=(0, 2, 1)]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=250}
  %param_4.404 = f32[1,512,52]{2,1,0} parameter(4)
  %bitcast.5309.11.clone.1 = f32[512,52]{1,0} bitcast(f32[1,512,52]{2,1,0} %param_4.404)
  %broadcast.594.11.clone.1 = f32[512,256,52]{2,1,0} broadcast(f32[512,52]{1,0} %bitcast.5309.11.clone.1), dimensions={0,2}, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoder_norm/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=228}
  %param_3.598 = f32[256]{0} parameter(3)
  %broadcast.595.8.clone.1 = f32[512,256,52]{2,1,0} broadcast(f32[256]{0} %param_3.598), dimensions={1}, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoder_norm/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=228}
  %multiply.348.7.clone.1 = f32[512,256,52]{2,1,0} multiply(f32[512,256,52]{2,1,0} %broadcast.594.11.clone.1, f32[512,256,52]{2,1,0} %broadcast.595.8.clone.1), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoder_norm/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=228}
  %multiply.365.3.clone.1 = f32[512,256,52]{2,1,0} multiply(f32[512,256,52]{2,1,0} %broadcast.615.5.clone.1, f32[512,256,52]{2,1,0} %multiply.348.7.clone.1), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoder_norm/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=228}
  %param_1.1526 = f32[512,256,52]{2,1,0} parameter(1)
  %param_2.935 = f32[512,52]{1,0} parameter(2)
  %broadcast.624.1.clone.1 = f32[512,256,52]{2,1,0} broadcast(f32[512,52]{1,0} %param_2.935), dimensions={0,2}, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoder_norm/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=228}
  %multiply.371.1.clone.1 = f32[512,256,52]{2,1,0} multiply(f32[512,256,52]{2,1,0} %param_1.1526, f32[512,256,52]{2,1,0} %broadcast.624.1.clone.1), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoder_norm/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=228}
  %param_0.1389 = f32[512,52]{1,0} parameter(0)
  %broadcast.626.1.clone.1 = f32[512,256,52]{2,1,0} broadcast(f32[512,52]{1,0} %param_0.1389), dimensions={0,2}, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoder_norm/broadcast_in_dim[shape=(52, 512, 256) broadcast_dimensions=(0, 1)]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=228}
  %add.251.1.clone.1 = f32[512,256,52]{2,1,0} add(f32[512,256,52]{2,1,0} %multiply.371.1.clone.1, f32[512,256,52]{2,1,0} %broadcast.626.1.clone.1), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoder_norm/add_any" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=228}
  %add.252.1.clone.1 = f32[512,256,52]{2,1,0} add(f32[512,256,52]{2,1,0} %multiply.365.3.clone.1, f32[512,256,52]{2,1,0} %add.251.1.clone.1), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoder_norm/add_any" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=228}
  %convert.1512.2 = bf16[512,256,52]{2,1,0} convert(f32[512,256,52]{2,1,0} %add.252.1.clone.1)
  %transpose.1203.1 = bf16[52,512,256]{2,1,0} transpose(bf16[512,256,52]{2,1,0} %convert.1512.2), dimensions={2,0,1}, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoder_norm/add_any" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=228}
  ROOT %tuple.46 = (bf16[52,512,256]{2,1,0}, f32[512,256,52]{2,1,0}) tuple(bf16[52,512,256]{2,1,0} %transpose.1203.1, f32[512,256,52]{2,1,0} %add.252.1.clone.1)
}

%fused_transpose.29 (param_0.789: f32[4,64], param_1.725: bf16[26624,256]) -> bf16[52,4,512,64] {
  %param_1.725 = bf16[26624,256]{1,0} parameter(1)
  %bitcast.4821.5 = bf16[52,512,4,64]{3,2,1,0} bitcast(bf16[26624,256]{1,0} %param_1.725)
  %transpose.1186.5 = bf16[52,4,64,512]{3,2,1,0} transpose(bf16[52,512,4,64]{3,2,1,0} %bitcast.4821.5), dimensions={0,2,3,1}, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/MultiHeadDotProductAttention_0/key/dot_general[dimension_numbers=(((2,), (0,)), ((), ())) precision=None preferred_element_type=None]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %convert.1423.3 = f32[52,4,64,512]{3,2,1,0} convert(bf16[52,4,64,512]{3,2,1,0} %transpose.1186.5)
  %param_0.789 = f32[4,64]{1,0} parameter(0)
  %broadcast.659.5 = f32[52,4,64,512]{3,2,1,0} broadcast(f32[4,64]{1,0} %param_0.789), dimensions={1,2}, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/MultiHeadDotProductAttention_0/key/add" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %add.222.5 = f32[52,4,64,512]{3,2,1,0} add(f32[52,4,64,512]{3,2,1,0} %convert.1423.3, f32[52,4,64,512]{3,2,1,0} %broadcast.659.5), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/MultiHeadDotProductAttention_0/key/add" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %convert.1426.3 = bf16[52,4,64,512]{3,2,1,0} convert(f32[52,4,64,512]{3,2,1,0} %add.222.5)
  ROOT %transpose.1220.1 = bf16[52,4,512,64]{3,2,1,0} transpose(bf16[52,4,64,512]{3,2,1,0} %convert.1426.3), dimensions={0,1,3,2}, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/MultiHeadDotProductAttention_0/key/add" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
}

%fused_transpose.30 (param_0.794: f32[4,64], param_1.731: bf16[26624,256]) -> bf16[52,4,512,64] {
  %param_1.731 = bf16[26624,256]{1,0} parameter(1)
  %bitcast.5100.5 = bf16[52,512,4,64]{3,2,1,0} bitcast(bf16[26624,256]{1,0} %param_1.731)
  %transpose.1197.5 = bf16[52,4,64,512]{3,2,1,0} transpose(bf16[52,512,4,64]{3,2,1,0} %bitcast.5100.5), dimensions={0,2,3,1}, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/MultiHeadDotProductAttention_0/key/dot_general[dimension_numbers=(((2,), (0,)), ((), ())) precision=None preferred_element_type=None]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %convert.1461.3 = f32[52,4,64,512]{3,2,1,0} convert(bf16[52,4,64,512]{3,2,1,0} %transpose.1197.5)
  %param_0.794 = f32[4,64]{1,0} parameter(0)
  %broadcast.666.5 = f32[52,4,64,512]{3,2,1,0} broadcast(f32[4,64]{1,0} %param_0.794), dimensions={1,2}, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/MultiHeadDotProductAttention_0/key/add" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %add.234.5 = f32[52,4,64,512]{3,2,1,0} add(f32[52,4,64,512]{3,2,1,0} %convert.1461.3, f32[52,4,64,512]{3,2,1,0} %broadcast.666.5), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/MultiHeadDotProductAttention_0/key/add" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %convert.1464.3 = bf16[52,4,64,512]{3,2,1,0} convert(f32[52,4,64,512]{3,2,1,0} %add.234.5)
  ROOT %transpose.1210.1 = bf16[52,4,512,64]{3,2,1,0} transpose(bf16[52,4,64,512]{3,2,1,0} %convert.1464.3), dimensions={0,1,3,2}, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/MultiHeadDotProductAttention_0/key/add" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
}

%fused_multiply (param_0.1369: f32[1,512,52], param_1.1470: f32[512,52], param_2.887: f32[512,52], param_3.568: f32[512,52], param_4.407: f32[512,52], param_5.328: f32[512,52]) -> (f32[512,52], f32[512,52]) {
  %param_3.568 = f32[512,52]{1,0} parameter(3)
  %bitcast.5521.7 = f32[1,512,52]{2,1,0} bitcast(f32[512,52]{1,0} %param_3.568)
  %param_0.1369 = f32[1,512,52]{2,1,0} parameter(0)
  %param_2.887 = f32[512,52]{1,0} parameter(2)
  %constant_35_11 = f32[] constant(0.00390625)
  %broadcast.555.49 = f32[512,52]{1,0} broadcast(f32[] %constant_35_11), dimensions={}
  %multiply.346.11 = f32[512,52]{1,0} multiply(f32[512,52]{1,0} %param_2.887, f32[512,52]{1,0} %broadcast.555.49), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoder_norm/div" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=228}
  %param_1.1470 = f32[512,52]{1,0} parameter(1)
  %multiply.347.9 = f32[512,52]{1,0} multiply(f32[512,52]{1,0} %param_1.1470, f32[512,52]{1,0} %param_1.1470), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoder_norm/integer_pow[y=2]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=228}
  %subtract.39.9 = f32[512,52]{1,0} subtract(f32[512,52]{1,0} %multiply.346.11, f32[512,52]{1,0} %multiply.347.9), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoder_norm/sub" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=228}
  %constant_68_54 = f32[] constant(0)
  %broadcast.557.145 = f32[512,52]{1,0} broadcast(f32[] %constant_68_54), dimensions={}
  %maximum.20.31 = f32[512,52]{1,0} maximum(f32[512,52]{1,0} %subtract.39.9, f32[512,52]{1,0} %broadcast.557.145), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoder_norm/max" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=228}
  %constant_64_6 = f32[] constant(1e-06)
  %broadcast.558.49 = f32[512,52]{1,0} broadcast(f32[] %constant_64_6), dimensions={}
  %add.241.13 = f32[512,52]{1,0} add(f32[512,52]{1,0} %maximum.20.31, f32[512,52]{1,0} %broadcast.558.49), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoder_norm/add" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=228}
  %bitcast.5306.10 = f32[1,512,52]{2,1,0} bitcast(f32[512,52]{1,0} %add.241.13)
  %divide.41.9 = f32[1,512,52]{2,1,0} divide(f32[1,512,52]{2,1,0} %param_0.1369, f32[1,512,52]{2,1,0} %bitcast.5306.10), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoder_norm/div" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=228}
  %constant_62_3 = f32[] constant(-0.5)
  %broadcast.617.29 = f32[1,512,52]{2,1,0} broadcast(f32[] %constant_62_3), dimensions={}
  %multiply.367.9 = f32[1,512,52]{2,1,0} multiply(f32[1,512,52]{2,1,0} %divide.41.9, f32[1,512,52]{2,1,0} %broadcast.617.29), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoder_norm/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=228}
  %multiply.368.7 = f32[1,512,52]{2,1,0} multiply(f32[1,512,52]{2,1,0} %bitcast.5521.7, f32[1,512,52]{2,1,0} %multiply.367.9), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoder_norm/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=228}
  %bitcast.5534.5 = f32[512,52]{1,0} bitcast(f32[1,512,52]{2,1,0} %multiply.368.7)
  %compare.41.7 = pred[512,52]{1,0} compare(f32[512,52]{1,0} %subtract.39.9, f32[512,52]{1,0} %maximum.20.31), direction=EQ, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoder_norm/eq" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=228}
  %constant_66_2 = f32[] constant(1)
  %broadcast.620.48 = f32[512,52]{1,0} broadcast(f32[] %constant_66_2), dimensions={}
  %select.35.7 = f32[512,52]{1,0} select(pred[512,52]{1,0} %compare.41.7, f32[512,52]{1,0} %broadcast.620.48, f32[512,52]{1,0} %broadcast.557.145), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoder_norm/select_n" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=228}
  %compare.42.7 = pred[512,52]{1,0} compare(f32[512,52]{1,0} %broadcast.557.145, f32[512,52]{1,0} %maximum.20.31), direction=EQ, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoder_norm/eq" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=228}
  %constant_70_3 = f32[] constant(2)
  %broadcast.622.29 = f32[512,52]{1,0} broadcast(f32[] %constant_70_3), dimensions={}
  %select.36.9 = f32[512,52]{1,0} select(pred[512,52]{1,0} %compare.42.7, f32[512,52]{1,0} %broadcast.622.29, f32[512,52]{1,0} %broadcast.620.48), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoder_norm/select_n" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=228}
  %divide.42.7 = f32[512,52]{1,0} divide(f32[512,52]{1,0} %select.35.7, f32[512,52]{1,0} %select.36.9), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoder_norm/div" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=228}
  %multiply.369.5 = f32[512,52]{1,0} multiply(f32[512,52]{1,0} %bitcast.5534.5, f32[512,52]{1,0} %divide.42.7), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoder_norm/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=228}
  %constant_209_3 = f32[] constant(0.0078125)
  %broadcast.623.2 = f32[512,52]{1,0} broadcast(f32[] %constant_209_3), dimensions={}, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoder_norm/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=228}
  %multiply.370.1 = f32[512,52]{1,0} multiply(f32[512,52]{1,0} %multiply.369.5, f32[512,52]{1,0} %broadcast.623.2), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoder_norm/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=228}
  %negate.35.1.clone.1 = f32[512,52]{1,0} negate(f32[512,52]{1,0} %multiply.369.5), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoder_norm/neg" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=228}
  %param_5.328 = f32[512,52]{1,0} parameter(5)
  %multiply.372.7.clone.1 = f32[512,52]{1,0} multiply(f32[512,52]{1,0} %param_5.328, f32[512,52]{1,0} %broadcast.623.2), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoder_norm/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=228}
  %multiply.373.5.clone.1 = f32[512,52]{1,0} multiply(f32[512,52]{1,0} %negate.35.1.clone.1, f32[512,52]{1,0} %multiply.372.7.clone.1), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoder_norm/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=228}
  %param_4.407 = f32[512,52]{1,0} parameter(4)
  %add.249.3.clone.1 = f32[512,52]{1,0} add(f32[512,52]{1,0} %multiply.373.5.clone.1, f32[512,52]{1,0} %param_4.407), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoder_norm/add_any" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=228}
  %multiply.375.1.clone.1 = f32[512,52]{1,0} multiply(f32[512,52]{1,0} %add.249.3.clone.1, f32[512,52]{1,0} %broadcast.555.49), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoder_norm/div" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=228}
  ROOT %tuple.47 = (f32[512,52]{1,0}, f32[512,52]{1,0}) tuple(f32[512,52]{1,0} %multiply.370.1, f32[512,52]{1,0} %multiply.375.1.clone.1)
}

%fused_multiply.1 (param_0.1370: f32[1,512,52], param_1.1471: f32[512,52], param_2.888: f32[512,52], param_3.569: f32[512,52], param_4.394: f32[512,52], param_5.317: f32[512,52]) -> (f32[512,52], f32[512,52]) {
  %param_3.569 = f32[512,52]{1,0} parameter(3)
  %bitcast.5634.7 = f32[1,512,52]{2,1,0} bitcast(f32[512,52]{1,0} %param_3.569)
  %param_0.1370 = f32[1,512,52]{2,1,0} parameter(0)
  %param_2.888 = f32[512,52]{1,0} parameter(2)
  %constant_35_9 = f32[] constant(0.00390625)
  %broadcast.555.53 = f32[512,52]{1,0} broadcast(f32[] %constant_35_9), dimensions={}
  %multiply.340.11 = f32[512,52]{1,0} multiply(f32[512,52]{1,0} %param_2.888, f32[512,52]{1,0} %broadcast.555.53), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/LayerNorm_1/div" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
  %param_1.1471 = f32[512,52]{1,0} parameter(1)
  %multiply.341.9 = f32[512,52]{1,0} multiply(f32[512,52]{1,0} %param_1.1471, f32[512,52]{1,0} %param_1.1471), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/LayerNorm_1/integer_pow[y=2]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
  %subtract.37.9 = f32[512,52]{1,0} subtract(f32[512,52]{1,0} %multiply.340.11, f32[512,52]{1,0} %multiply.341.9), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/LayerNorm_1/sub" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
  %constant_68_56 = f32[] constant(0)
  %broadcast.557.165 = f32[512,52]{1,0} broadcast(f32[] %constant_68_56), dimensions={}
  %maximum.19.31 = f32[512,52]{1,0} maximum(f32[512,52]{1,0} %subtract.37.9, f32[512,52]{1,0} %broadcast.557.165), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/LayerNorm_1/max" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
  %constant_64_7 = f32[] constant(1e-06)
  %broadcast.558.53 = f32[512,52]{1,0} broadcast(f32[] %constant_64_7), dimensions={}
  %add.237.13 = f32[512,52]{1,0} add(f32[512,52]{1,0} %maximum.19.31, f32[512,52]{1,0} %broadcast.558.53), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/LayerNorm_1/add" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
  %bitcast.5222.10 = f32[1,512,52]{2,1,0} bitcast(f32[512,52]{1,0} %add.237.13)
  %divide.43.9 = f32[1,512,52]{2,1,0} divide(f32[1,512,52]{2,1,0} %param_0.1370, f32[1,512,52]{2,1,0} %bitcast.5222.10), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/LayerNorm_1/div" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
  %constant_62_2 = f32[] constant(-0.5)
  %broadcast.617.33 = f32[1,512,52]{2,1,0} broadcast(f32[] %constant_62_2), dimensions={}
  %multiply.379.9 = f32[1,512,52]{2,1,0} multiply(f32[1,512,52]{2,1,0} %divide.43.9, f32[1,512,52]{2,1,0} %broadcast.617.33), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/LayerNorm_1/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
  %multiply.380.7 = f32[1,512,52]{2,1,0} multiply(f32[1,512,52]{2,1,0} %bitcast.5634.7, f32[1,512,52]{2,1,0} %multiply.379.9), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/LayerNorm_1/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
  %bitcast.5647.5 = f32[512,52]{1,0} bitcast(f32[1,512,52]{2,1,0} %multiply.380.7)
  %compare.43.7 = pred[512,52]{1,0} compare(f32[512,52]{1,0} %subtract.37.9, f32[512,52]{1,0} %maximum.19.31), direction=EQ, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/LayerNorm_1/eq" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
  %constant_66_5 = f32[] constant(1)
  %broadcast.620.56 = f32[512,52]{1,0} broadcast(f32[] %constant_66_5), dimensions={}
  %select.37.7 = f32[512,52]{1,0} select(pred[512,52]{1,0} %compare.43.7, f32[512,52]{1,0} %broadcast.620.56, f32[512,52]{1,0} %broadcast.557.165), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/LayerNorm_1/select_n" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
  %compare.44.7 = pred[512,52]{1,0} compare(f32[512,52]{1,0} %broadcast.557.165, f32[512,52]{1,0} %maximum.19.31), direction=EQ, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/LayerNorm_1/eq" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
  %constant_70_2 = f32[] constant(2)
  %broadcast.622.33 = f32[512,52]{1,0} broadcast(f32[] %constant_70_2), dimensions={}
  %select.38.9 = f32[512,52]{1,0} select(pred[512,52]{1,0} %compare.44.7, f32[512,52]{1,0} %broadcast.622.33, f32[512,52]{1,0} %broadcast.620.56), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/LayerNorm_1/select_n" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
  %divide.44.7 = f32[512,52]{1,0} divide(f32[512,52]{1,0} %select.37.7, f32[512,52]{1,0} %select.38.9), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/LayerNorm_1/div" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
  %multiply.381.5 = f32[512,52]{1,0} multiply(f32[512,52]{1,0} %bitcast.5647.5, f32[512,52]{1,0} %divide.44.7), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/LayerNorm_1/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
  %constant_209_4 = f32[] constant(0.0078125)
  %broadcast.623.3 = f32[512,52]{1,0} broadcast(f32[] %constant_209_4), dimensions={}, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoder_norm/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=228}
  %multiply.384.1 = f32[512,52]{1,0} multiply(f32[512,52]{1,0} %multiply.381.5, f32[512,52]{1,0} %broadcast.623.3), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/LayerNorm_1/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
  %negate.37.1.clone.1 = f32[512,52]{1,0} negate(f32[512,52]{1,0} %multiply.381.5), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/LayerNorm_1/neg" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
  %param_5.317 = f32[512,52]{1,0} parameter(5)
  %multiply.386.7.clone.1 = f32[512,52]{1,0} multiply(f32[512,52]{1,0} %param_5.317, f32[512,52]{1,0} %broadcast.623.3), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/LayerNorm_1/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
  %multiply.387.5.clone.1 = f32[512,52]{1,0} multiply(f32[512,52]{1,0} %negate.37.1.clone.1, f32[512,52]{1,0} %multiply.386.7.clone.1), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/LayerNorm_1/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
  %param_4.394 = f32[512,52]{1,0} parameter(4)
  %add.254.3.clone.1 = f32[512,52]{1,0} add(f32[512,52]{1,0} %multiply.387.5.clone.1, f32[512,52]{1,0} %param_4.394), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/LayerNorm_1/add_any" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
  %multiply.388.1.clone.1 = f32[512,52]{1,0} multiply(f32[512,52]{1,0} %add.254.3.clone.1, f32[512,52]{1,0} %broadcast.555.53), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/LayerNorm_1/div" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
  ROOT %tuple.44 = (f32[512,52]{1,0}, f32[512,52]{1,0}) tuple(f32[512,52]{1,0} %multiply.384.1, f32[512,52]{1,0} %multiply.388.1.clone.1)
}

%fused_multiply.2 (param_0.1371: f32[1,512,52], param_1.1472: f32[512,52], param_2.890: f32[512,52], param_3.571: f32[512,52], param_4.383: f32[512,52], param_5.308: f32[512,52]) -> (f32[512,52], f32[512,52]) {
  %param_3.571 = f32[512,52]{1,0} parameter(3)
  %bitcast.5872.7 = f32[1,512,52]{2,1,0} bitcast(f32[512,52]{1,0} %param_3.571)
  %param_0.1371 = f32[1,512,52]{2,1,0} parameter(0)
  %param_2.890 = f32[512,52]{1,0} parameter(2)
  %constant_35_7 = f32[] constant(0.00390625)
  %broadcast.555.57 = f32[512,52]{1,0} broadcast(f32[] %constant_35_7), dimensions={}
  %multiply.330.11 = f32[512,52]{1,0} multiply(f32[512,52]{1,0} %param_2.890, f32[512,52]{1,0} %broadcast.555.57), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/LayerNorm_0/div" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
  %param_1.1472 = f32[512,52]{1,0} parameter(1)
  %multiply.331.9 = f32[512,52]{1,0} multiply(f32[512,52]{1,0} %param_1.1472, f32[512,52]{1,0} %param_1.1472), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/LayerNorm_0/integer_pow[y=2]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
  %subtract.34.9 = f32[512,52]{1,0} subtract(f32[512,52]{1,0} %multiply.330.11, f32[512,52]{1,0} %multiply.331.9), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/LayerNorm_0/sub" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
  %constant_68_55 = f32[] constant(0)
  %broadcast.557.185 = f32[512,52]{1,0} broadcast(f32[] %constant_68_55), dimensions={}
  %maximum.18.31 = f32[512,52]{1,0} maximum(f32[512,52]{1,0} %subtract.34.9, f32[512,52]{1,0} %broadcast.557.185), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/LayerNorm_0/max" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
  %constant_64_8 = f32[] constant(1e-06)
  %broadcast.558.57 = f32[512,52]{1,0} broadcast(f32[] %constant_64_8), dimensions={}
  %add.229.13 = f32[512,52]{1,0} add(f32[512,52]{1,0} %maximum.18.31, f32[512,52]{1,0} %broadcast.558.57), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/LayerNorm_0/add" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
  %bitcast.5026.10 = f32[1,512,52]{2,1,0} bitcast(f32[512,52]{1,0} %add.229.13)
  %divide.47.9 = f32[1,512,52]{2,1,0} divide(f32[1,512,52]{2,1,0} %param_0.1371, f32[1,512,52]{2,1,0} %bitcast.5026.10), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/LayerNorm_0/div" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
  %constant_62_4 = f32[] constant(-0.5)
  %broadcast.617.37 = f32[1,512,52]{2,1,0} broadcast(f32[] %constant_62_4), dimensions={}
  %multiply.398.9 = f32[1,512,52]{2,1,0} multiply(f32[1,512,52]{2,1,0} %divide.47.9, f32[1,512,52]{2,1,0} %broadcast.617.37), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/LayerNorm_0/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
  %multiply.399.7 = f32[1,512,52]{2,1,0} multiply(f32[1,512,52]{2,1,0} %bitcast.5872.7, f32[1,512,52]{2,1,0} %multiply.398.9), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/LayerNorm_0/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
  %bitcast.5885.5 = f32[512,52]{1,0} bitcast(f32[1,512,52]{2,1,0} %multiply.399.7)
  %compare.45.7 = pred[512,52]{1,0} compare(f32[512,52]{1,0} %subtract.34.9, f32[512,52]{1,0} %maximum.18.31), direction=EQ, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/LayerNorm_0/eq" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
  %constant_66_4 = f32[] constant(1)
  %broadcast.620.64 = f32[512,52]{1,0} broadcast(f32[] %constant_66_4), dimensions={}
  %select.39.7 = f32[512,52]{1,0} select(pred[512,52]{1,0} %compare.45.7, f32[512,52]{1,0} %broadcast.620.64, f32[512,52]{1,0} %broadcast.557.185), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/LayerNorm_0/select_n" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
  %compare.46.7 = pred[512,52]{1,0} compare(f32[512,52]{1,0} %broadcast.557.185, f32[512,52]{1,0} %maximum.18.31), direction=EQ, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/LayerNorm_0/eq" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
  %constant_70_4 = f32[] constant(2)
  %broadcast.622.37 = f32[512,52]{1,0} broadcast(f32[] %constant_70_4), dimensions={}
  %select.40.9 = f32[512,52]{1,0} select(pred[512,52]{1,0} %compare.46.7, f32[512,52]{1,0} %broadcast.622.37, f32[512,52]{1,0} %broadcast.620.64), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/LayerNorm_0/select_n" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
  %divide.48.7 = f32[512,52]{1,0} divide(f32[512,52]{1,0} %select.39.7, f32[512,52]{1,0} %select.40.9), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/LayerNorm_0/div" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
  %multiply.400.5 = f32[512,52]{1,0} multiply(f32[512,52]{1,0} %bitcast.5885.5, f32[512,52]{1,0} %divide.48.7), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/LayerNorm_0/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
  %constant_209_6 = f32[] constant(0.0078125)
  %broadcast.623.5 = f32[512,52]{1,0} broadcast(f32[] %constant_209_6), dimensions={}, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoder_norm/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=228}
  %multiply.401.1 = f32[512,52]{1,0} multiply(f32[512,52]{1,0} %multiply.400.5, f32[512,52]{1,0} %broadcast.623.5), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/LayerNorm_0/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
  %negate.40.1.clone.1 = f32[512,52]{1,0} negate(f32[512,52]{1,0} %multiply.400.5), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/LayerNorm_0/neg" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
  %param_5.308 = f32[512,52]{1,0} parameter(5)
  %multiply.403.7.clone.1 = f32[512,52]{1,0} multiply(f32[512,52]{1,0} %param_5.308, f32[512,52]{1,0} %broadcast.623.5), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/LayerNorm_0/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
  %multiply.404.5.clone.1 = f32[512,52]{1,0} multiply(f32[512,52]{1,0} %negate.40.1.clone.1, f32[512,52]{1,0} %multiply.403.7.clone.1), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/LayerNorm_0/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
  %param_4.383 = f32[512,52]{1,0} parameter(4)
  %add.260.3.clone.1 = f32[512,52]{1,0} add(f32[512,52]{1,0} %multiply.404.5.clone.1, f32[512,52]{1,0} %param_4.383), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/LayerNorm_0/add_any" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
  %multiply.405.1.clone.1 = f32[512,52]{1,0} multiply(f32[512,52]{1,0} %add.260.3.clone.1, f32[512,52]{1,0} %broadcast.555.57), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/LayerNorm_0/div" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
  ROOT %tuple.34 = (f32[512,52]{1,0}, f32[512,52]{1,0}) tuple(f32[512,52]{1,0} %multiply.401.1, f32[512,52]{1,0} %multiply.405.1.clone.1)
}

%fused_multiply.3 (param_0.1372: f32[1,512,52], param_1.1473: f32[512,52], param_2.892: f32[512,52], param_3.573: f32[512,52], param_4.372: f32[512,52], param_5.299: f32[512,52]) -> (f32[512,52], f32[512,52]) {
  %param_3.573 = f32[512,52]{1,0} parameter(3)
  %bitcast.5985.7 = f32[1,512,52]{2,1,0} bitcast(f32[512,52]{1,0} %param_3.573)
  %param_0.1372 = f32[1,512,52]{2,1,0} parameter(0)
  %param_2.892 = f32[512,52]{1,0} parameter(2)
  %constant_35_5 = f32[] constant(0.00390625)
  %broadcast.555.61 = f32[512,52]{1,0} broadcast(f32[] %constant_35_5), dimensions={}
  %multiply.324.11 = f32[512,52]{1,0} multiply(f32[512,52]{1,0} %param_2.892, f32[512,52]{1,0} %broadcast.555.61), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/LayerNorm_1/div" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
  %param_1.1473 = f32[512,52]{1,0} parameter(1)
  %multiply.325.9 = f32[512,52]{1,0} multiply(f32[512,52]{1,0} %param_1.1473, f32[512,52]{1,0} %param_1.1473), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/LayerNorm_1/integer_pow[y=2]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
  %subtract.32.9 = f32[512,52]{1,0} subtract(f32[512,52]{1,0} %multiply.324.11, f32[512,52]{1,0} %multiply.325.9), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/LayerNorm_1/sub" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
  %constant_68_1 = f32[] constant(0)
  %broadcast.557.205 = f32[512,52]{1,0} broadcast(f32[] %constant_68_1), dimensions={}
  %maximum.17.31 = f32[512,52]{1,0} maximum(f32[512,52]{1,0} %subtract.32.9, f32[512,52]{1,0} %broadcast.557.205), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/LayerNorm_1/max" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
  %constant_64_10 = f32[] constant(1e-06)
  %broadcast.558.61 = f32[512,52]{1,0} broadcast(f32[] %constant_64_10), dimensions={}
  %add.225.13 = f32[512,52]{1,0} add(f32[512,52]{1,0} %maximum.17.31, f32[512,52]{1,0} %broadcast.558.61), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/LayerNorm_1/add" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
  %bitcast.4942.10 = f32[1,512,52]{2,1,0} bitcast(f32[512,52]{1,0} %add.225.13)
  %divide.49.9 = f32[1,512,52]{2,1,0} divide(f32[1,512,52]{2,1,0} %param_0.1372, f32[1,512,52]{2,1,0} %bitcast.4942.10), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/LayerNorm_1/div" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
  %constant_62_5 = f32[] constant(-0.5)
  %broadcast.617.41 = f32[1,512,52]{2,1,0} broadcast(f32[] %constant_62_5), dimensions={}
  %multiply.409.9 = f32[1,512,52]{2,1,0} multiply(f32[1,512,52]{2,1,0} %divide.49.9, f32[1,512,52]{2,1,0} %broadcast.617.41), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/LayerNorm_1/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
  %multiply.410.7 = f32[1,512,52]{2,1,0} multiply(f32[1,512,52]{2,1,0} %bitcast.5985.7, f32[1,512,52]{2,1,0} %multiply.409.9), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/LayerNorm_1/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
  %bitcast.5998.5 = f32[512,52]{1,0} bitcast(f32[1,512,52]{2,1,0} %multiply.410.7)
  %compare.47.7 = pred[512,52]{1,0} compare(f32[512,52]{1,0} %subtract.32.9, f32[512,52]{1,0} %maximum.17.31), direction=EQ, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/LayerNorm_1/eq" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
  %constant_66_3 = f32[] constant(1)
  %broadcast.620.72 = f32[512,52]{1,0} broadcast(f32[] %constant_66_3), dimensions={}
  %select.41.7 = f32[512,52]{1,0} select(pred[512,52]{1,0} %compare.47.7, f32[512,52]{1,0} %broadcast.620.72, f32[512,52]{1,0} %broadcast.557.205), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/LayerNorm_1/select_n" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
  %compare.48.7 = pred[512,52]{1,0} compare(f32[512,52]{1,0} %broadcast.557.205, f32[512,52]{1,0} %maximum.17.31), direction=EQ, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/LayerNorm_1/eq" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
  %constant_70_5 = f32[] constant(2)
  %broadcast.622.41 = f32[512,52]{1,0} broadcast(f32[] %constant_70_5), dimensions={}
  %select.42.9 = f32[512,52]{1,0} select(pred[512,52]{1,0} %compare.48.7, f32[512,52]{1,0} %broadcast.622.41, f32[512,52]{1,0} %broadcast.620.72), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/LayerNorm_1/select_n" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
  %divide.50.7 = f32[512,52]{1,0} divide(f32[512,52]{1,0} %select.41.7, f32[512,52]{1,0} %select.42.9), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/LayerNorm_1/div" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
  %multiply.411.5 = f32[512,52]{1,0} multiply(f32[512,52]{1,0} %bitcast.5998.5, f32[512,52]{1,0} %divide.50.7), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/LayerNorm_1/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
  %constant_209_8 = f32[] constant(0.0078125)
  %broadcast.623.7 = f32[512,52]{1,0} broadcast(f32[] %constant_209_8), dimensions={}, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoder_norm/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=228}
  %multiply.413.1 = f32[512,52]{1,0} multiply(f32[512,52]{1,0} %multiply.411.5, f32[512,52]{1,0} %broadcast.623.7), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/LayerNorm_1/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
  %negate.42.1.clone.1 = f32[512,52]{1,0} negate(f32[512,52]{1,0} %multiply.411.5), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/LayerNorm_1/neg" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
  %param_5.299 = f32[512,52]{1,0} parameter(5)
  %multiply.415.7.clone.1 = f32[512,52]{1,0} multiply(f32[512,52]{1,0} %param_5.299, f32[512,52]{1,0} %broadcast.623.7), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/LayerNorm_1/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
  %multiply.416.5.clone.1 = f32[512,52]{1,0} multiply(f32[512,52]{1,0} %negate.42.1.clone.1, f32[512,52]{1,0} %multiply.415.7.clone.1), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/LayerNorm_1/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
  %param_4.372 = f32[512,52]{1,0} parameter(4)
  %add.265.3.clone.1 = f32[512,52]{1,0} add(f32[512,52]{1,0} %multiply.416.5.clone.1, f32[512,52]{1,0} %param_4.372), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/LayerNorm_1/add_any" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
  %multiply.417.1.clone.1 = f32[512,52]{1,0} multiply(f32[512,52]{1,0} %add.265.3.clone.1, f32[512,52]{1,0} %broadcast.555.61), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/LayerNorm_1/div" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
  ROOT %tuple.31 = (f32[512,52]{1,0}, f32[512,52]{1,0}) tuple(f32[512,52]{1,0} %multiply.413.1, f32[512,52]{1,0} %multiply.417.1.clone.1)
}

%fused_multiply.4 (param_0.1373: f32[1,512,52], param_1.1474: f32[512,52], param_2.894: f32[512,52], param_3.575: f32[512,52], param_4.361: f32[512,52], param_5.288: f32[512,52]) -> (f32[512,52], f32[512,52]) {
  %param_3.575 = f32[512,52]{1,0} parameter(3)
  %bitcast.6629.7 = f32[1,512,52]{2,1,0} bitcast(f32[512,52]{1,0} %param_3.575)
  %param_0.1373 = f32[1,512,52]{2,1,0} parameter(0)
  %param_2.894 = f32[512,52]{1,0} parameter(2)
  %constant_35_2 = f32[] constant(0.00390625)
  %broadcast.555.65 = f32[512,52]{1,0} broadcast(f32[] %constant_35_2), dimensions={}
  %multiply.317.11 = f32[512,52]{1,0} multiply(f32[512,52]{1,0} %param_2.894, f32[512,52]{1,0} %broadcast.555.65), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/LayerNorm_0/div" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
  %param_1.1474 = f32[512,52]{1,0} parameter(1)
  %multiply.318.9 = f32[512,52]{1,0} multiply(f32[512,52]{1,0} %param_1.1474, f32[512,52]{1,0} %param_1.1474), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/LayerNorm_0/integer_pow[y=2]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
  %subtract.29.9 = f32[512,52]{1,0} subtract(f32[512,52]{1,0} %multiply.317.11, f32[512,52]{1,0} %multiply.318.9), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/LayerNorm_0/sub" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
  %constant_68_57 = f32[] constant(0)
  %broadcast.557.225 = f32[512,52]{1,0} broadcast(f32[] %constant_68_57), dimensions={}
  %maximum.16.31 = f32[512,52]{1,0} maximum(f32[512,52]{1,0} %subtract.29.9, f32[512,52]{1,0} %broadcast.557.225), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/LayerNorm_0/max" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
  %constant_64_9 = f32[] constant(1e-06)
  %broadcast.558.65 = f32[512,52]{1,0} broadcast(f32[] %constant_64_9), dimensions={}
  %add.218.13 = f32[512,52]{1,0} add(f32[512,52]{1,0} %maximum.16.31, f32[512,52]{1,0} %broadcast.558.65), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/LayerNorm_0/add" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
  %bitcast.4747.10 = f32[1,512,52]{2,1,0} bitcast(f32[512,52]{1,0} %add.218.13)
  %divide.53.9 = f32[1,512,52]{2,1,0} divide(f32[1,512,52]{2,1,0} %param_0.1373, f32[1,512,52]{2,1,0} %bitcast.4747.10), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/LayerNorm_0/div" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
  %constant_62_1 = f32[] constant(-0.5)
  %broadcast.617.45 = f32[1,512,52]{2,1,0} broadcast(f32[] %constant_62_1), dimensions={}
  %multiply.431.9 = f32[1,512,52]{2,1,0} multiply(f32[1,512,52]{2,1,0} %divide.53.9, f32[1,512,52]{2,1,0} %broadcast.617.45), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/LayerNorm_0/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
  %multiply.432.7 = f32[1,512,52]{2,1,0} multiply(f32[1,512,52]{2,1,0} %bitcast.6629.7, f32[1,512,52]{2,1,0} %multiply.431.9), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/LayerNorm_0/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
  %bitcast.6642.5 = f32[512,52]{1,0} bitcast(f32[1,512,52]{2,1,0} %multiply.432.7)
  %compare.49.7 = pred[512,52]{1,0} compare(f32[512,52]{1,0} %subtract.29.9, f32[512,52]{1,0} %maximum.16.31), direction=EQ, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/LayerNorm_0/eq" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
  %constant_66_1 = f32[] constant(1)
  %broadcast.620.80 = f32[512,52]{1,0} broadcast(f32[] %constant_66_1), dimensions={}
  %select.43.7 = f32[512,52]{1,0} select(pred[512,52]{1,0} %compare.49.7, f32[512,52]{1,0} %broadcast.620.80, f32[512,52]{1,0} %broadcast.557.225), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/LayerNorm_0/select_n" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
  %compare.50.7 = pred[512,52]{1,0} compare(f32[512,52]{1,0} %broadcast.557.225, f32[512,52]{1,0} %maximum.16.31), direction=EQ, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/LayerNorm_0/eq" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
  %constant_70_1 = f32[] constant(2)
  %broadcast.622.45 = f32[512,52]{1,0} broadcast(f32[] %constant_70_1), dimensions={}
  %select.44.9 = f32[512,52]{1,0} select(pred[512,52]{1,0} %compare.50.7, f32[512,52]{1,0} %broadcast.622.45, f32[512,52]{1,0} %broadcast.620.80), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/LayerNorm_0/select_n" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
  %divide.54.7 = f32[512,52]{1,0} divide(f32[512,52]{1,0} %select.43.7, f32[512,52]{1,0} %select.44.9), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/LayerNorm_0/div" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
  %multiply.433.5 = f32[512,52]{1,0} multiply(f32[512,52]{1,0} %bitcast.6642.5, f32[512,52]{1,0} %divide.54.7), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/LayerNorm_0/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
  %constant_209_10 = f32[] constant(0.0078125)
  %broadcast.623.9 = f32[512,52]{1,0} broadcast(f32[] %constant_209_10), dimensions={}, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoder_norm/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=228}
  %multiply.434.1 = f32[512,52]{1,0} multiply(f32[512,52]{1,0} %multiply.433.5, f32[512,52]{1,0} %broadcast.623.9), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/LayerNorm_0/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
  %negate.45.1.clone.1 = f32[512,52]{1,0} negate(f32[512,52]{1,0} %multiply.433.5), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/LayerNorm_0/neg" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
  %param_5.288 = f32[512,52]{1,0} parameter(5)
  %multiply.436.7.clone.1 = f32[512,52]{1,0} multiply(f32[512,52]{1,0} %param_5.288, f32[512,52]{1,0} %broadcast.623.9), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/LayerNorm_0/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
  %multiply.438.5.clone.1 = f32[512,52]{1,0} multiply(f32[512,52]{1,0} %negate.45.1.clone.1, f32[512,52]{1,0} %multiply.436.7.clone.1), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/LayerNorm_0/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
  %param_4.361 = f32[512,52]{1,0} parameter(4)
  %add.272.3.clone.1 = f32[512,52]{1,0} add(f32[512,52]{1,0} %multiply.438.5.clone.1, f32[512,52]{1,0} %param_4.361), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/LayerNorm_0/add_any" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
  %multiply.439.1.clone.1 = f32[512,52]{1,0} multiply(f32[512,52]{1,0} %add.272.3.clone.1, f32[512,52]{1,0} %broadcast.555.65), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/LayerNorm_0/div" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
  ROOT %tuple.21 = (f32[512,52]{1,0}, f32[512,52]{1,0}) tuple(f32[512,52]{1,0} %multiply.434.1, f32[512,52]{1,0} %multiply.439.1.clone.1)
}

%region_18.769.clone.1 (Arg_0.4.0: f32[], Arg_1.4.0: f32[]) -> f32[] {
  %Arg_1.4.0 = f32[] parameter(1)
  %Arg_0.4.0 = f32[] parameter(0)
  ROOT %add.182.0 = f32[] add(f32[] %Arg_0.4.0, f32[] %Arg_1.4.0), metadata={op_name="jit(loss)/jit(main)/reduce_sum[axes=(1,)]" source_file="/home/nicholas/programs/avid/avid/config.py" source_line=371}
}

%fused_reduce.28 (param_0.876: f32[52,4,512], param_1.866: bf16[208,512,512], param_2.410: f32[52,4,512], param_3.222: bf16[208,512,512]) -> f32[52,4,512] {
  %param_3.222 = bf16[208,512,512]{2,1,0} parameter(3)
  %bitcast.5754.17 = bf16[52,4,512,512]{3,2,1,0} bitcast(bf16[208,512,512]{2,1,0} %param_3.222)
  %convert.1515.17 = f32[52,4,512,512]{3,2,1,0} convert(bf16[52,4,512,512]{3,2,1,0} %bitcast.5754.17)
  %param_2.410 = f32[52,4,512]{2,1,0} parameter(2)
  %broadcast.700.3 = f32[52,4,512,512]{3,2,1,0} broadcast(f32[52,4,512]{2,1,0} %param_2.410), dimensions={0,1,2}, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/MultiHeadDotProductAttention_0/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %multiply.390.7 = f32[52,4,512,512]{3,2,1,0} multiply(f32[52,4,512,512]{3,2,1,0} %convert.1515.17, f32[52,4,512,512]{3,2,1,0} %broadcast.700.3), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/MultiHeadDotProductAttention_0/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %param_1.866 = bf16[208,512,512]{2,1,0} parameter(1)
  %bitcast.5115.17 = bf16[52,4,512,512]{3,2,1,0} bitcast(bf16[208,512,512]{2,1,0} %param_1.866)
  %convert.1465.17 = f32[52,4,512,512]{3,2,1,0} convert(bf16[52,4,512,512]{3,2,1,0} %bitcast.5115.17)
  %param_0.876 = f32[52,4,512]{2,1,0} parameter(0)
  %broadcast.667.11 = f32[52,4,512,512]{3,2,1,0} broadcast(f32[52,4,512]{2,1,0} %param_0.876), dimensions={0,1,2}, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/MultiHeadDotProductAttention_0/sub" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %subtract.35.13 = f32[52,4,512,512]{3,2,1,0} subtract(f32[52,4,512,512]{3,2,1,0} %convert.1465.17, f32[52,4,512,512]{3,2,1,0} %broadcast.667.11), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/MultiHeadDotProductAttention_0/sub" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %exponential.5.11 = f32[52,4,512,512]{3,2,1,0} exponential(f32[52,4,512,512]{3,2,1,0} %subtract.35.13), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/MultiHeadDotProductAttention_0/exp" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %multiply.391.5 = f32[52,4,512,512]{3,2,1,0} multiply(f32[52,4,512,512]{3,2,1,0} %multiply.390.7, f32[52,4,512,512]{3,2,1,0} %exponential.5.11), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/MultiHeadDotProductAttention_0/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %constant_55_6 = bf16[] constant(0)
  %convert.1640.3 = f32[] convert(bf16[] %constant_55_6)
  %reduce.981.3 = f32[52,4,512]{2,1,0} reduce(f32[52,4,512,512]{3,2,1,0} %multiply.391.5, f32[] %convert.1640.3), dimensions={3}, to_apply=%region_18.769.clone.1, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/MultiHeadDotProductAttention_0/reduce_sum[axes=(3,)]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  ROOT %negate.39.1 = f32[52,4,512]{2,1,0} negate(f32[52,4,512]{2,1,0} %reduce.981.3), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/MultiHeadDotProductAttention_0/neg" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
}

%region_18.769.clone.2 (Arg_0.5.0: f32[], Arg_1.5.0: f32[]) -> f32[] {
  %Arg_1.5.0 = f32[] parameter(1)
  %Arg_0.5.0 = f32[] parameter(0)
  ROOT %add.183.0 = f32[] add(f32[] %Arg_0.5.0, f32[] %Arg_1.5.0), metadata={op_name="jit(loss)/jit(main)/reduce_sum[axes=(1,)]" source_file="/home/nicholas/programs/avid/avid/config.py" source_line=371}
}

%fused_reduce.29 (param_0.877: f32[52,4,512], param_1.867: bf16[208,512,512], param_2.411: f32[52,4,512], param_3.223: bf16[208,512,512]) -> f32[52,4,512] {
  %param_3.223 = bf16[208,512,512]{2,1,0} parameter(3)
  %bitcast.6103.17 = bf16[52,4,512,512]{3,2,1,0} bitcast(bf16[208,512,512]{2,1,0} %param_3.223)
  %convert.1533.17 = f32[52,4,512,512]{3,2,1,0} convert(bf16[52,4,512,512]{3,2,1,0} %bitcast.6103.17)
  %param_2.411 = f32[52,4,512]{2,1,0} parameter(2)
  %broadcast.703.3 = f32[52,4,512,512]{3,2,1,0} broadcast(f32[52,4,512]{2,1,0} %param_2.411), dimensions={0,1,2}, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/MultiHeadDotProductAttention_0/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %multiply.419.7 = f32[52,4,512,512]{3,2,1,0} multiply(f32[52,4,512,512]{3,2,1,0} %convert.1533.17, f32[52,4,512,512]{3,2,1,0} %broadcast.703.3), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/MultiHeadDotProductAttention_0/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %param_1.867 = bf16[208,512,512]{2,1,0} parameter(1)
  %bitcast.4836.17 = bf16[52,4,512,512]{3,2,1,0} bitcast(bf16[208,512,512]{2,1,0} %param_1.867)
  %convert.1427.17 = f32[52,4,512,512]{3,2,1,0} convert(bf16[52,4,512,512]{3,2,1,0} %bitcast.4836.17)
  %param_0.877 = f32[52,4,512]{2,1,0} parameter(0)
  %broadcast.660.11 = f32[52,4,512,512]{3,2,1,0} broadcast(f32[52,4,512]{2,1,0} %param_0.877), dimensions={0,1,2}, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/MultiHeadDotProductAttention_0/sub" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %subtract.30.13 = f32[52,4,512,512]{3,2,1,0} subtract(f32[52,4,512,512]{3,2,1,0} %convert.1427.17, f32[52,4,512,512]{3,2,1,0} %broadcast.660.11), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/MultiHeadDotProductAttention_0/sub" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %exponential.4.11 = f32[52,4,512,512]{3,2,1,0} exponential(f32[52,4,512,512]{3,2,1,0} %subtract.30.13), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/MultiHeadDotProductAttention_0/exp" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %multiply.420.5 = f32[52,4,512,512]{3,2,1,0} multiply(f32[52,4,512,512]{3,2,1,0} %multiply.419.7, f32[52,4,512,512]{3,2,1,0} %exponential.4.11), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/MultiHeadDotProductAttention_0/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %constant_55_7 = bf16[] constant(0)
  %convert.1640.4 = f32[] convert(bf16[] %constant_55_7)
  %reduce.1214.3 = f32[52,4,512]{2,1,0} reduce(f32[52,4,512,512]{3,2,1,0} %multiply.420.5, f32[] %convert.1640.4), dimensions={3}, to_apply=%region_18.769.clone.2, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/MultiHeadDotProductAttention_0/reduce_sum[axes=(3,)]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  ROOT %negate.44.1 = f32[52,4,512]{2,1,0} negate(f32[52,4,512]{2,1,0} %reduce.1214.3), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/MultiHeadDotProductAttention_0/neg" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
}

%region_18.769.clone (Arg_0.3.0: f32[], Arg_1.3.0: f32[]) -> f32[] {
  %Arg_1.3.0 = f32[] parameter(1)
  %Arg_0.3.0 = f32[] parameter(0)
  ROOT %add.181.0 = f32[] add(f32[] %Arg_0.3.0, f32[] %Arg_1.3.0), metadata={op_name="jit(loss)/jit(main)/reduce_sum[axes=(1,)]" source_file="/home/nicholas/programs/avid/avid/config.py" source_line=371}
}

%fused_multiply_reduce_select (param_0.1390: bf16[52], param_1.1535: f32[52], param_2.957: f32[1]) -> (f32[52], bf16[52,52], bf16[52,52], f32[52,52]) {
  %param_1.1535 = f32[52]{0} parameter(1)
  %param_2.957 = f32[1]{0} parameter(2)
  %convert.1488.6.clone.1 = bf16[1]{0} convert(f32[1]{0} %param_2.957), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/vmap(head)/Dense_0/convert_element_type[new_dtype=bfloat16 weak_type=False]" source_file="/home/nicholas/programs/avid/avid/layers.py" source_line=49}
  %bitcast.5351.10.clone.1 = bf16[] bitcast(bf16[1]{0} %convert.1488.6.clone.1), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/vmap(head)/Dense_0/add" source_file="/home/nicholas/programs/avid/avid/layers.py" source_line=49}
  %convert.1634.7.clone.1 = f32[] convert(bf16[] %bitcast.5351.10.clone.1)
  %broadcast.675.5.clone.1 = f32[52]{0} broadcast(f32[] %convert.1634.7.clone.1), dimensions={}, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/vmap(head)/Dense_0/add" source_file="/home/nicholas/programs/avid/avid/layers.py" source_line=49}
  %add.243.5.clone.1 = f32[52]{0} add(f32[52]{0} %param_1.1535, f32[52]{0} %broadcast.675.5.clone.1), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/vmap(head)/Dense_0/add" source_file="/home/nicholas/programs/avid/avid/layers.py" source_line=49}
  %broadcast.676.34.clone.1 = f32[52,52]{1,0} broadcast(f32[52]{0} %add.243.5.clone.1), dimensions={0}, metadata={op_name="jit(loss)/jit(main)/sub" source_file="/home/nicholas/programs/avid/avid/config.py" source_line=371}
  %param_0.1390 = bf16[52]{0} parameter(0)
  %convert.1636.14.clone.1 = f32[52]{0} convert(bf16[52]{0} %param_0.1390)
  %broadcast.677.55.clone.1 = f32[52,52]{1,0} broadcast(f32[52]{0} %convert.1636.14.clone.1), dimensions={1}
  %add.244.55.clone.1 = f32[52,52]{1,0} add(f32[52,52]{1,0} %broadcast.676.34.clone.1, f32[52,52]{1,0} %broadcast.677.55.clone.1), metadata={op_name="jit(loss)/jit(main)/sub" source_file="/home/nicholas/programs/avid/avid/config.py" source_line=371}
  %constant_55_5 = bf16[] constant(0)
  %convert.1640.41.clone.1 = f32[] convert(bf16[] %constant_55_5)
  %broadcast.685.7.clone.1 = f32[52,52]{1,0} broadcast(f32[] %convert.1640.41.clone.1), dimensions={}
  %compare.37.5.clone.1 = pred[52,52]{1,0} compare(f32[52,52]{1,0} %add.244.55.clone.1, f32[52,52]{1,0} %broadcast.685.7.clone.1), direction=GE, metadata={op_name="jit(loss)/jit(main)/ge" source_file="/home/nicholas/programs/avid/avid/config.py" source_line=371}
  %abs.2.43.clone.1 = f32[52,52]{1,0} abs(f32[52,52]{1,0} %add.244.55.clone.1), metadata={op_name="jit(loss)/jit(main)/abs" source_file="/home/nicholas/programs/avid/avid/config.py" source_line=371}
  %constant_53_3_clone_1 = bf16[] constant(0.1001)
  %convert.1637.1.clone.1 = f32[] convert(bf16[] %constant_53_3_clone_1)
  %broadcast.679.30.clone.1 = f32[52,52]{1,0} broadcast(f32[] %convert.1637.1.clone.1), dimensions={}
  %minimum.2.31.clone.1 = f32[52,52]{1,0} minimum(f32[52,52]{1,0} %abs.2.43.clone.1, f32[52,52]{1,0} %broadcast.679.30.clone.1), metadata={op_name="jit(loss)/jit(main)/min" source_file="/home/nicholas/programs/avid/avid/config.py" source_line=371}
  %constant_208_3_clone_1 = bf16[] constant(0.003693), metadata={op_name="jit(loss)/jit(main)/mul" source_file="/home/nicholas/programs/avid/avid/config.py" source_line=371}
  %convert.1641.1.clone.1 = f32[] convert(bf16[] %constant_208_3_clone_1)
  %broadcast.688.7.clone.1 = f32[52,52]{1,0} broadcast(f32[] %convert.1641.1.clone.1), dimensions={}, metadata={op_name="jit(loss)/jit(main)/mul" source_file="/home/nicholas/programs/avid/avid/config.py" source_line=371}
  %multiply.359.13.clone.1 = f32[52,52]{1,0} multiply(f32[52,52]{1,0} %minimum.2.31.clone.1, f32[52,52]{1,0} %broadcast.688.7.clone.1), metadata={op_name="jit(loss)/jit(main)/mul" source_file="/home/nicholas/programs/avid/avid/config.py" source_line=371}
  %constant_43_3_clone_1 = bf16[] constant(-0.00037)
  %convert.1642.1.clone.1 = f32[] convert(bf16[] %constant_43_3_clone_1)
  %broadcast.691.7.clone.1 = f32[52,52]{1,0} broadcast(f32[] %convert.1642.1.clone.1), dimensions={}
  %add.246.11.clone.1 = f32[52,52]{1,0} add(f32[52,52]{1,0} %multiply.359.13.clone.1, f32[52,52]{1,0} %broadcast.691.7.clone.1), metadata={op_name="jit(loss)/jit(main)/add_any" source_file="/home/nicholas/programs/avid/avid/config.py" source_line=371}
  %compare.38.3.clone.1 = pred[52,52]{1,0} compare(f32[52,52]{1,0} %abs.2.43.clone.1, f32[52,52]{1,0} %minimum.2.31.clone.1), direction=EQ, metadata={op_name="jit(loss)/jit(main)/eq" source_file="/home/nicholas/programs/avid/avid/config.py" source_line=371}
  %constant_51_2_clone_1 = bf16[] constant(1)
  %broadcast.610.5.clone.1 = bf16[52,52]{1,0} broadcast(bf16[] %constant_51_2_clone_1), dimensions={}
  %broadcast.605.1.clone.1 = bf16[52,52]{1,0} broadcast(bf16[] %constant_55_5), dimensions={}
  %select.31.5.clone.1 = bf16[52,52]{1,0} select(pred[52,52]{1,0} %compare.38.3.clone.1, bf16[52,52]{1,0} %broadcast.610.5.clone.1, bf16[52,52]{1,0} %broadcast.605.1.clone.1), metadata={op_name="jit(loss)/jit(main)/select_n" source_file="/home/nicholas/programs/avid/avid/config.py" source_line=371}
  %convert.1501.5.clone.1 = f32[52,52]{1,0} convert(bf16[52,52]{1,0} %select.31.5.clone.1)
  %compare.39.3.clone.1 = pred[52,52]{1,0} compare(f32[52,52]{1,0} %broadcast.679.30.clone.1, f32[52,52]{1,0} %minimum.2.31.clone.1), direction=EQ, metadata={op_name="jit(loss)/jit(main)/eq" source_file="/home/nicholas/programs/avid/avid/config.py" source_line=371}
  %constant_49_1_clone_1 = bf16[] constant(2)
  %broadcast.611.5.clone.1 = bf16[52,52]{1,0} broadcast(bf16[] %constant_49_1_clone_1), dimensions={}
  %select.32.5.clone.1 = bf16[52,52]{1,0} select(pred[52,52]{1,0} %compare.39.3.clone.1, bf16[52,52]{1,0} %broadcast.611.5.clone.1, bf16[52,52]{1,0} %broadcast.610.5.clone.1), metadata={op_name="jit(loss)/jit(main)/select_n" source_file="/home/nicholas/programs/avid/avid/config.py" source_line=371}
  %convert.1503.5.clone.1 = f32[52,52]{1,0} convert(bf16[52,52]{1,0} %select.32.5.clone.1)
  %divide.40.7.clone.1 = f32[52,52]{1,0} divide(f32[52,52]{1,0} %convert.1501.5.clone.1, f32[52,52]{1,0} %convert.1503.5.clone.1), metadata={op_name="jit(loss)/jit(main)/div" source_file="/home/nicholas/programs/avid/avid/config.py" source_line=371}
  %multiply.360.9.clone.1 = f32[52,52]{1,0} multiply(f32[52,52]{1,0} %add.246.11.clone.1, f32[52,52]{1,0} %divide.40.7.clone.1), metadata={op_name="jit(loss)/jit(main)/mul" source_file="/home/nicholas/programs/avid/avid/config.py" source_line=371}
  %constant_45_3_clone_1 = bf16[] constant(0.00037)
  %convert.1643.1.clone.1 = f32[] convert(bf16[] %constant_45_3_clone_1)
  %broadcast.693.7.clone.1 = f32[52,52]{1,0} broadcast(f32[] %convert.1643.1.clone.1), dimensions={}
  %add.247.7.clone.1 = f32[52,52]{1,0} add(f32[52,52]{1,0} %multiply.360.9.clone.1, f32[52,52]{1,0} %broadcast.693.7.clone.1), metadata={op_name="jit(loss)/jit(main)/add_any" source_file="/home/nicholas/programs/avid/avid/config.py" source_line=371}
  %convert.1505.5.clone.1 = bf16[52,52]{1,0} convert(f32[52,52]{1,0} %add.247.7.clone.1)
  %select.33.1.clone.1 = bf16[52,52]{1,0} select(pred[52,52]{1,0} %compare.37.5.clone.1, bf16[52,52]{1,0} %convert.1505.5.clone.1, bf16[52,52]{1,0} %broadcast.605.1.clone.1), metadata={op_name="jit(loss)/jit(main)/select_n" source_file="/home/nicholas/programs/avid/avid/config.py" source_line=371}
  %convert.1506.5 = f32[52,52]{1,0} convert(bf16[52,52]{1,0} %select.33.1.clone.1)
  %constant_39_1_clone_1 = pred[] constant(false)
  %broadcast.613.1.clone.1 = pred[52,52]{1,0} broadcast(pred[] %constant_39_1_clone_1), dimensions={}
  %compare.40.1.clone.1 = pred[52,52]{1,0} compare(pred[52,52]{1,0} %compare.37.5.clone.1, pred[52,52]{1,0} %broadcast.613.1.clone.1), direction=EQ, metadata={op_name="jit(loss)/jit(main)/eq" source_file="/home/nicholas/programs/avid/avid/config.py" source_line=371}
  %select.34.1.clone.1 = bf16[52,52]{1,0} select(pred[52,52]{1,0} %compare.40.1.clone.1, bf16[52,52]{1,0} %convert.1505.5.clone.1, bf16[52,52]{1,0} %broadcast.605.1.clone.1), metadata={op_name="jit(loss)/jit(main)/select_n" source_file="/home/nicholas/programs/avid/avid/config.py" source_line=371}
  %convert.1507.5 = f32[52,52]{1,0} convert(bf16[52,52]{1,0} %select.34.1.clone.1)
  %negate.34.5 = f32[52,52]{1,0} negate(f32[52,52]{1,0} %convert.1507.5), metadata={op_name="jit(loss)/jit(main)/neg" source_file="/home/nicholas/programs/avid/avid/config.py" source_line=371}
  %add.248.5 = f32[52,52]{1,0} add(f32[52,52]{1,0} %convert.1506.5, f32[52,52]{1,0} %negate.34.5), metadata={op_name="jit(loss)/jit(main)/add_any" source_file="/home/nicholas/programs/avid/avid/config.py" source_line=371}
  %reduce.773.1 = f32[52]{0} reduce(f32[52,52]{1,0} %add.248.5, f32[] %convert.1640.41.clone.1), dimensions={1}, to_apply=%region_18.769.clone, metadata={op_name="jit(loss)/jit(main)/reduce_sum[axes=(1,)]" source_file="/home/nicholas/programs/avid/avid/config.py" source_line=371}
  %multiply.353.3.clone.1 = f32[52,52]{1,0} multiply(f32[52,52]{1,0} %minimum.2.31.clone.1, f32[52,52]{1,0} %minimum.2.31.clone.1), metadata={op_name="jit(loss)/jit(main)/integer_pow[y=2]" source_file="/home/nicholas/programs/avid/avid/config.py" source_line=371}
  %constant_47_2_clone_1 = bf16[] constant(0.5)
  %convert.1638.1.clone.1 = f32[] convert(bf16[] %constant_47_2_clone_1)
  %broadcast.681.3.clone.1 = f32[52,52]{1,0} broadcast(f32[] %convert.1638.1.clone.1), dimensions={}
  %multiply.354.3.clone.1 = f32[52,52]{1,0} multiply(f32[52,52]{1,0} %multiply.353.3.clone.1, f32[52,52]{1,0} %broadcast.681.3.clone.1), metadata={op_name="jit(loss)/jit(main)/mul" source_file="/home/nicholas/programs/avid/avid/config.py" source_line=371}
  %subtract.40.7.clone.1 = f32[52,52]{1,0} subtract(f32[52,52]{1,0} %abs.2.43.clone.1, f32[52,52]{1,0} %minimum.2.31.clone.1), metadata={op_name="jit(loss)/jit(main)/sub" source_file="/home/nicholas/programs/avid/avid/config.py" source_line=371}
  %multiply.355.5.clone.1 = f32[52,52]{1,0} multiply(f32[52,52]{1,0} %subtract.40.7.clone.1, f32[52,52]{1,0} %broadcast.679.30.clone.1), metadata={op_name="jit(loss)/jit(main)/mul" source_file="/home/nicholas/programs/avid/avid/config.py" source_line=371}
  %add.245.3.clone.1 = f32[52,52]{1,0} add(f32[52,52]{1,0} %multiply.354.3.clone.1, f32[52,52]{1,0} %multiply.355.5.clone.1), metadata={op_name="jit(loss)/jit(main)/add" source_file="/home/nicholas/programs/avid/avid/config.py" source_line=371}
  %constant_59_2_clone_1 = bf16[] constant(10)
  %convert.1639.1.clone.1 = f32[] convert(bf16[] %constant_59_2_clone_1)
  %broadcast.683.1.clone.1 = f32[52,52]{1,0} broadcast(f32[] %convert.1639.1.clone.1), dimensions={}
  %multiply.357.1.clone.1 = f32[52,52]{1,0} multiply(f32[52,52]{1,0} %add.245.3.clone.1, f32[52,52]{1,0} %broadcast.683.1.clone.1), metadata={op_name="jit(loss)/jit(main)/div" source_file="/home/nicholas/programs/avid/avid/config.py" source_line=371}
  ROOT %tuple.53 = (f32[52]{0}, bf16[52,52]{1,0}, bf16[52,52]{1,0}, f32[52,52]{1,0}) tuple(f32[52]{0} %reduce.773.1, bf16[52,52]{1,0} %select.33.1.clone.1, bf16[52,52]{1,0} %select.34.1.clone.1, f32[52,52]{1,0} %multiply.357.1.clone.1)
}

%region_18.769.clone.3 (Arg_0.6.0: f32[], Arg_1.6.0: f32[]) -> f32[] {
  %Arg_1.6.0 = f32[] parameter(1)
  %Arg_0.6.0 = f32[] parameter(0)
  ROOT %add.195.0 = f32[] add(f32[] %Arg_0.6.0, f32[] %Arg_1.6.0), metadata={op_name="jit(loss)/jit(main)/reduce_sum[axes=(1,)]" source_file="/home/nicholas/programs/avid/avid/config.py" source_line=371}
}

%fused_reduce.30 (param_0.878: f32[512,256,52]) -> f32[512,256] {
  %param_0.878 = f32[512,256,52]{2,1,0} parameter(0)
  %constant_55_8 = bf16[] constant(0)
  %convert.1640.5 = f32[] convert(bf16[] %constant_55_8)
  ROOT %reduce.76.1 = f32[512,256]{1,0} reduce(f32[512,256,52]{2,1,0} %param_0.878, f32[] %convert.1640.5), dimensions={2}, to_apply=%region_18.769.clone.3
}

%region_18.769.clone.7 (Arg_0.10.0: f32[], Arg_1.10.0: f32[]) -> f32[] {
  %Arg_1.10.0 = f32[] parameter(1)
  %Arg_0.10.0 = f32[] parameter(0)
  ROOT %add.197.0 = f32[] add(f32[] %Arg_0.10.0, f32[] %Arg_1.10.0), metadata={op_name="jit(loss)/jit(main)/reduce_sum[axes=(1,)]" source_file="/home/nicholas/programs/avid/avid/config.py" source_line=371}
}

%fused_reduce.31 (param_0.882: f32[512,256,52]) -> f32[512,256] {
  %param_0.882 = f32[512,256,52]{2,1,0} parameter(0)
  %constant_55_12 = bf16[] constant(0)
  %convert.1640.9 = f32[] convert(bf16[] %constant_55_12)
  ROOT %reduce.78.1 = f32[512,256]{1,0} reduce(f32[512,256,52]{2,1,0} %param_0.882, f32[] %convert.1640.9), dimensions={2}, to_apply=%region_18.769.clone.7
}

%region_18.769.clone.10 (Arg_0.13.0: f32[], Arg_1.13.0: f32[]) -> f32[] {
  %Arg_1.13.0 = f32[] parameter(1)
  %Arg_0.13.0 = f32[] parameter(0)
  ROOT %add.190.0 = f32[] add(f32[] %Arg_0.13.0, f32[] %Arg_1.13.0), metadata={op_name="jit(loss)/jit(main)/reduce_sum[axes=(1,)]" source_file="/home/nicholas/programs/avid/avid/config.py" source_line=371}
}

%region_18.769.clone.12 (Arg_0.15.0: f32[], Arg_1.15.0: f32[]) -> f32[] {
  %Arg_1.15.0 = f32[] parameter(1)
  %Arg_0.15.0 = f32[] parameter(0)
  ROOT %add.200.0 = f32[] add(f32[] %Arg_0.15.0, f32[] %Arg_1.15.0), metadata={op_name="jit(loss)/jit(main)/reduce_sum[axes=(1,)]" source_file="/home/nicholas/programs/avid/avid/config.py" source_line=371}
}

%region_18.769.clone.6 (Arg_0.9.0: f32[], Arg_1.9.0: f32[]) -> f32[] {
  %Arg_1.9.0 = f32[] parameter(1)
  %Arg_0.9.0 = f32[] parameter(0)
  ROOT %add.188.0 = f32[] add(f32[] %Arg_0.9.0, f32[] %Arg_1.9.0), metadata={op_name="jit(loss)/jit(main)/reduce_sum[axes=(1,)]" source_file="/home/nicholas/programs/avid/avid/config.py" source_line=371}
}

%region_18.769.clone.16 (Arg_0.19.0: f32[], Arg_1.19.0: f32[]) -> f32[] {
  %Arg_1.19.0 = f32[] parameter(1)
  %Arg_0.19.0 = f32[] parameter(0)
  ROOT %add.192.0 = f32[] add(f32[] %Arg_0.19.0, f32[] %Arg_1.19.0), metadata={op_name="jit(loss)/jit(main)/reduce_sum[axes=(1,)]" source_file="/home/nicholas/programs/avid/avid/config.py" source_line=371}
}

%region_18.769.clone.20 (Arg_0.23.0: f32[], Arg_1.23.0: f32[]) -> f32[] {
  %Arg_1.23.0 = f32[] parameter(1)
  %Arg_0.23.0 = f32[] parameter(0)
  ROOT %add.194.0 = f32[] add(f32[] %Arg_0.23.0, f32[] %Arg_1.23.0), metadata={op_name="jit(loss)/jit(main)/reduce_sum[axes=(1,)]" source_file="/home/nicholas/programs/avid/avid/config.py" source_line=371}
}

%fused_reduce.32 (param_0.885: f32[52,4,64], param_1.1548: f32[52,4,64], param_2.980: f32[52,4,64], param_3.662: f32[52,4,64], param_4.452: f32[52,4,64]) -> (f32[4,64], f32[4,64], f32[4,64], f32[4,64], f32[4,64]) {
  %param_0.885 = f32[52,4,64]{2,1,0} parameter(0)
  %constant_55_15 = bf16[] constant(0)
  %convert.1640.12 = f32[] convert(bf16[] %constant_55_15)
  %reduce.1251.1 = f32[4,64]{1,0} reduce(f32[52,4,64]{2,1,0} %param_0.885, f32[] %convert.1640.12), dimensions={0}, to_apply=%region_18.769.clone.10, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/MultiHeadDotProductAttention_0/query/reduce_sum[axes=(0, 1)]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %param_1.1548 = f32[52,4,64]{2,1,0} parameter(1)
  %reduce.1199.1.clone.1 = f32[4,64]{1,0} reduce(f32[52,4,64]{2,1,0} %param_1.1548, f32[] %convert.1640.12), dimensions={0}, to_apply=%region_18.769.clone.12, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/MultiHeadDotProductAttention_0/value/reduce_sum[axes=(0, 1)]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %param_2.980 = f32[52,4,64]{2,1,0} parameter(2)
  %reduce.1239.1.clone.1 = f32[4,64]{1,0} reduce(f32[52,4,64]{2,1,0} %param_2.980, f32[] %convert.1640.12), dimensions={0}, to_apply=%region_18.769.clone.6, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/MultiHeadDotProductAttention_0/key/reduce_sum[axes=(0, 1)]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %param_3.662 = f32[52,4,64]{2,1,0} parameter(3)
  %reduce.1006.1.clone.1 = f32[4,64]{1,0} reduce(f32[52,4,64]{2,1,0} %param_3.662, f32[] %convert.1640.12), dimensions={0}, to_apply=%region_18.769.clone.16, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/MultiHeadDotProductAttention_0/key/reduce_sum[axes=(0, 1)]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %param_4.452 = f32[52,4,64]{2,1,0} parameter(4)
  %reduce.1018.1.clone.1 = f32[4,64]{1,0} reduce(f32[52,4,64]{2,1,0} %param_4.452, f32[] %convert.1640.12), dimensions={0}, to_apply=%region_18.769.clone.20, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/MultiHeadDotProductAttention_0/query/reduce_sum[axes=(0, 1)]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  ROOT %tuple.82 = (f32[4,64]{1,0}, f32[4,64]{1,0}, f32[4,64]{1,0}, f32[4,64]{1,0}, f32[4,64]{1,0}) tuple(f32[4,64]{1,0} %reduce.1251.1, f32[4,64]{1,0} %reduce.1199.1.clone.1, f32[4,64]{1,0} %reduce.1239.1.clone.1, f32[4,64]{1,0} %reduce.1006.1.clone.1, f32[4,64]{1,0} %reduce.1018.1.clone.1)
}

%region_18.769.clone.13 (Arg_0.16.0: f32[], Arg_1.16.0: f32[]) -> f32[] {
  %Arg_1.16.0 = f32[] parameter(1)
  %Arg_0.16.0 = f32[] parameter(0)
  ROOT %add.201.0 = f32[] add(f32[] %Arg_0.16.0, f32[] %Arg_1.16.0), metadata={op_name="jit(loss)/jit(main)/reduce_sum[axes=(1,)]" source_file="/home/nicholas/programs/avid/avid/config.py" source_line=371}
}

%fused_reduce.33 (param_0.888: f32[512,256,52]) -> f32[512,256] {
  %param_0.888 = f32[512,256,52]{2,1,0} parameter(0)
  %constant_55_18 = bf16[] constant(0)
  %convert.1640.15 = f32[] convert(bf16[] %constant_55_18)
  ROOT %reduce.90.1 = f32[512,256]{1,0} reduce(f32[512,256,52]{2,1,0} %param_0.888, f32[] %convert.1640.15), dimensions={2}, to_apply=%region_18.769.clone.13
}

%region_18.769.clone.17 (Arg_0.20.0: f32[], Arg_1.20.0: f32[]) -> f32[] {
  %Arg_1.20.0 = f32[] parameter(1)
  %Arg_0.20.0 = f32[] parameter(0)
  ROOT %add.203.0 = f32[] add(f32[] %Arg_0.20.0, f32[] %Arg_1.20.0), metadata={op_name="jit(loss)/jit(main)/reduce_sum[axes=(1,)]" source_file="/home/nicholas/programs/avid/avid/config.py" source_line=371}
}

%fused_reduce.34 (param_0.892: f32[512,256,52]) -> f32[512,256] {
  %param_0.892 = f32[512,256,52]{2,1,0} parameter(0)
  %constant_55_22 = bf16[] constant(0)
  %convert.1640.19 = f32[] convert(bf16[] %constant_55_22)
  ROOT %reduce.92.1 = f32[512,256]{1,0} reduce(f32[512,256,52]{2,1,0} %param_0.892, f32[] %convert.1640.19), dimensions={2}, to_apply=%region_18.769.clone.17
}

%region_18.769.clone.22 (Arg_0.25.0: f32[], Arg_1.25.0: f32[]) -> f32[] {
  %Arg_1.25.0 = f32[] parameter(1)
  %Arg_0.25.0 = f32[] parameter(0)
  ROOT %add.207.0 = f32[] add(f32[] %Arg_0.25.0, f32[] %Arg_1.25.0), metadata={op_name="jit(loss)/jit(main)/reduce_sum[axes=(1,)]" source_file="/home/nicholas/programs/avid/avid/config.py" source_line=371}
}

%fused_reduce.35 (param_0.897: f32[52,4,64]) -> f32[4,64] {
  %param_0.897 = f32[52,4,64]{2,1,0} parameter(0)
  %constant_55_27 = bf16[] constant(0)
  %convert.1640.24 = f32[] convert(bf16[] %constant_55_27)
  ROOT %reduce.966.1 = f32[4,64]{1,0} reduce(f32[52,4,64]{2,1,0} %param_0.897, f32[] %convert.1640.24), dimensions={0}, to_apply=%region_18.769.clone.22, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/MultiHeadDotProductAttention_0/value/reduce_sum[axes=(0, 1)]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
}

%region_18.769.clone.24 (Arg_0.27.0: f32[], Arg_1.27.0: f32[]) -> f32[] {
  %Arg_1.27.0 = f32[] parameter(1)
  %Arg_0.27.0 = f32[] parameter(0)
  ROOT %add.208.0 = f32[] add(f32[] %Arg_0.27.0, f32[] %Arg_1.27.0), metadata={op_name="jit(loss)/jit(main)/reduce_sum[axes=(1,)]" source_file="/home/nicholas/programs/avid/avid/config.py" source_line=371}
}

%fused_reduce.36 (param_0.899: f32[512,256,52]) -> f32[512,256] {
  %param_0.899 = f32[512,256,52]{2,1,0} parameter(0)
  %constant_55_29 = bf16[] constant(0)
  %convert.1640.26 = f32[] convert(bf16[] %constant_55_29)
  ROOT %reduce.96.1 = f32[512,256]{1,0} reduce(f32[512,256,52]{2,1,0} %param_0.899, f32[] %convert.1640.26), dimensions={2}, to_apply=%region_18.769.clone.24
}

%region_18.769.clone.25 (Arg_0.28.0: f32[], Arg_1.28.0: f32[]) -> f32[] {
  %Arg_1.28.0 = f32[] parameter(1)
  %Arg_0.28.0 = f32[] parameter(0)
  ROOT %add.209.0 = f32[] add(f32[] %Arg_0.28.0, f32[] %Arg_1.28.0), metadata={op_name="jit(loss)/jit(main)/reduce_sum[axes=(1,)]" source_file="/home/nicholas/programs/avid/avid/config.py" source_line=371}
}

%fused_convert_reduce (param_0.900: f32[512,256]) -> (f32[256], bf16[512,256]) {
  %param_0.900 = f32[512,256]{1,0} parameter(0)
  %constant_55_30 = bf16[] constant(0)
  %convert.1640.27 = f32[] convert(bf16[] %constant_55_30)
  %reduce.1336.1 = f32[256]{0} reduce(f32[512,256]{1,0} %param_0.900, f32[] %convert.1640.27), dimensions={0}, to_apply=%region_18.769.clone.25, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/im_embed/vmap(inner)/vmap(Patchify_0)/patch_proj/reduce_sum[axes=(0, 1)]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=40}
  %convert.1601.1 = bf16[512,256]{1,0} convert(f32[512,256]{1,0} %param_0.900)
  ROOT %tuple.19 = (f32[256]{0}, bf16[512,256]{1,0}) tuple(f32[256]{0} %reduce.1336.1, bf16[512,256]{1,0} %convert.1601.1)
}

%region_18.769.clone.28 (Arg_0.31.0: f32[], Arg_1.31.0: f32[]) -> f32[] {
  %Arg_1.31.0 = f32[] parameter(1)
  %Arg_0.31.0 = f32[] parameter(0)
  ROOT %add.212.0 = f32[] add(f32[] %Arg_0.31.0, f32[] %Arg_1.31.0), metadata={op_name="jit(loss)/jit(main)/reduce_sum[axes=(1,)]" source_file="/home/nicholas/programs/avid/avid/config.py" source_line=371}
}

%fused_reduce.37 (param_0.902: f32[3510,64]) -> f32[64] {
  %param_0.902 = f32[3510,64]{1,0} parameter(0)
  %constant_55_32 = bf16[] constant(0)
  %convert.1640.29 = f32[] convert(bf16[] %constant_55_32)
  ROOT %reduce.1369.1 = f32[64]{0} reduce(f32[3510,64]{1,0} %param_0.902, f32[] %convert.1640.29), dimensions={0}, to_apply=%region_18.769.clone.28, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/spec_embed/vmap(vmap(vmap(species_embed)))/embed_module/Dense_0/reduce_sum[axes=(0, 1, 2)]" source_file="/home/nicholas/programs/avid/avid/layers.py" source_line=49}
}

%fused_reduce.38 (param_0.1337: f32[512,256,52], param_1.1431: f32[256], param_2.852: f32[1,512,52], param_3.585: f32[512,52], param_4.367: bf16[512,256], param_5.292: bf16[512,256,52]) -> (f32[512,52], f32[512,52]) {
  %param_0.1337 = f32[512,256,52]{2,1,0} parameter(0)
  %param_2.852 = f32[1,512,52]{2,1,0} parameter(2)
  %bitcast.4750.23 = f32[512,52]{1,0} bitcast(f32[1,512,52]{2,1,0} %param_2.852)
  %broadcast.559.23 = f32[512,256,52]{2,1,0} broadcast(f32[512,52]{1,0} %bitcast.4750.23), dimensions={0,2}, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/LayerNorm_0/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
  %param_1.1431 = f32[256]{0} parameter(1)
  %broadcast.560.20 = f32[512,256,52]{2,1,0} broadcast(f32[256]{0} %param_1.1431), dimensions={1}, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/LayerNorm_0/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
  %multiply.319.17 = f32[512,256,52]{2,1,0} multiply(f32[512,256,52]{2,1,0} %broadcast.559.23, f32[512,256,52]{2,1,0} %broadcast.560.20), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/LayerNorm_0/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
  %multiply.429.7 = f32[512,256,52]{2,1,0} multiply(f32[512,256,52]{2,1,0} %param_0.1337, f32[512,256,52]{2,1,0} %multiply.319.17), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/LayerNorm_0/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
  %constant_68_28 = f32[] constant(0)
  %reduce.50.3 = f32[512,52]{1,0} reduce(f32[512,256,52]{2,1,0} %multiply.429.7, f32[] %constant_68_28), dimensions={1}, to_apply=%region_2.202
  %negate.46.1 = f32[512,52]{1,0} negate(f32[512,52]{1,0} %reduce.50.3), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/LayerNorm_0/neg" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
  %param_5.292 = bf16[512,256,52]{2,1,0} parameter(5)
  %convert.1407.19.clone.1 = f32[512,256,52]{2,1,0} convert(bf16[512,256,52]{2,1,0} %param_5.292)
  %param_4.367 = bf16[512,256]{1,0} parameter(4)
  %convert.1617.10.clone.1 = f32[512,256]{1,0} convert(bf16[512,256]{1,0} %param_4.367)
  %broadcast.654.19.clone.1 = f32[512,256,52]{2,1,0} broadcast(f32[512,256]{1,0} %convert.1617.10.clone.1), dimensions={0,1}, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/im_embed/vmap(inner)/pos_embed/add" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=64}
  %add.217.19.clone.1 = f32[512,256,52]{2,1,0} add(f32[512,256,52]{2,1,0} %convert.1407.19.clone.1, f32[512,256,52]{2,1,0} %broadcast.654.19.clone.1), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/im_embed/vmap(inner)/pos_embed/add" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=64}
  %param_3.585 = f32[512,52]{1,0} parameter(3)
  %broadcast.556.9.clone.1 = f32[512,256,52]{2,1,0} broadcast(f32[512,52]{1,0} %param_3.585), dimensions={0,2}, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/LayerNorm_0/sub" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
  %subtract.28.9.clone.1 = f32[512,256,52]{2,1,0} subtract(f32[512,256,52]{2,1,0} %add.217.19.clone.1, f32[512,256,52]{2,1,0} %broadcast.556.9.clone.1), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/LayerNorm_0/sub" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
  %multiply.423.3.clone.1 = f32[512,256,52]{2,1,0} multiply(f32[512,256,52]{2,1,0} %subtract.28.9.clone.1, f32[512,256,52]{2,1,0} %param_0.1337), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/LayerNorm_0/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
  %multiply.430.3.clone.1 = f32[512,256,52]{2,1,0} multiply(f32[512,256,52]{2,1,0} %multiply.423.3.clone.1, f32[512,256,52]{2,1,0} %broadcast.560.20), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/LayerNorm_0/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
  %reduce.49.1.clone.1 = f32[512,52]{1,0} reduce(f32[512,256,52]{2,1,0} %multiply.430.3.clone.1, f32[] %constant_68_28), dimensions={1}, to_apply=%region_2.202
  ROOT %tuple.22 = (f32[512,52]{1,0}, f32[512,52]{1,0}) tuple(f32[512,52]{1,0} %negate.46.1, f32[512,52]{1,0} %reduce.49.1.clone.1)
}

%fused_reduce.39 (param_0.1336: f32[256], param_1.1430: f32[1,512,52], param_2.851: f32[256,52], param_3.607: f32[512,256,52], param_4.412: f32[512,52]) -> (f32[512,52], f32[512,52]) {
  %param_2.851 = f32[256,52]{1,0} parameter(2)
  %broadcast.615.13 = f32[512,256,52]{2,1,0} broadcast(f32[256,52]{1,0} %param_2.851), dimensions={1,2}, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/transpose[permutation=(0, 2, 1)]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=250}
  %param_1.1430 = f32[1,512,52]{2,1,0} parameter(1)
  %bitcast.5309.21 = f32[512,52]{1,0} bitcast(f32[1,512,52]{2,1,0} %param_1.1430)
  %broadcast.594.21 = f32[512,256,52]{2,1,0} broadcast(f32[512,52]{1,0} %bitcast.5309.21), dimensions={0,2}, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoder_norm/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=228}
  %param_0.1336 = f32[256]{0} parameter(0)
  %broadcast.595.18 = f32[512,256,52]{2,1,0} broadcast(f32[256]{0} %param_0.1336), dimensions={1}, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoder_norm/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=228}
  %multiply.348.15 = f32[512,256,52]{2,1,0} multiply(f32[512,256,52]{2,1,0} %broadcast.594.21, f32[512,256,52]{2,1,0} %broadcast.595.18), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoder_norm/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=228}
  %multiply.365.7 = f32[512,256,52]{2,1,0} multiply(f32[512,256,52]{2,1,0} %broadcast.615.13, f32[512,256,52]{2,1,0} %multiply.348.15), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoder_norm/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=228}
  %constant_68_27 = f32[] constant(0)
  %reduce.33.3 = f32[512,52]{1,0} reduce(f32[512,256,52]{2,1,0} %multiply.365.7, f32[] %constant_68_27), dimensions={1}, to_apply=%region_2.202
  %negate.36.1 = f32[512,52]{1,0} negate(f32[512,52]{1,0} %reduce.33.3), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoder_norm/neg" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=228}
  %param_3.607 = f32[512,256,52]{2,1,0} parameter(3)
  %param_4.412 = f32[512,52]{1,0} parameter(4)
  %broadcast.593.7.clone.1 = f32[512,256,52]{2,1,0} broadcast(f32[512,52]{1,0} %param_4.412), dimensions={0,2}, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoder_norm/sub" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=228}
  %subtract.38.7.clone.1 = f32[512,256,52]{2,1,0} subtract(f32[512,256,52]{2,1,0} %param_3.607, f32[512,256,52]{2,1,0} %broadcast.593.7.clone.1), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoder_norm/sub" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=228}
  %multiply.363.3.clone.1 = f32[512,256,52]{2,1,0} multiply(f32[512,256,52]{2,1,0} %subtract.38.7.clone.1, f32[512,256,52]{2,1,0} %broadcast.615.13), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoder_norm/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=228}
  %multiply.366.3.clone.1 = f32[512,256,52]{2,1,0} multiply(f32[512,256,52]{2,1,0} %multiply.363.3.clone.1, f32[512,256,52]{2,1,0} %broadcast.595.18), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoder_norm/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=228}
  %reduce.32.1.clone.1 = f32[512,52]{1,0} reduce(f32[512,256,52]{2,1,0} %multiply.366.3.clone.1, f32[] %constant_68_27), dimensions={1}, to_apply=%region_2.202
  ROOT %tuple.49 = (f32[512,52]{1,0}, f32[512,52]{1,0}) tuple(f32[512,52]{1,0} %negate.36.1, f32[512,52]{1,0} %reduce.32.1.clone.1)
}

%fused_multiply_reduce (param_0.1368: f32[52], param_1.1465: f32[256,1], param_2.945: f32[256,52]) -> (f32[256,52], f32[256,1]) {
  %param_0.1368 = f32[52]{0} parameter(0)
  %broadcast.694.3 = f32[256,52]{1,0} broadcast(f32[52]{0} %param_0.1368), dimensions={1}, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/vmap(head)/Dense_0/dot_general[dimension_numbers=(((1,), (1,)), ((), ())) precision=None preferred_element_type=None]" source_file="/home/nicholas/programs/avid/avid/layers.py" source_line=49}
  %param_1.1465 = f32[256,1]{1,0} parameter(1)
  %convert.1486.1 = bf16[256,1]{1,0} convert(f32[256,1]{1,0} %param_1.1465), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/vmap(head)/Dense_0/convert_element_type[new_dtype=bfloat16 weak_type=False]" source_file="/home/nicholas/programs/avid/avid/layers.py" source_line=49}
  %bitcast.5337.8 = bf16[256]{0} bitcast(bf16[256,1]{1,0} %convert.1486.1)
  %convert.1633.5 = f32[256]{0} convert(bf16[256]{0} %bitcast.5337.8)
  %broadcast.717.3 = f32[256,52]{1,0} broadcast(f32[256]{0} %convert.1633.5), dimensions={0}, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/vmap(head)/Dense_0/dot_general[dimension_numbers=(((1,), (0,)), ((), ())) precision=None preferred_element_type=None]" source_file="/home/nicholas/programs/avid/avid/layers.py" source_line=49}
  %multiply.361.3 = f32[256,52]{1,0} multiply(f32[256,52]{1,0} %broadcast.694.3, f32[256,52]{1,0} %broadcast.717.3), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/vmap(head)/Dense_0/dot_general[dimension_numbers=(((1,), (1,)), ((), ())) precision=None preferred_element_type=None]" source_file="/home/nicholas/programs/avid/avid/layers.py" source_line=49}
  %constant_56_1 = f32[] constant(0.001953125)
  %broadcast.597.1 = f32[256,52]{1,0} broadcast(f32[] %constant_56_1), dimensions={}
  %multiply.362.1 = f32[256,52]{1,0} multiply(f32[256,52]{1,0} %multiply.361.3, f32[256,52]{1,0} %broadcast.597.1), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/div" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=250}
  %param_2.945 = f32[256,52]{1,0} parameter(2)
  %broadcast.728.3.clone.1 = f32[52]{0} broadcast(f32[] %constant_56_1), dimensions={}
  %multiply.444.3.clone.1 = f32[52]{0} multiply(f32[52]{0} %param_0.1368, f32[52]{0} %broadcast.728.3.clone.1)
  %broadcast.731.7.clone.1 = f32[256,52]{1,0} broadcast(f32[52]{0} %multiply.444.3.clone.1), dimensions={1}
  %multiply.428.7.clone.1 = f32[256,52]{1,0} multiply(f32[256,52]{1,0} %param_2.945, f32[256,52]{1,0} %broadcast.731.7.clone.1)
  %constant_68_7_clone_1 = f32[] constant(0)
  %reduce.12.5.clone.1 = f32[256]{0} reduce(f32[256,52]{1,0} %multiply.428.7.clone.1, f32[] %constant_68_7_clone_1), dimensions={1}, to_apply=%region_2.202
  %convert.1592.3.clone.1 = bf16[256]{0} convert(f32[256]{0} %reduce.12.5.clone.1), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/vmap(head)/Dense_0/dot_general[dimension_numbers=(((0,), (0,)), ((), ())) precision=None preferred_element_type=None]" source_file="/home/nicholas/programs/avid/avid/layers.py" source_line=49}
  %bitcast.6601.1.clone.1 = bf16[256,1]{1,0} bitcast(bf16[256]{0} %convert.1592.3.clone.1)
  %convert.1593.1.clone.1 = f32[256,1]{1,0} convert(bf16[256,1]{1,0} %bitcast.6601.1.clone.1), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/vmap(head)/Dense_0/convert_element_type[new_dtype=float32 weak_type=False]" source_file="/home/nicholas/programs/avid/avid/layers.py" source_line=49}
  ROOT %tuple.50 = (f32[256,52]{1,0}, f32[256,1]{1,0}) tuple(f32[256,52]{1,0} %multiply.362.1, f32[256,1]{1,0} %convert.1593.1.clone.1)
}

%fused_gather (param_0.1203: s32[260,1], param_1.1298: f32[56,63]) -> bf16[260,1,63] {
  %param_1.1298 = f32[56,63]{1,0} parameter(1)
  %convert.1393.1 = bf16[56,63]{1,0} convert(f32[56,63]{1,0} %param_1.1298), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/spec_embed/vmap(vmap(vmap(species_embed)))/species_embed/convert_element_type[new_dtype=bfloat16 weak_type=False]" source_file="/home/nicholas/programs/avid/avid/encoder.py" source_line=36}
  %param_0.1203 = s32[260,1]{1,0} parameter(0)
  ROOT %gather.5.1 = bf16[260,1,63]{2,1,0} gather(bf16[56,63]{1,0} %convert.1393.1, s32[260,1]{1,0} %param_0.1203), offset_dims={1,2}, collapsed_slice_dims={}, start_index_map={0}, index_vector_dim=1, slice_sizes={1,63}, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/spec_embed/vmap(vmap(vmap(species_embed)))/species_embed/jit(_take)/gather[dimension_numbers=GatherDimensionNumbers(offset_dims=(2,), collapsed_slice_dims=(0,), start_index_map=(0,)) slice_sizes=(1, 63) unique_indices=False indices_are_sorted=False mode=GatherScatterMode.PROMISE_IN_BOUNDS fill_value=None]" source_file="/home/nicholas/programs/avid/avid/encoder.py" source_line=36}
}

%fused_convert.16 (param_0.1267: f32[]) -> bf16[] {
  %param_0.1267 = f32[] parameter(0)
  %constant_61_1 = f32[] constant(0.00036982249)
  %multiply.358.1 = f32[] multiply(f32[] %param_0.1267, f32[] %constant_61_1), metadata={op_name="jit(loss)/jit(main)/div" source_file="/home/nicholas/programs/avid/avid/config.py" source_line=372}
  ROOT %convert.1497.1 = bf16[] convert(f32[] %multiply.358.1), metadata={op_name="jit(loss)/jit(main)/convert_element_type[new_dtype=bfloat16 weak_type=False]" source_file="/home/nicholas/programs/avid/avid/config.py" source_line=372}
}

%fused_reduce.40 (param_0.1315: f32[256,52], param_1.1466: f32[256,1]) -> f32[52] {
  %param_0.1315 = f32[256,52]{1,0} parameter(0)
  %param_1.1466 = f32[256,1]{1,0} parameter(1)
  %convert.1486.5 = bf16[256,1]{1,0} convert(f32[256,1]{1,0} %param_1.1466), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/vmap(head)/Dense_0/convert_element_type[new_dtype=bfloat16 weak_type=False]" source_file="/home/nicholas/programs/avid/avid/layers.py" source_line=49}
  %bitcast.5337.12 = bf16[256]{0} bitcast(bf16[256,1]{1,0} %convert.1486.5)
  %convert.1633.9 = f32[256]{0} convert(bf16[256]{0} %bitcast.5337.12)
  %constant_56_2 = f32[] constant(0.001953125)
  %broadcast.672.5 = f32[256]{0} broadcast(f32[] %constant_56_2), dimensions={}
  %multiply.442.5 = f32[256]{0} multiply(f32[256]{0} %convert.1633.9, f32[256]{0} %broadcast.672.5)
  %broadcast.673.3 = f32[256,52]{1,0} broadcast(f32[256]{0} %multiply.442.5), dimensions={0}
  %multiply.351.3 = f32[256,52]{1,0} multiply(f32[256,52]{1,0} %param_0.1315, f32[256,52]{1,0} %broadcast.673.3)
  %constant_68_6 = f32[] constant(0)
  ROOT %reduce.8.1 = f32[52]{0} reduce(f32[256,52]{1,0} %multiply.351.3, f32[] %constant_68_6), dimensions={0}, to_apply=%region_2.202
}

%fused_broadcast () -> bf16[56,63] {
  %constant_55_1 = bf16[] constant(0)
  ROOT %broadcast.648.1 = bf16[56,63]{1,0} broadcast(bf16[] %constant_55_1), dimensions={}, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/spec_embed/vmap(vmap(vmap(species_embed)))/species_embed/jit(_take)/broadcast_in_dim[shape=(56, 63) broadcast_dimensions=()]" source_file="/home/nicholas/programs/avid/avid/encoder.py" source_line=36}
}

%region_18.769.clone.8 (Arg_0.11.0: f32[], Arg_1.11.0: f32[]) -> f32[] {
  %Arg_1.11.0 = f32[] parameter(1)
  %Arg_0.11.0 = f32[] parameter(0)
  ROOT %add.198.0 = f32[] add(f32[] %Arg_0.11.0, f32[] %Arg_1.11.0), metadata={op_name="jit(loss)/jit(main)/reduce_sum[axes=(1,)]" source_file="/home/nicholas/programs/avid/avid/config.py" source_line=371}
}

%region_18.769.clone.4 (Arg_0.7.0: f32[], Arg_1.7.0: f32[]) -> f32[] {
  %Arg_1.7.0 = f32[] parameter(1)
  %Arg_0.7.0 = f32[] parameter(0)
  ROOT %add.196.0 = f32[] add(f32[] %Arg_0.7.0, f32[] %Arg_1.7.0), metadata={op_name="jit(loss)/jit(main)/reduce_sum[axes=(1,)]" source_file="/home/nicholas/programs/avid/avid/config.py" source_line=371}
}

%region_18.769.clone.14 (Arg_0.17.0: f32[], Arg_1.17.0: f32[]) -> f32[] {
  %Arg_1.17.0 = f32[] parameter(1)
  %Arg_0.17.0 = f32[] parameter(0)
  ROOT %add.202.0 = f32[] add(f32[] %Arg_0.17.0, f32[] %Arg_1.17.0), metadata={op_name="jit(loss)/jit(main)/reduce_sum[axes=(1,)]" source_file="/home/nicholas/programs/avid/avid/config.py" source_line=371}
}

%region_18.769.clone.18 (Arg_0.21.0: f32[], Arg_1.21.0: f32[]) -> f32[] {
  %Arg_1.21.0 = f32[] parameter(1)
  %Arg_0.21.0 = f32[] parameter(0)
  ROOT %add.204.0 = f32[] add(f32[] %Arg_0.21.0, f32[] %Arg_1.21.0), metadata={op_name="jit(loss)/jit(main)/reduce_sum[axes=(1,)]" source_file="/home/nicholas/programs/avid/avid/config.py" source_line=371}
}

%fused_reduce.41 (param_0.1332: f32[512,256], param_1.1547: f32[512,256], param_2.977: f32[512,256], param_3.659: f32[512,256], param_4.449: f32[512,256]) -> (f32[256], f32[256], f32[256], f32[256], f32[256]) {
  %param_0.1332 = f32[512,256]{1,0} parameter(0)
  %constant_68_23 = f32[] constant(0)
  %reduce.802.1 = f32[256]{0} reduce(f32[512,256]{1,0} %param_0.1332, f32[] %constant_68_23), dimensions={0}, to_apply=%region_2.202, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoder_norm/reduce_sum[axes=(0, 1)]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=228}
  %param_1.1547 = f32[512,256]{1,0} parameter(1)
  %constant_55_13_clone_1 = bf16[] constant(0)
  %convert.1640.10.clone.1 = f32[] convert(bf16[] %constant_55_13_clone_1)
  %reduce.1185.1.clone.1 = f32[256]{0} reduce(f32[512,256]{1,0} %param_1.1547, f32[] %convert.1640.10.clone.1), dimensions={0}, to_apply=%region_18.769.clone.8, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/MultiHeadDotProductAttention_0/out/reduce_sum[axes=(0, 1)]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %param_2.977 = f32[512,256]{1,0} parameter(2)
  %reduce.1096.1.clone.1 = f32[256]{0} reduce(f32[512,256]{1,0} %param_2.977, f32[] %convert.1640.10.clone.1), dimensions={0}, to_apply=%region_18.769.clone.4, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/vmap(vmap(LazyInMLP_0))/Dense_0/reduce_sum[axes=(0, 1)]" source_file="/home/nicholas/programs/avid/avid/layers.py" source_line=49}
  %param_3.659 = f32[512,256]{1,0} parameter(3)
  %reduce.863.1.clone.1 = f32[256]{0} reduce(f32[512,256]{1,0} %param_3.659, f32[] %convert.1640.10.clone.1), dimensions={0}, to_apply=%region_18.769.clone.14, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/vmap(vmap(LazyInMLP_0))/Dense_0/reduce_sum[axes=(0, 1)]" source_file="/home/nicholas/programs/avid/avid/layers.py" source_line=49}
  %param_4.449 = f32[512,256]{1,0} parameter(4)
  %reduce.952.1.clone.1 = f32[256]{0} reduce(f32[512,256]{1,0} %param_4.449, f32[] %convert.1640.10.clone.1), dimensions={0}, to_apply=%region_18.769.clone.18, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/MultiHeadDotProductAttention_0/out/reduce_sum[axes=(0, 1)]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  ROOT %tuple.78 = (f32[256]{0}, f32[256]{0}, f32[256]{0}, f32[256]{0}, f32[256]{0}) tuple(f32[256]{0} %reduce.802.1, f32[256]{0} %reduce.1185.1.clone.1, f32[256]{0} %reduce.1096.1.clone.1, f32[256]{0} %reduce.863.1.clone.1, f32[256]{0} %reduce.952.1.clone.1)
}

%fused_reduce.42 (param_0.1333: f32[512,256], param_1.1546: f32[512,256], param_2.974: f32[512,256], param_3.656: f32[512,256], param_4.446: f32[512,256]) -> (f32[256], f32[256], f32[256], f32[256], f32[256]) {
  %param_0.1333 = f32[512,256]{1,0} parameter(0)
  %constant_68_24 = f32[] constant(0)
  %reduce.813.1 = f32[256]{0} reduce(f32[512,256]{1,0} %param_0.1333, f32[] %constant_68_24), dimensions={0}, to_apply=%region_2.202, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoder_norm/reduce_sum[axes=(0, 1)]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=228}
  %param_1.1546 = f32[512,256]{1,0} parameter(1)
  %reduce.901.1.clone.1 = f32[256]{0} reduce(f32[512,256]{1,0} %param_1.1546, f32[] %constant_68_24), dimensions={0}, to_apply=%region_2.202, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/LayerNorm_1/reduce_sum[axes=(0, 1)]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
  %param_2.974 = f32[512,256]{1,0} parameter(2)
  %reduce.1045.1.clone.1 = f32[256]{0} reduce(f32[512,256]{1,0} %param_2.974, f32[] %constant_68_24), dimensions={0}, to_apply=%region_2.202, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/LayerNorm_0/reduce_sum[axes=(0, 1)]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
  %param_3.656 = f32[512,256]{1,0} parameter(3)
  %reduce.1134.1.clone.1 = f32[256]{0} reduce(f32[512,256]{1,0} %param_3.656, f32[] %constant_68_24), dimensions={0}, to_apply=%region_2.202, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/LayerNorm_1/reduce_sum[axes=(0, 1)]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
  %param_4.446 = f32[512,256]{1,0} parameter(4)
  %reduce.1278.1.clone.1 = f32[256]{0} reduce(f32[512,256]{1,0} %param_4.446, f32[] %constant_68_24), dimensions={0}, to_apply=%region_2.202, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/LayerNorm_0/reduce_sum[axes=(0, 1)]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
  ROOT %tuple.74 = (f32[256]{0}, f32[256]{0}, f32[256]{0}, f32[256]{0}, f32[256]{0}) tuple(f32[256]{0} %reduce.813.1, f32[256]{0} %reduce.901.1.clone.1, f32[256]{0} %reduce.1045.1.clone.1, f32[256]{0} %reduce.1134.1.clone.1, f32[256]{0} %reduce.1278.1.clone.1)
}

%fused_reduce.43 (param_0.1348: f32[208,256], param_1.1545: f32[208,256], param_2.972: f32[208,256], param_3.654: f32[208,256]) -> (f32[256], f32[256], f32[256], f32[256]) {
  %param_0.1348 = f32[208,256]{1,0} parameter(0)
  %constant_68_39 = f32[] constant(0)
  %reduce.1267.1 = f32[256]{0} reduce(f32[208,256]{1,0} %param_0.1348, f32[] %constant_68_39), dimensions={0}, to_apply=%region_2.202, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/LayerNorm_0/reduce_sum[axes=(0, 1)]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
  %param_1.1545 = f32[208,256]{1,0} parameter(1)
  %reduce.1123.1.clone.1 = f32[256]{0} reduce(f32[208,256]{1,0} %param_1.1545, f32[] %constant_68_39), dimensions={0}, to_apply=%region_2.202, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/LayerNorm_1/reduce_sum[axes=(0, 1)]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
  %param_2.972 = f32[208,256]{1,0} parameter(2)
  %reduce.890.1.clone.1 = f32[256]{0} reduce(f32[208,256]{1,0} %param_2.972, f32[] %constant_68_39), dimensions={0}, to_apply=%region_2.202, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/LayerNorm_1/reduce_sum[axes=(0, 1)]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171}
  %param_3.654 = f32[208,256]{1,0} parameter(3)
  %reduce.1034.1.clone.1 = f32[256]{0} reduce(f32[208,256]{1,0} %param_3.654, f32[] %constant_68_39), dimensions={0}, to_apply=%region_2.202, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/LayerNorm_0/reduce_sum[axes=(0, 1)]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
  ROOT %tuple.70 = (f32[256]{0}, f32[256]{0}, f32[256]{0}, f32[256]{0}) tuple(f32[256]{0} %reduce.1267.1, f32[256]{0} %reduce.1123.1.clone.1, f32[256]{0} %reduce.890.1.clone.1, f32[256]{0} %reduce.1034.1.clone.1)
}

%fused_convert_divide (param_0.1378: f32[52,4,512]) -> (bf16[52,4,512], f32[52,4,512], bf16[52,4,512]) {
  %constant_51_4_clone_1 = bf16[] constant(1)
  %convert.1645.1.clone.1 = f32[] convert(bf16[] %constant_51_4_clone_1)
  %broadcast.697.2.clone.1 = f32[52,4,512]{2,1,0} broadcast(f32[] %convert.1645.1.clone.1), dimensions={}
  %param_0.1378 = f32[52,4,512]{2,1,0} parameter(0)
  %multiply.418.1.clone.1 = f32[52,4,512]{2,1,0} multiply(f32[52,4,512]{2,1,0} %param_0.1378, f32[52,4,512]{2,1,0} %param_0.1378), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/MultiHeadDotProductAttention_0/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %divide.52.1.clone.1 = f32[52,4,512]{2,1,0} divide(f32[52,4,512]{2,1,0} %broadcast.697.2.clone.1, f32[52,4,512]{2,1,0} %multiply.418.1.clone.1), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/MultiHeadDotProductAttention_0/div" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %convert.1537.1 = bf16[52,4,512]{2,1,0} convert(f32[52,4,512]{2,1,0} %divide.52.1.clone.1)
  %convert.1432.1 = bf16[52,4,512]{2,1,0} convert(f32[52,4,512]{2,1,0} %param_0.1378), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/MultiHeadDotProductAttention_0/convert_element_type[new_dtype=bfloat16 weak_type=False]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  ROOT %tuple.63 = (bf16[52,4,512]{2,1,0}, f32[52,4,512]{2,1,0}, bf16[52,4,512]{2,1,0}) tuple(bf16[52,4,512]{2,1,0} %convert.1537.1, f32[52,4,512]{2,1,0} %divide.52.1.clone.1, bf16[52,4,512]{2,1,0} %convert.1432.1)
}

%fused_convert_divide.1 (param_0.1385: f32[52,4,512]) -> (bf16[52,4,512], f32[52,4,512], bf16[52,4,512]) {
  %constant_51_3_clone_1 = bf16[] constant(1)
  %convert.1645.2.clone.1 = f32[] convert(bf16[] %constant_51_3_clone_1)
  %broadcast.697.1.clone.1 = f32[52,4,512]{2,1,0} broadcast(f32[] %convert.1645.2.clone.1), dimensions={}
  %param_0.1385 = f32[52,4,512]{2,1,0} parameter(0)
  %multiply.389.1.clone.1 = f32[52,4,512]{2,1,0} multiply(f32[52,4,512]{2,1,0} %param_0.1385, f32[52,4,512]{2,1,0} %param_0.1385), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/MultiHeadDotProductAttention_0/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %divide.46.1.clone.1 = f32[52,4,512]{2,1,0} divide(f32[52,4,512]{2,1,0} %broadcast.697.1.clone.1, f32[52,4,512]{2,1,0} %multiply.389.1.clone.1), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/MultiHeadDotProductAttention_0/div" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %convert.1519.1 = bf16[52,4,512]{2,1,0} convert(f32[52,4,512]{2,1,0} %divide.46.1.clone.1)
  %convert.1470.1 = bf16[52,4,512]{2,1,0} convert(f32[52,4,512]{2,1,0} %param_0.1385), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/MultiHeadDotProductAttention_0/convert_element_type[new_dtype=bfloat16 weak_type=False]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  ROOT %tuple.58 = (bf16[52,4,512]{2,1,0}, f32[52,4,512]{2,1,0}, bf16[52,4,512]{2,1,0}) tuple(bf16[52,4,512]{2,1,0} %convert.1519.1, f32[52,4,512]{2,1,0} %divide.46.1.clone.1, bf16[52,4,512]{2,1,0} %convert.1470.1)
}

%fused_convert.17 (param_0_0: bf16[256,256], param_1_0: bf16[256,256]) -> (f32[256,256], f32[256,256]) {
  %param_0_0 = bf16[256,256]{1,0} parameter(0)
  %convert.1551.2 = f32[256,256]{1,0} convert(bf16[256,256]{1,0} %param_0_0), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/vmap(vmap(LazyInMLP_0))/Dense_0/convert_element_type[new_dtype=float32 weak_type=False]" source_file="/home/nicholas/programs/avid/avid/layers.py" source_line=49}
  %param_1_0 = bf16[256,256]{1,0} parameter(1)
  %convert.1570.2 = f32[256,256]{1,0} convert(bf16[256,256]{1,0} %param_1_0), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/vmap(vmap(LazyInMLP_0))/Dense_0/convert_element_type[new_dtype=float32 weak_type=False]" source_file="/home/nicholas/programs/avid/avid/layers.py" source_line=49}
  ROOT %tuple.66 = (f32[256,256]{1,0}, f32[256,256]{1,0}) tuple(f32[256,256]{1,0} %convert.1551.2, f32[256,256]{1,0} %convert.1570.2)
}

%fused_slice (param_0_0.1: bf16[56,63], param_1_0.1: bf16[64,64]) -> (f32[3528], f32[4096]) {
  %param_0_0.1 = bf16[56,63]{1,0} parameter(0)
  %convert.1613.2 = f32[56,63]{1,0} convert(bf16[56,63]{1,0} %param_0_0.1), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/spec_embed/vmap(vmap(vmap(species_embed)))/species_embed/convert_element_type[new_dtype=float32 weak_type=False]" source_file="/home/nicholas/programs/avid/avid/encoder.py" source_line=36}
  %reshape.2171 = f32[3528]{0} reshape(f32[56,63]{1,0} %convert.1613.2), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/spec_embed/vmap(vmap(vmap(species_embed)))/species_embed/convert_element_type[new_dtype=float32 weak_type=False]" source_file="/home/nicholas/programs/avid/avid/encoder.py" source_line=36}
  %param_1_0.1 = bf16[64,64]{1,0} parameter(1)
  %convert.1608.2 = f32[64,64]{1,0} convert(bf16[64,64]{1,0} %param_1_0.1), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/spec_embed/vmap(vmap(vmap(species_embed)))/embed_module/Dense_0/convert_element_type[new_dtype=float32 weak_type=False]" source_file="/home/nicholas/programs/avid/avid/layers.py" source_line=49}
  %reshape.2172 = f32[4096]{0} reshape(f32[64,64]{1,0} %convert.1608.2), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/spec_embed/vmap(vmap(vmap(species_embed)))/embed_module/Dense_0/convert_element_type[new_dtype=float32 weak_type=False]" source_file="/home/nicholas/programs/avid/avid/layers.py" source_line=49}
  %concatenate.5 = f32[7624]{0} concatenate(f32[3528]{0} %reshape.2171, f32[4096]{0} %reshape.2172), dimensions={0}
  %slice.27 = f32[3528]{0} slice(f32[7624]{0} %concatenate.5), slice={[0:3528]}
  %slice.28 = f32[4096]{0} slice(f32[7624]{0} %concatenate.5), slice={[3528:7624]}
  ROOT %tuple.67 = (f32[3528]{0}, f32[4096]{0}) tuple(f32[3528]{0} %slice.27, f32[4096]{0} %slice.28), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/spec_embed/vmap(vmap(vmap(species_embed)))/embed_module/Dense_0/convert_element_type[new_dtype=float32 weak_type=False]" source_file="/home/nicholas/programs/avid/avid/layers.py" source_line=49}
}

%wrapped_convert_computation (param_0.1400: f32[64,64]) -> bf16[64,64] {
  %param_0.1400 = f32[64,64]{1,0} parameter(0)
  ROOT %convert.1394.1 = bf16[64,64]{1,0} convert(f32[64,64]{1,0} %param_0.1400), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/spec_embed/vmap(vmap(vmap(species_embed)))/embed_module/Dense_0/convert_element_type[new_dtype=bfloat16 weak_type=False]" source_file="/home/nicholas/programs/avid/avid/layers.py" source_line=49}
}

%wrapped_convert_computation.1 (param_0.1401: f32[1728,256]) -> bf16[1728,256] {
  %param_0.1401 = f32[1728,256]{1,0} parameter(0)
  ROOT %convert.1402.1 = bf16[1728,256]{1,0} convert(f32[1728,256]{1,0} %param_0.1401), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/im_embed/vmap(inner)/vmap(Patchify_0)/patch_proj/convert_element_type[new_dtype=bfloat16 weak_type=False]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=40}
}

%wrapped_convert_computation.2 (param_0.1402: f32[256,4,64]) -> bf16[256,4,64] {
  %param_0.1402 = f32[256,4,64]{2,1,0} parameter(0)
  ROOT %convert.1411.1 = bf16[256,4,64]{2,1,0} convert(f32[256,4,64]{2,1,0} %param_0.1402), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/MultiHeadDotProductAttention_0/value/convert_element_type[new_dtype=bfloat16 weak_type=False]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
}

%wrapped_convert_computation.3 (param_0.1403: f32[256,4,64]) -> bf16[256,4,64] {
  %param_0.1403 = f32[256,4,64]{2,1,0} parameter(0)
  ROOT %convert.1416.1 = bf16[256,4,64]{2,1,0} convert(f32[256,4,64]{2,1,0} %param_0.1403), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/MultiHeadDotProductAttention_0/query/convert_element_type[new_dtype=bfloat16 weak_type=False]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
}

%wrapped_convert_computation.4 (param_0.1404: f32[256,4,64]) -> bf16[256,4,64] {
  %param_0.1404 = f32[256,4,64]{2,1,0} parameter(0)
  ROOT %convert.1422.1 = bf16[256,4,64]{2,1,0} convert(f32[256,4,64]{2,1,0} %param_0.1404), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/MultiHeadDotProductAttention_0/key/convert_element_type[new_dtype=bfloat16 weak_type=False]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
}

%wrapped_convert_computation.5 (param_0.1405: f32[4,64,256]) -> bf16[4,64,256] {
  %param_0.1405 = f32[4,64,256]{2,1,0} parameter(0)
  ROOT %convert.1435.1 = bf16[4,64,256]{2,1,0} convert(f32[4,64,256]{2,1,0} %param_0.1405), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/MultiHeadDotProductAttention_0/out/convert_element_type[new_dtype=bfloat16 weak_type=False]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
}

%wrapped_convert_computation.6 (param_0.1406: f32[256,256]) -> bf16[256,256] {
  %param_0.1406 = f32[256,256]{1,0} parameter(0)
  ROOT %convert.1442.1 = bf16[256,256]{1,0} convert(f32[256,256]{1,0} %param_0.1406), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/vmap(vmap(LazyInMLP_0))/Dense_0/convert_element_type[new_dtype=bfloat16 weak_type=False]" source_file="/home/nicholas/programs/avid/avid/layers.py" source_line=49}
}

%wrapped_convert_computation.7 (param_0.1407: f32[256,4,64]) -> bf16[256,4,64] {
  %param_0.1407 = f32[256,4,64]{2,1,0} parameter(0)
  ROOT %convert.1449.1 = bf16[256,4,64]{2,1,0} convert(f32[256,4,64]{2,1,0} %param_0.1407), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/MultiHeadDotProductAttention_0/value/convert_element_type[new_dtype=bfloat16 weak_type=False]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
}

%wrapped_convert_computation.8 (param_0.1408: f32[256,4,64]) -> bf16[256,4,64] {
  %param_0.1408 = f32[256,4,64]{2,1,0} parameter(0)
  ROOT %convert.1454.1 = bf16[256,4,64]{2,1,0} convert(f32[256,4,64]{2,1,0} %param_0.1408), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/MultiHeadDotProductAttention_0/query/convert_element_type[new_dtype=bfloat16 weak_type=False]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
}

%wrapped_convert_computation.9 (param_0.1409: f32[256,4,64]) -> bf16[256,4,64] {
  %param_0.1409 = f32[256,4,64]{2,1,0} parameter(0)
  ROOT %convert.1460.1 = bf16[256,4,64]{2,1,0} convert(f32[256,4,64]{2,1,0} %param_0.1409), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/MultiHeadDotProductAttention_0/key/convert_element_type[new_dtype=bfloat16 weak_type=False]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
}

%wrapped_convert_computation.10 (param_0.1410: f32[4,64,256]) -> bf16[4,64,256] {
  %param_0.1410 = f32[4,64,256]{2,1,0} parameter(0)
  ROOT %convert.1473.1 = bf16[4,64,256]{2,1,0} convert(f32[4,64,256]{2,1,0} %param_0.1410), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/MultiHeadDotProductAttention_0/out/convert_element_type[new_dtype=bfloat16 weak_type=False]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
}

%wrapped_convert_computation.11 (param_0.1411: f32[256,256]) -> bf16[256,256] {
  %param_0.1411 = f32[256,256]{1,0} parameter(0)
  ROOT %convert.1480.1 = bf16[256,256]{1,0} convert(f32[256,256]{1,0} %param_0.1411), metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/vmap(vmap(LazyInMLP_0))/Dense_0/convert_element_type[new_dtype=bfloat16 weak_type=False]" source_file="/home/nicholas/programs/avid/avid/layers.py" source_line=49}
}

%wrapped_convert_computation.12 (param_0.1412: bf16[1728,256]) -> f32[1728,256] {
  %param_0.1412 = bf16[1728,256]{1,0} parameter(0)
  ROOT %convert.1598.1 = f32[1728,256]{1,0} convert(bf16[1728,256]{1,0} %param_0.1412), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/im_embed/vmap(inner)/vmap(Patchify_0)/patch_proj/convert_element_type[new_dtype=float32 weak_type=False]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=40}
}

ENTRY %main.1412 (Arg_0.1.0: f32[256], Arg_1.2.0: f32[256], Arg_2.3.0: f32[256], Arg_3.4.0: f32[256], Arg_4.5.0: f32[256], Arg_5.6.0: f32[256], Arg_6.7.0: f32[256], Arg_7.8.0: f32[256,256], Arg_8.9.0: f32[4,64], Arg_9.10.0: f32[256,4,64], Arg_10.11.0: f32[256], Arg_11.12.0: f32[4,64,256], Arg_12.13.0: f32[4,64], Arg_13.14.0: f32[256,4,64], Arg_14.15.0: f32[4,64], Arg_15.16.0: f32[256,4,64], Arg_16.17.0: f32[256], Arg_17.18.0: f32[256], Arg_18.19.0: f32[256], Arg_19.20.0: f32[256], Arg_20.21.0: f32[256], Arg_21.22.0: f32[256,256], Arg_22.23.0: f32[4,64], Arg_23.24.0: f32[256,4,64], Arg_24.25.0: f32[256], Arg_25.26.0: f32[4,64,256], Arg_26.27.0: f32[4,64], Arg_27.28.0: f32[256,4,64], Arg_28.29.0: f32[4,64], Arg_29.30.0: f32[256,4,64], Arg_30.31.0: f32[1], Arg_31.32.0: f32[256,1], Arg_32.33.0: f32[256], Arg_33.34.0: f32[1728,256], Arg_34.35.0: bf16[512,256], Arg_35.36.0: f32[64], Arg_36.37.0: f32[64,64], Arg_37.38.0: f32[56,63]) -> (bf16[], f32[256], f32[256], f32[256], f32[256], /*index=5*/f32[256], f32[256], f32[256], f32[256,256], f32[4,64], /*index=10*/f32[256,4,64], f32[256], f32[4,64,256], f32[4,64], f32[256,4,64], /*index=15*/f32[4,64], f32[256,4,64], f32[256], f32[256], f32[256], /*index=20*/f32[256], f32[256], f32[256,256], f32[4,64], f32[256,4,64], /*index=25*/f32[256], f32[4,64,256], f32[4,64], f32[256,4,64], f32[4,64], /*index=30*/f32[256,4,64], f32[1], f32[256,1], f32[256], f32[1728,256], /*index=35*/bf16[512,256], f32[64], f32[64,64], f32[56,63]) {
  %Arg_30.31.0 = f32[1]{0} parameter(30), sharding={replicated}
  %Arg_34.35.0 = bf16[512,256]{1,0} parameter(34), sharding={replicated}
  %Arg_19.20.0 = f32[256]{0} parameter(19), sharding={replicated}
  %Arg_17.18.0 = f32[256]{0} parameter(17), sharding={replicated}
  %Arg_5.6.0 = f32[256]{0} parameter(5), sharding={replicated}
  %Arg_3.4.0 = f32[256]{0} parameter(3), sharding={replicated}
  %Arg_1.2.0 = f32[256]{0} parameter(1), sharding={replicated}
  %constant_134_0 = bf16[5,52]{1,0} constant({...})
  %constant_129_0 = s32[260,1]{1,0} constant({...})
  %Arg_31.32.0 = f32[256,1]{1,0} parameter(31), sharding={replicated}
  %Arg_22.23.0 = f32[4,64]{1,0} parameter(22), sharding={replicated}
  %Arg_8.9.0 = f32[4,64]{1,0} parameter(8), sharding={replicated}
  %constant_233_0 = bf16[52]{0} constant({...})
  %constant_131_0 = bf16[13824,5,52,1]{3,2,1,0} constant({...})
  %Arg_37.38.0 = f32[56,63]{1,0} parameter(37), sharding={replicated}
  %Arg_36.37.0 = f32[64,64]{1,0} parameter(36), sharding={replicated}
  %Arg_35.36.0 = f32[64]{0} parameter(35), sharding={replicated}
  %Arg_33.34.0 = f32[1728,256]{1,0} parameter(33), sharding={replicated}
  %Arg_32.33.0 = f32[256]{0} parameter(32), sharding={replicated}
  %Arg_29.30.0 = f32[256,4,64]{2,1,0} parameter(29), sharding={replicated}
  %Arg_28.29.0 = f32[4,64]{1,0} parameter(28), sharding={replicated}
  %Arg_27.28.0 = f32[256,4,64]{2,1,0} parameter(27), sharding={replicated}
  %Arg_26.27.0 = f32[4,64]{1,0} parameter(26), sharding={replicated}
  %Arg_25.26.0 = f32[4,64,256]{2,1,0} parameter(25), sharding={replicated}
  %Arg_24.25.0 = f32[256]{0} parameter(24), sharding={replicated}
  %Arg_23.24.0 = f32[256,4,64]{2,1,0} parameter(23), sharding={replicated}
  %Arg_21.22.0 = f32[256,256]{1,0} parameter(21), sharding={replicated}
  %Arg_20.21.0 = f32[256]{0} parameter(20), sharding={replicated}
  %Arg_18.19.0 = f32[256]{0} parameter(18), sharding={replicated}
  %Arg_16.17.0 = f32[256]{0} parameter(16), sharding={replicated}
  %Arg_15.16.0 = f32[256,4,64]{2,1,0} parameter(15), sharding={replicated}
  %Arg_14.15.0 = f32[4,64]{1,0} parameter(14), sharding={replicated}
  %Arg_13.14.0 = f32[256,4,64]{2,1,0} parameter(13), sharding={replicated}
  %Arg_12.13.0 = f32[4,64]{1,0} parameter(12), sharding={replicated}
  %Arg_11.12.0 = f32[4,64,256]{2,1,0} parameter(11), sharding={replicated}
  %Arg_10.11.0 = f32[256]{0} parameter(10), sharding={replicated}
  %Arg_9.10.0 = f32[256,4,64]{2,1,0} parameter(9), sharding={replicated}
  %Arg_7.8.0 = f32[256,256]{1,0} parameter(7), sharding={replicated}
  %Arg_6.7.0 = f32[256]{0} parameter(6), sharding={replicated}
  %Arg_4.5.0 = f32[256]{0} parameter(4), sharding={replicated}
  %Arg_2.3.0 = f32[256]{0} parameter(2), sharding={replicated}
  %Arg_0.1.0 = f32[256]{0} parameter(0), sharding={replicated}
  %loop_broadcast_fusion = bf16[56,63]{1,0} fusion(), kind=kLoop, calls=%fused_broadcast, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/spec_embed/vmap(vmap(vmap(species_embed)))/species_embed/jit(_take)/broadcast_in_dim[shape=(56, 63) broadcast_dimensions=()]" source_file="/home/nicholas/programs/avid/avid/encoder.py" source_line=36}
  %wrapped_convert = bf16[64,64]{1,0} fusion(f32[64,64]{1,0} %Arg_36.37.0), kind=kLoop, calls=%wrapped_convert_computation, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/spec_embed/vmap(vmap(vmap(species_embed)))/embed_module/Dense_0/convert_element_type[new_dtype=bfloat16 weak_type=False]" source_file="/home/nicholas/programs/avid/avid/layers.py" source_line=49}
  %loop_gather_fusion = bf16[260,1,63]{2,1,0} fusion(s32[260,1]{1,0} %constant_129_0, f32[56,63]{1,0} %Arg_37.38.0), kind=kLoop, calls=%fused_gather, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/spec_embed/vmap(vmap(vmap(species_embed)))/species_embed/jit(_take)/gather[dimension_numbers=GatherDimensionNumbers(offset_dims=(2,), collapsed_slice_dims=(0,), start_index_map=(0,)) slice_sizes=(1, 63) unique_indices=False indices_are_sorted=False mode=GatherScatterMode.PROMISE_IN_BOUNDS fill_value=None]" source_file="/home/nicholas/programs/avid/avid/encoder.py" source_line=36}
  %wrapped_convert.6 = bf16[256,256]{1,0} fusion(f32[256,256]{1,0} %Arg_7.8.0), kind=kLoop, calls=%wrapped_convert_computation.6, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/vmap(vmap(LazyInMLP_0))/Dense_0/convert_element_type[new_dtype=bfloat16 weak_type=False]" source_file="/home/nicholas/programs/avid/avid/layers.py" source_line=49}
  %wrapped_convert.4 = bf16[256,4,64]{2,1,0} fusion(f32[256,4,64]{2,1,0} %Arg_9.10.0), kind=kLoop, calls=%wrapped_convert_computation.4, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/MultiHeadDotProductAttention_0/key/convert_element_type[new_dtype=bfloat16 weak_type=False]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %bitcast.4818.0 = bf16[256,256]{1,0} bitcast(bf16[256,4,64]{2,1,0} %wrapped_convert.4)
  %bitcast.6157.0 = bf16[256,256]{0,1} bitcast(bf16[256,4,64]{2,1,0} %wrapped_convert.4)
  %wrapped_convert.5 = bf16[4,64,256]{2,1,0} fusion(f32[4,64,256]{2,1,0} %Arg_11.12.0), kind=kLoop, calls=%wrapped_convert_computation.5, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/MultiHeadDotProductAttention_0/out/convert_element_type[new_dtype=bfloat16 weak_type=False]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %bitcast.4877.0 = bf16[256,256]{1,0} bitcast(bf16[4,64,256]{2,1,0} %wrapped_convert.5)
  %bitcast.6067.0 = bf16[256,256]{0,1} bitcast(bf16[4,64,256]{2,1,0} %wrapped_convert.5)
  %wrapped_convert.3 = bf16[256,4,64]{2,1,0} fusion(f32[256,4,64]{2,1,0} %Arg_13.14.0), kind=kLoop, calls=%wrapped_convert_computation.3, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/MultiHeadDotProductAttention_0/query/convert_element_type[new_dtype=bfloat16 weak_type=False]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %bitcast.4792.0 = bf16[256,256]{1,0} bitcast(bf16[256,4,64]{2,1,0} %wrapped_convert.3)
  %bitcast.6188.0 = bf16[256,256]{0,1} bitcast(bf16[256,4,64]{2,1,0} %wrapped_convert.3)
  %wrapped_convert.2 = bf16[256,4,64]{2,1,0} fusion(f32[256,4,64]{2,1,0} %Arg_15.16.0), kind=kLoop, calls=%wrapped_convert_computation.2, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/MultiHeadDotProductAttention_0/value/convert_element_type[new_dtype=bfloat16 weak_type=False]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %bitcast.4770.0 = bf16[256,256]{1,0} bitcast(bf16[256,4,64]{2,1,0} %wrapped_convert.2)
  %bitcast.6089.0 = bf16[256,256]{0,1} bitcast(bf16[256,4,64]{2,1,0} %wrapped_convert.2)
  %wrapped_convert.11 = bf16[256,256]{1,0} fusion(f32[256,256]{1,0} %Arg_21.22.0), kind=kLoop, calls=%wrapped_convert_computation.11, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/vmap(vmap(LazyInMLP_0))/Dense_0/convert_element_type[new_dtype=bfloat16 weak_type=False]" source_file="/home/nicholas/programs/avid/avid/layers.py" source_line=49}
  %wrapped_convert.9 = bf16[256,4,64]{2,1,0} fusion(f32[256,4,64]{2,1,0} %Arg_23.24.0), kind=kLoop, calls=%wrapped_convert_computation.9, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/MultiHeadDotProductAttention_0/key/convert_element_type[new_dtype=bfloat16 weak_type=False]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %bitcast.5097.0 = bf16[256,256]{1,0} bitcast(bf16[256,4,64]{2,1,0} %wrapped_convert.9)
  %bitcast.5809.0 = bf16[256,256]{0,1} bitcast(bf16[256,4,64]{2,1,0} %wrapped_convert.9)
  %wrapped_convert.10 = bf16[4,64,256]{2,1,0} fusion(f32[4,64,256]{2,1,0} %Arg_25.26.0), kind=kLoop, calls=%wrapped_convert_computation.10, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/MultiHeadDotProductAttention_0/out/convert_element_type[new_dtype=bfloat16 weak_type=False]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %bitcast.5157.0 = bf16[256,256]{1,0} bitcast(bf16[4,64,256]{2,1,0} %wrapped_convert.10)
  %bitcast.5718.0 = bf16[256,256]{0,1} bitcast(bf16[4,64,256]{2,1,0} %wrapped_convert.10)
  %wrapped_convert.8 = bf16[256,4,64]{2,1,0} fusion(f32[256,4,64]{2,1,0} %Arg_27.28.0), kind=kLoop, calls=%wrapped_convert_computation.8, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/MultiHeadDotProductAttention_0/query/convert_element_type[new_dtype=bfloat16 weak_type=False]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %bitcast.5071.0 = bf16[256,256]{1,0} bitcast(bf16[256,4,64]{2,1,0} %wrapped_convert.8)
  %bitcast.5840.0 = bf16[256,256]{0,1} bitcast(bf16[256,4,64]{2,1,0} %wrapped_convert.8)
  %wrapped_convert.7 = bf16[256,4,64]{2,1,0} fusion(f32[256,4,64]{2,1,0} %Arg_29.30.0), kind=kLoop, calls=%wrapped_convert_computation.7, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/MultiHeadDotProductAttention_0/value/convert_element_type[new_dtype=bfloat16 weak_type=False]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %bitcast.5049.0 = bf16[256,256]{1,0} bitcast(bf16[256,4,64]{2,1,0} %wrapped_convert.7)
  %bitcast.5740.0 = bf16[256,256]{0,1} bitcast(bf16[256,4,64]{2,1,0} %wrapped_convert.7)
  %wrapped_convert.1 = bf16[1728,256]{1,0} fusion(f32[1728,256]{1,0} %Arg_33.34.0), kind=kLoop, calls=%wrapped_convert_computation.1, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/im_embed/vmap(inner)/vmap(Patchify_0)/patch_proj/convert_element_type[new_dtype=bfloat16 weak_type=False]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=40}
  %input_concatenate_fusion = bf16[13824,5,52,64]{3,2,1,0} fusion(bf16[13824,5,52,1]{3,2,1,0} %constant_131_0, bf16[260,1,63]{2,1,0} %loop_gather_fusion), kind=kInput, calls=%fused_concatenate, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/spec_embed/vmap(vmap(vmap(species_embed)))/concatenate[dimension=3]" source_file="/home/nicholas/programs/avid/avid/encoder.py" source_line=36}
  %bitcast.6778.0 = bf16[3594240,64]{1,0} bitcast(bf16[13824,5,52,64]{3,2,1,0} %input_concatenate_fusion)
  %custom-call.48.0 = (bf16[3594240,64]{1,0}, s8[4194304]{0}) custom-call(bf16[3594240,64]{1,0} %bitcast.6778.0, bf16[64,64]{1,0} %wrapped_convert), custom_call_target="__cublas$gemm", metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/spec_embed/vmap(vmap(vmap(species_embed)))/embed_module/Dense_0/dot_general[dimension_numbers=(((3,), (0,)), ((), ())) precision=None preferred_element_type=None]" source_file="/home/nicholas/programs/avid/avid/layers.py" source_line=49}, backend_config={"operation_queue_id":"0","wait_on_operation_queues":[],"gemm_backend_config":{"alpha_real":1,"alpha_imag":0,"beta":0,"dot_dimension_numbers":{"lhs_contracting_dimensions":["1"],"rhs_contracting_dimensions":["0"],"lhs_batch_dimensions":[],"rhs_batch_dimensions":[]},"precision_config":{"operand_precision":["DEFAULT","DEFAULT"]},"epilogue":"DEFAULT","selected_algorithm":"-1","lhs_stride":"230031360","rhs_stride":"4096","grad_x":false,"grad_y":false}}
  %get-tuple-element.34.0 = bf16[3594240,64]{1,0} get-tuple-element((bf16[3594240,64]{1,0}, s8[4194304]{0}) %custom-call.48.0), index=0, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/spec_embed/vmap(vmap(vmap(species_embed)))/embed_module/Dense_0/dot_general[dimension_numbers=(((3,), (0,)), ((), ())) precision=None preferred_element_type=None]" source_file="/home/nicholas/programs/avid/avid/layers.py" source_line=49}
  %loop_transpose_fusion = bf16[52,8,8,8,3,3,3,64]{7,6,5,4,3,2,1,0} fusion(f32[64]{0} %Arg_35.36.0, bf16[3594240,64]{1,0} %get-tuple-element.34.0, bf16[5,52]{1,0} %constant_134_0), kind=kLoop, calls=%fused_transpose.11, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/im_embed/vmap(inner)/transpose[permutation=(0, 1, 3, 5, 2, 4, 6, 7)]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=103}
  %bitcast.6721.0 = bf16[26624,1728]{1,0} bitcast(bf16[52,8,8,8,3,3,3,64]{7,6,5,4,3,2,1,0} %loop_transpose_fusion)
  %custom-call.49.0 = (bf16[26624,256]{1,0}, s8[4194304]{0}) custom-call(bf16[26624,1728]{1,0} %bitcast.6721.0, bf16[1728,256]{1,0} %wrapped_convert.1), custom_call_target="__cublas$gemm", metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/im_embed/vmap(inner)/vmap(Patchify_0)/patch_proj/dot_general[dimension_numbers=(((2,), (0,)), ((), ())) precision=None preferred_element_type=None]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=40}, backend_config={"operation_queue_id":"0","wait_on_operation_queues":[],"gemm_backend_config":{"alpha_real":1,"alpha_imag":0,"beta":0,"dot_dimension_numbers":{"lhs_contracting_dimensions":["1"],"rhs_contracting_dimensions":["0"],"lhs_batch_dimensions":[],"rhs_batch_dimensions":[]},"precision_config":{"operand_precision":["DEFAULT","DEFAULT"]},"epilogue":"DEFAULT","selected_algorithm":"-1","lhs_stride":"46006272","rhs_stride":"442368","grad_x":false,"grad_y":false}}
  %get-tuple-element.35.0 = bf16[26624,256]{1,0} get-tuple-element((bf16[26624,256]{1,0}, s8[4194304]{0}) %custom-call.49.0), index=0, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/im_embed/vmap(inner)/vmap(Patchify_0)/patch_proj/dot_general[dimension_numbers=(((2,), (0,)), ((), ())) precision=None preferred_element_type=None]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=40}
  %input_transpose_fusion.10 = bf16[512,256,52]{2,1,0} fusion(f32[256]{0} %Arg_32.33.0, bf16[26624,256]{1,0} %get-tuple-element.35.0), kind=kInput, calls=%fused_transpose.10, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/im_embed/vmap(inner)/vmap(Patchify_0)/patch_proj/add" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=40}
  %input_reduce_fusion.27 = (f32[512,52]{1,0}, f32[512,52]{1,0}) fusion(bf16[512,256,52]{2,1,0} %input_transpose_fusion.10, bf16[512,256]{1,0} %Arg_34.35.0), kind=kInput, calls=%fused_reduce.27
  %get-tuple-element.169 = f32[512,52]{1,0} get-tuple-element((f32[512,52]{1,0}, f32[512,52]{1,0}) %input_reduce_fusion.27), index=1
  %get-tuple-element.168 = f32[512,52]{1,0} get-tuple-element((f32[512,52]{1,0}, f32[512,52]{1,0}) %input_reduce_fusion.27), index=0
  %loop_multiply_rsqrt_fusion.4 = (f32[1,512,52]{2,1,0}, f32[512,52]{1,0}) fusion(f32[512,52]{1,0} %get-tuple-element.169, f32[512,52]{1,0} %get-tuple-element.168), kind=kLoop, calls=%fused_multiply_rsqrt.4, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/LayerNorm_0/rsqrt" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156 deduplicated_name="loop_multiply_rsqrt_fusion"}
  %get-tuple-element.166 = f32[1,512,52]{2,1,0} get-tuple-element((f32[1,512,52]{2,1,0}, f32[512,52]{1,0}) %loop_multiply_rsqrt_fusion.4), index=0
  %get-tuple-element.167 = f32[512,52]{1,0} get-tuple-element((f32[1,512,52]{2,1,0}, f32[512,52]{1,0}) %loop_multiply_rsqrt_fusion.4), index=1
  %input_transpose_fusion.19 = bf16[52,512,256]{2,1,0} fusion(f32[256]{0} %Arg_2.3.0, f32[256]{0} %Arg_3.4.0, f32[1,512,52]{2,1,0} %get-tuple-element.166, f32[512,52]{1,0} %get-tuple-element.167, bf16[512,256]{1,0} %Arg_34.35.0, /*index=5*/bf16[512,256,52]{2,1,0} %input_transpose_fusion.10), kind=kInput, calls=%fused_transpose.20, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/LayerNorm_0/convert_element_type[new_dtype=bfloat16 weak_type=False]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
  %bitcast.6377.0 = bf16[26624,256]{1,0} bitcast(bf16[52,512,256]{2,1,0} %input_transpose_fusion.19)
  %custom-call.52.0 = (bf16[26624,256]{1,0}, s8[4194304]{0}) custom-call(bf16[26624,256]{1,0} %bitcast.6377.0, bf16[256,256]{1,0} %bitcast.4818.0), custom_call_target="__cublas$gemm", metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/MultiHeadDotProductAttention_0/key/dot_general[dimension_numbers=(((2,), (0,)), ((), ())) precision=None preferred_element_type=None]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}, backend_config={"operation_queue_id":"0","wait_on_operation_queues":[],"gemm_backend_config":{"alpha_real":1,"alpha_imag":0,"beta":0,"dot_dimension_numbers":{"lhs_contracting_dimensions":["1"],"rhs_contracting_dimensions":["0"],"lhs_batch_dimensions":[],"rhs_batch_dimensions":[]},"precision_config":{"operand_precision":["DEFAULT","DEFAULT"]},"epilogue":"DEFAULT","selected_algorithm":"-1","lhs_stride":"6815744","rhs_stride":"65536","grad_x":false,"grad_y":false}}
  %get-tuple-element.38.0 = bf16[26624,256]{1,0} get-tuple-element((bf16[26624,256]{1,0}, s8[4194304]{0}) %custom-call.52.0), index=0, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/MultiHeadDotProductAttention_0/key/dot_general[dimension_numbers=(((2,), (0,)), ((), ())) precision=None preferred_element_type=None]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %input_transpose_fusion.28 = bf16[52,4,512,64]{3,2,1,0} fusion(f32[4,64]{1,0} %Arg_8.9.0, bf16[26624,256]{1,0} %get-tuple-element.38.0), kind=kInput, calls=%fused_transpose.29, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/MultiHeadDotProductAttention_0/key/add" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158 deduplicated_name="input_transpose_fusion.28"}
  %input_transpose_fusion.13 = bf16[52,4,64,512]{3,2,1,0} fusion(f32[4,64]{1,0} %Arg_8.9.0, bf16[26624,256]{1,0} %get-tuple-element.38.0), kind=kInput, calls=%fused_transpose.14
  %bitcast.4833.0 = bf16[208,64,512]{2,1,0} bitcast(bf16[52,4,64,512]{3,2,1,0} %input_transpose_fusion.13)
  %bitcast.6171.0 = bf16[208,512,64]{2,1,0} bitcast(bf16[52,4,512,64]{3,2,1,0} %input_transpose_fusion.28)
  %custom-call.51.0 = (bf16[26624,256]{1,0}, s8[4194304]{0}) custom-call(bf16[26624,256]{1,0} %bitcast.6377.0, bf16[256,256]{1,0} %bitcast.4792.0), custom_call_target="__cublas$gemm", metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/MultiHeadDotProductAttention_0/query/dot_general[dimension_numbers=(((2,), (0,)), ((), ())) precision=None preferred_element_type=None]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}, backend_config={"operation_queue_id":"0","wait_on_operation_queues":[],"gemm_backend_config":{"alpha_real":1,"alpha_imag":0,"beta":0,"dot_dimension_numbers":{"lhs_contracting_dimensions":["1"],"rhs_contracting_dimensions":["0"],"lhs_batch_dimensions":[],"rhs_batch_dimensions":[]},"precision_config":{"operand_precision":["DEFAULT","DEFAULT"]},"epilogue":"DEFAULT","selected_algorithm":"-1","lhs_stride":"6815744","rhs_stride":"65536","grad_x":false,"grad_y":false}}
  %get-tuple-element.37.0 = bf16[26624,256]{1,0} get-tuple-element((bf16[26624,256]{1,0}, s8[4194304]{0}) %custom-call.51.0), index=0, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/MultiHeadDotProductAttention_0/query/dot_general[dimension_numbers=(((2,), (0,)), ((), ())) precision=None preferred_element_type=None]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %loop_convert_fusion.15 = bf16[52,4,512,64]{3,2,1,0} fusion(f32[4,64]{1,0} %Arg_12.13.0, bf16[26624,256]{1,0} %get-tuple-element.37.0), kind=kLoop, calls=%fused_convert.15
  %bitcast.4811.0 = bf16[208,512,64]{2,1,0} bitcast(bf16[52,4,512,64]{3,2,1,0} %loop_convert_fusion.15)
  %custom-call.50.0 = (bf16[26624,256]{1,0}, s8[4194304]{0}) custom-call(bf16[26624,256]{1,0} %bitcast.6377.0, bf16[256,256]{1,0} %bitcast.4770.0), custom_call_target="__cublas$gemm", metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/MultiHeadDotProductAttention_0/value/dot_general[dimension_numbers=(((2,), (0,)), ((), ())) precision=None preferred_element_type=None]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}, backend_config={"operation_queue_id":"0","wait_on_operation_queues":[],"gemm_backend_config":{"alpha_real":1,"alpha_imag":0,"beta":0,"dot_dimension_numbers":{"lhs_contracting_dimensions":["1"],"rhs_contracting_dimensions":["0"],"lhs_batch_dimensions":[],"rhs_batch_dimensions":[]},"precision_config":{"operand_precision":["DEFAULT","DEFAULT"]},"epilogue":"DEFAULT","selected_algorithm":"-1","lhs_stride":"6815744","rhs_stride":"65536","grad_x":false,"grad_y":false}}
  %get-tuple-element.36.0 = bf16[26624,256]{1,0} get-tuple-element((bf16[26624,256]{1,0}, s8[4194304]{0}) %custom-call.50.0), index=0, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/MultiHeadDotProductAttention_0/value/dot_general[dimension_numbers=(((2,), (0,)), ((), ())) precision=None preferred_element_type=None]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %input_transpose_fusion.14 = bf16[52,4,64,512]{3,2,1,0} fusion(f32[4,64]{1,0} %Arg_14.15.0, bf16[26624,256]{1,0} %get-tuple-element.36.0), kind=kInput, calls=%fused_transpose.15
  %bitcast.4785.0 = bf16[208,64,512]{2,1,0} bitcast(bf16[52,4,64,512]{3,2,1,0} %input_transpose_fusion.14)
  %custom-call.53.0 = (bf16[208,512,512]{2,1,0}, s8[4194304]{0}) custom-call(bf16[208,512,64]{2,1,0} %bitcast.4811.0, bf16[208,64,512]{2,1,0} %bitcast.4833.0), custom_call_target="__cublas$gemm", metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/MultiHeadDotProductAttention_0/...qhd,...khd->...hqk/dot_general[dimension_numbers=(((3,), (3,)), ((0, 2), (0, 2))) precision=None preferred_element_type=bfloat16]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}, backend_config={"operation_queue_id":"0","wait_on_operation_queues":[],"gemm_backend_config":{"alpha_real":1,"alpha_imag":0,"beta":0,"dot_dimension_numbers":{"lhs_contracting_dimensions":["2"],"rhs_contracting_dimensions":["1"],"lhs_batch_dimensions":["0"],"rhs_batch_dimensions":["0"]},"precision_config":{"operand_precision":["DEFAULT","DEFAULT"]},"epilogue":"DEFAULT","selected_algorithm":"-1","lhs_stride":"32768","rhs_stride":"32768","grad_x":false,"grad_y":false}}
  %get-tuple-element.39.0 = bf16[208,512,512]{2,1,0} get-tuple-element((bf16[208,512,512]{2,1,0}, s8[4194304]{0}) %custom-call.53.0), index=0, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/MultiHeadDotProductAttention_0/...qhd,...khd->...hqk/dot_general[dimension_numbers=(((3,), (3,)), ((0, 2), (0, 2))) precision=None preferred_element_type=bfloat16]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %input_reduce_fusion.8 = f32[52,4,512]{2,1,0} fusion(bf16[208,512,512]{2,1,0} %get-tuple-element.39.0), kind=kInput, calls=%fused_reduce.8, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/MultiHeadDotProductAttention_0/reduce_max[axes=(3,)]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158 deduplicated_name="input_reduce_fusion.8"}
  %input_reduce_fusion.10 = f32[52,4,512]{2,1,0} fusion(f32[52,4,512]{2,1,0} %input_reduce_fusion.8, bf16[208,512,512]{2,1,0} %get-tuple-element.39.0), kind=kInput, calls=%fused_reduce.10, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/MultiHeadDotProductAttention_0/reduce_sum[axes=(3,)]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158 deduplicated_name="input_reduce_fusion.10"}
  %loop_convert_divide_fusion = (bf16[52,4,512]{2,1,0}, f32[52,4,512]{2,1,0}, bf16[52,4,512]{2,1,0}) fusion(f32[52,4,512]{2,1,0} %input_reduce_fusion.10), kind=kLoop, calls=%fused_convert_divide
  %get-tuple-element.99 = f32[52,4,512]{2,1,0} get-tuple-element((bf16[52,4,512]{2,1,0}, f32[52,4,512]{2,1,0}, bf16[52,4,512]{2,1,0}) %loop_convert_divide_fusion), index=1
  %loop_convert_fusion.11 = bf16[52,4,512,512]{3,2,1,0} fusion(f32[52,4,512]{2,1,0} %input_reduce_fusion.10, f32[52,4,512]{2,1,0} %input_reduce_fusion.8, bf16[208,512,512]{2,1,0} %get-tuple-element.39.0), kind=kLoop, calls=%fused_convert.11
  %bitcast.4865.0 = bf16[208,512,512]{2,1,0} bitcast(bf16[52,4,512,512]{3,2,1,0} %loop_convert_fusion.11)
  %custom-call.54.0 = (bf16[208,64,512]{2,1,0}, s8[4194304]{0}) custom-call(bf16[208,64,512]{2,1,0} %bitcast.4785.0, bf16[208,512,512]{2,1,0} %bitcast.4865.0), custom_call_target="__cublas$gemm", metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/MultiHeadDotProductAttention_0/...hqk,...khd->...qhd/dot_general[dimension_numbers=(((1,), (3,)), ((0, 2), (0, 1))) precision=None preferred_element_type=bfloat16]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}, backend_config={"operation_queue_id":"0","wait_on_operation_queues":[],"gemm_backend_config":{"alpha_real":1,"alpha_imag":0,"beta":0,"dot_dimension_numbers":{"lhs_contracting_dimensions":["2"],"rhs_contracting_dimensions":["2"],"lhs_batch_dimensions":["0"],"rhs_batch_dimensions":["0"]},"precision_config":{"operand_precision":["DEFAULT","DEFAULT"]},"epilogue":"DEFAULT","selected_algorithm":"-1","lhs_stride":"32768","rhs_stride":"262144","grad_x":false,"grad_y":false}}
  %get-tuple-element.40.0 = bf16[208,64,512]{2,1,0} get-tuple-element((bf16[208,64,512]{2,1,0}, s8[4194304]{0}) %custom-call.54.0), index=0, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/MultiHeadDotProductAttention_0/...hqk,...khd->...qhd/dot_general[dimension_numbers=(((1,), (3,)), ((0, 2), (0, 1))) precision=None preferred_element_type=bfloat16]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %input_transpose_fusion.9 = bf16[52,512,4,64]{3,2,1,0} fusion(bf16[208,64,512]{2,1,0} %get-tuple-element.40.0), kind=kInput, calls=%fused_transpose.9, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/MultiHeadDotProductAttention_0/...hqk,...khd->...qhd/transpose[permutation=(0, 3, 1, 2)]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158 deduplicated_name="input_transpose_fusion.8"}
  %bitcast.6324.0 = bf16[26624,256]{1,0} bitcast(bf16[52,512,4,64]{3,2,1,0} %input_transpose_fusion.9)
  %custom-call.55.0 = (bf16[26624,256]{1,0}, s8[4194304]{0}) custom-call(bf16[26624,256]{1,0} %bitcast.6324.0, bf16[256,256]{1,0} %bitcast.4877.0), custom_call_target="__cublas$gemm", metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/MultiHeadDotProductAttention_0/out/dot_general[dimension_numbers=(((2, 3), (0, 1)), ((), ())) precision=None preferred_element_type=None]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}, backend_config={"operation_queue_id":"0","wait_on_operation_queues":[],"gemm_backend_config":{"alpha_real":1,"alpha_imag":0,"beta":0,"dot_dimension_numbers":{"lhs_contracting_dimensions":["1"],"rhs_contracting_dimensions":["0"],"lhs_batch_dimensions":[],"rhs_batch_dimensions":[]},"precision_config":{"operand_precision":["DEFAULT","DEFAULT"]},"epilogue":"DEFAULT","selected_algorithm":"-1","lhs_stride":"6815744","rhs_stride":"65536","grad_x":false,"grad_y":false}}
  %get-tuple-element.41.0 = bf16[26624,256]{1,0} get-tuple-element((bf16[26624,256]{1,0}, s8[4194304]{0}) %custom-call.55.0), index=0, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/MultiHeadDotProductAttention_0/out/dot_general[dimension_numbers=(((2, 3), (0, 1)), ((), ())) precision=None preferred_element_type=None]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %input_transpose_fusion.18 = f32[512,256,52]{2,1,0} fusion(bf16[512,256,52]{2,1,0} %input_transpose_fusion.10, bf16[512,256]{1,0} %Arg_34.35.0, f32[256]{0} %Arg_10.11.0, bf16[26624,256]{1,0} %get-tuple-element.41.0), kind=kInput, calls=%fused_transpose.19, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/add" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=168}
  %input_reduce_fusion.16 = (f32[512,52]{1,0}, f32[512,52]{1,0}) fusion(f32[512,256,52]{2,1,0} %input_transpose_fusion.18), kind=kInput, calls=%fused_reduce.16
  %get-tuple-element.164 = f32[512,52]{1,0} get-tuple-element((f32[512,52]{1,0}, f32[512,52]{1,0}) %input_reduce_fusion.16), index=1
  %get-tuple-element.163 = f32[512,52]{1,0} get-tuple-element((f32[512,52]{1,0}, f32[512,52]{1,0}) %input_reduce_fusion.16), index=0
  %loop_multiply_rsqrt_fusion.3 = (f32[1,512,52]{2,1,0}, f32[512,52]{1,0}) fusion(f32[512,52]{1,0} %get-tuple-element.163, f32[512,52]{1,0} %get-tuple-element.164), kind=kLoop, calls=%fused_multiply_rsqrt.3, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/LayerNorm_1/rsqrt" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171 deduplicated_name="loop_multiply_rsqrt_fusion"}
  %get-tuple-element.161 = f32[1,512,52]{2,1,0} get-tuple-element((f32[1,512,52]{2,1,0}, f32[512,52]{1,0}) %loop_multiply_rsqrt_fusion.3), index=0
  %get-tuple-element.162 = f32[512,52]{1,0} get-tuple-element((f32[1,512,52]{2,1,0}, f32[512,52]{1,0}) %loop_multiply_rsqrt_fusion.3), index=1
  %input_transpose_fusion.20 = bf16[52,512,256]{2,1,0} fusion(f32[256]{0} %Arg_4.5.0, f32[256]{0} %Arg_5.6.0, f32[1,512,52]{2,1,0} %get-tuple-element.161, f32[512,256,52]{2,1,0} %input_transpose_fusion.18, f32[512,52]{1,0} %get-tuple-element.162), kind=kInput, calls=%fused_transpose.21, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/LayerNorm_1/convert_element_type[new_dtype=bfloat16 weak_type=False]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171 deduplicated_name="input_transpose_fusion.20"}
  %bitcast.6263.0 = bf16[26624,256]{1,0} bitcast(bf16[52,512,256]{2,1,0} %input_transpose_fusion.20)
  %custom-call.56.0 = (bf16[26624,256]{1,0}, s8[4194304]{0}) custom-call(bf16[26624,256]{1,0} %bitcast.6263.0, bf16[256,256]{1,0} %wrapped_convert.6), custom_call_target="__cublas$gemm", metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/vmap(vmap(LazyInMLP_0))/Dense_0/dot_general[dimension_numbers=(((2,), (0,)), ((), ())) precision=None preferred_element_type=None]" source_file="/home/nicholas/programs/avid/avid/layers.py" source_line=49}, backend_config={"operation_queue_id":"0","wait_on_operation_queues":[],"gemm_backend_config":{"alpha_real":1,"alpha_imag":0,"beta":0,"dot_dimension_numbers":{"lhs_contracting_dimensions":["1"],"rhs_contracting_dimensions":["0"],"lhs_batch_dimensions":[],"rhs_batch_dimensions":[]},"precision_config":{"operand_precision":["DEFAULT","DEFAULT"]},"epilogue":"DEFAULT","selected_algorithm":"-1","lhs_stride":"6815744","rhs_stride":"65536","grad_x":false,"grad_y":false}}
  %get-tuple-element.42.0 = bf16[26624,256]{1,0} get-tuple-element((bf16[26624,256]{1,0}, s8[4194304]{0}) %custom-call.56.0), index=0, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/vmap(vmap(LazyInMLP_0))/Dense_0/dot_general[dimension_numbers=(((2,), (0,)), ((), ())) precision=None preferred_element_type=None]" source_file="/home/nicholas/programs/avid/avid/layers.py" source_line=49}
  %input_transpose_fusion.17 = f32[512,256,52]{2,1,0} fusion(f32[512,256,52]{2,1,0} %input_transpose_fusion.18, f32[256]{0} %Arg_6.7.0, bf16[26624,256]{1,0} %get-tuple-element.42.0), kind=kInput, calls=%fused_transpose.18, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_0/add" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=185 deduplicated_name="input_transpose_fusion.15"}
  %input_reduce_fusion.15 = (f32[512,52]{1,0}, f32[512,52]{1,0}) fusion(f32[512,256,52]{2,1,0} %input_transpose_fusion.17), kind=kInput, calls=%fused_reduce.15
  %get-tuple-element.160 = f32[512,52]{1,0} get-tuple-element((f32[512,52]{1,0}, f32[512,52]{1,0}) %input_reduce_fusion.15), index=1
  %get-tuple-element.159 = f32[512,52]{1,0} get-tuple-element((f32[512,52]{1,0}, f32[512,52]{1,0}) %input_reduce_fusion.15), index=0
  %loop_multiply_rsqrt_fusion.2 = (f32[1,512,52]{2,1,0}, f32[512,52]{1,0}) fusion(f32[512,52]{1,0} %get-tuple-element.159, f32[512,52]{1,0} %get-tuple-element.160), kind=kLoop, calls=%fused_multiply_rsqrt.2, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/LayerNorm_0/rsqrt" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156 deduplicated_name="loop_multiply_rsqrt_fusion"}
  %get-tuple-element.157 = f32[1,512,52]{2,1,0} get-tuple-element((f32[1,512,52]{2,1,0}, f32[512,52]{1,0}) %loop_multiply_rsqrt_fusion.2), index=0
  %get-tuple-element.158 = f32[512,52]{1,0} get-tuple-element((f32[1,512,52]{2,1,0}, f32[512,52]{1,0}) %loop_multiply_rsqrt_fusion.2), index=1
  %input_transpose_fusion.21 = bf16[52,512,256]{2,1,0} fusion(f32[256]{0} %Arg_16.17.0, f32[256]{0} %Arg_17.18.0, f32[1,512,52]{2,1,0} %get-tuple-element.157, f32[512,256,52]{2,1,0} %input_transpose_fusion.17, f32[512,52]{1,0} %get-tuple-element.158), kind=kInput, calls=%fused_transpose.22, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/LayerNorm_0/convert_element_type[new_dtype=bfloat16 weak_type=False]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156 deduplicated_name="input_transpose_fusion.20"}
  %bitcast.6565.0 = bf16[26624,256]{1,0} bitcast(bf16[52,512,256]{2,1,0} %input_transpose_fusion.21)
  %custom-call.59.0 = (bf16[26624,256]{1,0}, s8[4194304]{0}) custom-call(bf16[26624,256]{1,0} %bitcast.6565.0, bf16[256,256]{1,0} %bitcast.5097.0), custom_call_target="__cublas$gemm", metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/MultiHeadDotProductAttention_0/key/dot_general[dimension_numbers=(((2,), (0,)), ((), ())) precision=None preferred_element_type=None]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}, backend_config={"operation_queue_id":"0","wait_on_operation_queues":[],"gemm_backend_config":{"alpha_real":1,"alpha_imag":0,"beta":0,"dot_dimension_numbers":{"lhs_contracting_dimensions":["1"],"rhs_contracting_dimensions":["0"],"lhs_batch_dimensions":[],"rhs_batch_dimensions":[]},"precision_config":{"operand_precision":["DEFAULT","DEFAULT"]},"epilogue":"DEFAULT","selected_algorithm":"-1","lhs_stride":"6815744","rhs_stride":"65536","grad_x":false,"grad_y":false}}
  %get-tuple-element.45.0 = bf16[26624,256]{1,0} get-tuple-element((bf16[26624,256]{1,0}, s8[4194304]{0}) %custom-call.59.0), index=0, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/MultiHeadDotProductAttention_0/key/dot_general[dimension_numbers=(((2,), (0,)), ((), ())) precision=None preferred_element_type=None]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %input_transpose_fusion.29 = bf16[52,4,512,64]{3,2,1,0} fusion(f32[4,64]{1,0} %Arg_22.23.0, bf16[26624,256]{1,0} %get-tuple-element.45.0), kind=kInput, calls=%fused_transpose.30, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/MultiHeadDotProductAttention_0/key/add" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158 deduplicated_name="input_transpose_fusion.28"}
  %input_transpose_fusion.11 = bf16[52,4,64,512]{3,2,1,0} fusion(f32[4,64]{1,0} %Arg_22.23.0, bf16[26624,256]{1,0} %get-tuple-element.45.0), kind=kInput, calls=%fused_transpose.12
  %bitcast.5112.0 = bf16[208,64,512]{2,1,0} bitcast(bf16[52,4,64,512]{3,2,1,0} %input_transpose_fusion.11)
  %bitcast.5823.0 = bf16[208,512,64]{2,1,0} bitcast(bf16[52,4,512,64]{3,2,1,0} %input_transpose_fusion.29)
  %custom-call.58.0 = (bf16[26624,256]{1,0}, s8[4194304]{0}) custom-call(bf16[26624,256]{1,0} %bitcast.6565.0, bf16[256,256]{1,0} %bitcast.5071.0), custom_call_target="__cublas$gemm", metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/MultiHeadDotProductAttention_0/query/dot_general[dimension_numbers=(((2,), (0,)), ((), ())) precision=None preferred_element_type=None]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}, backend_config={"operation_queue_id":"0","wait_on_operation_queues":[],"gemm_backend_config":{"alpha_real":1,"alpha_imag":0,"beta":0,"dot_dimension_numbers":{"lhs_contracting_dimensions":["1"],"rhs_contracting_dimensions":["0"],"lhs_batch_dimensions":[],"rhs_batch_dimensions":[]},"precision_config":{"operand_precision":["DEFAULT","DEFAULT"]},"epilogue":"DEFAULT","selected_algorithm":"-1","lhs_stride":"6815744","rhs_stride":"65536","grad_x":false,"grad_y":false}}
  %get-tuple-element.44.0 = bf16[26624,256]{1,0} get-tuple-element((bf16[26624,256]{1,0}, s8[4194304]{0}) %custom-call.58.0), index=0, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/MultiHeadDotProductAttention_0/query/dot_general[dimension_numbers=(((2,), (0,)), ((), ())) precision=None preferred_element_type=None]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %loop_convert_fusion.14 = bf16[52,4,512,64]{3,2,1,0} fusion(f32[4,64]{1,0} %Arg_26.27.0, bf16[26624,256]{1,0} %get-tuple-element.44.0), kind=kLoop, calls=%fused_convert.14
  %bitcast.5090.0 = bf16[208,512,64]{2,1,0} bitcast(bf16[52,4,512,64]{3,2,1,0} %loop_convert_fusion.14)
  %custom-call.57.0 = (bf16[26624,256]{1,0}, s8[4194304]{0}) custom-call(bf16[26624,256]{1,0} %bitcast.6565.0, bf16[256,256]{1,0} %bitcast.5049.0), custom_call_target="__cublas$gemm", metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/MultiHeadDotProductAttention_0/value/dot_general[dimension_numbers=(((2,), (0,)), ((), ())) precision=None preferred_element_type=None]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}, backend_config={"operation_queue_id":"0","wait_on_operation_queues":[],"gemm_backend_config":{"alpha_real":1,"alpha_imag":0,"beta":0,"dot_dimension_numbers":{"lhs_contracting_dimensions":["1"],"rhs_contracting_dimensions":["0"],"lhs_batch_dimensions":[],"rhs_batch_dimensions":[]},"precision_config":{"operand_precision":["DEFAULT","DEFAULT"]},"epilogue":"DEFAULT","selected_algorithm":"-1","lhs_stride":"6815744","rhs_stride":"65536","grad_x":false,"grad_y":false}}
  %get-tuple-element.43.0 = bf16[26624,256]{1,0} get-tuple-element((bf16[26624,256]{1,0}, s8[4194304]{0}) %custom-call.57.0), index=0, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/MultiHeadDotProductAttention_0/value/dot_general[dimension_numbers=(((2,), (0,)), ((), ())) precision=None preferred_element_type=None]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %input_transpose_fusion.12 = bf16[52,4,64,512]{3,2,1,0} fusion(f32[4,64]{1,0} %Arg_28.29.0, bf16[26624,256]{1,0} %get-tuple-element.43.0), kind=kInput, calls=%fused_transpose.13
  %bitcast.5064.0 = bf16[208,64,512]{2,1,0} bitcast(bf16[52,4,64,512]{3,2,1,0} %input_transpose_fusion.12)
  %custom-call.60.0 = (bf16[208,512,512]{2,1,0}, s8[4194304]{0}) custom-call(bf16[208,512,64]{2,1,0} %bitcast.5090.0, bf16[208,64,512]{2,1,0} %bitcast.5112.0), custom_call_target="__cublas$gemm", metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/MultiHeadDotProductAttention_0/...qhd,...khd->...hqk/dot_general[dimension_numbers=(((3,), (3,)), ((0, 2), (0, 2))) precision=None preferred_element_type=bfloat16]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}, backend_config={"operation_queue_id":"0","wait_on_operation_queues":[],"gemm_backend_config":{"alpha_real":1,"alpha_imag":0,"beta":0,"dot_dimension_numbers":{"lhs_contracting_dimensions":["2"],"rhs_contracting_dimensions":["1"],"lhs_batch_dimensions":["0"],"rhs_batch_dimensions":["0"]},"precision_config":{"operand_precision":["DEFAULT","DEFAULT"]},"epilogue":"DEFAULT","selected_algorithm":"-1","lhs_stride":"32768","rhs_stride":"32768","grad_x":false,"grad_y":false}}
  %get-tuple-element.46.0 = bf16[208,512,512]{2,1,0} get-tuple-element((bf16[208,512,512]{2,1,0}, s8[4194304]{0}) %custom-call.60.0), index=0, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/MultiHeadDotProductAttention_0/...qhd,...khd->...hqk/dot_general[dimension_numbers=(((3,), (3,)), ((0, 2), (0, 2))) precision=None preferred_element_type=bfloat16]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %input_reduce_fusion.9 = f32[52,4,512]{2,1,0} fusion(bf16[208,512,512]{2,1,0} %get-tuple-element.46.0), kind=kInput, calls=%fused_reduce.9, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/MultiHeadDotProductAttention_0/reduce_max[axes=(3,)]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158 deduplicated_name="input_reduce_fusion.8"}
  %input_reduce_fusion.11 = f32[52,4,512]{2,1,0} fusion(f32[52,4,512]{2,1,0} %input_reduce_fusion.9, bf16[208,512,512]{2,1,0} %get-tuple-element.46.0), kind=kInput, calls=%fused_reduce.11, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/MultiHeadDotProductAttention_0/reduce_sum[axes=(3,)]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158 deduplicated_name="input_reduce_fusion.10"}
  %loop_convert_divide_fusion.1 = (bf16[52,4,512]{2,1,0}, f32[52,4,512]{2,1,0}, bf16[52,4,512]{2,1,0}) fusion(f32[52,4,512]{2,1,0} %input_reduce_fusion.11), kind=kLoop, calls=%fused_convert_divide.1
  %get-tuple-element.123 = f32[52,4,512]{2,1,0} get-tuple-element((bf16[52,4,512]{2,1,0}, f32[52,4,512]{2,1,0}, bf16[52,4,512]{2,1,0}) %loop_convert_divide_fusion.1), index=1
  %loop_convert_fusion.13 = bf16[52,4,512,512]{3,2,1,0} fusion(f32[52,4,512]{2,1,0} %input_reduce_fusion.11, f32[52,4,512]{2,1,0} %input_reduce_fusion.9, bf16[208,512,512]{2,1,0} %get-tuple-element.46.0), kind=kLoop, calls=%fused_convert.13
  %bitcast.5145.0 = bf16[208,512,512]{2,1,0} bitcast(bf16[52,4,512,512]{3,2,1,0} %loop_convert_fusion.13)
  %custom-call.61.0 = (bf16[208,64,512]{2,1,0}, s8[4194304]{0}) custom-call(bf16[208,64,512]{2,1,0} %bitcast.5064.0, bf16[208,512,512]{2,1,0} %bitcast.5145.0), custom_call_target="__cublas$gemm", metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/MultiHeadDotProductAttention_0/...hqk,...khd->...qhd/dot_general[dimension_numbers=(((1,), (3,)), ((0, 2), (0, 1))) precision=None preferred_element_type=bfloat16]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}, backend_config={"operation_queue_id":"0","wait_on_operation_queues":[],"gemm_backend_config":{"alpha_real":1,"alpha_imag":0,"beta":0,"dot_dimension_numbers":{"lhs_contracting_dimensions":["2"],"rhs_contracting_dimensions":["2"],"lhs_batch_dimensions":["0"],"rhs_batch_dimensions":["0"]},"precision_config":{"operand_precision":["DEFAULT","DEFAULT"]},"epilogue":"DEFAULT","selected_algorithm":"-1","lhs_stride":"32768","rhs_stride":"262144","grad_x":false,"grad_y":false}}
  %get-tuple-element.47.0 = bf16[208,64,512]{2,1,0} get-tuple-element((bf16[208,64,512]{2,1,0}, s8[4194304]{0}) %custom-call.61.0), index=0, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/MultiHeadDotProductAttention_0/...hqk,...khd->...qhd/dot_general[dimension_numbers=(((1,), (3,)), ((0, 2), (0, 1))) precision=None preferred_element_type=bfloat16]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %input_transpose_fusion.8 = bf16[52,512,4,64]{3,2,1,0} fusion(bf16[208,64,512]{2,1,0} %get-tuple-element.47.0), kind=kInput, calls=%fused_transpose.8, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/MultiHeadDotProductAttention_0/...hqk,...khd->...qhd/transpose[permutation=(0, 3, 1, 2)]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158 deduplicated_name="input_transpose_fusion.8"}
  %bitcast.6512.0 = bf16[26624,256]{1,0} bitcast(bf16[52,512,4,64]{3,2,1,0} %input_transpose_fusion.8)
  %custom-call.62.0 = (bf16[26624,256]{1,0}, s8[4194304]{0}) custom-call(bf16[26624,256]{1,0} %bitcast.6512.0, bf16[256,256]{1,0} %bitcast.5157.0), custom_call_target="__cublas$gemm", metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/MultiHeadDotProductAttention_0/out/dot_general[dimension_numbers=(((2, 3), (0, 1)), ((), ())) precision=None preferred_element_type=None]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}, backend_config={"operation_queue_id":"0","wait_on_operation_queues":[],"gemm_backend_config":{"alpha_real":1,"alpha_imag":0,"beta":0,"dot_dimension_numbers":{"lhs_contracting_dimensions":["1"],"rhs_contracting_dimensions":["0"],"lhs_batch_dimensions":[],"rhs_batch_dimensions":[]},"precision_config":{"operand_precision":["DEFAULT","DEFAULT"]},"epilogue":"DEFAULT","selected_algorithm":"-1","lhs_stride":"6815744","rhs_stride":"65536","grad_x":false,"grad_y":false}}
  %get-tuple-element.48.0 = bf16[26624,256]{1,0} get-tuple-element((bf16[26624,256]{1,0}, s8[4194304]{0}) %custom-call.62.0), index=0, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/MultiHeadDotProductAttention_0/out/dot_general[dimension_numbers=(((2, 3), (0, 1)), ((), ())) precision=None preferred_element_type=None]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %input_transpose_fusion.16 = f32[512,256,52]{2,1,0} fusion(f32[512,256,52]{2,1,0} %input_transpose_fusion.17, f32[256]{0} %Arg_24.25.0, bf16[26624,256]{1,0} %get-tuple-element.48.0), kind=kInput, calls=%fused_transpose.17, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/add" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=168}
  %input_reduce_fusion.14 = (f32[512,52]{1,0}, f32[512,52]{1,0}) fusion(f32[512,256,52]{2,1,0} %input_transpose_fusion.16), kind=kInput, calls=%fused_reduce.14
  %get-tuple-element.155 = f32[512,52]{1,0} get-tuple-element((f32[512,52]{1,0}, f32[512,52]{1,0}) %input_reduce_fusion.14), index=1
  %get-tuple-element.154 = f32[512,52]{1,0} get-tuple-element((f32[512,52]{1,0}, f32[512,52]{1,0}) %input_reduce_fusion.14), index=0
  %loop_multiply_rsqrt_fusion.1 = (f32[1,512,52]{2,1,0}, f32[512,52]{1,0}) fusion(f32[512,52]{1,0} %get-tuple-element.154, f32[512,52]{1,0} %get-tuple-element.155), kind=kLoop, calls=%fused_multiply_rsqrt.1, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/LayerNorm_1/rsqrt" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171 deduplicated_name="loop_multiply_rsqrt_fusion"}
  %get-tuple-element.152 = f32[1,512,52]{2,1,0} get-tuple-element((f32[1,512,52]{2,1,0}, f32[512,52]{1,0}) %loop_multiply_rsqrt_fusion.1), index=0
  %get-tuple-element.153 = f32[512,52]{1,0} get-tuple-element((f32[1,512,52]{2,1,0}, f32[512,52]{1,0}) %loop_multiply_rsqrt_fusion.1), index=1
  %input_transpose_fusion.22 = bf16[52,512,256]{2,1,0} fusion(f32[256]{0} %Arg_18.19.0, f32[256]{0} %Arg_19.20.0, f32[1,512,52]{2,1,0} %get-tuple-element.152, f32[512,256,52]{2,1,0} %input_transpose_fusion.16, f32[512,52]{1,0} %get-tuple-element.153), kind=kInput, calls=%fused_transpose.23, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/LayerNorm_1/convert_element_type[new_dtype=bfloat16 weak_type=False]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171 deduplicated_name="input_transpose_fusion.20"}
  %bitcast.6451.0 = bf16[26624,256]{1,0} bitcast(bf16[52,512,256]{2,1,0} %input_transpose_fusion.22)
  %custom-call.63.0 = (bf16[26624,256]{1,0}, s8[4194304]{0}) custom-call(bf16[26624,256]{1,0} %bitcast.6451.0, bf16[256,256]{1,0} %wrapped_convert.11), custom_call_target="__cublas$gemm", metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/vmap(vmap(LazyInMLP_0))/Dense_0/dot_general[dimension_numbers=(((2,), (0,)), ((), ())) precision=None preferred_element_type=None]" source_file="/home/nicholas/programs/avid/avid/layers.py" source_line=49}, backend_config={"operation_queue_id":"0","wait_on_operation_queues":[],"gemm_backend_config":{"alpha_real":1,"alpha_imag":0,"beta":0,"dot_dimension_numbers":{"lhs_contracting_dimensions":["1"],"rhs_contracting_dimensions":["0"],"lhs_batch_dimensions":[],"rhs_batch_dimensions":[]},"precision_config":{"operand_precision":["DEFAULT","DEFAULT"]},"epilogue":"DEFAULT","selected_algorithm":"-1","lhs_stride":"6815744","rhs_stride":"65536","grad_x":false,"grad_y":false}}
  %get-tuple-element.49.0 = bf16[26624,256]{1,0} get-tuple-element((bf16[26624,256]{1,0}, s8[4194304]{0}) %custom-call.63.0), index=0, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/vmap(vmap(LazyInMLP_0))/Dense_0/dot_general[dimension_numbers=(((2,), (0,)), ((), ())) precision=None preferred_element_type=None]" source_file="/home/nicholas/programs/avid/avid/layers.py" source_line=49}
  %input_transpose_fusion.15 = f32[512,256,52]{2,1,0} fusion(f32[512,256,52]{2,1,0} %input_transpose_fusion.16, f32[256]{0} %Arg_20.21.0, bf16[26624,256]{1,0} %get-tuple-element.49.0), kind=kInput, calls=%fused_transpose.16, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoderblock_1/add" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=185 deduplicated_name="input_transpose_fusion.15"}
  %input_reduce_fusion.13 = (f32[512,52]{1,0}, f32[512,52]{1,0}) fusion(f32[512,256,52]{2,1,0} %input_transpose_fusion.15), kind=kInput, calls=%fused_reduce.13
  %get-tuple-element.151 = f32[512,52]{1,0} get-tuple-element((f32[512,52]{1,0}, f32[512,52]{1,0}) %input_reduce_fusion.13), index=1
  %get-tuple-element.150 = f32[512,52]{1,0} get-tuple-element((f32[512,52]{1,0}, f32[512,52]{1,0}) %input_reduce_fusion.13), index=0
  %loop_multiply_rsqrt_fusion = (f32[1,512,52]{2,1,0}, f32[512,52]{1,0}) fusion(f32[512,52]{1,0} %get-tuple-element.150, f32[512,52]{1,0} %get-tuple-element.151), kind=kLoop, calls=%fused_multiply_rsqrt, metadata={op_name="jit(loss)/jit(main)/jvp(ViTRegressor)/encoder/encoder_norm/rsqrt" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=228 deduplicated_name="loop_multiply_rsqrt_fusion"}
  %get-tuple-element.148 = f32[1,512,52]{2,1,0} get-tuple-element((f32[1,512,52]{2,1,0}, f32[512,52]{1,0}) %loop_multiply_rsqrt_fusion), index=0
  %get-tuple-element.149 = f32[512,52]{1,0} get-tuple-element((f32[1,512,52]{2,1,0}, f32[512,52]{1,0}) %loop_multiply_rsqrt_fusion), index=1
  %input_reduce_fusion.17 = f32[256,52]{1,0} fusion(f32[256]{0} %Arg_1.2.0, f32[1,512,52]{2,1,0} %get-tuple-element.148, f32[256]{0} %Arg_0.1.0, f32[512,256,52]{2,1,0} %input_transpose_fusion.15, f32[512,52]{1,0} %get-tuple-element.149), kind=kInput, calls=%fused_reduce.17
  %input_reduce_fusion.40 = f32[52]{0} fusion(f32[256,52]{1,0} %input_reduce_fusion.17, f32[256,1]{1,0} %Arg_31.32.0), kind=kInput, calls=%fused_reduce.40
  %input_multiply_reduce_select_fusion = (f32[52]{0}, bf16[52,52]{1,0}, bf16[52,52]{1,0}, f32[52,52]{1,0}) fusion(bf16[52]{0} %constant_233_0, f32[52]{0} %input_reduce_fusion.40, f32[1]{0} %Arg_30.31.0), kind=kInput, calls=%fused_multiply_reduce_select, metadata={op_name="jit(loss)/jit(main)/reduce_sum[axes=(1,)]" source_file="/home/nicholas/programs/avid/avid/config.py" source_line=371}
  %get-tuple-element.147 = f32[52,52]{1,0} get-tuple-element((f32[52]{0}, bf16[52,52]{1,0}, bf16[52,52]{1,0}, f32[52,52]{1,0}) %input_multiply_reduce_select_fusion), index=3
  %input_reduce_fusion.5 = f32[] fusion(f32[52,52]{1,0} %get-tuple-element.147), kind=kInput, calls=%fused_reduce.5, metadata={op_name="jit(loss)/jit(main)/reduce_sum[axes=(0, 1)]" source_file="/home/nicholas/programs/avid/avid/config.py" source_line=372}
  %loop_convert_fusion.16 = bf16[] fusion(f32[] %input_reduce_fusion.5), kind=kLoop, calls=%fused_convert.16, metadata={op_name="jit(loss)/jit(main)/convert_element_type[new_dtype=bfloat16 weak_type=False]" source_file="/home/nicholas/programs/avid/avid/config.py" source_line=372}
  %get-tuple-element.146 = bf16[52,52]{1,0} get-tuple-element((f32[52]{0}, bf16[52,52]{1,0}, bf16[52,52]{1,0}, f32[52,52]{1,0}) %input_multiply_reduce_select_fusion), index=2
  %get-tuple-element.145 = bf16[52,52]{1,0} get-tuple-element((f32[52]{0}, bf16[52,52]{1,0}, bf16[52,52]{1,0}, f32[52,52]{1,0}) %input_multiply_reduce_select_fusion), index=1
  %input_reduce_fusion = f32[1]{0} fusion(bf16[52,52]{1,0} %get-tuple-element.146, bf16[52,52]{1,0} %get-tuple-element.145), kind=kInput, calls=%fused_reduce, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/vmap(head)/Dense_0/convert_element_type[new_dtype=float32 weak_type=False]" source_file="/home/nicholas/programs/avid/avid/layers.py" source_line=49}
  %get-tuple-element.144 = f32[52]{0} get-tuple-element((f32[52]{0}, bf16[52,52]{1,0}, bf16[52,52]{1,0}, f32[52,52]{1,0}) %input_multiply_reduce_select_fusion), index=0
  %input_multiply_reduce_fusion = (f32[256,52]{1,0}, f32[256,1]{1,0}) fusion(f32[52]{0} %get-tuple-element.144, f32[256,1]{1,0} %Arg_31.32.0, f32[256,52]{1,0} %input_reduce_fusion.17), kind=kInput, calls=%fused_multiply_reduce, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/div" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=250}
  %get-tuple-element.142 = f32[256,52]{1,0} get-tuple-element((f32[256,52]{1,0}, f32[256,1]{1,0}) %input_multiply_reduce_fusion), index=0
  %get-tuple-element.143 = f32[256,1]{1,0} get-tuple-element((f32[256,52]{1,0}, f32[256,1]{1,0}) %input_multiply_reduce_fusion), index=1
  %input_reduce_fusion.39 = (f32[512,52]{1,0}, f32[512,52]{1,0}) fusion(f32[256]{0} %Arg_1.2.0, f32[1,512,52]{2,1,0} %get-tuple-element.148, f32[256,52]{1,0} %get-tuple-element.142, f32[512,256,52]{2,1,0} %input_transpose_fusion.15, f32[512,52]{1,0} %get-tuple-element.149), kind=kInput, calls=%fused_reduce.39, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoder_norm/neg" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=228}
  %get-tuple-element.141 = f32[512,52]{1,0} get-tuple-element((f32[512,52]{1,0}, f32[512,52]{1,0}) %input_reduce_fusion.39), index=1
  %get-tuple-element.140 = f32[512,52]{1,0} get-tuple-element((f32[512,52]{1,0}, f32[512,52]{1,0}) %input_reduce_fusion.39), index=0
  %loop_multiply_fusion = (f32[512,52]{1,0}, f32[512,52]{1,0}) fusion(f32[1,512,52]{2,1,0} %get-tuple-element.148, f32[512,52]{1,0} %get-tuple-element.149, f32[512,52]{1,0} %get-tuple-element.150, f32[512,52]{1,0} %get-tuple-element.141, f32[512,52]{1,0} %get-tuple-element.140, /*index=5*/f32[512,52]{1,0} %get-tuple-element.151), kind=kLoop, calls=%fused_multiply, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoder_norm/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=228 deduplicated_name="loop_multiply_fusion"}
  %get-tuple-element.137 = f32[512,52]{1,0} get-tuple-element((f32[512,52]{1,0}, f32[512,52]{1,0}) %loop_multiply_fusion), index=1
  %get-tuple-element.136 = f32[512,52]{1,0} get-tuple-element((f32[512,52]{1,0}, f32[512,52]{1,0}) %loop_multiply_fusion), index=0
  %input_reduce_fusion.12 = (f32[512,256]{1,0}, f32[512,256]{1,0}) fusion(f32[256,52]{1,0} %get-tuple-element.142, f32[512,256,52]{2,1,0} %input_transpose_fusion.15, f32[512,52]{1,0} %get-tuple-element.149, f32[1,512,52]{2,1,0} %get-tuple-element.148), kind=kInput, calls=%fused_reduce.12
  %get-tuple-element.139 = f32[512,256]{1,0} get-tuple-element((f32[512,256]{1,0}, f32[512,256]{1,0}) %input_reduce_fusion.12), index=1
  %get-tuple-element.138 = f32[512,256]{1,0} get-tuple-element((f32[512,256]{1,0}, f32[512,256]{1,0}) %input_reduce_fusion.12), index=0
  %input_add_transpose_fusion.4 = (bf16[52,512,256]{2,1,0}, f32[512,256,52]{2,1,0}) fusion(f32[512,52]{1,0} %get-tuple-element.137, f32[512,256,52]{2,1,0} %input_transpose_fusion.15, f32[512,52]{1,0} %get-tuple-element.136, f32[256]{0} %Arg_1.2.0, f32[1,512,52]{2,1,0} %get-tuple-element.148, /*index=5*/f32[256,52]{1,0} %get-tuple-element.142), kind=kInput, calls=%fused_add_transpose.4, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoder_norm/add_any" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=228}
  %get-tuple-element.135 = f32[512,256,52]{2,1,0} get-tuple-element((bf16[52,512,256]{2,1,0}, f32[512,256,52]{2,1,0}) %input_add_transpose_fusion.4), index=1
  %get-tuple-element.134 = bf16[52,512,256]{2,1,0} get-tuple-element((bf16[52,512,256]{2,1,0}, f32[512,256,52]{2,1,0}) %input_add_transpose_fusion.4), index=0
  %bitcast.5601.0 = bf16[26624,256]{1,0} bitcast(bf16[52,512,256]{2,1,0} %get-tuple-element.134)
  %input_reduce_fusion.33 = f32[512,256]{1,0} fusion(f32[512,256,52]{2,1,0} %get-tuple-element.135), kind=kInput, calls=%fused_reduce.33
  %custom-call.64.0 = (bf16[26624,256]{1,0}, s8[4194304]{0}) custom-call(bf16[26624,256]{1,0} %bitcast.5601.0, bf16[256,256]{1,0} %wrapped_convert.11), custom_call_target="__cublas$gemm", metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/vmap(vmap(LazyInMLP_0))/Dense_0/dot_general[dimension_numbers=(((2,), (1,)), ((), ())) precision=None preferred_element_type=None]" source_file="/home/nicholas/programs/avid/avid/layers.py" source_line=49}, backend_config={"operation_queue_id":"0","wait_on_operation_queues":[],"gemm_backend_config":{"alpha_real":1,"alpha_imag":0,"beta":0,"dot_dimension_numbers":{"lhs_contracting_dimensions":["1"],"rhs_contracting_dimensions":["1"],"lhs_batch_dimensions":[],"rhs_batch_dimensions":[]},"precision_config":{"operand_precision":["DEFAULT","DEFAULT"]},"epilogue":"DEFAULT","selected_algorithm":"-1","lhs_stride":"6815744","rhs_stride":"65536","grad_x":false,"grad_y":false}}
  %get-tuple-element.50.0 = bf16[26624,256]{1,0} get-tuple-element((bf16[26624,256]{1,0}, s8[4194304]{0}) %custom-call.64.0), index=0, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/vmap(vmap(LazyInMLP_0))/Dense_0/dot_general[dimension_numbers=(((2,), (1,)), ((), ())) precision=None preferred_element_type=None]" source_file="/home/nicholas/programs/avid/avid/layers.py" source_line=49}
  %input_reduce_fusion.1 = f32[208,256]{1,0} fusion(bf16[26624,256]{1,0} %get-tuple-element.50.0), kind=kInput, calls=%fused_reduce.1, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/LayerNorm_1/reduce_sum[axes=(0, 1)]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171 deduplicated_name="input_reduce_fusion.1"}
  %input_transpose_fusion.7 = f32[512,256,52]{2,1,0} fusion(bf16[26624,256]{1,0} %get-tuple-element.50.0), kind=kInput, calls=%fused_transpose.7, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/LayerNorm_1/convert_element_type[new_dtype=float32 weak_type=False]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171 deduplicated_name="input_transpose_fusion.3"}
  %input_reduce_fusion.24 = (f32[512,52]{1,0}, f32[512,52]{1,0}) fusion(f32[256]{0} %Arg_19.20.0, f32[512,256,52]{2,1,0} %input_transpose_fusion.7, f32[512,256,52]{2,1,0} %input_transpose_fusion.16, f32[512,52]{1,0} %get-tuple-element.153, f32[1,512,52]{2,1,0} %get-tuple-element.152), kind=kInput, calls=%fused_reduce.24
  %get-tuple-element.133 = f32[512,52]{1,0} get-tuple-element((f32[512,52]{1,0}, f32[512,52]{1,0}) %input_reduce_fusion.24), index=1
  %get-tuple-element.132 = f32[512,52]{1,0} get-tuple-element((f32[512,52]{1,0}, f32[512,52]{1,0}) %input_reduce_fusion.24), index=0
  %loop_multiply_fusion.1 = (f32[512,52]{1,0}, f32[512,52]{1,0}) fusion(f32[1,512,52]{2,1,0} %get-tuple-element.152, f32[512,52]{1,0} %get-tuple-element.153, f32[512,52]{1,0} %get-tuple-element.154, f32[512,52]{1,0} %get-tuple-element.132, f32[512,52]{1,0} %get-tuple-element.133, /*index=5*/f32[512,52]{1,0} %get-tuple-element.155), kind=kLoop, calls=%fused_multiply.1, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/LayerNorm_1/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171 deduplicated_name="loop_multiply_fusion"}
  %get-tuple-element.129 = f32[512,52]{1,0} get-tuple-element((f32[512,52]{1,0}, f32[512,52]{1,0}) %loop_multiply_fusion.1), index=1
  %get-tuple-element.128 = f32[512,52]{1,0} get-tuple-element((f32[512,52]{1,0}, f32[512,52]{1,0}) %loop_multiply_fusion.1), index=0
  %input_reduce_fusion.18 = f32[512,256]{1,0} fusion(f32[1,512,52]{2,1,0} %get-tuple-element.152, f32[512,256,52]{2,1,0} %input_transpose_fusion.7, f32[512,256,52]{2,1,0} %input_transpose_fusion.16, f32[512,52]{1,0} %get-tuple-element.153), kind=kInput, calls=%fused_reduce.18
  %input_add_transpose_fusion.3 = (bf16[52,512,256]{2,1,0}, f32[512,256,52]{2,1,0}) fusion(f32[512,52]{1,0} %get-tuple-element.129, f32[512,256,52]{2,1,0} %input_transpose_fusion.16, f32[512,52]{1,0} %get-tuple-element.128, f32[512,256,52]{2,1,0} %get-tuple-element.135, f32[512,256,52]{2,1,0} %input_transpose_fusion.7, /*index=5*/f32[256]{0} %Arg_19.20.0, f32[1,512,52]{2,1,0} %get-tuple-element.152), kind=kInput, calls=%fused_add_transpose.3, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/LayerNorm_1/add_any" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171 deduplicated_name="input_add_transpose_fusion.1"}
  %input_transpose_fusion.27 = bf16[256,52,512]{2,1,0} fusion(f32[512,256,52]{2,1,0} %get-tuple-element.135), kind=kInput, calls=%fused_transpose.28, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=183 deduplicated_name="input_transpose_fusion.23"}
  %get-tuple-element.127 = f32[512,256,52]{2,1,0} get-tuple-element((bf16[52,512,256]{2,1,0}, f32[512,256,52]{2,1,0}) %input_add_transpose_fusion.3), index=1
  %get-tuple-element.126 = bf16[52,512,256]{2,1,0} get-tuple-element((bf16[52,512,256]{2,1,0}, f32[512,256,52]{2,1,0}) %input_add_transpose_fusion.3), index=0
  %bitcast.5714.0 = bf16[26624,256]{1,0} bitcast(bf16[52,512,256]{2,1,0} %get-tuple-element.126)
  %bitcast.6456.0 = bf16[256,26624]{1,0} bitcast(bf16[256,52,512]{2,1,0} %input_transpose_fusion.27)
  %custom-call.85.0 = (bf16[256,256]{1,0}, s8[4194304]{0}) custom-call(bf16[26624,256]{1,0} %bitcast.6451.0, bf16[256,26624]{1,0} %bitcast.6456.0), custom_call_target="__cublas$gemm", metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/vmap(vmap(LazyInMLP_0))/Dense_0/transpose[permutation=(1, 0)]" source_file="/home/nicholas/programs/avid/avid/layers.py" source_line=49}, backend_config={"operation_queue_id":"0","wait_on_operation_queues":[],"gemm_backend_config":{"alpha_real":1,"alpha_imag":0,"beta":0,"dot_dimension_numbers":{"lhs_contracting_dimensions":["0"],"rhs_contracting_dimensions":["1"],"lhs_batch_dimensions":[],"rhs_batch_dimensions":[]},"precision_config":{"operand_precision":["DEFAULT","DEFAULT"]},"epilogue":"DEFAULT","selected_algorithm":"-1","lhs_stride":"6815744","rhs_stride":"6815744","grad_x":false,"grad_y":false}}
  %get-tuple-element.73.0 = bf16[256,256]{1,0} get-tuple-element((bf16[256,256]{1,0}, s8[4194304]{0}) %custom-call.85.0), index=0, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/vmap(vmap(LazyInMLP_0))/Dense_0/transpose[permutation=(1, 0)]" source_file="/home/nicholas/programs/avid/avid/layers.py" source_line=49}
  %input_reduce_fusion.34 = f32[512,256]{1,0} fusion(f32[512,256,52]{2,1,0} %get-tuple-element.127), kind=kInput, calls=%fused_reduce.34
  %custom-call.65.0 = (bf16[26624,256]{1,0}, s8[4194304]{0}) custom-call(bf16[26624,256]{1,0} %bitcast.5714.0, bf16[256,256]{0,1} %bitcast.5718.0), custom_call_target="__cublas$gemm", metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/MultiHeadDotProductAttention_0/out/dot_general[dimension_numbers=(((2,), (2,)), ((), ())) precision=None preferred_element_type=None]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}, backend_config={"operation_queue_id":"0","wait_on_operation_queues":[],"gemm_backend_config":{"alpha_real":1,"alpha_imag":0,"beta":0,"dot_dimension_numbers":{"lhs_contracting_dimensions":["1"],"rhs_contracting_dimensions":["0"],"lhs_batch_dimensions":[],"rhs_batch_dimensions":[]},"precision_config":{"operand_precision":["DEFAULT","DEFAULT"]},"epilogue":"DEFAULT","selected_algorithm":"-1","lhs_stride":"6815744","rhs_stride":"65536","grad_x":false,"grad_y":false}}
  %get-tuple-element.51.0 = bf16[26624,256]{1,0} get-tuple-element((bf16[26624,256]{1,0}, s8[4194304]{0}) %custom-call.65.0), index=0, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/MultiHeadDotProductAttention_0/out/dot_general[dimension_numbers=(((2,), (2,)), ((), ())) precision=None preferred_element_type=None]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %input_transpose_fusion.26 = bf16[256,52,512]{2,1,0} fusion(f32[512,256,52]{2,1,0} %get-tuple-element.127), kind=kInput, calls=%fused_transpose.27, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=167 deduplicated_name="input_transpose_fusion.23"}
  %bitcast.6510.0 = bf16[256,26624]{1,0} bitcast(bf16[256,52,512]{2,1,0} %input_transpose_fusion.26)
  %custom-call.87.0 = (bf16[256,256]{0,1}, s8[4194304]{0}) custom-call(bf16[256,26624]{1,0} %bitcast.6510.0, bf16[26624,256]{1,0} %bitcast.6512.0), custom_call_target="__cublas$gemm", metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/MultiHeadDotProductAttention_0/out/dot_general[dimension_numbers=(((0, 1), (0, 1)), ((), ())) precision=None preferred_element_type=None]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}, backend_config={"operation_queue_id":"0","wait_on_operation_queues":[],"gemm_backend_config":{"alpha_real":1,"alpha_imag":0,"beta":0,"dot_dimension_numbers":{"lhs_contracting_dimensions":["1"],"rhs_contracting_dimensions":["0"],"lhs_batch_dimensions":[],"rhs_batch_dimensions":[]},"precision_config":{"operand_precision":["DEFAULT","DEFAULT"]},"epilogue":"DEFAULT","selected_algorithm":"-1","lhs_stride":"6815744","rhs_stride":"6815744","grad_x":false,"grad_y":false}}
  %get-tuple-element.75.0 = bf16[256,256]{0,1} get-tuple-element((bf16[256,256]{0,1}, s8[4194304]{0}) %custom-call.87.0), index=0, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/MultiHeadDotProductAttention_0/out/dot_general[dimension_numbers=(((0, 1), (0, 1)), ((), ())) precision=None preferred_element_type=None]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %loop_convert_fusion.3 = f32[4,64,256]{2,1,0} fusion(bf16[256,256]{0,1} %get-tuple-element.75.0), kind=kLoop, calls=%fused_convert.3, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/MultiHeadDotProductAttention_0/out/convert_element_type[new_dtype=float32 weak_type=False]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158 deduplicated_name="loop_convert_fusion.3"}
  %input_transpose_fusion.6 = (bf16[52,4,512,64]{3,2,1,0}, bf16[52,4,64,512]{3,2,1,0}) fusion(bf16[26624,256]{1,0} %get-tuple-element.51.0), kind=kInput, calls=%fused_transpose.6, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/MultiHeadDotProductAttention_0/...hqk,...khd->...qhd/transpose[permutation=(0, 2, 3, 1)]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158 deduplicated_name="input_transpose_fusion.2"}
  %get-tuple-element.125 = bf16[52,4,64,512]{3,2,1,0} get-tuple-element((bf16[52,4,512,64]{3,2,1,0}, bf16[52,4,64,512]{3,2,1,0}) %input_transpose_fusion.6), index=1
  %get-tuple-element.124 = bf16[52,4,512,64]{3,2,1,0} get-tuple-element((bf16[52,4,512,64]{3,2,1,0}, bf16[52,4,64,512]{3,2,1,0}) %input_transpose_fusion.6), index=0
  %bitcast.5747.0 = bf16[208,512,64]{2,1,0} bitcast(bf16[52,4,512,64]{3,2,1,0} %get-tuple-element.124)
  %bitcast.5725.0 = bf16[208,64,512]{2,1,0} bitcast(bf16[52,4,64,512]{3,2,1,0} %get-tuple-element.125)
  %custom-call.66.0 = (bf16[208,64,512]{2,1,0}, s8[4194304]{0}) custom-call(bf16[208,64,512]{2,1,0} %bitcast.5725.0, bf16[208,512,512]{2,1,0} %bitcast.5145.0), custom_call_target="__cublas$gemm", metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/MultiHeadDotProductAttention_0/...hqk,...khd->...qhd/dot_general[dimension_numbers=(((3,), (2,)), ((0, 1), (0, 1))) precision=None preferred_element_type=bfloat16]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}, backend_config={"operation_queue_id":"0","wait_on_operation_queues":[],"gemm_backend_config":{"alpha_real":1,"alpha_imag":0,"beta":0,"dot_dimension_numbers":{"lhs_contracting_dimensions":["2"],"rhs_contracting_dimensions":["1"],"lhs_batch_dimensions":["0"],"rhs_batch_dimensions":["0"]},"precision_config":{"operand_precision":["DEFAULT","DEFAULT"]},"epilogue":"DEFAULT","selected_algorithm":"-1","lhs_stride":"32768","rhs_stride":"262144","grad_x":false,"grad_y":false}}
  %get-tuple-element.52.0 = bf16[208,64,512]{2,1,0} get-tuple-element((bf16[208,64,512]{2,1,0}, s8[4194304]{0}) %custom-call.66.0), index=0, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/MultiHeadDotProductAttention_0/...hqk,...khd->...qhd/dot_general[dimension_numbers=(((3,), (2,)), ((0, 1), (0, 1))) precision=None preferred_element_type=bfloat16]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %input_reduce_fusion.25 = f32[52,4,64]{2,1,0} fusion(bf16[208,64,512]{2,1,0} %get-tuple-element.52.0), kind=kInput, calls=%fused_reduce.25
  %input_reduce_fusion.35 = f32[4,64]{1,0} fusion(f32[52,4,64]{2,1,0} %input_reduce_fusion.25), kind=kInput, calls=%fused_reduce.35, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/MultiHeadDotProductAttention_0/value/reduce_sum[axes=(0, 1)]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %input_transpose_fusion.5 = (bf16[4,64,52,512]{3,2,1,0}, bf16[52,512,4,64]{3,2,1,0}) fusion(bf16[208,64,512]{2,1,0} %get-tuple-element.52.0), kind=kInput, calls=%fused_transpose.5, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/MultiHeadDotProductAttention_0/...hqk,...khd->...qhd/transpose[permutation=(0, 3, 1, 2)]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158 deduplicated_name="input_transpose_fusion.1"}
  %get-tuple-element.118 = bf16[52,512,4,64]{3,2,1,0} get-tuple-element((bf16[4,64,52,512]{3,2,1,0}, bf16[52,512,4,64]{3,2,1,0}) %input_transpose_fusion.5), index=1
  %get-tuple-element.117 = bf16[4,64,52,512]{3,2,1,0} get-tuple-element((bf16[4,64,52,512]{3,2,1,0}, bf16[52,512,4,64]{3,2,1,0}) %input_transpose_fusion.5), index=0
  %bitcast.6563.0 = bf16[256,26624]{1,0} bitcast(bf16[4,64,52,512]{3,2,1,0} %get-tuple-element.117)
  %custom-call.89.0 = (bf16[256,256]{0,1}, s8[4194304]{0}) custom-call(bf16[256,26624]{1,0} %bitcast.6563.0, bf16[26624,256]{1,0} %bitcast.6565.0), custom_call_target="__cublas$gemm", metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/MultiHeadDotProductAttention_0/value/dot_general[dimension_numbers=(((0, 1), (0, 1)), ((), ())) precision=None preferred_element_type=None]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}, backend_config={"operation_queue_id":"0","wait_on_operation_queues":[],"gemm_backend_config":{"alpha_real":1,"alpha_imag":0,"beta":0,"dot_dimension_numbers":{"lhs_contracting_dimensions":["1"],"rhs_contracting_dimensions":["0"],"lhs_batch_dimensions":[],"rhs_batch_dimensions":[]},"precision_config":{"operand_precision":["DEFAULT","DEFAULT"]},"epilogue":"DEFAULT","selected_algorithm":"-1","lhs_stride":"6815744","rhs_stride":"6815744","grad_x":false,"grad_y":false}}
  %get-tuple-element.77.0 = bf16[256,256]{0,1} get-tuple-element((bf16[256,256]{0,1}, s8[4194304]{0}) %custom-call.89.0), index=0, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/MultiHeadDotProductAttention_0/value/dot_general[dimension_numbers=(((0, 1), (0, 1)), ((), ())) precision=None preferred_element_type=None]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %bitcast.5736.0 = bf16[26624,256]{1,0} bitcast(bf16[52,512,4,64]{3,2,1,0} %get-tuple-element.118)
  %loop_convert_fusion.1 = f32[256,4,64]{2,1,0} fusion(bf16[256,256]{0,1} %get-tuple-element.77.0), kind=kLoop, calls=%fused_convert.1, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/MultiHeadDotProductAttention_0/value/convert_element_type[new_dtype=float32 weak_type=False]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158 deduplicated_name="loop_convert_fusion.1"}
  %custom-call.67.0 = (bf16[208,512,512]{2,1,0}, s8[4194304]{0}) custom-call(bf16[208,512,64]{2,1,0} %bitcast.5747.0, bf16[208,64,512]{2,1,0} %bitcast.5064.0), custom_call_target="__cublas$gemm", metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/MultiHeadDotProductAttention_0/...hqk,...khd->...qhd/dot_general[dimension_numbers=(((2,), (3,)), ((0, 1), (0, 2))) precision=None preferred_element_type=bfloat16]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}, backend_config={"operation_queue_id":"0","wait_on_operation_queues":[],"gemm_backend_config":{"alpha_real":1,"alpha_imag":0,"beta":0,"dot_dimension_numbers":{"lhs_contracting_dimensions":["2"],"rhs_contracting_dimensions":["1"],"lhs_batch_dimensions":["0"],"rhs_batch_dimensions":["0"]},"precision_config":{"operand_precision":["DEFAULT","DEFAULT"]},"epilogue":"DEFAULT","selected_algorithm":"-1","lhs_stride":"32768","rhs_stride":"32768","grad_x":false,"grad_y":false}}
  %get-tuple-element.53.0 = bf16[208,512,512]{2,1,0} get-tuple-element((bf16[208,512,512]{2,1,0}, s8[4194304]{0}) %custom-call.67.0), index=0, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/MultiHeadDotProductAttention_0/...hqk,...khd->...qhd/dot_general[dimension_numbers=(((2,), (3,)), ((0, 1), (0, 2))) precision=None preferred_element_type=bfloat16]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %input_reduce_fusion.28 = f32[52,4,512]{2,1,0} fusion(f32[52,4,512]{2,1,0} %input_reduce_fusion.9, bf16[208,512,512]{2,1,0} %get-tuple-element.46.0, f32[52,4,512]{2,1,0} %get-tuple-element.123, bf16[208,512,512]{2,1,0} %get-tuple-element.53.0), kind=kInput, calls=%fused_reduce.28, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/MultiHeadDotProductAttention_0/neg" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158 deduplicated_name="input_reduce_fusion.28"}
  %loop_convert_fusion.12 = bf16[52,4,512,512]{3,2,1,0} fusion(f32[52,4,512]{2,1,0} %input_reduce_fusion.11, bf16[208,512,512]{2,1,0} %get-tuple-element.53.0, f32[52,4,512]{2,1,0} %input_reduce_fusion.28, f32[52,4,512]{2,1,0} %input_reduce_fusion.9, bf16[208,512,512]{2,1,0} %get-tuple-element.46.0), kind=kLoop, calls=%fused_convert.12
  %bitcast.5794.0 = bf16[208,512,512]{2,1,0} bitcast(bf16[52,4,512,512]{3,2,1,0} %loop_convert_fusion.12)
  %custom-call.70.0 = (bf16[208,512,64]{2,1,0}, s8[4194304]{0}) custom-call(bf16[208,512,512]{2,1,0} %bitcast.5794.0, bf16[208,512,64]{2,1,0} %bitcast.5823.0), custom_call_target="__cublas$gemm", metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/MultiHeadDotProductAttention_0/...qhd,...khd->...hqk/dot_general[dimension_numbers=(((3,), (1,)), ((0, 1), (0, 2))) precision=None preferred_element_type=bfloat16]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}, backend_config={"operation_queue_id":"0","wait_on_operation_queues":[],"gemm_backend_config":{"alpha_real":1,"alpha_imag":0,"beta":0,"dot_dimension_numbers":{"lhs_contracting_dimensions":["2"],"rhs_contracting_dimensions":["1"],"lhs_batch_dimensions":["0"],"rhs_batch_dimensions":["0"]},"precision_config":{"operand_precision":["DEFAULT","DEFAULT"]},"epilogue":"DEFAULT","selected_algorithm":"-1","lhs_stride":"262144","rhs_stride":"32768","grad_x":false,"grad_y":false}}
  %custom-call.68.0 = (bf16[208,512,64]{2,1,0}, s8[4194304]{0}) custom-call(bf16[208,512,512]{2,1,0} %bitcast.5794.0, bf16[208,512,64]{2,1,0} %bitcast.5090.0), custom_call_target="__cublas$gemm", metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/MultiHeadDotProductAttention_0/...qhd,...khd->...hqk/dot_general[dimension_numbers=(((2,), (1,)), ((0, 1), (0, 2))) precision=None preferred_element_type=bfloat16]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}, backend_config={"operation_queue_id":"0","wait_on_operation_queues":[],"gemm_backend_config":{"alpha_real":1,"alpha_imag":0,"beta":0,"dot_dimension_numbers":{"lhs_contracting_dimensions":["1"],"rhs_contracting_dimensions":["1"],"lhs_batch_dimensions":["0"],"rhs_batch_dimensions":["0"]},"precision_config":{"operand_precision":["DEFAULT","DEFAULT"]},"epilogue":"DEFAULT","selected_algorithm":"-1","lhs_stride":"262144","rhs_stride":"32768","grad_x":false,"grad_y":false}}
  %get-tuple-element.54.0 = bf16[208,512,64]{2,1,0} get-tuple-element((bf16[208,512,64]{2,1,0}, s8[4194304]{0}) %custom-call.68.0), index=0, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/MultiHeadDotProductAttention_0/...qhd,...khd->...hqk/dot_general[dimension_numbers=(((2,), (1,)), ((0, 1), (0, 2))) precision=None preferred_element_type=bfloat16]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %get-tuple-element.57.0 = bf16[208,512,64]{2,1,0} get-tuple-element((bf16[208,512,64]{2,1,0}, s8[4194304]{0}) %custom-call.70.0), index=0, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/MultiHeadDotProductAttention_0/...qhd,...khd->...hqk/dot_general[dimension_numbers=(((3,), (1,)), ((0, 1), (0, 2))) precision=None preferred_element_type=bfloat16]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %input_reduce_transpose_fusion.3 = (bf16[52,512,4,64]{3,2,1,0}, f32[52,4,64]{2,1,0}, bf16[4,64,52,512]{3,2,1,0}) fusion(bf16[208,512,64]{2,1,0} %get-tuple-element.57.0), kind=kInput, calls=%fused_reduce_transpose.3, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/MultiHeadDotProductAttention_0/div" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158 deduplicated_name="input_reduce_transpose_fusion.2"}
  %get-tuple-element.121 = bf16[4,64,52,512]{3,2,1,0} get-tuple-element((bf16[52,512,4,64]{3,2,1,0}, f32[52,4,64]{2,1,0}, bf16[4,64,52,512]{3,2,1,0}) %input_reduce_transpose_fusion.3), index=2
  %bitcast.6534.0 = bf16[256,26624]{1,0} bitcast(bf16[4,64,52,512]{3,2,1,0} %get-tuple-element.121)
  %get-tuple-element.120 = f32[52,4,64]{2,1,0} get-tuple-element((bf16[52,512,4,64]{3,2,1,0}, f32[52,4,64]{2,1,0}, bf16[4,64,52,512]{3,2,1,0}) %input_reduce_transpose_fusion.3), index=1
  %get-tuple-element.119 = bf16[52,512,4,64]{3,2,1,0} get-tuple-element((bf16[52,512,4,64]{3,2,1,0}, f32[52,4,64]{2,1,0}, bf16[4,64,52,512]{3,2,1,0}) %input_reduce_transpose_fusion.3), index=0
  %bitcast.5836.0 = bf16[26624,256]{1,0} bitcast(bf16[52,512,4,64]{3,2,1,0} %get-tuple-element.119)
  %custom-call.71.0 = (bf16[26624,256]{1,0}, s8[4194304]{0}) custom-call(bf16[26624,256]{1,0} %bitcast.5836.0, bf16[256,256]{0,1} %bitcast.5840.0), custom_call_target="__cublas$gemm", metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/MultiHeadDotProductAttention_0/query/dot_general[dimension_numbers=(((2, 3), (1, 2)), ((), ())) precision=None preferred_element_type=None]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}, backend_config={"operation_queue_id":"0","wait_on_operation_queues":[],"gemm_backend_config":{"alpha_real":1,"alpha_imag":0,"beta":0,"dot_dimension_numbers":{"lhs_contracting_dimensions":["1"],"rhs_contracting_dimensions":["0"],"lhs_batch_dimensions":[],"rhs_batch_dimensions":[]},"precision_config":{"operand_precision":["DEFAULT","DEFAULT"]},"epilogue":"DEFAULT","selected_algorithm":"-1","lhs_stride":"6815744","rhs_stride":"65536","grad_x":false,"grad_y":false}}
  %get-tuple-element.58.0 = bf16[26624,256]{1,0} get-tuple-element((bf16[26624,256]{1,0}, s8[4194304]{0}) %custom-call.71.0), index=0, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/MultiHeadDotProductAttention_0/query/dot_general[dimension_numbers=(((2, 3), (1, 2)), ((), ())) precision=None preferred_element_type=None]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %custom-call.88.0 = (bf16[256,256]{0,1}, s8[4194304]{0}) custom-call(bf16[256,26624]{1,0} %bitcast.6534.0, bf16[26624,256]{1,0} %bitcast.6565.0), custom_call_target="__cublas$gemm", metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/MultiHeadDotProductAttention_0/query/dot_general[dimension_numbers=(((0, 1), (0, 1)), ((), ())) precision=None preferred_element_type=None]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}, backend_config={"operation_queue_id":"0","wait_on_operation_queues":[],"gemm_backend_config":{"alpha_real":1,"alpha_imag":0,"beta":0,"dot_dimension_numbers":{"lhs_contracting_dimensions":["1"],"rhs_contracting_dimensions":["0"],"lhs_batch_dimensions":[],"rhs_batch_dimensions":[]},"precision_config":{"operand_precision":["DEFAULT","DEFAULT"]},"epilogue":"DEFAULT","selected_algorithm":"-1","lhs_stride":"6815744","rhs_stride":"6815744","grad_x":false,"grad_y":false}}
  %get-tuple-element.76.0 = bf16[256,256]{0,1} get-tuple-element((bf16[256,256]{0,1}, s8[4194304]{0}) %custom-call.88.0), index=0, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/MultiHeadDotProductAttention_0/query/dot_general[dimension_numbers=(((0, 1), (0, 1)), ((), ())) precision=None preferred_element_type=None]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %loop_convert_fusion.2 = f32[256,4,64]{2,1,0} fusion(bf16[256,256]{0,1} %get-tuple-element.76.0), kind=kLoop, calls=%fused_convert.2, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/MultiHeadDotProductAttention_0/query/convert_element_type[new_dtype=float32 weak_type=False]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158 deduplicated_name="loop_convert_fusion.1"}
  %input_reduce_transpose_fusion.1 = (bf16[4,64,52,512]{3,2,1,0}, bf16[52,512,4,64]{3,2,1,0}, f32[52,4,64]{2,1,0}) fusion(bf16[208,512,64]{2,1,0} %get-tuple-element.54.0), kind=kInput, calls=%fused_reduce_transpose.1, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/MultiHeadDotProductAttention_0/...qhd,...khd->...hqk/transpose[permutation=(0, 2, 1, 3)]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158 deduplicated_name="input_reduce_transpose_fusion"}
  %get-tuple-element.116 = f32[52,4,64]{2,1,0} get-tuple-element((bf16[4,64,52,512]{3,2,1,0}, bf16[52,512,4,64]{3,2,1,0}, f32[52,4,64]{2,1,0}) %input_reduce_transpose_fusion.1), index=2
  %get-tuple-element.115 = bf16[52,512,4,64]{3,2,1,0} get-tuple-element((bf16[4,64,52,512]{3,2,1,0}, bf16[52,512,4,64]{3,2,1,0}, f32[52,4,64]{2,1,0}) %input_reduce_transpose_fusion.1), index=1
  %get-tuple-element.114 = bf16[4,64,52,512]{3,2,1,0} get-tuple-element((bf16[4,64,52,512]{3,2,1,0}, bf16[52,512,4,64]{3,2,1,0}, f32[52,4,64]{2,1,0}) %input_reduce_transpose_fusion.1), index=0
  %bitcast.6481.0 = bf16[256,26624]{1,0} bitcast(bf16[4,64,52,512]{3,2,1,0} %get-tuple-element.114)
  %custom-call.86.0 = (bf16[256,256]{0,1}, s8[4194304]{0}) custom-call(bf16[256,26624]{1,0} %bitcast.6481.0, bf16[26624,256]{1,0} %bitcast.6565.0), custom_call_target="__cublas$gemm", metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/MultiHeadDotProductAttention_0/key/dot_general[dimension_numbers=(((0, 1), (0, 1)), ((), ())) precision=None preferred_element_type=None]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}, backend_config={"operation_queue_id":"0","wait_on_operation_queues":[],"gemm_backend_config":{"alpha_real":1,"alpha_imag":0,"beta":0,"dot_dimension_numbers":{"lhs_contracting_dimensions":["1"],"rhs_contracting_dimensions":["0"],"lhs_batch_dimensions":[],"rhs_batch_dimensions":[]},"precision_config":{"operand_precision":["DEFAULT","DEFAULT"]},"epilogue":"DEFAULT","selected_algorithm":"-1","lhs_stride":"6815744","rhs_stride":"6815744","grad_x":false,"grad_y":false}}
  %get-tuple-element.74.0 = bf16[256,256]{0,1} get-tuple-element((bf16[256,256]{0,1}, s8[4194304]{0}) %custom-call.86.0), index=0, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/MultiHeadDotProductAttention_0/key/dot_general[dimension_numbers=(((0, 1), (0, 1)), ((), ())) precision=None preferred_element_type=None]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %bitcast.5805.0 = bf16[26624,256]{1,0} bitcast(bf16[52,512,4,64]{3,2,1,0} %get-tuple-element.115)
  %loop_convert_fusion.4 = f32[256,4,64]{2,1,0} fusion(bf16[256,256]{0,1} %get-tuple-element.74.0), kind=kLoop, calls=%fused_convert.4, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/MultiHeadDotProductAttention_0/key/convert_element_type[new_dtype=float32 weak_type=False]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158 deduplicated_name="loop_convert_fusion.1"}
  %custom-call.69.0 = (bf16[26624,256]{1,0}, s8[4194304]{0}) custom-call(bf16[26624,256]{1,0} %bitcast.5805.0, bf16[256,256]{0,1} %bitcast.5809.0), custom_call_target="__cublas$gemm", metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/MultiHeadDotProductAttention_0/key/dot_general[dimension_numbers=(((2, 3), (1, 2)), ((), ())) precision=None preferred_element_type=None]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}, backend_config={"operation_queue_id":"0","wait_on_operation_queues":[],"gemm_backend_config":{"alpha_real":1,"alpha_imag":0,"beta":0,"dot_dimension_numbers":{"lhs_contracting_dimensions":["1"],"rhs_contracting_dimensions":["0"],"lhs_batch_dimensions":[],"rhs_batch_dimensions":[]},"precision_config":{"operand_precision":["DEFAULT","DEFAULT"]},"epilogue":"DEFAULT","selected_algorithm":"-1","lhs_stride":"6815744","rhs_stride":"65536","grad_x":false,"grad_y":false}}
  %get-tuple-element.55.0 = bf16[26624,256]{1,0} get-tuple-element((bf16[26624,256]{1,0}, s8[4194304]{0}) %custom-call.69.0), index=0, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/MultiHeadDotProductAttention_0/key/dot_general[dimension_numbers=(((2, 3), (1, 2)), ((), ())) precision=None preferred_element_type=None]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %cublas-gemm.4.0 = (bf16[26624,256]{1,0}, s8[4194304]{0}) custom-call(bf16[26624,256]{1,0} %bitcast.5736.0, bf16[256,256]{0,1} %bitcast.5740.0, bf16[26624,256]{1,0} %get-tuple-element.55.0), custom_call_target="__cublas$gemm", output_to_operand_aliasing={{0}: (2, {})}, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/MultiHeadDotProductAttention_0/value/dot_general[dimension_numbers=(((2, 3), (1, 2)), ((), ())) precision=None preferred_element_type=None]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}, backend_config={"operation_queue_id":"0","wait_on_operation_queues":[],"gemm_backend_config":{"alpha_real":1,"alpha_imag":0,"beta":1,"dot_dimension_numbers":{"lhs_contracting_dimensions":["1"],"rhs_contracting_dimensions":["0"],"lhs_batch_dimensions":[],"rhs_batch_dimensions":[]},"precision_config":{"operand_precision":["DEFAULT","DEFAULT"]},"epilogue":"DEFAULT","selected_algorithm":"-1","lhs_stride":"6815744","rhs_stride":"65536","grad_x":false,"grad_y":false}}
  %get-tuple-element.56.0 = bf16[26624,256]{1,0} get-tuple-element((bf16[26624,256]{1,0}, s8[4194304]{0}) %cublas-gemm.4.0), index=0, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/MultiHeadDotProductAttention_0/value/dot_general[dimension_numbers=(((2, 3), (1, 2)), ((), ())) precision=None preferred_element_type=None]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %input_reduce_fusion.2 = f32[208,256]{1,0} fusion(bf16[26624,256]{1,0} %get-tuple-element.58.0, bf16[26624,256]{1,0} %get-tuple-element.56.0), kind=kInput, calls=%fused_reduce.2, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/LayerNorm_0/reduce_sum[axes=(0, 1)]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156 deduplicated_name="input_reduce_fusion.2"}
  %input_transpose_fusion.4 = f32[512,256,52]{2,1,0} fusion(bf16[26624,256]{1,0} %get-tuple-element.58.0, bf16[26624,256]{1,0} %get-tuple-element.56.0), kind=kInput, calls=%fused_transpose.4, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/LayerNorm_0/convert_element_type[new_dtype=float32 weak_type=False]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156 deduplicated_name="input_transpose_fusion"}
  %input_reduce_fusion.23 = (f32[512,52]{1,0}, f32[512,52]{1,0}) fusion(f32[256]{0} %Arg_17.18.0, f32[512,256,52]{2,1,0} %input_transpose_fusion.4, f32[512,256,52]{2,1,0} %input_transpose_fusion.17, f32[512,52]{1,0} %get-tuple-element.158, f32[1,512,52]{2,1,0} %get-tuple-element.157), kind=kInput, calls=%fused_reduce.23
  %get-tuple-element.113 = f32[512,52]{1,0} get-tuple-element((f32[512,52]{1,0}, f32[512,52]{1,0}) %input_reduce_fusion.23), index=1
  %get-tuple-element.112 = f32[512,52]{1,0} get-tuple-element((f32[512,52]{1,0}, f32[512,52]{1,0}) %input_reduce_fusion.23), index=0
  %loop_multiply_fusion.2 = (f32[512,52]{1,0}, f32[512,52]{1,0}) fusion(f32[1,512,52]{2,1,0} %get-tuple-element.157, f32[512,52]{1,0} %get-tuple-element.158, f32[512,52]{1,0} %get-tuple-element.159, f32[512,52]{1,0} %get-tuple-element.112, f32[512,52]{1,0} %get-tuple-element.113, /*index=5*/f32[512,52]{1,0} %get-tuple-element.160), kind=kLoop, calls=%fused_multiply.2, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/LayerNorm_0/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156 deduplicated_name="loop_multiply_fusion"}
  %get-tuple-element.111 = f32[512,52]{1,0} get-tuple-element((f32[512,52]{1,0}, f32[512,52]{1,0}) %loop_multiply_fusion.2), index=1
  %get-tuple-element.110 = f32[512,52]{1,0} get-tuple-element((f32[512,52]{1,0}, f32[512,52]{1,0}) %loop_multiply_fusion.2), index=0
  %input_reduce_fusion.19 = f32[512,256]{1,0} fusion(f32[1,512,52]{2,1,0} %get-tuple-element.157, f32[512,256,52]{2,1,0} %input_transpose_fusion.4, f32[512,256,52]{2,1,0} %input_transpose_fusion.17, f32[512,52]{1,0} %get-tuple-element.158), kind=kInput, calls=%fused_reduce.19
  %input_add_transpose_fusion.2 = (bf16[52,512,256]{2,1,0}, f32[512,256,52]{2,1,0}) fusion(f32[512,52]{1,0} %get-tuple-element.111, f32[512,256,52]{2,1,0} %input_transpose_fusion.17, f32[512,52]{1,0} %get-tuple-element.110, f32[512,256,52]{2,1,0} %get-tuple-element.127, f32[512,256,52]{2,1,0} %input_transpose_fusion.4, /*index=5*/f32[256]{0} %Arg_17.18.0, f32[1,512,52]{2,1,0} %get-tuple-element.157), kind=kInput, calls=%fused_add_transpose.2, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/LayerNorm_0/add_any" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156 deduplicated_name="input_add_transpose_fusion.1"}
  %get-tuple-element.109 = f32[512,256,52]{2,1,0} get-tuple-element((bf16[52,512,256]{2,1,0}, f32[512,256,52]{2,1,0}) %input_add_transpose_fusion.2), index=1
  %get-tuple-element.108 = bf16[52,512,256]{2,1,0} get-tuple-element((bf16[52,512,256]{2,1,0}, f32[512,256,52]{2,1,0}) %input_add_transpose_fusion.2), index=0
  %bitcast.5952.0 = bf16[26624,256]{1,0} bitcast(bf16[52,512,256]{2,1,0} %get-tuple-element.108)
  %input_reduce_fusion.30 = f32[512,256]{1,0} fusion(f32[512,256,52]{2,1,0} %get-tuple-element.109), kind=kInput, calls=%fused_reduce.30
  %custom-call.72.0 = (bf16[26624,256]{1,0}, s8[4194304]{0}) custom-call(bf16[26624,256]{1,0} %bitcast.5952.0, bf16[256,256]{1,0} %wrapped_convert.6), custom_call_target="__cublas$gemm", metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/vmap(vmap(LazyInMLP_0))/Dense_0/dot_general[dimension_numbers=(((2,), (1,)), ((), ())) precision=None preferred_element_type=None]" source_file="/home/nicholas/programs/avid/avid/layers.py" source_line=49}, backend_config={"operation_queue_id":"0","wait_on_operation_queues":[],"gemm_backend_config":{"alpha_real":1,"alpha_imag":0,"beta":0,"dot_dimension_numbers":{"lhs_contracting_dimensions":["1"],"rhs_contracting_dimensions":["1"],"lhs_batch_dimensions":[],"rhs_batch_dimensions":[]},"precision_config":{"operand_precision":["DEFAULT","DEFAULT"]},"epilogue":"DEFAULT","selected_algorithm":"-1","lhs_stride":"6815744","rhs_stride":"65536","grad_x":false,"grad_y":false}}
  %get-tuple-element.59.0 = bf16[26624,256]{1,0} get-tuple-element((bf16[26624,256]{1,0}, s8[4194304]{0}) %custom-call.72.0), index=0, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/vmap(vmap(LazyInMLP_0))/Dense_0/dot_general[dimension_numbers=(((2,), (1,)), ((), ())) precision=None preferred_element_type=None]" source_file="/home/nicholas/programs/avid/avid/layers.py" source_line=49}
  %input_reduce_fusion.3 = f32[208,256]{1,0} fusion(bf16[26624,256]{1,0} %get-tuple-element.59.0), kind=kInput, calls=%fused_reduce.3, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/LayerNorm_1/reduce_sum[axes=(0, 1)]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171 deduplicated_name="input_reduce_fusion.1"}
  %input_transpose_fusion.3 = f32[512,256,52]{2,1,0} fusion(bf16[26624,256]{1,0} %get-tuple-element.59.0), kind=kInput, calls=%fused_transpose.3, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/LayerNorm_1/convert_element_type[new_dtype=float32 weak_type=False]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171 deduplicated_name="input_transpose_fusion.3"}
  %input_reduce_fusion.22 = (f32[512,52]{1,0}, f32[512,52]{1,0}) fusion(f32[256]{0} %Arg_5.6.0, f32[512,256,52]{2,1,0} %input_transpose_fusion.3, f32[512,256,52]{2,1,0} %input_transpose_fusion.18, f32[512,52]{1,0} %get-tuple-element.162, f32[1,512,52]{2,1,0} %get-tuple-element.161), kind=kInput, calls=%fused_reduce.22
  %get-tuple-element.107 = f32[512,52]{1,0} get-tuple-element((f32[512,52]{1,0}, f32[512,52]{1,0}) %input_reduce_fusion.22), index=1
  %get-tuple-element.106 = f32[512,52]{1,0} get-tuple-element((f32[512,52]{1,0}, f32[512,52]{1,0}) %input_reduce_fusion.22), index=0
  %loop_multiply_fusion.3 = (f32[512,52]{1,0}, f32[512,52]{1,0}) fusion(f32[1,512,52]{2,1,0} %get-tuple-element.161, f32[512,52]{1,0} %get-tuple-element.162, f32[512,52]{1,0} %get-tuple-element.163, f32[512,52]{1,0} %get-tuple-element.106, f32[512,52]{1,0} %get-tuple-element.107, /*index=5*/f32[512,52]{1,0} %get-tuple-element.164), kind=kLoop, calls=%fused_multiply.3, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/LayerNorm_1/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171 deduplicated_name="loop_multiply_fusion"}
  %get-tuple-element.105 = f32[512,52]{1,0} get-tuple-element((f32[512,52]{1,0}, f32[512,52]{1,0}) %loop_multiply_fusion.3), index=1
  %get-tuple-element.104 = f32[512,52]{1,0} get-tuple-element((f32[512,52]{1,0}, f32[512,52]{1,0}) %loop_multiply_fusion.3), index=0
  %input_reduce_fusion.20 = f32[512,256]{1,0} fusion(f32[1,512,52]{2,1,0} %get-tuple-element.161, f32[512,256,52]{2,1,0} %input_transpose_fusion.3, f32[512,256,52]{2,1,0} %input_transpose_fusion.18, f32[512,52]{1,0} %get-tuple-element.162), kind=kInput, calls=%fused_reduce.20
  %input_add_transpose_fusion.1 = (bf16[52,512,256]{2,1,0}, f32[512,256,52]{2,1,0}) fusion(f32[512,52]{1,0} %get-tuple-element.105, f32[512,256,52]{2,1,0} %input_transpose_fusion.18, f32[512,52]{1,0} %get-tuple-element.104, f32[512,256,52]{2,1,0} %get-tuple-element.109, f32[512,256,52]{2,1,0} %input_transpose_fusion.3, /*index=5*/f32[256]{0} %Arg_5.6.0, f32[1,512,52]{2,1,0} %get-tuple-element.161), kind=kInput, calls=%fused_add_transpose.1, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/LayerNorm_1/add_any" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=171 deduplicated_name="input_add_transpose_fusion.1"}
  %input_transpose_fusion.25 = bf16[256,52,512]{2,1,0} fusion(f32[512,256,52]{2,1,0} %get-tuple-element.109), kind=kInput, calls=%fused_transpose.26, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=183 deduplicated_name="input_transpose_fusion.23"}
  %get-tuple-element.103 = f32[512,256,52]{2,1,0} get-tuple-element((bf16[52,512,256]{2,1,0}, f32[512,256,52]{2,1,0}) %input_add_transpose_fusion.1), index=1
  %get-tuple-element.102 = bf16[52,512,256]{2,1,0} get-tuple-element((bf16[52,512,256]{2,1,0}, f32[512,256,52]{2,1,0}) %input_add_transpose_fusion.1), index=0
  %bitcast.6063.0 = bf16[26624,256]{1,0} bitcast(bf16[52,512,256]{2,1,0} %get-tuple-element.102)
  %bitcast.6268.0 = bf16[256,26624]{1,0} bitcast(bf16[256,52,512]{2,1,0} %input_transpose_fusion.25)
  %custom-call.80.0 = (bf16[256,256]{1,0}, s8[4194304]{0}) custom-call(bf16[26624,256]{1,0} %bitcast.6263.0, bf16[256,26624]{1,0} %bitcast.6268.0), custom_call_target="__cublas$gemm", metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/vmap(vmap(LazyInMLP_0))/Dense_0/transpose[permutation=(1, 0)]" source_file="/home/nicholas/programs/avid/avid/layers.py" source_line=49}, backend_config={"operation_queue_id":"0","wait_on_operation_queues":[],"gemm_backend_config":{"alpha_real":1,"alpha_imag":0,"beta":0,"dot_dimension_numbers":{"lhs_contracting_dimensions":["0"],"rhs_contracting_dimensions":["1"],"lhs_batch_dimensions":[],"rhs_batch_dimensions":[]},"precision_config":{"operand_precision":["DEFAULT","DEFAULT"]},"epilogue":"DEFAULT","selected_algorithm":"-1","lhs_stride":"6815744","rhs_stride":"6815744","grad_x":false,"grad_y":false}}
  %get-tuple-element.68.0 = bf16[256,256]{1,0} get-tuple-element((bf16[256,256]{1,0}, s8[4194304]{0}) %custom-call.80.0), index=0, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/vmap(vmap(LazyInMLP_0))/Dense_0/transpose[permutation=(1, 0)]" source_file="/home/nicholas/programs/avid/avid/layers.py" source_line=49}
  %loop_convert_fusion.17 = (f32[256,256]{1,0}, f32[256,256]{1,0}) fusion(bf16[256,256]{1,0} %get-tuple-element.68.0, bf16[256,256]{1,0} %get-tuple-element.73.0), kind=kLoop, calls=%fused_convert.17
  %get-tuple-element.171 = f32[256,256]{1,0} get-tuple-element((f32[256,256]{1,0}, f32[256,256]{1,0}) %loop_convert_fusion.17), index=1, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_1/vmap(vmap(LazyInMLP_0))/Dense_0/convert_element_type[new_dtype=float32 weak_type=False]" source_file="/home/nicholas/programs/avid/avid/layers.py" source_line=49}
  %get-tuple-element.170 = f32[256,256]{1,0} get-tuple-element((f32[256,256]{1,0}, f32[256,256]{1,0}) %loop_convert_fusion.17), index=0, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/vmap(vmap(LazyInMLP_0))/Dense_0/convert_element_type[new_dtype=float32 weak_type=False]" source_file="/home/nicholas/programs/avid/avid/layers.py" source_line=49}
  %input_reduce_fusion.31 = f32[512,256]{1,0} fusion(f32[512,256,52]{2,1,0} %get-tuple-element.103), kind=kInput, calls=%fused_reduce.31
  %input_reduce_fusion.41 = (f32[256]{0}, f32[256]{0}, f32[256]{0}, f32[256]{0}, f32[256]{0}) fusion(f32[512,256]{1,0} %get-tuple-element.138, f32[512,256]{1,0} %input_reduce_fusion.31, f32[512,256]{1,0} %input_reduce_fusion.30, f32[512,256]{1,0} %input_reduce_fusion.33, f32[512,256]{1,0} %input_reduce_fusion.34), kind=kInput, calls=%fused_reduce.41, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoder_norm/reduce_sum[axes=(0, 1)]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=228}
  %get-tuple-element.187 = f32[256]{0} get-tuple-element((f32[256]{0}, f32[256]{0}, f32[256]{0}, f32[256]{0}, f32[256]{0}) %input_reduce_fusion.41), index=4
  %get-tuple-element.186 = f32[256]{0} get-tuple-element((f32[256]{0}, f32[256]{0}, f32[256]{0}, f32[256]{0}, f32[256]{0}) %input_reduce_fusion.41), index=3
  %get-tuple-element.185 = f32[256]{0} get-tuple-element((f32[256]{0}, f32[256]{0}, f32[256]{0}, f32[256]{0}, f32[256]{0}) %input_reduce_fusion.41), index=2
  %get-tuple-element.184 = f32[256]{0} get-tuple-element((f32[256]{0}, f32[256]{0}, f32[256]{0}, f32[256]{0}, f32[256]{0}) %input_reduce_fusion.41), index=1
  %get-tuple-element.183 = f32[256]{0} get-tuple-element((f32[256]{0}, f32[256]{0}, f32[256]{0}, f32[256]{0}, f32[256]{0}) %input_reduce_fusion.41), index=0
  %custom-call.73.0 = (bf16[26624,256]{1,0}, s8[4194304]{0}) custom-call(bf16[26624,256]{1,0} %bitcast.6063.0, bf16[256,256]{0,1} %bitcast.6067.0), custom_call_target="__cublas$gemm", metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/MultiHeadDotProductAttention_0/out/dot_general[dimension_numbers=(((2,), (2,)), ((), ())) precision=None preferred_element_type=None]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}, backend_config={"operation_queue_id":"0","wait_on_operation_queues":[],"gemm_backend_config":{"alpha_real":1,"alpha_imag":0,"beta":0,"dot_dimension_numbers":{"lhs_contracting_dimensions":["1"],"rhs_contracting_dimensions":["0"],"lhs_batch_dimensions":[],"rhs_batch_dimensions":[]},"precision_config":{"operand_precision":["DEFAULT","DEFAULT"]},"epilogue":"DEFAULT","selected_algorithm":"-1","lhs_stride":"6815744","rhs_stride":"65536","grad_x":false,"grad_y":false}}
  %get-tuple-element.60.0 = bf16[26624,256]{1,0} get-tuple-element((bf16[26624,256]{1,0}, s8[4194304]{0}) %custom-call.73.0), index=0, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/MultiHeadDotProductAttention_0/out/dot_general[dimension_numbers=(((2,), (2,)), ((), ())) precision=None preferred_element_type=None]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %input_transpose_fusion.24 = bf16[256,52,512]{2,1,0} fusion(f32[512,256,52]{2,1,0} %get-tuple-element.103), kind=kInput, calls=%fused_transpose.25, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=167 deduplicated_name="input_transpose_fusion.23"}
  %bitcast.6322.0 = bf16[256,26624]{1,0} bitcast(bf16[256,52,512]{2,1,0} %input_transpose_fusion.24)
  %custom-call.82.0 = (bf16[256,256]{0,1}, s8[4194304]{0}) custom-call(bf16[256,26624]{1,0} %bitcast.6322.0, bf16[26624,256]{1,0} %bitcast.6324.0), custom_call_target="__cublas$gemm", metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/MultiHeadDotProductAttention_0/out/dot_general[dimension_numbers=(((0, 1), (0, 1)), ((), ())) precision=None preferred_element_type=None]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}, backend_config={"operation_queue_id":"0","wait_on_operation_queues":[],"gemm_backend_config":{"alpha_real":1,"alpha_imag":0,"beta":0,"dot_dimension_numbers":{"lhs_contracting_dimensions":["1"],"rhs_contracting_dimensions":["0"],"lhs_batch_dimensions":[],"rhs_batch_dimensions":[]},"precision_config":{"operand_precision":["DEFAULT","DEFAULT"]},"epilogue":"DEFAULT","selected_algorithm":"-1","lhs_stride":"6815744","rhs_stride":"6815744","grad_x":false,"grad_y":false}}
  %get-tuple-element.70.0 = bf16[256,256]{0,1} get-tuple-element((bf16[256,256]{0,1}, s8[4194304]{0}) %custom-call.82.0), index=0, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/MultiHeadDotProductAttention_0/out/dot_general[dimension_numbers=(((0, 1), (0, 1)), ((), ())) precision=None preferred_element_type=None]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %loop_convert_fusion.7 = f32[4,64,256]{2,1,0} fusion(bf16[256,256]{0,1} %get-tuple-element.70.0), kind=kLoop, calls=%fused_convert.7, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/MultiHeadDotProductAttention_0/out/convert_element_type[new_dtype=float32 weak_type=False]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158 deduplicated_name="loop_convert_fusion.3"}
  %input_transpose_fusion.2 = (bf16[52,4,512,64]{3,2,1,0}, bf16[52,4,64,512]{3,2,1,0}) fusion(bf16[26624,256]{1,0} %get-tuple-element.60.0), kind=kInput, calls=%fused_transpose.2, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/MultiHeadDotProductAttention_0/...hqk,...khd->...qhd/transpose[permutation=(0, 2, 3, 1)]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158 deduplicated_name="input_transpose_fusion.2"}
  %get-tuple-element.101 = bf16[52,4,64,512]{3,2,1,0} get-tuple-element((bf16[52,4,512,64]{3,2,1,0}, bf16[52,4,64,512]{3,2,1,0}) %input_transpose_fusion.2), index=1
  %get-tuple-element.100 = bf16[52,4,512,64]{3,2,1,0} get-tuple-element((bf16[52,4,512,64]{3,2,1,0}, bf16[52,4,64,512]{3,2,1,0}) %input_transpose_fusion.2), index=0
  %bitcast.6096.0 = bf16[208,512,64]{2,1,0} bitcast(bf16[52,4,512,64]{3,2,1,0} %get-tuple-element.100)
  %bitcast.6074.0 = bf16[208,64,512]{2,1,0} bitcast(bf16[52,4,64,512]{3,2,1,0} %get-tuple-element.101)
  %custom-call.74.0 = (bf16[208,64,512]{2,1,0}, s8[4194304]{0}) custom-call(bf16[208,64,512]{2,1,0} %bitcast.6074.0, bf16[208,512,512]{2,1,0} %bitcast.4865.0), custom_call_target="__cublas$gemm", metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/MultiHeadDotProductAttention_0/...hqk,...khd->...qhd/dot_general[dimension_numbers=(((3,), (2,)), ((0, 1), (0, 1))) precision=None preferred_element_type=bfloat16]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}, backend_config={"operation_queue_id":"0","wait_on_operation_queues":[],"gemm_backend_config":{"alpha_real":1,"alpha_imag":0,"beta":0,"dot_dimension_numbers":{"lhs_contracting_dimensions":["2"],"rhs_contracting_dimensions":["1"],"lhs_batch_dimensions":["0"],"rhs_batch_dimensions":["0"]},"precision_config":{"operand_precision":["DEFAULT","DEFAULT"]},"epilogue":"DEFAULT","selected_algorithm":"-1","lhs_stride":"32768","rhs_stride":"262144","grad_x":false,"grad_y":false}}
  %get-tuple-element.61.0 = bf16[208,64,512]{2,1,0} get-tuple-element((bf16[208,64,512]{2,1,0}, s8[4194304]{0}) %custom-call.74.0), index=0, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/MultiHeadDotProductAttention_0/...hqk,...khd->...qhd/dot_general[dimension_numbers=(((3,), (2,)), ((0, 1), (0, 1))) precision=None preferred_element_type=bfloat16]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %input_reduce_fusion.26 = f32[52,4,64]{2,1,0} fusion(bf16[208,64,512]{2,1,0} %get-tuple-element.61.0), kind=kInput, calls=%fused_reduce.26
  %input_transpose_fusion.1 = (bf16[4,64,52,512]{3,2,1,0}, bf16[52,512,4,64]{3,2,1,0}) fusion(bf16[208,64,512]{2,1,0} %get-tuple-element.61.0), kind=kInput, calls=%fused_transpose.1, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/MultiHeadDotProductAttention_0/...hqk,...khd->...qhd/transpose[permutation=(0, 3, 1, 2)]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158 deduplicated_name="input_transpose_fusion.1"}
  %get-tuple-element.94 = bf16[52,512,4,64]{3,2,1,0} get-tuple-element((bf16[4,64,52,512]{3,2,1,0}, bf16[52,512,4,64]{3,2,1,0}) %input_transpose_fusion.1), index=1
  %get-tuple-element.93 = bf16[4,64,52,512]{3,2,1,0} get-tuple-element((bf16[4,64,52,512]{3,2,1,0}, bf16[52,512,4,64]{3,2,1,0}) %input_transpose_fusion.1), index=0
  %bitcast.6375.0 = bf16[256,26624]{1,0} bitcast(bf16[4,64,52,512]{3,2,1,0} %get-tuple-element.93)
  %custom-call.84.0 = (bf16[256,256]{0,1}, s8[4194304]{0}) custom-call(bf16[256,26624]{1,0} %bitcast.6375.0, bf16[26624,256]{1,0} %bitcast.6377.0), custom_call_target="__cublas$gemm", metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/MultiHeadDotProductAttention_0/value/dot_general[dimension_numbers=(((0, 1), (0, 1)), ((), ())) precision=None preferred_element_type=None]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}, backend_config={"operation_queue_id":"0","wait_on_operation_queues":[],"gemm_backend_config":{"alpha_real":1,"alpha_imag":0,"beta":0,"dot_dimension_numbers":{"lhs_contracting_dimensions":["1"],"rhs_contracting_dimensions":["0"],"lhs_batch_dimensions":[],"rhs_batch_dimensions":[]},"precision_config":{"operand_precision":["DEFAULT","DEFAULT"]},"epilogue":"DEFAULT","selected_algorithm":"-1","lhs_stride":"6815744","rhs_stride":"6815744","grad_x":false,"grad_y":false}}
  %get-tuple-element.72.0 = bf16[256,256]{0,1} get-tuple-element((bf16[256,256]{0,1}, s8[4194304]{0}) %custom-call.84.0), index=0, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/MultiHeadDotProductAttention_0/value/dot_general[dimension_numbers=(((0, 1), (0, 1)), ((), ())) precision=None preferred_element_type=None]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %bitcast.6085.0 = bf16[26624,256]{1,0} bitcast(bf16[52,512,4,64]{3,2,1,0} %get-tuple-element.94)
  %loop_convert_fusion.5 = f32[256,4,64]{2,1,0} fusion(bf16[256,256]{0,1} %get-tuple-element.72.0), kind=kLoop, calls=%fused_convert.5, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/MultiHeadDotProductAttention_0/value/convert_element_type[new_dtype=float32 weak_type=False]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158 deduplicated_name="loop_convert_fusion.1"}
  %custom-call.75.0 = (bf16[208,512,512]{2,1,0}, s8[4194304]{0}) custom-call(bf16[208,512,64]{2,1,0} %bitcast.6096.0, bf16[208,64,512]{2,1,0} %bitcast.4785.0), custom_call_target="__cublas$gemm", metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/MultiHeadDotProductAttention_0/...hqk,...khd->...qhd/dot_general[dimension_numbers=(((2,), (3,)), ((0, 1), (0, 2))) precision=None preferred_element_type=bfloat16]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}, backend_config={"operation_queue_id":"0","wait_on_operation_queues":[],"gemm_backend_config":{"alpha_real":1,"alpha_imag":0,"beta":0,"dot_dimension_numbers":{"lhs_contracting_dimensions":["2"],"rhs_contracting_dimensions":["1"],"lhs_batch_dimensions":["0"],"rhs_batch_dimensions":["0"]},"precision_config":{"operand_precision":["DEFAULT","DEFAULT"]},"epilogue":"DEFAULT","selected_algorithm":"-1","lhs_stride":"32768","rhs_stride":"32768","grad_x":false,"grad_y":false}}
  %get-tuple-element.62.0 = bf16[208,512,512]{2,1,0} get-tuple-element((bf16[208,512,512]{2,1,0}, s8[4194304]{0}) %custom-call.75.0), index=0, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/MultiHeadDotProductAttention_0/...hqk,...khd->...qhd/dot_general[dimension_numbers=(((2,), (3,)), ((0, 1), (0, 2))) precision=None preferred_element_type=bfloat16]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %input_reduce_fusion.29 = f32[52,4,512]{2,1,0} fusion(f32[52,4,512]{2,1,0} %input_reduce_fusion.8, bf16[208,512,512]{2,1,0} %get-tuple-element.39.0, f32[52,4,512]{2,1,0} %get-tuple-element.99, bf16[208,512,512]{2,1,0} %get-tuple-element.62.0), kind=kInput, calls=%fused_reduce.29, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/MultiHeadDotProductAttention_0/neg" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158 deduplicated_name="input_reduce_fusion.28"}
  %loop_convert_fusion.10 = bf16[52,4,512,512]{3,2,1,0} fusion(f32[52,4,512]{2,1,0} %input_reduce_fusion.10, bf16[208,512,512]{2,1,0} %get-tuple-element.62.0, f32[52,4,512]{2,1,0} %input_reduce_fusion.29, f32[52,4,512]{2,1,0} %input_reduce_fusion.8, bf16[208,512,512]{2,1,0} %get-tuple-element.39.0), kind=kLoop, calls=%fused_convert.10
  %bitcast.6142.0 = bf16[208,512,512]{2,1,0} bitcast(bf16[52,4,512,512]{3,2,1,0} %loop_convert_fusion.10)
  %custom-call.78.0 = (bf16[208,512,64]{2,1,0}, s8[4194304]{0}) custom-call(bf16[208,512,512]{2,1,0} %bitcast.6142.0, bf16[208,512,64]{2,1,0} %bitcast.6171.0), custom_call_target="__cublas$gemm", metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/MultiHeadDotProductAttention_0/...qhd,...khd->...hqk/dot_general[dimension_numbers=(((3,), (1,)), ((0, 1), (0, 2))) precision=None preferred_element_type=bfloat16]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}, backend_config={"operation_queue_id":"0","wait_on_operation_queues":[],"gemm_backend_config":{"alpha_real":1,"alpha_imag":0,"beta":0,"dot_dimension_numbers":{"lhs_contracting_dimensions":["2"],"rhs_contracting_dimensions":["1"],"lhs_batch_dimensions":["0"],"rhs_batch_dimensions":["0"]},"precision_config":{"operand_precision":["DEFAULT","DEFAULT"]},"epilogue":"DEFAULT","selected_algorithm":"-1","lhs_stride":"262144","rhs_stride":"32768","grad_x":false,"grad_y":false}}
  %custom-call.76.0 = (bf16[208,512,64]{2,1,0}, s8[4194304]{0}) custom-call(bf16[208,512,512]{2,1,0} %bitcast.6142.0, bf16[208,512,64]{2,1,0} %bitcast.4811.0), custom_call_target="__cublas$gemm", metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/MultiHeadDotProductAttention_0/...qhd,...khd->...hqk/dot_general[dimension_numbers=(((2,), (1,)), ((0, 1), (0, 2))) precision=None preferred_element_type=bfloat16]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}, backend_config={"operation_queue_id":"0","wait_on_operation_queues":[],"gemm_backend_config":{"alpha_real":1,"alpha_imag":0,"beta":0,"dot_dimension_numbers":{"lhs_contracting_dimensions":["1"],"rhs_contracting_dimensions":["1"],"lhs_batch_dimensions":["0"],"rhs_batch_dimensions":["0"]},"precision_config":{"operand_precision":["DEFAULT","DEFAULT"]},"epilogue":"DEFAULT","selected_algorithm":"-1","lhs_stride":"262144","rhs_stride":"32768","grad_x":false,"grad_y":false}}
  %get-tuple-element.63.0 = bf16[208,512,64]{2,1,0} get-tuple-element((bf16[208,512,64]{2,1,0}, s8[4194304]{0}) %custom-call.76.0), index=0, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/MultiHeadDotProductAttention_0/...qhd,...khd->...hqk/dot_general[dimension_numbers=(((2,), (1,)), ((0, 1), (0, 2))) precision=None preferred_element_type=bfloat16]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %get-tuple-element.66.0 = bf16[208,512,64]{2,1,0} get-tuple-element((bf16[208,512,64]{2,1,0}, s8[4194304]{0}) %custom-call.78.0), index=0, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/MultiHeadDotProductAttention_0/...qhd,...khd->...hqk/dot_general[dimension_numbers=(((3,), (1,)), ((0, 1), (0, 2))) precision=None preferred_element_type=bfloat16]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %input_reduce_transpose_fusion.2 = (bf16[52,512,4,64]{3,2,1,0}, f32[52,4,64]{2,1,0}, bf16[4,64,52,512]{3,2,1,0}) fusion(bf16[208,512,64]{2,1,0} %get-tuple-element.66.0), kind=kInput, calls=%fused_reduce_transpose.2, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/MultiHeadDotProductAttention_0/div" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158 deduplicated_name="input_reduce_transpose_fusion.2"}
  %get-tuple-element.97 = bf16[4,64,52,512]{3,2,1,0} get-tuple-element((bf16[52,512,4,64]{3,2,1,0}, f32[52,4,64]{2,1,0}, bf16[4,64,52,512]{3,2,1,0}) %input_reduce_transpose_fusion.2), index=2
  %bitcast.6346.0 = bf16[256,26624]{1,0} bitcast(bf16[4,64,52,512]{3,2,1,0} %get-tuple-element.97)
  %get-tuple-element.96 = f32[52,4,64]{2,1,0} get-tuple-element((bf16[52,512,4,64]{3,2,1,0}, f32[52,4,64]{2,1,0}, bf16[4,64,52,512]{3,2,1,0}) %input_reduce_transpose_fusion.2), index=1
  %get-tuple-element.95 = bf16[52,512,4,64]{3,2,1,0} get-tuple-element((bf16[52,512,4,64]{3,2,1,0}, f32[52,4,64]{2,1,0}, bf16[4,64,52,512]{3,2,1,0}) %input_reduce_transpose_fusion.2), index=0
  %bitcast.6184.0 = bf16[26624,256]{1,0} bitcast(bf16[52,512,4,64]{3,2,1,0} %get-tuple-element.95)
  %custom-call.79.0 = (bf16[26624,256]{1,0}, s8[4194304]{0}) custom-call(bf16[26624,256]{1,0} %bitcast.6184.0, bf16[256,256]{0,1} %bitcast.6188.0), custom_call_target="__cublas$gemm", metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/MultiHeadDotProductAttention_0/query/dot_general[dimension_numbers=(((2, 3), (1, 2)), ((), ())) precision=None preferred_element_type=None]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}, backend_config={"operation_queue_id":"0","wait_on_operation_queues":[],"gemm_backend_config":{"alpha_real":1,"alpha_imag":0,"beta":0,"dot_dimension_numbers":{"lhs_contracting_dimensions":["1"],"rhs_contracting_dimensions":["0"],"lhs_batch_dimensions":[],"rhs_batch_dimensions":[]},"precision_config":{"operand_precision":["DEFAULT","DEFAULT"]},"epilogue":"DEFAULT","selected_algorithm":"-1","lhs_stride":"6815744","rhs_stride":"65536","grad_x":false,"grad_y":false}}
  %get-tuple-element.67.0 = bf16[26624,256]{1,0} get-tuple-element((bf16[26624,256]{1,0}, s8[4194304]{0}) %custom-call.79.0), index=0, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/MultiHeadDotProductAttention_0/query/dot_general[dimension_numbers=(((2, 3), (1, 2)), ((), ())) precision=None preferred_element_type=None]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %custom-call.83.0 = (bf16[256,256]{0,1}, s8[4194304]{0}) custom-call(bf16[256,26624]{1,0} %bitcast.6346.0, bf16[26624,256]{1,0} %bitcast.6377.0), custom_call_target="__cublas$gemm", metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/MultiHeadDotProductAttention_0/query/dot_general[dimension_numbers=(((0, 1), (0, 1)), ((), ())) precision=None preferred_element_type=None]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}, backend_config={"operation_queue_id":"0","wait_on_operation_queues":[],"gemm_backend_config":{"alpha_real":1,"alpha_imag":0,"beta":0,"dot_dimension_numbers":{"lhs_contracting_dimensions":["1"],"rhs_contracting_dimensions":["0"],"lhs_batch_dimensions":[],"rhs_batch_dimensions":[]},"precision_config":{"operand_precision":["DEFAULT","DEFAULT"]},"epilogue":"DEFAULT","selected_algorithm":"-1","lhs_stride":"6815744","rhs_stride":"6815744","grad_x":false,"grad_y":false}}
  %get-tuple-element.71.0 = bf16[256,256]{0,1} get-tuple-element((bf16[256,256]{0,1}, s8[4194304]{0}) %custom-call.83.0), index=0, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/MultiHeadDotProductAttention_0/query/dot_general[dimension_numbers=(((0, 1), (0, 1)), ((), ())) precision=None preferred_element_type=None]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %loop_convert_fusion.6 = f32[256,4,64]{2,1,0} fusion(bf16[256,256]{0,1} %get-tuple-element.71.0), kind=kLoop, calls=%fused_convert.6, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/MultiHeadDotProductAttention_0/query/convert_element_type[new_dtype=float32 weak_type=False]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158 deduplicated_name="loop_convert_fusion.1"}
  %input_reduce_transpose_fusion = (bf16[4,64,52,512]{3,2,1,0}, bf16[52,512,4,64]{3,2,1,0}, f32[52,4,64]{2,1,0}) fusion(bf16[208,512,64]{2,1,0} %get-tuple-element.63.0), kind=kInput, calls=%fused_reduce_transpose, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/MultiHeadDotProductAttention_0/...qhd,...khd->...hqk/transpose[permutation=(0, 2, 1, 3)]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158 deduplicated_name="input_reduce_transpose_fusion"}
  %get-tuple-element.92 = f32[52,4,64]{2,1,0} get-tuple-element((bf16[4,64,52,512]{3,2,1,0}, bf16[52,512,4,64]{3,2,1,0}, f32[52,4,64]{2,1,0}) %input_reduce_transpose_fusion), index=2
  %input_reduce_fusion.32 = (f32[4,64]{1,0}, f32[4,64]{1,0}, f32[4,64]{1,0}, f32[4,64]{1,0}, f32[4,64]{1,0}) fusion(f32[52,4,64]{2,1,0} %get-tuple-element.96, f32[52,4,64]{2,1,0} %input_reduce_fusion.26, f32[52,4,64]{2,1,0} %get-tuple-element.92, f32[52,4,64]{2,1,0} %get-tuple-element.116, f32[52,4,64]{2,1,0} %get-tuple-element.120), kind=kInput, calls=%fused_reduce.32, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/MultiHeadDotProductAttention_0/query/reduce_sum[axes=(0, 1)]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %get-tuple-element.198 = f32[4,64]{1,0} get-tuple-element((f32[4,64]{1,0}, f32[4,64]{1,0}, f32[4,64]{1,0}, f32[4,64]{1,0}, f32[4,64]{1,0}) %input_reduce_fusion.32), index=4
  %get-tuple-element.197 = f32[4,64]{1,0} get-tuple-element((f32[4,64]{1,0}, f32[4,64]{1,0}, f32[4,64]{1,0}, f32[4,64]{1,0}, f32[4,64]{1,0}) %input_reduce_fusion.32), index=3
  %get-tuple-element.196 = f32[4,64]{1,0} get-tuple-element((f32[4,64]{1,0}, f32[4,64]{1,0}, f32[4,64]{1,0}, f32[4,64]{1,0}, f32[4,64]{1,0}) %input_reduce_fusion.32), index=2
  %get-tuple-element.189 = f32[4,64]{1,0} get-tuple-element((f32[4,64]{1,0}, f32[4,64]{1,0}, f32[4,64]{1,0}, f32[4,64]{1,0}, f32[4,64]{1,0}) %input_reduce_fusion.32), index=1
  %get-tuple-element.188 = f32[4,64]{1,0} get-tuple-element((f32[4,64]{1,0}, f32[4,64]{1,0}, f32[4,64]{1,0}, f32[4,64]{1,0}, f32[4,64]{1,0}) %input_reduce_fusion.32), index=0
  %get-tuple-element.91 = bf16[52,512,4,64]{3,2,1,0} get-tuple-element((bf16[4,64,52,512]{3,2,1,0}, bf16[52,512,4,64]{3,2,1,0}, f32[52,4,64]{2,1,0}) %input_reduce_transpose_fusion), index=1
  %get-tuple-element.90 = bf16[4,64,52,512]{3,2,1,0} get-tuple-element((bf16[4,64,52,512]{3,2,1,0}, bf16[52,512,4,64]{3,2,1,0}, f32[52,4,64]{2,1,0}) %input_reduce_transpose_fusion), index=0
  %bitcast.6293.0 = bf16[256,26624]{1,0} bitcast(bf16[4,64,52,512]{3,2,1,0} %get-tuple-element.90)
  %custom-call.81.0 = (bf16[256,256]{0,1}, s8[4194304]{0}) custom-call(bf16[256,26624]{1,0} %bitcast.6293.0, bf16[26624,256]{1,0} %bitcast.6377.0), custom_call_target="__cublas$gemm", metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/MultiHeadDotProductAttention_0/key/dot_general[dimension_numbers=(((0, 1), (0, 1)), ((), ())) precision=None preferred_element_type=None]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}, backend_config={"operation_queue_id":"0","wait_on_operation_queues":[],"gemm_backend_config":{"alpha_real":1,"alpha_imag":0,"beta":0,"dot_dimension_numbers":{"lhs_contracting_dimensions":["1"],"rhs_contracting_dimensions":["0"],"lhs_batch_dimensions":[],"rhs_batch_dimensions":[]},"precision_config":{"operand_precision":["DEFAULT","DEFAULT"]},"epilogue":"DEFAULT","selected_algorithm":"-1","lhs_stride":"6815744","rhs_stride":"6815744","grad_x":false,"grad_y":false}}
  %get-tuple-element.69.0 = bf16[256,256]{0,1} get-tuple-element((bf16[256,256]{0,1}, s8[4194304]{0}) %custom-call.81.0), index=0, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/MultiHeadDotProductAttention_0/key/dot_general[dimension_numbers=(((0, 1), (0, 1)), ((), ())) precision=None preferred_element_type=None]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %bitcast.6153.0 = bf16[26624,256]{1,0} bitcast(bf16[52,512,4,64]{3,2,1,0} %get-tuple-element.91)
  %loop_convert_fusion.8 = f32[256,4,64]{2,1,0} fusion(bf16[256,256]{0,1} %get-tuple-element.69.0), kind=kLoop, calls=%fused_convert.8, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/MultiHeadDotProductAttention_0/key/convert_element_type[new_dtype=float32 weak_type=False]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158 deduplicated_name="loop_convert_fusion.1"}
  %custom-call.77.0 = (bf16[26624,256]{1,0}, s8[4194304]{0}) custom-call(bf16[26624,256]{1,0} %bitcast.6153.0, bf16[256,256]{0,1} %bitcast.6157.0), custom_call_target="__cublas$gemm", metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/MultiHeadDotProductAttention_0/key/dot_general[dimension_numbers=(((2, 3), (1, 2)), ((), ())) precision=None preferred_element_type=None]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}, backend_config={"operation_queue_id":"0","wait_on_operation_queues":[],"gemm_backend_config":{"alpha_real":1,"alpha_imag":0,"beta":0,"dot_dimension_numbers":{"lhs_contracting_dimensions":["1"],"rhs_contracting_dimensions":["0"],"lhs_batch_dimensions":[],"rhs_batch_dimensions":[]},"precision_config":{"operand_precision":["DEFAULT","DEFAULT"]},"epilogue":"DEFAULT","selected_algorithm":"-1","lhs_stride":"6815744","rhs_stride":"65536","grad_x":false,"grad_y":false}}
  %get-tuple-element.64.0 = bf16[26624,256]{1,0} get-tuple-element((bf16[26624,256]{1,0}, s8[4194304]{0}) %custom-call.77.0), index=0, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/MultiHeadDotProductAttention_0/key/dot_general[dimension_numbers=(((2, 3), (1, 2)), ((), ())) precision=None preferred_element_type=None]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %cublas-gemm.5.0 = (bf16[26624,256]{1,0}, s8[4194304]{0}) custom-call(bf16[26624,256]{1,0} %bitcast.6085.0, bf16[256,256]{0,1} %bitcast.6089.0, bf16[26624,256]{1,0} %get-tuple-element.64.0), custom_call_target="__cublas$gemm", output_to_operand_aliasing={{0}: (2, {})}, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/MultiHeadDotProductAttention_0/value/dot_general[dimension_numbers=(((2, 3), (1, 2)), ((), ())) precision=None preferred_element_type=None]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}, backend_config={"operation_queue_id":"0","wait_on_operation_queues":[],"gemm_backend_config":{"alpha_real":1,"alpha_imag":0,"beta":1,"dot_dimension_numbers":{"lhs_contracting_dimensions":["1"],"rhs_contracting_dimensions":["0"],"lhs_batch_dimensions":[],"rhs_batch_dimensions":[]},"precision_config":{"operand_precision":["DEFAULT","DEFAULT"]},"epilogue":"DEFAULT","selected_algorithm":"-1","lhs_stride":"6815744","rhs_stride":"65536","grad_x":false,"grad_y":false}}
  %get-tuple-element.65.0 = bf16[26624,256]{1,0} get-tuple-element((bf16[26624,256]{1,0}, s8[4194304]{0}) %cublas-gemm.5.0), index=0, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/MultiHeadDotProductAttention_0/value/dot_general[dimension_numbers=(((2, 3), (1, 2)), ((), ())) precision=None preferred_element_type=None]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=158}
  %input_reduce_fusion.4 = f32[208,256]{1,0} fusion(bf16[26624,256]{1,0} %get-tuple-element.67.0, bf16[26624,256]{1,0} %get-tuple-element.65.0), kind=kInput, calls=%fused_reduce.4, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/LayerNorm_0/reduce_sum[axes=(0, 1)]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156 deduplicated_name="input_reduce_fusion.2"}
  %input_reduce_fusion.43 = (f32[256]{0}, f32[256]{0}, f32[256]{0}, f32[256]{0}) fusion(f32[208,256]{1,0} %input_reduce_fusion.4, f32[208,256]{1,0} %input_reduce_fusion.3, f32[208,256]{1,0} %input_reduce_fusion.1, f32[208,256]{1,0} %input_reduce_fusion.2), kind=kInput, calls=%fused_reduce.43, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/LayerNorm_0/reduce_sum[axes=(0, 1)]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
  %input_transpose_fusion = f32[512,256,52]{2,1,0} fusion(bf16[26624,256]{1,0} %get-tuple-element.67.0, bf16[26624,256]{1,0} %get-tuple-element.65.0), kind=kInput, calls=%fused_transpose, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/LayerNorm_0/convert_element_type[new_dtype=float32 weak_type=False]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156 deduplicated_name="input_transpose_fusion"}
  %get-tuple-element.177 = f32[256]{0} get-tuple-element((f32[256]{0}, f32[256]{0}, f32[256]{0}, f32[256]{0}) %input_reduce_fusion.43), index=3
  %get-tuple-element.176 = f32[256]{0} get-tuple-element((f32[256]{0}, f32[256]{0}, f32[256]{0}, f32[256]{0}) %input_reduce_fusion.43), index=2
  %get-tuple-element.175 = f32[256]{0} get-tuple-element((f32[256]{0}, f32[256]{0}, f32[256]{0}, f32[256]{0}) %input_reduce_fusion.43), index=1
  %get-tuple-element.174 = f32[256]{0} get-tuple-element((f32[256]{0}, f32[256]{0}, f32[256]{0}, f32[256]{0}) %input_reduce_fusion.43), index=0
  %input_reduce_fusion.38 = (f32[512,52]{1,0}, f32[512,52]{1,0}) fusion(f32[512,256,52]{2,1,0} %input_transpose_fusion, f32[256]{0} %Arg_3.4.0, f32[1,512,52]{2,1,0} %get-tuple-element.166, f32[512,52]{1,0} %get-tuple-element.167, bf16[512,256]{1,0} %Arg_34.35.0, /*index=5*/bf16[512,256,52]{2,1,0} %input_transpose_fusion.10), kind=kInput, calls=%fused_reduce.38, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/LayerNorm_0/neg" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
  %get-tuple-element.89 = f32[512,52]{1,0} get-tuple-element((f32[512,52]{1,0}, f32[512,52]{1,0}) %input_reduce_fusion.38), index=1
  %get-tuple-element.88 = f32[512,52]{1,0} get-tuple-element((f32[512,52]{1,0}, f32[512,52]{1,0}) %input_reduce_fusion.38), index=0
  %loop_multiply_fusion.4 = (f32[512,52]{1,0}, f32[512,52]{1,0}) fusion(f32[1,512,52]{2,1,0} %get-tuple-element.166, f32[512,52]{1,0} %get-tuple-element.167, f32[512,52]{1,0} %get-tuple-element.169, f32[512,52]{1,0} %get-tuple-element.89, f32[512,52]{1,0} %get-tuple-element.88, /*index=5*/f32[512,52]{1,0} %get-tuple-element.168), kind=kLoop, calls=%fused_multiply.4, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/LayerNorm_0/mul" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156 deduplicated_name="loop_multiply_fusion"}
  %get-tuple-element.87 = f32[512,52]{1,0} get-tuple-element((f32[512,52]{1,0}, f32[512,52]{1,0}) %loop_multiply_fusion.4), index=1
  %get-tuple-element.86 = f32[512,52]{1,0} get-tuple-element((f32[512,52]{1,0}, f32[512,52]{1,0}) %loop_multiply_fusion.4), index=0
  %input_reduce_fusion.21 = f32[512,256]{1,0} fusion(f32[1,512,52]{2,1,0} %get-tuple-element.166, f32[512,256,52]{2,1,0} %input_transpose_fusion, f32[512,52]{1,0} %get-tuple-element.167, bf16[512,256]{1,0} %Arg_34.35.0, bf16[512,256,52]{2,1,0} %input_transpose_fusion.10), kind=kInput, calls=%fused_reduce.21
  %input_add_transpose_fusion = (bf16[52,512,256]{2,1,0}, f32[512,256,52]{2,1,0}) fusion(f32[512,52]{1,0} %get-tuple-element.87, f32[512,52]{1,0} %get-tuple-element.86, bf16[512,256]{1,0} %Arg_34.35.0, bf16[512,256,52]{2,1,0} %input_transpose_fusion.10, f32[512,256,52]{2,1,0} %get-tuple-element.103, /*index=5*/f32[512,256,52]{2,1,0} %input_transpose_fusion, f32[256]{0} %Arg_3.4.0, f32[1,512,52]{2,1,0} %get-tuple-element.166), kind=kInput, calls=%fused_add_transpose, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/LayerNorm_0/add_any" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156}
  %input_reduce_fusion.42 = (f32[256]{0}, f32[256]{0}, f32[256]{0}, f32[256]{0}, f32[256]{0}) fusion(f32[512,256]{1,0} %get-tuple-element.139, f32[512,256]{1,0} %input_reduce_fusion.18, f32[512,256]{1,0} %input_reduce_fusion.19, f32[512,256]{1,0} %input_reduce_fusion.20, f32[512,256]{1,0} %input_reduce_fusion.21), kind=kInput, calls=%fused_reduce.42, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoder_norm/reduce_sum[axes=(0, 1)]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=228}
  %get-tuple-element.85 = f32[512,256,52]{2,1,0} get-tuple-element((bf16[52,512,256]{2,1,0}, f32[512,256,52]{2,1,0}) %input_add_transpose_fusion), index=1
  %get-tuple-element.84 = bf16[52,512,256]{2,1,0} get-tuple-element((bf16[52,512,256]{2,1,0}, f32[512,256,52]{2,1,0}) %input_add_transpose_fusion), index=0
  %bitcast.6745.0 = bf16[26624,256]{1,0} bitcast(bf16[52,512,256]{2,1,0} %get-tuple-element.84)
  %get-tuple-element.182 = f32[256]{0} get-tuple-element((f32[256]{0}, f32[256]{0}, f32[256]{0}, f32[256]{0}, f32[256]{0}) %input_reduce_fusion.42), index=4
  %get-tuple-element.181 = f32[256]{0} get-tuple-element((f32[256]{0}, f32[256]{0}, f32[256]{0}, f32[256]{0}, f32[256]{0}) %input_reduce_fusion.42), index=3
  %get-tuple-element.180 = f32[256]{0} get-tuple-element((f32[256]{0}, f32[256]{0}, f32[256]{0}, f32[256]{0}, f32[256]{0}) %input_reduce_fusion.42), index=2
  %get-tuple-element.179 = f32[256]{0} get-tuple-element((f32[256]{0}, f32[256]{0}, f32[256]{0}, f32[256]{0}, f32[256]{0}) %input_reduce_fusion.42), index=1
  %get-tuple-element.178 = f32[256]{0} get-tuple-element((f32[256]{0}, f32[256]{0}, f32[256]{0}, f32[256]{0}, f32[256]{0}) %input_reduce_fusion.42), index=0
  %input_reduce_fusion.36 = f32[512,256]{1,0} fusion(f32[512,256,52]{2,1,0} %get-tuple-element.85), kind=kInput, calls=%fused_reduce.36
  %input_transpose_fusion.23 = bf16[256,52,512]{2,1,0} fusion(f32[512,256,52]{2,1,0} %get-tuple-element.85), kind=kInput, calls=%fused_transpose.24, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/encoder/encoderblock_0/LayerNorm_0/add_any" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=156 deduplicated_name="input_transpose_fusion.23"}
  %input_convert_reduce_fusion = (f32[256]{0}, bf16[512,256]{1,0}) fusion(f32[512,256]{1,0} %input_reduce_fusion.36), kind=kInput, calls=%fused_convert_reduce, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/im_embed/vmap(inner)/vmap(Patchify_0)/patch_proj/reduce_sum[axes=(0, 1)]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=40}
  %get-tuple-element.83 = bf16[512,256]{1,0} get-tuple-element((f32[256]{0}, bf16[512,256]{1,0}) %input_convert_reduce_fusion), index=1
  %get-tuple-element.82 = f32[256]{0} get-tuple-element((f32[256]{0}, bf16[512,256]{1,0}) %input_convert_reduce_fusion), index=0
  %bitcast.6726.0 = bf16[256,26624]{1,0} bitcast(bf16[256,52,512]{2,1,0} %input_transpose_fusion.23)
  %custom-call.90.0 = (bf16[1728,256]{1,0}, s8[4194304]{0}) custom-call(bf16[26624,1728]{1,0} %bitcast.6721.0, bf16[256,26624]{1,0} %bitcast.6726.0), custom_call_target="__cublas$gemm", metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/im_embed/vmap(inner)/vmap(Patchify_0)/patch_proj/transpose[permutation=(1, 0)]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=40}, backend_config={"operation_queue_id":"0","wait_on_operation_queues":[],"gemm_backend_config":{"alpha_real":1,"alpha_imag":0,"beta":0,"dot_dimension_numbers":{"lhs_contracting_dimensions":["0"],"rhs_contracting_dimensions":["1"],"lhs_batch_dimensions":[],"rhs_batch_dimensions":[]},"precision_config":{"operand_precision":["DEFAULT","DEFAULT"]},"epilogue":"DEFAULT","selected_algorithm":"-1","lhs_stride":"46006272","rhs_stride":"6815744","grad_x":false,"grad_y":false}}
  %get-tuple-element.78.0 = bf16[1728,256]{1,0} get-tuple-element((bf16[1728,256]{1,0}, s8[4194304]{0}) %custom-call.90.0), index=0, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/im_embed/vmap(inner)/vmap(Patchify_0)/patch_proj/transpose[permutation=(1, 0)]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=40}
  %wrapped_convert.12 = f32[1728,256]{1,0} fusion(bf16[1728,256]{1,0} %get-tuple-element.78.0), kind=kLoop, calls=%wrapped_convert_computation.12, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/im_embed/vmap(inner)/vmap(Patchify_0)/patch_proj/convert_element_type[new_dtype=float32 weak_type=False]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=40}
  %custom-call.91.0 = (bf16[26624,1728]{1,0}, s8[4194304]{0}) custom-call(bf16[26624,256]{1,0} %bitcast.6745.0, bf16[1728,256]{1,0} %wrapped_convert.1), custom_call_target="__cublas$gemm", metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/im_embed/vmap(inner)/vmap(Patchify_0)/patch_proj/dot_general[dimension_numbers=(((2,), (1,)), ((), ())) precision=None preferred_element_type=None]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=40}, backend_config={"operation_queue_id":"0","wait_on_operation_queues":[],"gemm_backend_config":{"alpha_real":1,"alpha_imag":0,"beta":0,"dot_dimension_numbers":{"lhs_contracting_dimensions":["1"],"rhs_contracting_dimensions":["1"],"lhs_batch_dimensions":[],"rhs_batch_dimensions":[]},"precision_config":{"operand_precision":["DEFAULT","DEFAULT"]},"epilogue":"DEFAULT","selected_algorithm":"-1","lhs_stride":"6815744","rhs_stride":"442368","grad_x":false,"grad_y":false}}
  %get-tuple-element.79.0 = bf16[26624,1728]{1,0} get-tuple-element((bf16[26624,1728]{1,0}, s8[4194304]{0}) %custom-call.91.0), index=0, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/im_embed/vmap(inner)/vmap(Patchify_0)/patch_proj/dot_general[dimension_numbers=(((2,), (1,)), ((), ())) precision=None preferred_element_type=None]" source_file="/home/nicholas/programs/avid/avid/vit.py" source_line=40}
  %loop_convert_fusion.9 = bf16[13824,5,52,64]{3,2,1,0} fusion(bf16[26624,1728]{1,0} %get-tuple-element.79.0, bf16[5,52]{1,0} %constant_134_0), kind=kLoop, calls=%fused_convert.9
  %bitcast.6782.0 = bf16[64,3594240]{0,1} bitcast(bf16[13824,5,52,64]{3,2,1,0} %loop_convert_fusion.9)
  %custom-call.92.0 = (bf16[64,64]{1,0}, s8[4194304]{0}) custom-call(bf16[3594240,64]{1,0} %bitcast.6778.0, bf16[64,3594240]{0,1} %bitcast.6782.0), custom_call_target="__cublas$gemm", metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/spec_embed/vmap(vmap(vmap(species_embed)))/embed_module/Dense_0/transpose[permutation=(1, 0)]" source_file="/home/nicholas/programs/avid/avid/layers.py" source_line=49}, backend_config={"operation_queue_id":"0","wait_on_operation_queues":[],"gemm_backend_config":{"alpha_real":1,"alpha_imag":0,"beta":0,"dot_dimension_numbers":{"lhs_contracting_dimensions":["0"],"rhs_contracting_dimensions":["1"],"lhs_batch_dimensions":[],"rhs_batch_dimensions":[]},"precision_config":{"operand_precision":["DEFAULT","DEFAULT"]},"epilogue":"DEFAULT","selected_algorithm":"-1","lhs_stride":"230031360","rhs_stride":"230031360","grad_x":false,"grad_y":false}}
  %get-tuple-element.80.0 = bf16[64,64]{1,0} get-tuple-element((bf16[64,64]{1,0}, s8[4194304]{0}) %custom-call.92.0), index=0, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/spec_embed/vmap(vmap(vmap(species_embed)))/embed_module/Dense_0/transpose[permutation=(1, 0)]" source_file="/home/nicholas/programs/avid/avid/layers.py" source_line=49}
  %bitcast.6794.0 = bf16[3594240,64]{1,0} bitcast(bf16[13824,5,52,64]{3,2,1,0} %loop_convert_fusion.9)
  %input_reduce_fusion.6 = f32[3510,64]{1,0} fusion(bf16[13824,5,52,64]{3,2,1,0} %loop_convert_fusion.9), kind=kInput, calls=%fused_reduce.6, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/spec_embed/vmap(vmap(vmap(species_embed)))/embed_module/Dense_0/reduce_sum[axes=(0, 1, 2)]" source_file="/home/nicholas/programs/avid/avid/layers.py" source_line=49}
  %input_reduce_fusion.37 = f32[64]{0} fusion(f32[3510,64]{1,0} %input_reduce_fusion.6), kind=kInput, calls=%fused_reduce.37, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/spec_embed/vmap(vmap(vmap(species_embed)))/embed_module/Dense_0/reduce_sum[axes=(0, 1, 2)]" source_file="/home/nicholas/programs/avid/avid/layers.py" source_line=49}
  %custom-call.93.0 = (bf16[3594240,64]{1,0}, s8[4194304]{0}) custom-call(bf16[3594240,64]{1,0} %bitcast.6794.0, bf16[64,64]{1,0} %wrapped_convert), custom_call_target="__cublas$gemm", metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/spec_embed/vmap(vmap(vmap(species_embed)))/embed_module/Dense_0/dot_general[dimension_numbers=(((3,), (1,)), ((), ())) precision=None preferred_element_type=None]" source_file="/home/nicholas/programs/avid/avid/layers.py" source_line=49}, backend_config={"operation_queue_id":"0","wait_on_operation_queues":[],"gemm_backend_config":{"alpha_real":1,"alpha_imag":0,"beta":0,"dot_dimension_numbers":{"lhs_contracting_dimensions":["1"],"rhs_contracting_dimensions":["1"],"lhs_batch_dimensions":[],"rhs_batch_dimensions":[]},"precision_config":{"operand_precision":["DEFAULT","DEFAULT"]},"epilogue":"DEFAULT","selected_algorithm":"-1","lhs_stride":"230031360","rhs_stride":"4096","grad_x":false,"grad_y":false}}
  %get-tuple-element.81.0 = bf16[3594240,64]{1,0} get-tuple-element((bf16[3594240,64]{1,0}, s8[4194304]{0}) %custom-call.93.0), index=0, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/spec_embed/vmap(vmap(vmap(species_embed)))/embed_module/Dense_0/dot_general[dimension_numbers=(((3,), (1,)), ((), ())) precision=None preferred_element_type=None]" source_file="/home/nicholas/programs/avid/avid/layers.py" source_line=49}
  %input_reduce_fusion.7 = f32[216,5,52,63]{3,2,1,0} fusion(bf16[3594240,64]{1,0} %get-tuple-element.81.0), kind=kInput, calls=%fused_reduce.7, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/spec_embed/vmap(vmap(vmap(species_embed)))/reduce_sum[axes=(0,)]" source_file="/home/nicholas/programs/avid/avid/encoder.py" source_line=36}
  %input_scatter_fusion = bf16[56,63]{1,0} fusion(bf16[56,63]{1,0} %loop_broadcast_fusion, s32[260,1]{1,0} %constant_129_0, f32[216,5,52,63]{3,2,1,0} %input_reduce_fusion.7), kind=kInput, calls=%fused_scatter, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/spec_embed/vmap(vmap(vmap(species_embed)))/species_embed/jit(_take)/scatter-add[update_consts=() dimension_numbers=ScatterDimensionNumbers(update_window_dims=(2,), inserted_window_dims=(0,), scatter_dims_to_operand_dims=(0,)) indices_are_sorted=False unique_indices=False mode=GatherScatterMode.FILL_OR_DROP]" source_file="/home/nicholas/programs/avid/avid/encoder.py" source_line=36}
  %input_slice_fusion = (f32[3528]{0}, f32[4096]{0}) fusion(bf16[56,63]{1,0} %input_scatter_fusion, bf16[64,64]{1,0} %get-tuple-element.80.0), kind=kInput, calls=%fused_slice, metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/spec_embed/vmap(vmap(vmap(species_embed)))/embed_module/Dense_0/convert_element_type[new_dtype=float32 weak_type=False]" source_file="/home/nicholas/programs/avid/avid/layers.py" source_line=49}
  %get-tuple-element.173 = f32[4096]{0} get-tuple-element((f32[3528]{0}, f32[4096]{0}) %input_slice_fusion), index=1
  %get-tuple-element.172 = f32[3528]{0} get-tuple-element((f32[3528]{0}, f32[4096]{0}) %input_slice_fusion), index=0
  %bitcast.7233 = f32[56,63]{1,0} bitcast(f32[3528]{0} %get-tuple-element.172), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/spec_embed/vmap(vmap(vmap(species_embed)))/species_embed/convert_element_type[new_dtype=float32 weak_type=False]" source_file="/home/nicholas/programs/avid/avid/encoder.py" source_line=36}
  %bitcast.7234 = f32[64,64]{1,0} bitcast(f32[4096]{0} %get-tuple-element.173), metadata={op_name="jit(loss)/jit(main)/transpose(jvp(ViTRegressor))/spec_embed/vmap(vmap(vmap(species_embed)))/embed_module/Dense_0/convert_element_type[new_dtype=float32 weak_type=False]" source_file="/home/nicholas/programs/avid/avid/layers.py" source_line=49}
  ROOT %tuple.1411.0 = (bf16[], f32[256]{0}, f32[256]{0}, f32[256]{0}, f32[256]{0}, /*index=5*/f32[256]{0}, f32[256]{0}, f32[256]{0}, f32[256,256]{1,0}, f32[4,64]{1,0}, /*index=10*/f32[256,4,64]{2,1,0}, f32[256]{0}, f32[4,64,256]{2,1,0}, f32[4,64]{1,0}, f32[256,4,64]{2,1,0}, /*index=15*/f32[4,64]{1,0}, f32[256,4,64]{2,1,0}, f32[256]{0}, f32[256]{0}, f32[256]{0}, /*index=20*/f32[256]{0}, f32[256]{0}, f32[256,256]{1,0}, f32[4,64]{1,0}, f32[256,4,64]{2,1,0}, /*index=25*/f32[256]{0}, f32[4,64,256]{2,1,0}, f32[4,64]{1,0}, f32[256,4,64]{2,1,0}, f32[4,64]{1,0}, /*index=30*/f32[256,4,64]{2,1,0}, f32[1]{0}, f32[256,1]{1,0}, f32[256]{0}, f32[1728,256]{1,0}, /*index=35*/bf16[512,256]{1,0}, f32[64]{0}, f32[64,64]{1,0}, f32[56,63]{1,0}) tuple(bf16[] %loop_convert_fusion.16, f32[256]{0} %get-tuple-element.183, f32[256]{0} %get-tuple-element.178, f32[256]{0} %get-tuple-element.174, f32[256]{0} %get-tuple-element.182, /*index=5*/f32[256]{0} %get-tuple-element.175, f32[256]{0} %get-tuple-element.181, f32[256]{0} %get-tuple-element.185, f32[256,256]{1,0} %get-tuple-element.170, f32[4,64]{1,0} %get-tuple-element.196, /*index=10*/f32[256,4,64]{2,1,0} %loop_convert_fusion.8, f32[256]{0} %get-tuple-element.184, f32[4,64,256]{2,1,0} %loop_convert_fusion.7, f32[4,64]{1,0} %get-tuple-element.188, f32[256,4,64]{2,1,0} %loop_convert_fusion.6, /*index=15*/f32[4,64]{1,0} %get-tuple-element.189, f32[256,4,64]{2,1,0} %loop_convert_fusion.5, f32[256]{0} %get-tuple-element.177, f32[256]{0} %get-tuple-element.180, f32[256]{0} %get-tuple-element.176, /*index=20*/f32[256]{0} %get-tuple-element.179, f32[256]{0} %get-tuple-element.186, f32[256,256]{1,0} %get-tuple-element.171, f32[4,64]{1,0} %get-tuple-element.197, f32[256,4,64]{2,1,0} %loop_convert_fusion.4, /*index=25*/f32[256]{0} %get-tuple-element.187, f32[4,64,256]{2,1,0} %loop_convert_fusion.3, f32[4,64]{1,0} %get-tuple-element.198, f32[256,4,64]{2,1,0} %loop_convert_fusion.2, f32[4,64]{1,0} %input_reduce_fusion.35, /*index=30*/f32[256,4,64]{2,1,0} %loop_convert_fusion.1, f32[1]{0} %input_reduce_fusion, f32[256,1]{1,0} %get-tuple-element.143, f32[256]{0} %get-tuple-element.82, f32[1728,256]{1,0} %wrapped_convert.12, /*index=35*/bf16[512,256]{1,0} %get-tuple-element.83, f32[64]{0} %input_reduce_fusion.37, f32[64,64]{1,0} %bitcast.7234, f32[56,63]{1,0} %bitcast.7233)
}

